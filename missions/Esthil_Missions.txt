
esthil_missions_1v = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = B54
	}
	
	B54_gather_canrecs_texts = {
		icon = mission_court_education
		position = 1
		
		trigger = {
			months_of_ruling = 120
			custom_trigger_tooltip = {
				tooltip = esthil_tt_15
				has_country_flag = esthil_varina_speech_done
			}
		}
		
		effect = {
			country_event = {
				id = flavor_esthil.2
				days = 180
			}
		}
	}
	
	B54_defeating_time = {
		icon = mission_restore_faith_in_the_throne
		position = 2
		required_missions = {
			B54_gather_canrecs_texts
		}
		
		trigger = {
			custom_trigger_tooltip = {
				tooltip =  esthil_tt_1
				OR = {
					has_country_flag = lich_ruler_has_phylactery
					has_ruler_flag = is_a_lich
					has_ruler_flag = is_a_secret_lich
				}
				has_country_flag = canrecs_research
		 	}
		}
		
		effect = {
			change_adm = 1
			change_dip = 1
			change_mil = 1
			take_estate_land_share_gigantic = { estate = all }
		}
	}
	
	B54_crown_of_the_damned = {
		icon = mission_rb_inland_india
		position = 3
		required_missions = {
			B54_defeating_time
		}
		
		trigger = {
			custom_trigger_tooltip = {
				tooltip =  esthil_tt_2
				had_country_flag = {
					flag = lich_ruler_has_phylactery
					days = 43800 # 120 years
				}
		 	}
			custom_trigger_tooltip = {
				tooltip =  esthil_tt_3
				OR = {
		 			has_ruler_flag = enchantment_3
		 			court_mage = 3
				}
		 	}
			any_owned_province = { trade_goods = gold }
			any_owned_province = { trade_goods = gems }
			any_owned_province = { trade_goods = damestear}
		}
		
		effect = {
			add_power_projection = {
				type = mission_rewards_power_projection
				amount = 20
			}
			add_country_modifier = {
				name = "esthil_crown_of_the_damned"
				duration = -1
			}
		}
	}
	
	B54_the_southern_walls = {
		icon = mission_sail_to_the_east_indies
		position = 4
		required_missions = {
			B54_white_walls_for_a_black_empire
		}
		
		provinces_to_highlight = {
			OR = {
				area = upper_nath_area
				area = ardent_glade_area
				area = southgate_area
				area = oldhaven_area
				area = coalwoud_area
				area = steelhyl_area
				area = serpentsmarck_area
				area = bradescker_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			upper_nath_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			ardent_glade_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			southgate_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			oldhaven_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			coalwoud_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			steelhyl_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			serpentsmarck_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			bradescker_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		effect = {
			865 = { #Ardent Keep
				add_base_tax = 2
				add_base_production = 2
				add_base_manpower = 2
				change_culture = ROOT
				change_religion = ROOT
			}
		}
	}
	
	B54_the_skull_keep = {
		icon = fight_bosnian_heresies
		position = 5
		required_missions = {
			B54_the_southern_walls
		}
		
		provinces_to_highlight = {
			province_id = 865
			NOT = {
				AND = {
					owned_by = ROOT
					has_courthouse_building_trigger = yes
					has_building = ramparts
					has_fort_building_trigger = yes
				}
			}
		}
		
		trigger = {
			865 = { #Ardent Keep
				owned_by = ROOT
				has_courthouse_building_trigger = yes
				has_building = ramparts
				has_fort_building_trigger = yes
			}
		}
		
		effect = {
			865 = {
				rename_capital = "Skull Keep"
				change_province_name = "Skull Keep"
				add_province_modifier = {
					name = esthil_skull_keep
					duration = -1
				}
			}
		}
	}
	
	B54_the_dread_legion = {
		icon = gory_to_the_black_army
		position = 6
		required_missions = {
			B54_the_skull_keep
		}
		
		provinces_to_highlight = {
			owned_by = ROOT
			province_group = southern_walls
			NOT = {
				AND = {
					province_has_current_tech_fort_trigger = yes
					has_manpower_building_trigger = yes
				}
			}
		}
		
		trigger = {
			num_of_owned_provinces_with = {
				value = 4
				province_group = southern_walls
				province_has_current_tech_fort_trigger = yes
				has_manpower_building_trigger = yes
			}
		}
		
		effect = {
			unlock_merc_company = {
				merc_company = merc_esthil_dread_legion
			}
			random_owned_province = {
				limit = {
					province_group = southern_walls
					province_has_current_tech_fort_trigger = yes
					has_manpower_building_trigger = yes
					NOT = { has_province_modifier = esthil_fortifications }
				}
				add_permanent_province_modifier = {
					name = "esthil_fortifications"
					duration = -1
				}
			}
			random_owned_province = {
				limit = {
					province_group = southern_walls
					province_has_current_tech_fort_trigger = yes
					has_manpower_building_trigger = yes
					NOT = { has_province_modifier = esthil_fortifications }
				}
				add_permanent_province_modifier = {
					name = "esthil_fortifications"
					duration = -1
				}
			}
			random_owned_province = {
				limit = {
					province_group = southern_walls
					province_has_current_tech_fort_trigger = yes
					has_manpower_building_trigger = yes
					NOT = { has_province_modifier = esthil_fortifications }
				}
				add_permanent_province_modifier = {
					name = "esthil_fortifications"
					duration = -1
				}
			}
			random_owned_province = {
				limit = {
					province_group = southern_walls
					province_has_current_tech_fort_trigger = yes
					has_manpower_building_trigger = yes
					NOT = { has_province_modifier = esthil_fortifications }
				}
				add_permanent_province_modifier = {
					name = "esthil_fortifications"
					duration = -1
				}
			}
		}
	}
	
	B54_the_wightknights = {
		icon = mission_conquer_5_states
		position = 7
		required_missions = {
			B54_the_dread_legion
			B54_the_pale_legion
		}
		
		trigger = {
			num_of_owned_provinces_with = {
				value = 5
				has_manpower_building_trigger = yes
			}
			num_of_cavalry = 25
		}
		
		effect = {
			unlock_merc_company = {
				merc_company = merc_esthil_wightknights
			}
		}
	}
}

esthil_missions_2v = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = B54
	} #These are triggers for the entire series
	
	B54_esthil = {
		icon = porcelain_from_meissen
		position = 1
		
		provinces_to_highlight = {
			is_capital_of = ROOT
			NOT = {
				AND = {
					has_building = mage_tower
					development = 15
				}
			}
		}
		
		trigger = {
			capital_scope = { #Southgate
				owned_by = ROOT
				has_building = mage_tower
				development = 15
			}
		}
		
		effect = {
			capital_scope = {
				add_province_modifier = {
					name = esthil_tower
					duration = -1
				}
			}
		}
	}
	
	B54_castle_esthil = {
		icon = mission_monarch_diplomacy
		position = 2
		required_missions = {
			B54_our_own_land
			B54_esthil
		}
		
		provinces_to_highlight = {
			province_id = 830
			NOT = {
				AND = {
					owned_by = ROOT
					has_fort_building_trigger = yes
				}
			}
		}
		
		trigger = {
			830 = { #Southgate
				owned_by = ROOT
				has_fort_building_trigger = yes
			}
		}
		
		effect = {
			830 = {
				# add_province_modifier = {	#already has too many permanent modifiers and this gives no lore
				# 	name = esthil_southgate_castle
				# 	duration = -1
				# }
				add_base_manpower = 2
			}
		}
	}
	
	B54_white_walls_for_a_black_empire = {
		icon = consolidate_switzerland
		position = 3
		required_missions = {
			B54_castle_esthil
		}
		
		trigger = {
			army_size = 40
			manpower_percentage = 0.90
		}
		
		effect = {
			upper_nath_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			ardent_glade_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			southgate_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			oldhaven_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			northyl_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			westgate_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			lower_nath_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			nortmere_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			trialmount_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			serpentsmarck_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			bradescker_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			steelhyl_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			coalwoud_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			if = {
  				limit = {
					756 = { #Moonisle
						NOT = { is_core = B54 }
						NOT = { is_permanent_claim = B54 }
					}
  				}
				756 = { add_permanent_claim = B54 }
			}
		}
	}
	
	B54_the_northern_walls = {
		icon = expand_the_terraferma
		position = 4
		required_missions = {
			B54_white_walls_for_a_black_empire
		}
		
		provinces_to_highlight = {
			OR = {
				AND = {
					OR = {
						area = nortmere_area
						area = westgate_area
						area = lower_nath_area
						area = northyl_area
						area = trialmount_area
					}
					NOT = { country_or_non_sovereign_subject_holds = ROOT }
				}
				AND = {
					province_id = 756
					NOT = { owned_by = ROOT }
				}
			}
		}
		
		trigger = {
			nortmere_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			westgate_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			lower_nath_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			northyl_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			trialmount_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			756 = {
				owned_by = ROOT
			}
		}
		
		effect = {
			754 = { #Westgate
				add_province_modifier = {
					name = "esthil_gate_tolls"
					duration = 3650
				}
			}
			830 = { #Southgate
				add_province_modifier = {
					name = "esthil_gate_tolls"
					duration = 3650
				}
			}
		}
	}
	
	B54_settle_the_north = {
		icon = mission_colonial
		position = 5
		required_missions = {
			B54_the_northern_walls
		}
		
		provinces_to_highlight = {
			OR = {
				province_id = 754
				province_id = 849
			}
			NOT = {
				AND = {
					owned_by = ROOT
					culture = ROOT
					religion = ROOT
					has_manpower_building_trigger = yes
					has_trade_building_trigger = yes
				}
			}
		}
		
		trigger = {
			754 = { #Westgate
				owned_by = ROOT
				culture = ROOT
				religion = ROOT
				#development = 20
				has_manpower_building_trigger = yes
				has_trade_building_trigger = yes
			}
			849 = { #Westgate
				owned_by = ROOT
				culture = ROOT
				religion = ROOT
				#development = 20
				has_manpower_building_trigger = yes
				has_trade_building_trigger = yes
			}
			adm_power = 200
			treasury = 1000
		}
		
		effect = {
			add_treasury = -1000
			add_adm_power = -200
			754 = { #Westgate
				add_base_tax = 1
				add_base_production = 1
				if = {
					limit = {
						754 = {
							NOT = {
								trade_goods = gold
								trade_goods = gems
								trade_goods = mithril
								trade_goods = damestear
							}
						}
					}
					random_list = {
						40 = {
							754 = { change_trade_goods = cloth }
						}
						30 = {
							754 = { change_trade_goods = glass }
						}
						30 = {
							754 = { change_trade_goods = paper }
						}
					}
				}
			}
			849 = { #Khugsroad
				add_base_tax = 1
				add_base_production = 1
				if = {
					limit = {
						849 = {
							NOT = {
								trade_goods = gold
								trade_goods = gems
								trade_goods = mithril
								trade_goods = damestear
							}
						}
					}
					random_list = {
						40 = {
							849 = { change_trade_goods = cloth }
						}
						30 = {
							849 = { change_trade_goods = glass }
						}
						30 = {
							849 = { change_trade_goods = paper }
						}
					}
				}
			}
		}
	}
	
	B54_the_pale_legion = {
		icon = protect_against_austria
		position = 6
		required_missions = {
			B54_settle_the_north
		}
		
		provinces_to_highlight = {
			province_group = northern_walls
			NOT = {
				AND = {
					province_has_current_tech_fort_trigger = yes
					has_manpower_building_trigger = yes
				}
			}
		}
		
		trigger = {
			num_of_owned_provinces_with = {
				value = 3
				province_group = northern_walls
				province_has_current_tech_fort_trigger = yes
				has_manpower_building_trigger = yes
			}
		}
		
		effect = {
			unlock_merc_company = {
				merc_company = merc_esthil_pale_legion
			}
			custom_tooltip = esthil_pale_legion_reward_tt
			random_owned_province = {
				limit = {
					province_group = northern_walls
					province_has_current_tech_fort_trigger = yes
					has_manpower_building_trigger = yes
					NOT = { has_province_modifier = esthil_fortifications }
				}
				add_permanent_province_modifier = {
					name = "esthil_fortifications"
					duration = -1
				}
			}
			random_owned_province = {
				limit = {
					province_group = northern_walls
					province_has_current_tech_fort_trigger = yes
					has_manpower_building_trigger = yes
					NOT = { has_province_modifier = esthil_fortifications }
				}
				add_permanent_province_modifier = {
					name = "esthil_fortifications"
					duration = -1
				}
			}
			random_owned_province = {
				limit = {
					province_group = northern_walls
					province_has_current_tech_fort_trigger = yes
					has_manpower_building_trigger = yes
					NOT = { has_province_modifier = esthil_fortifications }
				}
				add_permanent_province_modifier = {
					name = "esthil_fortifications"
					duration = -1
				}
			}
		}
	}
	
	B54_fortify_the_entrances = {
		icon = alpine_defenses
		position = 7
		required_missions = {
			B54_the_pale_legion
			B54_the_dread_legion
		}
		
		provinces_to_highlight = {
			OR = {
				province_id = 849
				province_id = 860
			}
			NOT = {
				AND = {
					owned_by = ROOT
					has_fort_building_trigger = yes
				}
			}
		}
		
		trigger = {
			849 = {
				owned_by = ROOT
				has_fort_building_trigger = yes
			}
			860 = {
				owned_by = ROOT
				has_fort_building_trigger = yes
			}
		}
		
		effect = {
			849 = {
				add_province_modifier = {
					name = esthil_deathguard
					duration = -1
				}
			}
			860 = {
				add_province_modifier = {
					name = esthil_deathguard
					duration = -1
				}
			}
		}
	}
}

esthil_missions_3v = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = B54
	} #These are triggers for the entire series
	
	B54_our_own_land = {
		icon = prosper_in_piedmont
		position = 1
		
		trigger = {
			num_of_cities = 10
		}
		
		effect = {
			southgate_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			castonath_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = ROOT
			}
			add_prestige = 20
			add_country_modifier = {
				name = "esthil_land_consolidation"
				duration = 3650
			}
		}
	}
	
	B54_a_capital_for_an_empire = {
		icon = unify_piedmont
		position = 2
		required_missions = {
			B54_our_own_land
			B54_esthil
		}
		
		provinces_to_highlight = {
			area = castonath_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		
		trigger = {
			is_at_war = no
			castonath_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		
		effect = {
			set_capital = 831
			831 = { #SouthCastonath
				change_culture = ROOT
				change_religion = ROOT
			}
			832 = { #LowerCastonath
				change_culture = ROOT
				change_religion = ROOT
			}
			833 = { #NorthCastonath
				change_culture = ROOT
				change_religion = ROOT
			}
			add_adm_power = 200
		}
	}
	
	B54_excavate_the_steelhills = {
		icon = kingdom_of_cyprus
		position = 3
		required_missions = {
			B54_a_capital_for_an_empire
		}
		
		provinces_to_highlight = {
			OR = {
				area = serpentsmarck_area
				area = steelhyl_area
				area = coalwoud_area
			}
		}
		
		trigger = {
			serpentsmarck_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			steelhyl_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			coalwoud_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			treasury = 1500
		}
		
		effect = {
			add_treasury = -1500
			custom_tooltip = esthil_tt_4
			hidden_effect = {
				860 = {
					if = {
						limit = {
							NOT = {
								trade_goods = iron
								trade_goods = coal
								trade_goods = copper
								trade_goods = gold
								trade_goods = gems
								trade_goods = damestear
							}
						}
						random_list = {
							50 = {
								860 = { change_trade_goods = iron }
							}
							45 = {
								860 = { change_trade_goods = copper }
							}
							5 = {
								860 = { change_trade_goods = gold }
							}
						}
					}
				}
				861 = {
					if = {
						limit = {
							NOT = {
								trade_goods = iron
								trade_goods = coal
								trade_goods = copper
								trade_goods = gold
								trade_goods = gems
								trade_goods = damestear
							}
						}
						random_list = {
							50 = {
								861 = { change_trade_goods = iron }
							}
							45 = {
								861 = { change_trade_goods = copper }
							}
							5 = {
								861 = { change_trade_goods = gold }
							}
						}
					}
				}
				862 = {
					if = {
						limit = {
							NOT = {
								trade_goods = iron
								trade_goods = coal
								trade_goods = copper
								trade_goods = gold
								trade_goods = gems
								trade_goods = damestear
							}
						}
						random_list = {
							50 = {
								862 = { change_trade_goods = iron }
							}
							45 = {
								862 = { change_trade_goods = copper }
							}
							5 = {
								862 = { change_trade_goods = gold }
							}
						}
					}
				}
				859 = {
					if = {
						limit = {
							NOT = {
								trade_goods = iron
								trade_goods = coal
								trade_goods = copper
								trade_goods = gold
								trade_goods = gems
								trade_goods = damestear
							}
						}
						random_list = {
							50 = {
								859 = { change_trade_goods = iron }
							}
							45 = {
								859 = { change_trade_goods = copper }
							}
							5 = {
								859 = { change_trade_goods = gold }
							}
						}
					}
				}
				858 = {
					if = {
						limit = {
							NOT = {
								trade_goods = iron
								trade_goods = coal
								trade_goods = copper
								trade_goods = gold
								trade_goods = gems
								trade_goods = damestear
							}
						}
						random_list = {
							50 = {
								858 = { change_trade_goods = iron }
							}
							45 = {
								858 = { change_trade_goods = copper }
							}
							5 = {
								858 = { change_trade_goods = gold }
							}
						}
					}
				}
				852 = {
					if = {
						limit = {
							NOT = {
								trade_goods = iron
								trade_goods = coal
								trade_goods = copper
								trade_goods = gold
								trade_goods = gems
								trade_goods = damestear
							}
						}
						random_list = {
							50 = {
								852 = { change_trade_goods = iron }
							}
							45 = {
								852 = { change_trade_goods = copper }
							}
							5 = {
								852 = { change_trade_goods = gold }
							}
						}
					}
				}
				846 = {
					if = {
						limit = {
							NOT = {
								trade_goods = iron
								trade_goods = coal
								trade_goods = copper
								trade_goods = gold
								trade_goods = gems
								trade_goods = damestear
							}
						}
						random_list = {
							50 = {
								846 = { change_trade_goods = iron }
							}
							45 = {
								846 = { change_trade_goods = copper }
							}
							5 = {
								846 = { change_trade_goods = gold }
							}
						}
					}
				}
				860 = { #Steelhyl
					add_province_modifier = {
						name = "esthil_deadmines_0"
						duration = 1825
					}
				}
				861 = { #Alloysford
					add_province_modifier = {
						name = "esthil_deadmines_0"
						duration = 1825
					}
				}
				862 = { #Coalwoud
					add_province_modifier = {
						name = "esthil_deadmines_0"
						duration = 1825
					}
				}
				859 = { #Charwic
					add_province_modifier = {
						name = "esthil_deadmines_0"
						duration = 1825
					}
				}
				858 = { #Shaterwood
					add_province_modifier = {
						name = "esthil_deadmines_0"
						duration = 1825
					}
				}
				852 = { #Northmarck
					add_province_modifier = {
						name = "esthil_deadmines_0"
						duration = 1825
					}
				}
				846 = { #Serpentswic
					add_province_modifier = {
						name = "esthil_deadmines_0"
						duration = 1825
					}
				}
			}
		}
	}
	
	B54_bodies_for_the_mines = {
		icon = mission_monarch_diplomacy
		position = 4
		required_missions = {
			B54_excavate_the_steelhills
		}
		
		provinces_to_highlight = {
			province_id = 860
			NOT = {
				AND = {
					owned_by = ROOT
					num_of_units_in_province = {
						who = owner
						amount = 20
					}
				}
			}
		}
		
		trigger = {
			860 = {
				owned_by = ROOT
				num_of_units_in_province = {
   					who = owner
					amount = 20
				}
			}
			NOT = {
				any_owned_province = {
					has_province_modifier = esthil_deadmines_0
				}
			}
		}
		
		effect = {
			860 = { #Steelhyl
				kill_units = {
   					who = owner
					amount = 20
				}
				add_devastation = 50
				change_culture = ROOT
				change_religion = ROOT
				add_province_modifier = {
					name = "esthil_deadmines_1"
					duration = -1
				}
			}
			861 = { #Alloysford
				add_devastation = 50
				change_culture = ROOT
				change_religion = ROOT
				add_province_modifier = {
					name = "esthil_deadmines_1"
					duration = -1
				}
			}
			862 = { #Coalwoud
				add_devastation = 50
				change_culture = ROOT
				change_religion = ROOT
				add_province_modifier = {
					name = "esthil_deadmines_1"
					duration = -1
				}
			}
			859 = { #Charwic
				add_devastation = 50
				change_culture = ROOT
				change_religion = ROOT
				add_province_modifier = {
					name = "esthil_deadmines_1"
					duration = -1
				}
			}
			858 = { #Shaterwood
				add_devastation = 50
				change_culture = ROOT
				change_religion = ROOT
				add_province_modifier = {
					name = "esthil_deadmines_1"
					duration = -1
				}
			}
			852 = { #Northmarck
				add_devastation = 50
				change_culture = ROOT
				change_religion = ROOT
				add_province_modifier = {
					name = "esthil_deadmines_1"
					duration = -1
				}
			}
			846 = { #Serpentswic
				add_devastation = 50
				change_culture = ROOT
				change_religion = ROOT
				add_province_modifier = {
					name = "esthil_deadmines_1"
					duration = -1
				}
			}
		}
	}
	
	B54_the_deadmines = {
		icon = reform_the_state
		position = 5
		required_missions = {
			B54_bodies_for_the_mines
		}
		
		provinces_to_highlight = {
			OR = {
				area = serpentsmarck_area
				area = steelhyl_area
				area = coalwoud_area
			}
		}
		
		trigger = {
			860 = { #Steelhyl
				owned_by = ROOT
				base_production = 5
				OR = {
					has_production_building_trigger = yes
					trade_goods = gold
				}
				NOT = { devastation = 1 }
			}
			custom_trigger_tooltip = {
				tooltip = esthil_the_deadmines_tt
				861 = { #Alloysford
					owned_by = ROOT
					base_production = 5
					OR = {
						has_production_building_trigger = yes
						trade_goods = gold
					}
					NOT = { devastation = 1 }
				}
				862 = { #Coalwoud
					owned_by = ROOT
					base_production = 5
					OR = {
						has_production_building_trigger = yes
						trade_goods = gold
					}
					NOT = { devastation = 1 }
				}
				859 = { #Charwic
					owned_by = ROOT
					base_production = 5
					OR = {
						has_production_building_trigger = yes
						trade_goods = gold
					}
					NOT = { devastation = 1 }
				}
				858 = { #Shatterwood
					owned_by = ROOT
					base_production = 5
					OR = {
						has_production_building_trigger = yes
						trade_goods = gold
					}
					NOT = { devastation = 1 }
				}
				852 = { #Nortmarck
					owned_by = ROOT
					base_production = 5
					OR = {
						has_production_building_trigger = yes
						trade_goods = gold
					}
					NOT = { devastation = 1 }
				}
				846 = { #Serpentswic
					owned_by = ROOT
					base_production = 5
					OR = {
						has_production_building_trigger = yes
						trade_goods = gold
					}
					NOT = { devastation = 1 }
				}
			}
		}
		
		effect = {
			860 = { #Steelhyl
				remove_province_modifier = esthil_deadmines_1
				add_province_modifier = {
					name = "esthil_deadmines_2"
					duration = -1
				}
			}
			861 = { #Alloysford
				remove_province_modifier = esthil_deadmines_1
				add_province_modifier = {
					name = "esthil_deadmines_2"
					duration = -1
				}
			}
			862 = { #Coalwoud
				remove_province_modifier = esthil_deadmines_1
				add_province_modifier = {
					name = "esthil_deadmines_2"
					duration = -1
				}
			}
			859 = { #Charwic
				remove_province_modifier = esthil_deadmines_1
				add_province_modifier = {
					name = "esthil_deadmines_2"
					duration = -1
				}
			}
			858 = { #Shatterwood
				remove_province_modifier = esthil_deadmines_1
				add_province_modifier = {
					name = "esthil_deadmines_2"
					duration = -1
				}
			}
			852 = { #Northmarck
				remove_province_modifier = esthil_deadmines_1
				add_province_modifier = {
					name = "esthil_deadmines_2"
					duration = -1
				}
			}
			846 = { #Serpentswic
				remove_province_modifier = esthil_deadmines_1
				add_province_modifier = {
					name = "esthil_deadmines_2"
					duration = -1
				}
			}
		}
	}
	
	B54_wood_for_the_mines = {
		icon = claim_the_borderlands
		position = 6
		required_missions = {
			B54_settle_the_north
			B54_the_deadmines
		}
		
		provinces_to_highlight = {
			OR = {
				area = westgate_area
				area = northyl_area
				area = trialmount_area
			}
			NOT = {
				AND = {
					has_trade_building_trigger = yes
					OR = {
						has_production_building_trigger = yes
						trade_goods = gold
					}
				}
			}
		}
		
		trigger = {
			num_of_owned_provinces_with = {
				value = 3
				OR = {
					area = westgate_area
					area = northyl_area
					area = trialmount_area
				}
				has_trade_building_trigger = yes
				OR = {
					has_production_building_trigger = yes
					trade_goods = gold
				}
			}
		}
		
		effect = {
			random_owned_province = {
				limit = {
					OR = {
						area = westgate_area
						area = northyl_area
						area = trialmount_area
					}
					has_trade_building_trigger = yes
					OR = {
						has_production_building_trigger = yes
						trade_goods = gold
					}
					NOT = { has_province_modifier = esthil_wood_exploit }
					NOT = { province_id = 849 }
					NOT = { province_id = 754 }
				}
				add_base_production = 1
				add_permanent_province_modifier = {
					name = "esthil_wood_exploit"
					duration = 3650
				}
				if = {
					limit = { NOT = { trade_goods = naval_supplies } }
					change_trade_goods = naval_supplies
				}
			}
			random_owned_province = {
				limit = {
					OR = {
						area = westgate_area
						area = northyl_area
						area = trialmount_area
					}
					has_trade_building_trigger = yes
					OR = {
						has_production_building_trigger = yes
						trade_goods = gold
					}
					NOT = { has_province_modifier = esthil_wood_exploit }
					NOT = { province_id = 849 }
					NOT = { province_id = 754 }
				}
				add_base_production = 1
				add_permanent_province_modifier = {
					name = "esthil_wood_exploit"
					duration = 3650
				}
				if = {
					limit = { NOT = { trade_goods = naval_supplies } }
					change_trade_goods = naval_supplies
				}
			}
			random_owned_province = {
				limit = {
					OR = {
						area = westgate_area
						area = northyl_area
						area = trialmount_area
					}
					has_trade_building_trigger = yes
					OR = {
						has_production_building_trigger = yes
						trade_goods = gold
					}
					NOT = { has_province_modifier = esthil_wood_exploit }
					NOT = { province_id = 849 }
					NOT = { province_id = 754 }
				}
				add_base_production = 1
				add_permanent_province_modifier = {
					name = "esthil_wood_exploit"
					duration = 3650
				}
				if = {
					limit = { NOT = { trade_goods = naval_supplies } }
					change_trade_goods = naval_supplies
				}
			}
			860 = { #Steelhyl
				remove_province_modifier = esthil_deadmines_2
				add_province_modifier = {
					name = "esthil_deadmines_3"
					duration = -1
				}
			}
			861 = { #Alloysford
				remove_province_modifier = esthil_deadmines_2
				add_province_modifier = {
					name = "esthil_deadmines_3"
					duration = -1
				}
			}
			862 = { #Coalwoud
				remove_province_modifier = esthil_deadmines_2
				add_province_modifier = {
					name = "esthil_deadmines_3"
					duration = -1
				}
			}
			859 = { #Charwic
				remove_province_modifier = esthil_deadmines_2
				add_province_modifier = {
					name = "esthil_deadmines_3"
					duration = -1
				}
			}
			858 = { #Shatterwood
				remove_province_modifier = esthil_deadmines_2
				add_province_modifier = {
					name = "esthil_deadmines_3"
					duration = -1
				}
			}
			852 = { #Northmarck
				remove_province_modifier = esthil_deadmines_2
				add_province_modifier = {
					name = "esthil_deadmines_3"
					duration = -1
				}
			}
			846 = { #Serpentswic
				remove_province_modifier = esthil_deadmines_2
				add_province_modifier = {
					name = "esthil_deadmines_3"
					duration = -1
				}
			}
		}
	}
	
	B54_the_control_point = {
		icon = catholic_confraternity
		position = 8
		required_missions = {
			B54_wood_for_the_mines
		}
		
		provinces_to_highlight = {
			OR = {
				area = serpentsmarck_area
				area = steelhyl_area
				area = coalwoud_area
			}
		}
		
		trigger = {
			any_owned_province = {
				OR = {
					area = steelhyl_area
					area = serpentsmarck_area
					area = coalwoud_area
				}
				has_courthouse_building_trigger = yes
				has_building = mage_tower
				has_building = trade_depot
			}
		}
		effect = {
			860 = { #Steelhyl
				remove_province_modifier = esthil_deadmines_3
				add_province_modifier = {
					name = "esthil_deadmines_4"
					duration = -1
				}
			}
			861 = { #Alloysford
				remove_province_modifier = esthil_deadmines_3
				add_province_modifier = {
					name = "esthil_deadmines_4"
					duration = -1
				}
			}
			862 = { #Coalwoud
				remove_province_modifier = esthil_deadmines_3
				add_province_modifier = {
					name = "esthil_deadmines_4"
					duration = -1
				}
			}
			859 = { #Charwic
				remove_province_modifier = esthil_deadmines_3
				add_province_modifier = {
					name = "esthil_deadmines_4"
					duration = -1
				}
			}
			858 = { #Shatterwood
				remove_province_modifier = esthil_deadmines_3
				add_province_modifier = {
					name = "esthil_deadmines_4"
					duration = -1
				}
			}
			852 = { #Northmarck
				remove_province_modifier = esthil_deadmines_3
				add_province_modifier = {
					name = "esthil_deadmines_4"
					duration = -1
				}
			}
			846 = { #Serpentswic
				remove_province_modifier = esthil_deadmines_3
				add_province_modifier = {
					name = "esthil_deadmines_4"
					duration = -1
				}
			}
			random_owned_province = {
				limit = {
					OR = {
						area = serpentsmarck_area
						area = steelhyl_area
						area = coalwoud_area
					}
					has_courthouse_building_trigger = yes
					has_building = mage_tower
					has_building = trade_depot
				}
				add_province_modifier = {
					name = "esthil_control_point"
					duration = -1
				}
				change_trade_goods = paper
				remove_province_modifier = esthil_deadmines_4
			}
		}
	}
}

esthil_missions_4v = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = B54
	} #These are triggers for the entire series
	
	B54_shroud_over_esthil = {
		icon = reform_the_nomocanon
		position = 1
		
		trigger = {
			custom_trigger_tooltip = {
				tooltip =  is_necromancy_1_tt
				has_ruler_flag = necromancy_1
			}
			has_estate_privilege = estate_mages_reduced_research_regulations
			NOT = {
				estate_influence = {
					estate = estate_mages
					influence = 40
				}
			}
		}
		
		effect = {
			custom_tooltip = esthil_tt_7
			set_country_flag = esthil_lodge_of_necromancers
		}
	}
	
	B54_esthil_uni_of_dark_arts = {
		icon = public_works
		position = 2
		required_missions = {
			B54_shroud_over_esthil
		}
		
		provinces_to_highlight = {
			province_id = 833
			NOT = {
				AND = {
					has_building = university
					development = 40
				}
			}
		}
		
		trigger = {
			833 = { #NorthCastonath
				has_building = university
				development = 40
			}
		}
		
		effect = {
			set_country_flag = esthil_university_of_dark_arts
			custom_tooltip = esthil_tt_8
		}
	}
	
	B54_a_city_of_the_dead = {
		icon = powerhouse_of_the_north
		position = 3
		required_missions = {
			B54_a_capital_for_an_empire
		}
		
		provinces_to_highlight = {
			area = castonath_area
			OR = {
				NOT = { development = 20 }
				local_autonomy = 1
			}
		}
		
		trigger = {
			831 = { #SouthCastonath
				development = 20
				NOT = { local_autonomy = 1 }
			}
			832 = { #LowerCastonath
				development = 20
				NOT = { local_autonomy = 1 }
			}
			833 = { #NorthCastonath
				development = 20
				NOT = { local_autonomy = 1 }
			}
			custom_trigger_tooltip = {
				tooltip = has_negotiated_with_patricians_tt
				OR = {
					has_global_flag = castonath_patricians_wiped_out
					has_country_flag = castonath_patricians_reinstated
					has_country_flag = castonath_patricians_autonomous
					has_country_flag = castonath_patricians_curtailing_relationship
				}
			}
		}
		
		effect = {
			831 = {
				add_base_tax = 1
				add_base_production = 1
				add_base_manpower = 1
				add_province_modifier = {
					name = esthil_a_city_of_the_dead
					duration = -1
				}
			}
			832 = {
				add_base_tax = 1
				add_base_production = 1
				add_base_manpower = 1
				add_province_modifier = {
					name = esthil_a_city_of_the_dead
					duration = -1
				}
			}
			833 = {
				add_base_tax = 1
				add_base_production = 1
				add_base_manpower = 1
				add_province_modifier = {
					name = esthil_a_city_of_the_dead
					duration = -1
				}
			}
		}
	}
	
	B54_death_tax = {
		icon = reform_the_monte
		position = 4
		required_missions = {
			B54_a_city_of_the_dead
		}
		
		provinces_to_highlight = {
			area = castonath_area
			NOT = { has_tax_building_trigger = yes }
		}
		
		trigger = {
			831 = { #SouthCastonath
				has_tax_building_trigger = yes
			}
			832 = { #LowerCastonath
				has_tax_building_trigger = yes
			}
			833 = { #NorthCastonath
				has_tax_building_trigger = yes
			}
			treasurer = 2
			adm = 3
		}
		
		effect = {
			set_country_flag = esthil_unlocked_death_tax
			custom_tooltip = esthil_tt_unlock_death_tax
		}
	}
	
	B54_quiet_countryside = {
		icon = prosperity_for_all
		position = 5
		required_missions = {
			B54_death_tax
		}
		
		provinces_to_highlight = {
			OR = {
				area = nortmere_area
				area = southgate_area
			}
			OR = {
				NOT = { country_or_non_sovereign_subject_holds = ROOT }
				devastation = 1
				unrest = 1
			}
		}
		
		trigger = {
			nortmere_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			southgate_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			834 = { #Sapphirewatch
				NOT = {
					devastation = 1
					unrest = 1
				}
			}
			835 = { #Nortmerewic
				NOT = {
					devastation = 1
					unrest = 1
				}
			}
			836 = { #Nurced
				NOT = {
					devastation = 1
					unrest = 1
				}
			}
			755 = { #Wardenhall
				NOT = {
					devastation = 1
					unrest = 1
				}
			}
			829 = { #Silverdocks
				NOT = {
					devastation = 1
					unrest = 1
				}
			}
			830 = { #Southgate
				NOT = {
					devastation = 1
					unrest = 1
				}
			}
			828 = { #Ar Urion
				NOT = {
					devastation = 1
					unrest = 1
				}
			}
		}
		
		effect = {
			custom_tooltip = esthil_tt_5
			hidden_effect = {
				random_list = {
					45 = {
						828 = { change_trade_goods = livestock }
					}
					45 = {
						828 = { change_trade_goods = grain }
					}
					5 = {
						828 = { change_trade_goods = wine }
					}
					5 = {
						828 = { change_trade_goods = tobacco }
					}
				}
				random_list = {
					45 = {
						830 = { change_trade_goods = livestock }
					}
					45 = {
						830 = { change_trade_goods = grain }
					}
					5 = {
						830 = { change_trade_goods = wine }
					}
					5 = {
						830 = { change_trade_goods = tobacco }
					}
				}
				random_list = {
					45 = {
						829 = { change_trade_goods = livestock }
					}
					45 = {
						829 = { change_trade_goods = grain }
					}
					5 = {
						829 = { change_trade_goods = wine }
					}
					5 = {
						829 = { change_trade_goods = tobacco }
					}
				}
				random_list = {
					45 = {
						755 = { change_trade_goods = livestock }
					}
					45 = {
						755 = { change_trade_goods = grain }
					}
					5 = {
						755 = { change_trade_goods = wine }
					}
					5 = {
						755 = { change_trade_goods = tobacco }
					}
				}
				random_list = {
					45 = {
						835 = { change_trade_goods = livestock }
					}
					45 = {
						835 = { change_trade_goods = grain }
					}
					5 = {
						835 = { change_trade_goods = wine }
					}
					5 = {
						835 = { change_trade_goods = tobacco }
					}
				}
				random_list = {
					45 = {
						836 = { change_trade_goods = livestock }
					}
					45 = {
						836 = { change_trade_goods = grain }
					}
					5 = {
						836 = { change_trade_goods = wine }
					}
					5 = {
						836 = { change_trade_goods = tobacco }
					}
				}
				random_list = {
					45 = {
						834 = { change_trade_goods = livestock }
					}
					45 = {
						834 = { change_trade_goods = grain }
					}
					5 = {
						834 = { change_trade_goods = wine }
					}
					5 = {
						834 = { change_trade_goods = tobacco }
					}
				}
				834 = { #Sapphirewatch
					add_province_modifier = {
						name = "esthil_countryside_1"
						duration = -1
					}
				}
				835 = { #Nortmerewic
					add_province_modifier = {
						name = "esthil_countryside_1"
						duration = -1
					}
				}
				836 = { #Nurced
					add_province_modifier = {
						name = "esthil_countryside_1"
						duration = -1
					}
				}
				755 = { #Wardenhall
					add_province_modifier = {
						name = "esthil_countryside_1"
						duration = -1
					}
				}
				829 = { #Silverdocks
					add_province_modifier = {
						name = "esthil_countryside_1"
						duration = -1
					}
				}
				830 = { #Southgate
					add_province_modifier = {
						name = "esthil_countryside_1"
						duration = -1
					}
				}
				828 = { #Ar Urion
					add_province_modifier = {
						name = "esthil_countryside_1"
						duration = -1
					}
				}
			}
		}
	}
	
 	B54_feast_of_the_dead = {
		icon = wittenberg_university
		position = 5
		required_missions = {
			B54_quiet_countryside
		}
		
		provinces_to_highlight = {
			OR = {
				area = nortmere_area
				area = southgate_area
			}
			NOT = {
				AND = {
					country_or_non_sovereign_subject_holds = ROOT
					OR = {
						has_production_building_trigger = yes
						trade_goods = gold
					}
					has_manufactory_trigger = yes
				}
			}
		}
		
		trigger = {
			nortmere_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			southgate_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			834 = { #Sapphirewatch
				OR = {
					has_production_building_trigger = yes
					trade_goods = gold
				}
				has_manufactory_trigger = yes
			}
			835 = { #Nortmerewic
				OR = {
					has_production_building_trigger = yes
					trade_goods = gold
				}
				has_manufactory_trigger = yes
			}
			836 = { #Nurced
				OR = {
					has_production_building_trigger = yes
					trade_goods = gold
				}
				has_manufactory_trigger = yes
			}
			755 = { #Wardenhall
				OR = {
					has_production_building_trigger = yes
					trade_goods = gold
				}
				has_manufactory_trigger = yes
			}
			829 = { #Silverdocks
				OR = {
					has_production_building_trigger = yes
					trade_goods = gold
				}
				has_manufactory_trigger = yes
			}
			830 = { #Southgate
				OR = {
					has_production_building_trigger = yes
					trade_goods = gold
				}
				has_manufactory_trigger = yes
			}
			828 = { #Ar Urion
				OR = {
					has_production_building_trigger = yes
					trade_goods = gold
				}
				has_manufactory_trigger = yes
			}
		}
		
		effect = {
			834 = { #Sapphirewatch
				remove_province_modifier = esthil_countryside_1
				add_province_modifier = {
					name = "esthil_countryside_2"
					duration = -1
				}
			}
			835 = { #Nortmerewic
				remove_province_modifier = esthil_countryside_1
				add_province_modifier = {
					name = "esthil_countryside_2"
					duration = -1
				}
			}
			836 = { #N?rced
				remove_province_modifier = esthil_countryside_1
				add_province_modifier = {
					name = "esthil_countryside_2"
					duration = -1
				}
			}
			755 = { #Wardenhall
				remove_province_modifier = esthil_countryside_1
				add_province_modifier = {
					name = "esthil_countryside_2"
					duration = -1
				}
			}
			829 = { #Silverdocks
				remove_province_modifier = esthil_countryside_1
				add_province_modifier = {
					name = "esthil_countryside_2"
					duration = -1
				}
			}
			830 = { #Southgate
				remove_province_modifier = esthil_countryside_1
				add_province_modifier = {
					name = "esthil_countryside_2"
					duration = -1
				}
			}
			828 = { #Ar Urion
				remove_province_modifier = esthil_countryside_1
				add_province_modifier = {
					name = "esthil_countryside_2"
					duration = -1
				}
			}
		}
	}
	B54_many_silos_of_silvervord = {
		icon = the_london_steelyard
		position = 6
		required_missions = {
			B54_feast_of_the_dead
		}
		provinces_to_highlight = {
			province_id = 756
			NOT = {
				AND = {
					owned_by = ROOT
					has_trade_building_trigger = yes
					base_production = 20
				}
			}
		}
		
		trigger = {
			756 = { #Silvervord
				owned_by = ROOT
				#province_has_center_of_trade_of_level = 2
				has_trade_building_trigger = yes
				base_production = 20
			}
		}
		
		effect = {
			add_country_modifier = {
				name = esthil_silvervord_grain
				duration = 3650
			}
		}
	}
	
	B54_necronomics = {
		icon = standardize_relazioni
		position = 9
		required_missions = {
			B54_many_silos_of_silvervord
			B54_the_control_point
			B54_visit_from_above
		}
		
		provinces_to_highlight = {
			OR = {
				AND = {
					OR = {
						province_id = 756
						province_id = 849
						province_id = 754
						has_province_modifier = esthil_control_point
					}
					NOT = { development = 30 }
				}
				AND = {
					area = castonath_area
					NOT = { is_prosperous = yes }
				}
			}
		}
		
		trigger = {
			NOT = { average_autonomy = 30 }
			756 = { #Silvervord
				development = 30
			}
			849 = { #Khugsroad
				development = 30
			}
			754 = { #Westgate
				development = 30
			}
			any_owned_province = {
				has_province_modifier = esthil_control_point
				development = 30
			}
			castonath_area = {
				type = all
				custom_trigger_tooltip = {
					tooltip = is_prosperous_tt
					is_prosperous = yes
				}
			}
			785 = { is_strongest_trade_power = ROOT }
			current_income_balance = 50
		}
		
		effect = {
			add_country_modifier = {
				name = "esthil_necronomics"
				duration = -1
			}
		}
	}
}

esthil_missions_5v = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = B54
	} #These are triggers for the entire series
	
	B54_unholy_aliance = {
		icon = mission_monarch_diplomacy
		position = 1
		
		trigger = {
			custom_trigger_tooltip = {
				tooltip =  esthil_tt_9
				if = {
					limit = { exists = B34 }
					alliance_with = B34
				}
				else = {
					any_ally = {
						is_evil = yes
					}
				}
			}
		}
		
		effect = {
			add_country_modifier = {
				name = "esthil_unholy_aliance"
				duration = 36500
			}
			if = {
				limit = { exists = B34 }
				B34 = {
					add_country_modifier = {
						name = "esthil_unholy_aliance"
						duration = 36500
					}
				}
			}
			if = {
				limit = { NOT = { exists = B34 } }
				random_ally = {
					limit = {
						OR = {
							has_ruler_flag = is_a_lich
							has_country_flag = exposed_ruler_vampire
							has_country_flag = witch_king_flag
						}
					}
					add_country_modifier = {
						name = "esthil_unholy_aliance"
						duration = 36500
					}
				}
			}
		}
	}
	
	B54_resistance_is_futile = {
		icon = french_revolution
		position = 2
		required_missions = {
			B54_shroud_over_esthil
		}
		
		trigger = {
			custom_trigger_tooltip = {
				tooltip = is_necromancy_2_tt
				has_ruler_flag = necromancy_2
			}
			num_of_owned_provinces_with = {
				value = 2
				culture = green_orc
				is_overseas = no
				continent = europe
			}
			adm_power = 300
		}
		
		effect = {
			add_adm_power = -300
			largest_decrease_of_orcish_tolerance_effect = yes
			custom_tooltip = esthil_tt_11
			hidden_effect = {
				random_owned_province = {
					limit = {
						culture = green_orc
						NOT = { has_province_modifier = esthil_cleanse }
					}
					add_province_modifier = {
						name = "esthil_cleanse"
						duration = 36500
					}
					create_revolt = 1
					change_culture = ROOT
					change_religion = ROOT
					add_devastation = 50
				}
				random_owned_province = {
					limit = {
						culture = green_orc
						NOT = { has_province_modifier = esthil_cleanse }
					}
					add_province_modifier = {
						name = "esthil_cleanse"
						duration = 36500
					}
					create_revolt = 1
					change_culture = ROOT
					change_religion = ROOT
					add_devastation = 50
				}
				random_owned_province = {
					limit = {
						culture = green_orc
						NOT = { has_province_modifier = esthil_cleanse }
					}
					add_province_modifier = {
						name = "esthil_cleanse"
						duration = 36500
					}
					create_revolt = 1
					change_culture = ROOT
					change_religion = ROOT
					add_devastation = 50
				}
				random_owned_province = {
					limit = {
						culture = green_orc
						NOT = { has_province_modifier = esthil_cleanse }
					}
					add_province_modifier = {
						name = "esthil_cleanse"
						duration = 36500
					}
					create_revolt = 1
					change_culture = ROOT
					change_religion = ROOT
					add_devastation = 50
				}
				random_owned_province = {
					limit = {
						culture = green_orc
						NOT = { has_province_modifier = esthil_cleanse }
					}
					add_province_modifier = {
						name = "esthil_cleanse"
						duration = 36500
					}
					create_revolt = 1
					change_culture = ROOT
					change_religion = ROOT
					add_devastation = 50
				}
				random_owned_province = {
					limit = {
						culture = green_orc
						NOT = { has_province_modifier = esthil_cleanse }
					}
					add_province_modifier = {
						name = "esthil_cleanse"
						duration = 36500
					}
					create_revolt = 1
					change_culture = ROOT
					change_religion = ROOT
					add_devastation = 50
				}
				random_owned_province = {
					limit = {
						culture = green_orc
						NOT = { has_province_modifier = esthil_cleanse }
					}
					add_province_modifier = {
						name = "esthil_cleanse"
						duration = 36500
					}
					create_revolt = 1
					change_culture = ROOT
					change_religion = ROOT
					add_devastation = 50
				}
				random_owned_province = {
					limit = {
						culture = green_orc
						NOT = { has_province_modifier = esthil_cleanse }
					}
					add_province_modifier = {
						name = "esthil_cleanse"
						duration = 36500
					}
					create_revolt = 1
					change_culture = ROOT
					change_religion = ROOT
					add_devastation = 50
				}
				random_owned_province = {
					limit = {
						culture = green_orc
						NOT = { has_province_modifier = esthil_cleanse }
					}
					add_province_modifier = {
						name = "esthil_cleanse"
						duration = 36500
					}
					create_revolt = 1
					change_culture = ROOT
					change_religion = ROOT
					add_devastation = 50
				}
				random_owned_province = {
					limit = {
						culture = green_orc
						NOT = { has_province_modifier = esthil_cleanse }
					}
					add_province_modifier = {
						name = "esthil_cleanse"
						duration = 36500
					}
					create_revolt = 1
					change_culture = ROOT
					change_religion = ROOT
					add_devastation = 50
				}
			}
		}
	}
	
	B54_army_of_the_dead = {
		icon = mission_build_up_to_force_limit
		position = 3
		required_missions = {
			B54_resistance_is_futile
		}
		
		trigger = {
			has_country_modifier = undead_military
		}
		
		effect = {
			add_prestige = 10
		}
	}
	
	B54_stitchworks = {
		icon = mission_early_game_buildings
		position = 4
		required_missions = {
			B54_army_of_the_dead
		}
		
		provinces_to_highlight = {
			province_id = 828
			NOT = {
				AND = {
					owned_by = ROOT
					has_manpower_building_trigger = yes
					OR = {
						has_production_building_trigger = yes
						trade_goods = gold
					}
					development = 20
				}
			}
		}
		
		trigger = {
			has_country_modifier = undead_military
			828 = {
				owned_by = ROOT
				has_manpower_building_trigger = yes
				OR = {
					has_production_building_trigger = yes
					trade_goods = gold
				}
				development = 20
			}
		}
		
		effect = {
			828 = {
				rename_capital = "The Stitchworks"
				add_province_modifier = {
					name = "esthil_stitchworks"
					duration = -1
				}
			}
		}
	}
	
	B54_the_foundation = {
		icon = fortify_the_passes
		position = 5
		required_missions = {
			B54_stitchworks
		}
		
		provinces_to_highlight = {
			has_province_modifier = esthil_tower
			NOT = {
				AND = {
					OR = {
						has_production_building_trigger = yes
						trade_goods = gold
					}
					has_building = mage_tower
					development = 30
				}
			}
		}
		
		trigger = {
			any_owned_province = {
				has_province_modifier = esthil_tower
				OR = {
					has_production_building_trigger = yes
					trade_goods = gold
				}
				has_building = mage_tower
				development = 30
			}
			treasury = 7000
		}
		
		effect = {
			random_owned_province = {
				limit = { has_province_modifier = esthil_tower }
				add_province_modifier = {
					name = "esthil_building_morgurax"
					duration = 3650
				}
			}
			add_treasury = -7000
		}
	}
	
	B54_palace_in_the_skies = {
		icon = give_him_back_his_legions
		position = 6
		required_missions = {
			B54_the_foundation
		}
		
		trigger = {
			adm_power = 100
			dip_power = 100
			mil_power = 100
			custom_trigger_tooltip = {
				tooltip = esthil_tt_12
				OR = {
					has_ruler_flag = transmutation_3
					court_mage = 5
				}
			}
			OR = {
				AND = {
					any_ally = {
						damestear = 1
						trust = { who = ROOT value = 80 }
					}
					treasury = 5000
				}
				any_owned_province = {
					trade_goods = damestear
					base_production = 8
				}
			}
			any_owned_province = {
				has_province_modifier = esthil_tower
				NOT = { has_province_modifier = esthil_building_morgurax }
			}
		}
		
		effect = {
			add_adm_power = -100
			add_dip_power = -100
			add_mil_power = -100
			if = {
				limit = { 
					NOT = { 
						any_owned_province = {
							trade_goods = damestear
							base_production = 8
						}
					}
				}
				add_treasury = -5000
			}
			random_owned_province = {
				limit = { has_province_modifier = esthil_tower }
				add_province_modifier = {
					name = "esthil_testing_runs"
					duration = 3650
				}
			}
		}
	}
	
	B54_finishing_touches = {
		icon = friends_in_high_places
		position = 7
		required_missions = {
			B54_palace_in_the_skies
		}
		
		provinces_to_highlight = {
			has_province_modifier = esthil_tower
			OR = {
				has_province_modifier = esthil_testing_runs
				NOT = {
					num_of_units_in_province = {
						who = ROOT
						amount = 10
					}
				}
			}
		}
		
		trigger = {
			any_owned_province = {
				has_province_modifier = esthil_tower
				NOT = { has_province_modifier = esthil_testing_runs }
				num_of_units_in_province = {
					who = ROOT
					amount = 10
				}
			}
		}
		
		effect = {
			random_owned_province = {
				limit = { has_province_modifier = esthil_tower }
				kill_units = {
					who = owner
					amount = 10
				}
				area = {
					add_province_modifier = {
						name = "esthil_morgurax"
						duration = -1
					}
					set_province_flag = current_morgurax_location
				}
				remove_province_modifier = esthil_tower
			}
		}
	}
	
	B54_visit_from_above = {
		icon = polish_diplomacy
		position = 8
		required_missions = {
			B54_finishing_touches
		}
		
		trigger = {
			any_owned_province = {
				has_province_modifier = esthil_morgurax
			}
			dip_power = 100
			adm_power = 100
		}
		effect = {
			add_adm_power = -100
			add_dip_power = -100
			custom_tooltip = esthil_tt_13
			set_country_flag = esthil_morgurax_visits
		}
	}
}
