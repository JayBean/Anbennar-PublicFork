thangoya_1 = {
    slot = 1
    generic = no
    ai = yes
    has_country_shield = yes
    
    potential = {
        tag = Z62 #Thangoya
    }
    
    
    thangoya_1_5 = {
        icon = mission_new_dawn         
        position = 5        

        required_missions = {}
        
        provinces_to_highlight = {
            OR = {
                province_id = 4789 #Azkare
                province_id = 4788 #Elnak Phakphon
                province_id = 4779 #Huban 
                province_id = 4777 #Haiban 
            }
            NOT = { has_seat_in_parliament = yes }
        }
    
        trigger = {
            4789 = { has_seat_in_parliament = yes } #Azkare
            4788 = { has_seat_in_parliament = yes } #Elnak Phakphon
            4779 = { has_seat_in_parliament = yes } #Huban
            4777 = { has_seat_in_parliament = yes } #Haiban
            custom_trigger_tooltip = {
                tooltip = thangoya_passed_a_debate_tt
                check_variable = {
                    which = issues_passed
                    value = 1
                }
            }
        }
        
        effect = {
            4789 = { add_elven_minority_size_effect = yes } #Azkare
            4779 = { add_elven_minority_size_effect = yes } #Huban
            anb_add_accepted_culture_or_dip_power = { culture = sunrise_elf free = yes }
            complex_dynamic_effect = {
                first_custom_tooltip = thangoya_azkare_mission_tt
				first_limit = "has_country_modifier = thangoya_azkare_ruler"
				first_effect = "
                4789 = { add_base_tax = 1 add_base_production = 2 } #Azkare
                4779 = { add_base_tax = 1 add_base_production = 2 } #Huban
				"
            }
            # custom_tooltip = thangoya_azkare_mission_tt
            # tooltip = {
            #     4789 = { add_base_tax = 1 add_base_production = 2 } #Azkare
            #     4779 = { add_base_tax = 1 add_base_production = 2 } #Huban
            # }
            # hidden_effect = {
            #     if = {
            #         limit = { has_country_modifier = thangoya_azkare_ruler }
            #         4789 = { add_base_tax = 1 add_base_production = 2 } #Azkare
            #         4779 = { add_base_tax = 1 add_base_production = 2 } #Huban
            #     }
            # }
        }
    }

	thangoya_1_6 = {
        icon = mission_cossack_cavalry
        position = 6
        
        required_missions = {
            thangoya_1_5
        }
        
        provinces_to_highlight = {
            OR = {
                province_id = 4790 #Vai Ma
                province_id = 4791 #Yemakhai
                province_id = 4792 #Kang Kaiden
                province_id = 5425 #Phaksanam
            }
            NOT = {
                AND = {
                    base_production = 3 
                    base_manpower = 3 
                }
            }
        }
    
        trigger = {
            4790 = { base_production = 3 base_manpower = 3 } #Vai Ma
            4791 = { base_production = 3 base_manpower = 3 } #Yemakhai
            4792 = { base_production = 3 base_manpower = 3 } #Kang Kaiden
            5425 = { base_production = 3 base_manpower = 3 } #Phaksanam
            num_of_cavalry = 6
        }
        
        effect = {
            add_country_modifier = {
                name = thangoya_purebred_lancers
                duration = -1
            }
        }
    }

	thangoya_1_7 = {
        icon = mission_early_game_buildings
        position = 7
        
        required_missions = {
            thangoya_1_6
        }
        
        provinces_to_highlight = {
            area = thirabnir_area
            OR = {
                AND = {
                    NOT = { has_terrain = desert }
                    NOT = { development = 9 }
                }
                AND = {
                    has_terrain = desert
                    NOT = { development = 6 }
                }
            }
        }
    
        trigger = {
            thirabnir_area = {
                type = all
                OR = {
                    AND = {
                        NOT = { has_terrain = desert }
                        development = 9
                    }
                    AND = {
                        has_terrain = desert
                        development = 6
                    }
                }
            }
            OR = {
                government_reform_progress = 50
                economic_ideas = 3
                infrastructure_ideas = 3
            }
            if = {
                limit = { thirabnir_mission = yes }
                AND = {
                    OR = {
                        any_owned_province = { culture_is_dwarven = yes }
                        any_known_country = {
                            any_owned_province = { culture_is_dwarven = yes }
                            has_opinion = {
                                who = PREV #Thangoya
                                value = 150
                            }
                        }
                    }
                    OR = {
                        any_owned_province = { culture_is_harpy = yes }
                        any_known_country = {
                            any_owned_province = { culture_is_harpy = yes }
                            has_opinion = {
                                who = PREV #Thangoya
                                value = 150
                            }
                        }
                    }
                }
            }
            else = {
                custom_trigger_tooltip = { #The "spoiler"
                    tooltip = thangoya_1_7_tt
                    always = yes
                }
            }
        }
        
        effect = {
            custom_tooltip = thangoya_default_reward_tt
            4788 = { change_trade_goods = copper } #Elnak Phakphon
            4778 = { change_trade_goods = glass } #Kesanthi

            custom_tooltip = feitenEmpty
            complex_dynamic_effect_without_alternative = {
                first_custom_tooltip = thangoya_50_reform_progress_tt
				first_limit = "government_reform_progress = 50"
				first_effect = "
                    add_country_modifier = {
                        name = thangoya_reorganize_local_admin
                        duration = 9125
                    }
                    change_government_reform_progress = -50
				"
                second_custom_tooltip = thangoya_3_econ_ideas
				second_limit = "economic_ideas = 3"
				second_effect = "
                    add_country_modifier = {
                        name = thangoya_diverse_industries
                        duration = 9125
                    }
				"
                third_custom_tooltip = thangoya_3_infra_ideas
				third_limit = "infrastructure_ideas = 3"
				third_effect = "
                    add_country_modifier = {
                        name = thangoya_long_term_planning
                        duration = 9125
                    }
				"
                fourth_custom_tooltip = thangoya_thirabnir_mission_tt
				fourth_limit = "thirabnir_mission = yes"
				fourth_effect = "
                    4788 = { add_dwarven_minority_size_effect = yes add_dwarven_minority_size_effect = yes } #Elnak Phakphon
                    4778 = { add_harpy_minority_size_effect = yes } #Kesanthi
				"
            }
            # hidden_effect = {
            #     if = {
            #         limit = { government_reform_progress = 50 }
            #         add_country_modifier = {
            #             name = thangoya_reorganize_local_admin
            #             duration = 9125
            #         }
            #         change_government_reform_progress = -50
            #     }
            #     if = {
            #         limit = { economic_ideas = 3 }
            #         add_country_modifier = {
            #             name = thangoya_diverse_industries
            #             duration = 9125
            #         }
            #     }
            #     if = {
            #         limit = { infrastructure_ideas = 3 }
            #         add_country_modifier = {
            #             name = thangoya_long_term_planning
            #             duration = 9125
            #         }
            #     }
            #     if = {
            #         limit = { has_country_modifier = thangoya_thirabnir_ruler }
            #         4788 = { add_dwarven_minority_size_effect = yes add_dwarven_minority_size_effect = yes } #Elnak Phakphon
            #         4778 = { add_harpy_minority_size_effect = yes } #Kesanthi
            #     }
            # }
        }
    }

	thangoya_1_9 = {
        icon = sponsor_the_arts
        position = 9
        
        required_missions = {
            thangoya_2_8
        }
    
        trigger = {
            calc_true_if = {
                sikai_townships_group = { type = all has_manufactory_trigger = yes }
                amount = 4
            }
        }
        
        effect = {
            sikai_townships_group = {
                custom_tooltip = thangoya_1_1_0_dev_manufactory_tt
            }
            define_advisor = {
                type = philosopher
                skill = 3
                discount = yes
                culture = sikai
            }
            hidden_effect = {
                sikai_townships_group = {
                    if = { 
                        limit = { has_manufactory_trigger = yes }
                        add_base_tax = 1
                        add_base_production = 1
                    } 
                }
            }
        }
    }

	thangoya_1_10 = {
        icon = mission_the_finns
        position = 10
        
        required_missions = {
            thangoya_1_9
            thangoya_2_9
        }
    
        trigger = {
            estate_loyalty = {
                estate = estate_mages
                loyalty = 60
            }
            estate_influence = {
                estate = estate_mages
                influence = 35
            }
            NOT = {
                has_estate_privilege = estate_mages_cast_spells
            }
            has_active_debate = yes
        }
        
        effect = {
            custom_tooltip = thangoya_appease_the_estates_tt
            remove_enacted_issue = yes
            start_debate = appease_the_estates

            set_estate_privilege = estate_mages_cast_spells
            add_country_modifier = {
                name = thangoya_state_employed_mages
                duration = 3650
            }
             
            custom_tooltip = thangoya_khao_elnak_mission_tt
            if = {
                limit = { khao_elnak_mission = yes }
                custom_tooltip = BONUS_REWARD_YES
            }
            else = { custom_tooltip = BONUS_REWARD_NO }
            tooltip = {
                add_country_modifier = {
                    name = magic_estate_aiding_construction_3
                    duration = 3650
                }
            }

            custom_tooltip = thangoya_no_mission_tt
            if = {
                limit = { khao_elnak_mission = no }
                custom_tooltip = BONUS_REWARD_YES
            }
            else = { custom_tooltip = BONUS_REWARD_NO }
            tooltip = {
                add_country_modifier = {
                    name = magic_estate_aiding_construction_2
                    duration = 3650
                }
            }
            hidden_effect = { 
                set_country_flag = thangoya_appease_the_estates 
                if = { 
                    limit = { khao_elnak_mission = yes }
                    add_country_modifier = {
                        name = magic_estate_aiding_construction_3
                        duration = 3650
                    }
                }
                else = {
                    add_country_modifier = {
                        name = magic_estate_aiding_construction_2
                        duration = 3650
                    }
                }
            }
        }
    }

	thangoya_1_11 = {
        icon = mission_industrial_forging
        position = 11
        
        required_missions = {
            thangoya_1_10
			thangoya_2_10
        }
        
        provinces_to_highlight = {
            OR = {
                AND = {
                    OR = {
                        province_id = 4787 #Lektonmai
                        province_id = 4788 #Elnak Phakpkon
                        province_id = 4777 #Hubai
                    }
                    NOT = { 
                        AND = {
                            has_building = weapons 
                            has_seat_in_parliament = yes
                            num_of_times_expanded_infrastructure = 2
                        }
                    }
                }
                AND = {
                    province_id = 4940 #Phungoen
                    NOT = {
                        AND = {
                            has_manufactory_trigger = yes
                            fort_level = 2
                            has_seat_in_parliament = yes
                            num_of_times_expanded_infrastructure = 2
                        }
                    }
                }
            }
        }
    
        trigger = {
            4787 = { #Lektonmai
                has_building = weapons 
                has_seat_in_parliament = yes
                num_of_times_expanded_infrastructure = 2
            }
            4777 = { #Hubai
                has_building = weapons 
                has_seat_in_parliament = yes
                num_of_times_expanded_infrastructure = 2
            }
            4940 = { #Phungoen
                has_manufactory_trigger = yes
                fort_level = 2
                has_seat_in_parliament = yes
                num_of_times_expanded_infrastructure = 2
            }
            4788 = { #Elnak Phakphon
                has_building = weapons 
                has_seat_in_parliament = yes
                num_of_times_expanded_infrastructure = 2
            }
            if = {
                limit = { lo_ngoen_mission = yes }
                OR = { 
                    master_of_mint = 1
                    treasurer  = 1
                    natural_scientist = 1
                }
            }
            else = { 
                num_of_artillery = 10 
                custom_trigger_tooltip = { #The "spoiler"
                    tooltip = thangoya_1_11_tt
                    always = yes
                }
            }
        }
        
        effect = {
            4940 = { #Phungoen
                custom_tooltip = thangoya_default_reward_tt
                add_province_modifier = {
                    name = Y58_gold_production
                    duration = -1
                }

                custom_tooltip = thangoya_phungoen_state_house_tt
                if = {
                    limit = { has_building = state_house }
                    custom_tooltip = BONUS_REWARD_YES
                }
                else = { custom_tooltip = BONUS_REWARD_NO }
                tooltip = {
                    ROOT = { change_government_reform_progress = 100 }
                }

                custom_tooltip = thangoya_phungoen_households_tt
                if = {
                    limit = { has_building = soldier_households }
                    custom_tooltip = BONUS_REWARD_YES
                }
                else = { custom_tooltip = BONUS_REWARD_NO }
                tooltip = {
                    ROOT = {
                        add_country_modifier = {
                            name = thangoya_work_for_your_armor
                            duration = 18250
                        }
                    }
                }

                custom_tooltip = thangoya_phungoen_ramparts_tt
                if = {
                    limit = { has_building = ramparts }
                    custom_tooltip = BONUS_REWARD_YES
                }
                else = { custom_tooltip = BONUS_REWARD_NO }
                tooltip = {
                    add_province_modifier = {
                        name = local_fortress
                        duration = -1
                    }
                }
            }

            custom_tooltip = thangoya_lo_ngoen_mission_tt
            if = {
                limit = { lo_ngoen_mission = yes }
                custom_tooltip = BONUS_REWARD_YES
            }
            else = { custom_tooltip = BONUS_REWARD_NO }
            tooltip = {
                add_inflation = -5
            }
            hidden_effect = {
                if = {
                    limit = { 4940 = { has_building = state_house } } #Phungoen
                    change_government_reform_progress = 100
                }
                if = {
                    limit = { 4940 = { has_building = soldier_households  } } #Phungoen
                    add_country_modifier = {
                        name = thangoya_work_for_your_armor
                        duration = 18250
                    }
                }
                if = {
                    limit = { 4940 = { has_building = ramparts } } #Phungoen
                    4940 = { #Phungoen
                        add_province_modifier = {
                            name = local_fortress
                            duration = -1
                        }
                    }
                }
                if = {
                    limit = { lo_ngoen_mission = yes }
                    add_inflation = -5
                }
            }
        }
    }
}

thangoya_2 = {
    slot = 2
    generic = no
    ai = yes
    has_country_shield = yes
    
    potential = {
        tag = Z62 #Thangoya
    }
    
    
    thangoya_2_5 = {
        icon = jap_balance_shinokosho
        position = 5
        
        required_missions = {} #First row
        
        provinces_to_highlight = {
            AND = {
                OR = {
                    province_id = 4789 #Azkare
                    province_id = 4787 #Lektonmai
                    province_id = 4940 #Phungoen
                    province_id = 4777 #Huban
                }
                NOT = { has_building = temple }
            }
        }

        trigger = {
            if = {
                limit = { lo_ngoen_mission = yes }
                calc_true_if = {
                    4789 = { has_building = temple } #Azkare
                    4787 = { has_building = temple } #Lektonmai
                    4940 = { has_building = temple } #Phungoen
                    4777 = { has_building = temple } #Huban
                    amount = 2
                }
                army_size = 20
            }
            else = {
                4789 = { has_building = temple } #Azkare
                4787 = { has_building = temple } #Lektonmai
                4940 = { has_building = temple } #Phungoen
                4777 = { has_building = temple } #Huban
                OR = {
                    army_size = Y28 #Jiangliusi
                    army_size = 25
                }
                custom_trigger_tooltip = { #The "spoiler"
                    tooltip = thangoya_2_5_tt
                    always = yes
                }
            }
        }
        
        effect = {
            custom_tooltip = thangoya_xiaken_minority_event_tt
            if = {
                limit = { 
                    any_known_country = {
                        has_reform = xiaken
                        has_opinion = { #I am 75% sure this order is faster, given I check for provinces next but idk
                            who = PREV #Thangoya
                            value = 100
                        }
                        any_owned_province = { culture_is_human = no }
                    }
                }
                custom_tooltip = BONUS_REWARD_YES
            }
            else = { custom_tooltip = BONUS_REWARD_NO }
            tooltip = { country_event = { id = thangoya_event.5 days = 3650 } }

            custom_tooltip = feitenEmpty
            custom_tooltip = thangoya_no_mission_tt
            if = {
                limit = { lo_ngoen_mission = no }
                custom_tooltip = BONUS_REWARD_YES
            }
            else = { custom_tooltip = BONUS_REWARD_NO }
            tooltip = { country_event = { id = thangoya_event.2 } }
            custom_tooltip = thangoya_lo_ngoen_mission_tt
            if = {
                limit = { lo_ngoen_mission = yes }
                custom_tooltip = BONUS_REWARD_YES
            }
            else = { custom_tooltip = BONUS_REWARD_NO }
            custom_tooltip = thangoya_sikai_xiaken_cores_tt
            tooltip = { country_event = { id = thangoya_event.3 } }
            custom_tooltip = thangoya_xiaken_minority_event_tt
            tooltip = { country_event = { id = thangoya_event.5 days = 3650 } }
            hidden_effect = {
                if = {
                    limit = { has_country_modifier = thangoya_lo_ngoen_ruler }
                    country_event = { id = thangoya_event.3 }
                }
                else = { country_event = { id = thangoya_event.2 } }
                if = {
                    limit = { 
                        any_known_country = {
                            has_reform = xiaken
                            has_opinion = { #I am 75% sure this order is faster, given I check for provinces but idk
                                who = PREV #Thangoya
                                value = 100
                            }
                            any_owned_province = { culture_is_human = no }
                        }
                    }
                    country_event = { id = thangoya_event.5 days = 3650 }
                }
            }
        }
    }

	thangoya_2_6 = {
        icon = jap_financial_cliques
        position = 6
        
        required_missions = {
            thangoya_2_5
        }
        
        provinces_to_highlight = {
            OR = {
                AND = {
                    OR = {
                        area = jilin_anb_area
                        area = zhonglin_area
                        area = aoshan_area
                        area = pevyirer_area
                    }
                    NOT = { country_or_non_sovereign_subject_holds = ROOT } #Thangoya
                }
                AND = {
                    area = dekaipnam_area
                    NOT = {
                        OR = {
                            country_or_non_sovereign_subject_holds = ROOT #Thangoya
                            country_or_non_sovereign_subject_holds = Y58 #Lot Dekkhang
                        }
                    }
                }
            }
        }
    
        trigger = {
            jilin_anb_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT #Thangoya
            }
            zhonglin_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT #Thangoya
            }
            aoshan_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT #Thangoya
            }
            pevyirer_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT #Thangoya
            }
            dekaipnam_area = {
                type = all
                OR = {
                    country_or_non_sovereign_subject_holds = ROOT #Thangoya
                    country_or_non_sovereign_subject_holds = Y58 #Lot Dekkhang
                }
            }
            accepted_culture = szitu #Szitu
        }
        
        effect = {
            add_country_modifier = {
                name = thangoya_custodians_of_xianjie
                duration = -1
            }
            country_event = { id = thangoya_event.10 }
            custom_tooltip = feitenEmpty
            custom_tooltip = thangoya_wulin_humiliated_tt
            tooltip = {
                add_prestige = 20
                add_adm_power = 50
                add_dip_power = 50
                add_mil_power = 50
            }
            hidden_effect = {
                if = {
                    limit = {
                        any_known_country = {
                            has_reform = wulin 
                            humiliated_by = PREV #Thangoya
                        }
                    }
                    add_prestige = 20
                    add_adm_power = 50
                    add_dip_power = 50
                    add_mil_power = 50
                }
            }
        }
    }

	thangoya_2_8 = {
        icon = mission_hanseatic_city
        position = 8
        
        required_missions = {
            thangoya_1_7
			thangoya_3_7
        }
    
        trigger = {
            OR = {
                calc_true_if = {
                    sikai_townships_group = { type = all has_building = workshop }
                    amount = 8
                }
                workshop = 15
            }
            OR = {
                has_church_aspect = transmutative_path_weaving_weal #Azkare aspect
                has_church_aspect = transmutative_path_dessicate_landscape #Thirabnir aspect
                has_church_aspect = transmutative_path_dredge_the_flats #Lo Ngoen aspect
                has_church_aspect = transmutative_path_threadeth_the_corn #Khao Elnak aspect
            }
        }
        
        effect = {
            custom_tooltip = thangoya_fund_an_industrial_project_tt
            custom_tooltip = thangoya_25_dev_prov_tt
            hidden_effect = {
                sikai_townships_group = {
                    limit = {
                        any_province_in_state = {
                            development = 25
                        }
                    }
                    add_next_institution_embracement = 50
                }
                set_country_flag = thangoya_fund_an_industrial_project
            }
        }
    }

	thangoya_2_9 = {
        icon = mission_hanseatic_city
        position = 9
        
        required_missions = {
			thangoya_2_8
        }
        
        provinces_to_highlight = {
            province_group = sikai_townships_group
            if = {
                limit = {
                    has_dlc = "Leviathan"
                }
                NOT = { num_of_times_expanded_infrastructure = 1 }
            }
            else = { NOT = { development = 15 } }
        }
    
        trigger = {
            sikai_townships_group = {
                type = all
                if = {
                    limit = {
                        has_dlc = "Leviathan"
                    }
                    num_of_times_expanded_infrastructure = 1
                }
                else = { development = 15 }
            }
        }
        
        effect = {
            sikai_townships_group = {
                add_province_modifier = {
                    name = thangoya_growing_economy
                    duration = 9125
                }
            }
        }
    }

	thangoya_2_10 = {
        icon = mission_rice_field
        position = 10
        
        required_missions = {
			thangoya_2_9
        }
    
        provinces_to_highlight = {
            province_group = sikai_townships_group
            NOT = {
                AND = {
                    OR = {
                        can_build = farm_estate
                        trade_goods = salt
                    }
                    has_manufactory_trigger = yes
                    has_building = barracks
                    has_free_manufactory_slot_trigger = yes #Thank you Armitage, appreciated
                }
            }
        }

        trigger = {
            num_of_owned_provinces_with = {
                province_group = sikai_townships_group
                custom_trigger_tooltip = {
                    tooltip = thangoya_farm_or_salt_tt
                    OR = {
                        OR = {
                            AND = {
                                NOT = { has_building = farm_estate }
                                can_build = farm_estate
                            }
                            has_building = farm_estate
                        }
                        trade_goods = salt
                    }
                }
                has_manufactory_trigger = yes
                has_manpower_building_trigger = yes
                has_free_manufactory_slot_trigger = yes #Thank you Armitage, appreciated
                value = 4
            }
        }
        
        effect = {
            sikai_townships_group = {
                limit = {
                    OR = {
                        has_building = farm_estate
                        AND = {
                            trade_goods = salt
                            has_building = wharf
                        }
                    }
                    has_manpower_building_trigger = yes
                    num_free_building_slots = 1 #no trigger for manufactory building slots :/
                }
                custom_tooltip = thangoya_every_good_province_effect_tt
                tooltip = { remove_building = barracks }
                add_building = soldier_households
                hidden_effect = { 
                    anb_manufactory_discount = yes 
                    remove_building = barracks
                }
            }
        }
    }

	thangoya_2_12 = {
        icon = mission_magic_tower
        position = 12
        
        required_missions = {
            thangoya_1_11
			thangoya_2_10
			thangoya_3_11
        }
        
        provinces_to_highlight = {
            OR = {
                AND = {
                    province_group = sikai_townships_group
                    NOT = {
                        province_id = 4788 #Elnak Phakphon
                        province_id = 4778 #Kesanthi
                        province_id = 4789 #Azkare
                        province_id = 4777 #Huban
                    }
                    OR = {
                        NOT = { num_of_times_expanded_infrastructure = 2 }
                        has_production_manufactory_or_gold_trigger = no
                    }
                }
                AND = {
                    OR = {
                        province_id = 4788 #Elnak Phakphon
                        province_id = 4778 #Kesanthi
                        province_id = 4789 #Azkare
                        province_id = 4777 #Huban
                    }
                    NOT = { 
                        AND = {
                            num_of_times_expanded_infrastructure = 3
                            has_building = state_house
                        }
                    }
                }
            }
        }
    
        trigger = {
            sikai_townships_group = {
                type = all
                num_of_times_expanded_infrastructure = 2
                OR = {
                    province_id = 4940 #Phungoen
                    has_production_manufactory_or_gold_trigger = yes
                }
            }
            4788 = { #Elnak Phakphon
                num_of_times_expanded_infrastructure = 3
                has_building = state_house
            }
            4778 = { #Kesanthi
                num_of_times_expanded_infrastructure = 3
                has_building = state_house
            }
            4789 = { #Azkare
                num_of_times_expanded_infrastructure = 3
                has_building = state_house
            }
            4777 = { #Huban
                num_of_times_expanded_infrastructure = 3
                has_building = state_house
            }
            
        }
        
        effect = {
            4788 = { #Elnak Phakphon
                add_province_modifier = {
                    name = thangoya_sikai_metropolis
                    duration = -1
                }
            }
            4778 = { #Kesanthi
                add_province_modifier = {
                    name = thangoya_sikai_metropolis
                    duration = -1
                }
            }
            4789 = { #Azkare
                add_province_modifier = {
                    name = thangoya_sikai_metropolis
                    duration = -1
                }
            }
            4777 = { #Huban
                add_province_modifier = {
                    name = thangoya_sikai_metropolis
                    duration = -1
                }
            }
        }
    }
}

thangoya_3 = {
    slot = 3
    generic = no
    ai = yes
    has_country_shield = yes
    
    potential = {
        tag = Z62 #Thangoya
    }


	thangoya_3_6 = {
        icon = mission_build_up_to_force_limit
        position = 6
        
        required_missions = {
            thangoya_2_5
        }
        
        provinces_to_highlight = {
            AND = {
                culture = sikai
                NOT = { country_or_non_sovereign_subject_holds = ROOT } #Thangoya
            }
            AND = {
                province_id = 4940 #Phungoen
                NOT = { base_production = 8 }
            }
        }
    
        trigger = {
            custom_trigger_tooltip = {
                tooltip = thangoya_all_sikai_provinces_tt
                NOT = {
                    any_known_country = {
                        any_owned_province = {
                            culture = sikai 
                        }
                    }
                }
            }
            4940 = { base_production = 8 } #Phungoen
            4794 = { #Xaram
                custom_trigger_tooltip = {
                    tooltip = thangoya_seat_in_parliament_tt
                    has_seat_in_parliament = yes
                }    
            } 
            OR = {
                4783 = { #Lo Pashong
                    custom_trigger_tooltip = {
                        tooltip = thangoya_seat_in_parliament_tt
                        has_seat_in_parliament = yes
                    }    
                } 
                4785 = { #Kwhanhu
                    custom_trigger_tooltip = {
                        tooltip = thangoya_seat_in_parliament_tt
                        has_seat_in_parliament = yes
                    }    
                } 
                4935 = { #Tameuong
                    custom_trigger_tooltip = {
                        tooltip = thangoya_seat_in_parliament_tt
                        has_seat_in_parliament = yes
                    }    
                } 
            }
            NOT = { has_country_modifier = thangoya_warrior_refugees }
        }
        
        effect = {
            remove_country_modifier = thangoya_integrated_xia
            add_country_modifier = {
                name = thangoya_shields_of_thangoya
                duration = -1
            }
        }
    }

	thangoya_3_7 = {
        icon = mission_book_of_royal_degrees
        position = 7
        
        required_missions = {
            thangoya_4_6
        }
        
        provinces_to_highlight = {
            OR = {
                AND = {
                    if = {
                        limit = { ROOT = { khao_elnak_mission = no } } #Thangoya
                        province_id = 5424 #Verkal Ozovar
                        NOT = {
                            AND = {
                                owned_by = ROOT #Thangoya
                                has_seat_in_parliament = yes
                                ROOT = { #Thangoya
                                    high_tolerance_dwarven_race_trigger = yes
                                    has_country_modifier = separation_of_powers
                                }
                            }
                        }
                    }
                    else = { always = no }
                }
                AND = { 
                    owned_by = Y63 #Verkal Ozovar
                    Y63 = { #Verkal Ozovar
                        NOT = {
                            AND = {
                                is_subject_of = ROOT #Thangoya
                                reverse_has_opinion = {
                                    who = ROOT #Thangoya
                                    value = 190
                                }
                            }
                        }
                        if = { 
                            limit = { ROOT = { khao_elnak_mission = yes } }  #Thangoya
                            AND = {
                                NOT = { 
                                    has_25_opinion_sent_gift = { target = ROOT } #Thangoya
                                    has_10_opinion_getting_subsidies = { target = ROOT } #Thangoya
                                }
                            }
                        }
                        else = { liberty_desire = 25 }
                    } 
                    ROOT = { NOT = { has_country_modifier = separation_of_powers } } #Thangoya
                }
            }
        }
    
        trigger = {
            has_country_modifier = separation_of_powers
            OR = {
                AND = {
                    if = {
                        limit = { khao_elnak_mission = no }
                        AND = {
                            5424 = { #Verkal Ozovar
                                country_or_non_sovereign_subject_holds = ROOT
                                custom_trigger_tooltip = {
                                    tooltip = thangoya_seat_in_parliament_tt
                                    has_seat_in_parliament = yes
                                }    
                            }
                            high_tolerance_dwarven_race_trigger = yes
                        }
                    }
                    else = { always = no }
                }
                AND = {
                    Y63 = { #Verkal Ozovar
                        is_subject_of = ROOT #Thangoya
                        has_opinion = {
                            who = ROOT #Thangoya
                            value = 190
                        }
                        if = {
                            limit = { ROOT = { khao_elnak_mission = yes } }
                            has_25_opinion_sent_gift = { target = ROOT } #Thangoya
                            has_15_opinion_getting_subsidies = { target = ROOT } #Thangoya
                        }
                        else = { NOT = { liberty_desire = 25 } }
                    } 
                }
                
            }
            if = {
                limit = { khao_elnak_mission = no }
                custom_trigger_tooltip = { #The "spoiler"
                    tooltip = thangoya_3_7_tt
                    always = yes
                }
            }
        }
        
        effect = {
            if = {
                limit = { has_dlc = "Leviathan" }
                add_government_reform = kai_diligent_bureucracy
            }
            else = { add_government_reform = kai_diligent_bureucracy_no_dlc }

            custom_tooltip = feitenEmpty
            custom_tooltip = thangoya_khao_elnak_mission_tt
            if = {
                limit = { khao_elnak_mission = yes }
                custom_tooltip = BONUS_REWARD_YES
            }
            else = { custom_tooltip = BONUS_REWARD_NO }
            tooltip = {
                country_event = { id = thangoya_event.13 }
            }
            hidden_effect = {
                if = {
                    limit = { khao_elnak_mission = yes }
                    country_event = { id = thangoya_event.13 }
                }
            }
        }
    }

	thangoya_3_9 = {
        icon = mission_conquer_air
        position = 9
        
        required_missions = {
            thangoya_2_8
			thangoya_4_8
        }

        provinces_to_highlight = {
            if = {
                limit = { ROOT = { lo_ngoen_mission = yes } }
                OR = {
                    province_id = 4780 #Masanthi
                    province_id = 4943 #Sikhawlom
                }
                NOT = {
                    AND = {
                        infantry_in_province = 10
                        has_province_modifier = scorched_earth
                    }
                }
            }
            else = { always = no } #nothing
        }
    
        trigger = {
            if = {
                limit = { lo_ngoen_mission = yes }
                4780 = { #Masanthi
                    infantry_in_province = 10
                    has_province_modifier = scorched_earth
                }
                4943 = { #Sikhawlom
                    infantry_in_province = 10
                    has_province_modifier = scorched_earth
                }
            }
            else = {
                has_estate_privilege = estate_adventurers_spirit_hunters
                has_estate_privilege = estate_mages_spirit_speakers
                OR = {
                    4780 = { has_building = fort_15th } #Masanthi
                    4943 = { has_building = fort_15th } #Sikhawlom
                }
                OR = {
                    any_known_country = {
                        religion = mystic_accord
                        OR = {
                            alliance_with = PREV #Thangoya
                            PREV = { #Thangoya
                                has_spy_network_in = {
                                    who = PREV #any_known_country
                                    value = 50
                                }
                            }
                        }
                    }
                    has_matching_religion = mystic_accord
                }
                custom_trigger_tooltip = { #The "spoiler"
                    tooltip = thangoya_3_9_tt
                    always = yes
                }
            }
        }
        
        effect = {
            4780 = { #Masanthi
                add_base_tax = 3
                add_province_modifier = {
                    name = thangoya_white_winds
                    duration = -1
                }

                custom_tooltip = thangoya_lo_ngoen_mission_tt #Not using complex_dynamic_effect as it doesn't click with at least one of those effects
                if = {
                    limit = { ROOT = { lo_ngoen_mission = yes } }
                    custom_tooltip = BONUS_REWARD_YES
                }
                else = { custom_tooltip = BONUS_REWARD_NO }
                tooltip = {
                    add_base_manpower = 3
                    kill_units = {
                        who = controller
                        type = infantry
                        amount = 2
                    } 
                }
            }

            custom_tooltip = feitenEmpty

            4943 = { #Sikhawlom
                add_base_production = 3
                add_province_modifier = {
                    name = thangoya_white_winds
                    duration = -1
                }

                custom_tooltip = thangoya_lo_ngoen_mission_tt #Not using complex_dynamic_effect as it doesn't click with at least one of those effects
                if = {
                    limit = { ROOT = { lo_ngoen_mission = yes } }
                    custom_tooltip = BONUS_REWARD_YES
                }
                else = { custom_tooltip = BONUS_REWARD_NO }
                tooltip = {
                    add_base_manpower = 3
                    kill_units = {
                        who = controller
                        type = infantry
                        amount = 4
                    } 
                }
            }
            hidden_effect = {
                if = { 
                    limit = { lo_ngoen_mission = yes } 
                    4780 = { #Masanthi
                        add_base_manpower = 3
                        kill_units = {
                            who = controller
                            type = infantry
                            amount = 2
                        } 
                    }
                    4943 = { #Sikhawlom
                        add_base_manpower = 3
                        kill_units = {
                            who = controller
                            type = infantry
                            amount = 4
                        } 
                    }
                }
            }
        }
    }

	thangoya_3_10 = {
        icon = establish_oktoberfest
        position = 10
        
        required_missions = {
            thangoya_2_9
            thangoya_3_9
        }
        
        provinces_to_highlight = {
            owned_by = ROOT
            OR = {
                has_infestation_1 = yes
                has_infestation_2 = yes
                has_infestation_3 = yes
            }
        }
    
        trigger = {
            4779 = { province_has_center_of_trade_of_level = 2 } #Haiban
            OR = {
                custom_trigger_tooltip = {
                    tooltip = thangoya_2_aw_modifier_tt
                    NOT = {
                        calc_true_if = {
                            ROOT = {
                                all_owned_province = {
                                    OR = {
                                        has_infestation_1 = yes
                                        has_infestation_2 = yes
                                        has_infestation_3 = yes
                                    }
                                }
                            }
                            amount = 3
                        }
                    }
                }
                4779 = { has_province_modifier = chi_wellspring_3 }
            }
            
            estate_loyalty = {
                estate = estate_adventurers
                loyalty = 60
            }
            if = {
                limit = { thirabnir_mission = yes }
                num_of_estate_privileges = {
                    estate = estate_adventurers
                    value = 4
                }
                custom_trigger_tooltip = {
                    tooltip = thangoya_has_sponsor_adventurers_tt
                    calc_true_if = {
                        has_estate_privilege = estate_adventurers_sponsor_beast_slayers
                        has_estate_privilege = estate_adventurers_sponsor_do_gooders
                        has_estate_privilege = estate_adventurers_sponsor_holy_paladins
                        has_estate_privilege = estate_adventurers_sponsor_monster_hunters
                        has_estate_privilege = estate_adventurers_sponsor_rogues
                        has_estate_privilege = estate_adventurers_sponsor_sellswords
                        amount = 1
                    }
                }
            }
            else = {
                estate_influence = {
                    estate = estate_adventurers
                    influence = 40
                }
                num_of_estate_privileges = {
                    estate = estate_adventurers
                    value = 6
                }
                custom_trigger_tooltip = {
                    tooltip = thangoya_has_2_sponsor_adventurers_tt
                    calc_true_if = {
                        has_estate_privilege = estate_adventurers_sponsor_beast_slayers
                        has_estate_privilege = estate_adventurers_sponsor_do_gooders
                        has_estate_privilege = estate_adventurers_sponsor_holy_paladins
                        has_estate_privilege = estate_adventurers_sponsor_monster_hunters
                        has_estate_privilege = estate_adventurers_sponsor_rogues
                        has_estate_privilege = estate_adventurers_sponsor_sellswords
                        amount = 2
                    }
                }
                custom_trigger_tooltip = { #The "spoiler"
                    tooltip = thangoya_3_10_tt
                    always = yes
                }
            }
        }
        
        effect = {
            4779 = { #Haiban
                add_harimari_minority_size_effect = yes
                add_hobgoblin_minority_size_effect = yes
                if = { 
                    limit = { 
                        OR = {
                            has_dlc = "Dharma"
                            province_has_center_of_trade_of_level = 3
                        }
                    }
                    ROOT = { add_treasury = 500 } #Thangoya
                }
                else = { add_center_of_trade_level = 1 }
            }
            sikai_townships_group = {
                add_province_modifier = {
                    name = thangoya_return_of_princes
                    duration = 10950
                }
            }
            complex_dynamic_effect = {
                first_custom_tooltip = thangoya_thirabnir_mission_tt
				first_limit = "thirabnir_mission = yes"
				first_effect = "anb_add_accepted_culture_or_dip_power = { culture = swallow_command free = yes }"
            }
            # custom_tooltip = thangoya_thirabnir_mission_tt
            # tooltip = {
            #     anb_add_accepted_culture_or_dip_power = { culture = swallow_command free = yes }
            # }
            # hidden_effect = {
            #     if = { 
            #         limit = { has_country_modifier = thangoya_thirabnir_ruler } 
            #         anb_add_accepted_culture_or_dip_power = { culture = swallow_command free = yes }
            #     }
            # }
        }
    }

	thangoya_3_11 = {
        icon = mission_gujarati_textiles
        position = 11
        
        required_missions = {
			thangoya_2_10
            thangoya_3_10
        }
        
        provinces_to_highlight = {
            OR = {
                AND = {
                    province_id = 4789 #Azkare
                    NOT = {
                        AND = {
                            has_building = textile
                            num_of_times_expanded_infrastructure = 2
                        }
                    }
                }
                AND = {
                    province_id = 4779 #Haiban
                    NOT = { num_of_times_expanded_infrastructure = 2 }
                }
            }
        }
    
        trigger = {
            4789 = { #Azkare
                has_building = textile
                num_of_times_expanded_infrastructure = 2
                has_any_ongoing_construction = no
            }
            4779 = { num_of_times_expanded_infrastructure = 2 } #Haiban
            4500 = { #Kharunyana
                strongest_trade_power = {
                    OR = {
                        tag = ROOT #Thangoya
                        trade_embargo_by = ROOT #Thangoya
                    }
                }
            }
            1361 = { #Gulf Of Rahen
                strongest_trade_power = {
                    OR = {
                        tag = ROOT #Thangoya
                        trade_embargo_by = ROOT #Thangoya
                    }
                }
            }
            if = {
                limit = { azkare_mission = yes }
                estate_loyalty = {
                    estate = estate_burghers
                    loyalty = 60
                }
                estate_influence = {
                    estate = estate_burghers
                    influence = 75
                }
                4778 = { has_any_ongoing_construction = no } #Kesanthi
            }
            else = {
                mercantilism = 20
                custom_trigger_tooltip = { #The "spoiler"
                    tooltip = thangoya_3_11_tt
                    always = yes
                }
            }
        }
        
        effect = {
            4779 = { #Haiban
                add_building_construction = {
                    building = plantations
                    speed = 1
                    cost = 0
                }
            }
            complex_dynamic_effect = {
                first_custom_tooltip = thangoya_azkare_mission_tt
				first_limit = "azkare_mission = yes"
				first_effect = "
                    4778 = { #Kesanthi
                        add_building_construction = {
                            building = mills
                            speed = 1
                            cost = 0
                        }
                    }
                    add_mercantilism = 5
				"
            }
            # custom_tooltip = thangoya_azkare_mission_tt
            # tooltip = {
            #     4778 = { #Kesanthi
            #         add_building_construction = {
            #             building = mills
            #             speed = 1
            #             cost = 0
            #         }
            #     }
            #     add_mercantilism = 5
            # }
            # hidden_effect = {
            #     if = {
            #         limit = { has_country_modifier = thangoya_azkare_ruler }
            #         4778 = { #Kesanthi
            #             add_building_construction = {
            #                 building = mills
            #                 speed = 1
            #                 cost = 0
            #             }
            #         }
            #         add_mercantilism = 5
            #     }
            # }
        }
    }

	thangoya_3_13 = {
        icon = mission_assemble_an_army
        position = 13
        
        required_missions = {
            thangoya_2_12
			thangoya_4_12
        }
    
        trigger = {
            OR = {
                army_professionalism = 0.5
                army_tradition = 80
            }
            army_size_percentage = 0.9
            num_accepted_cultures = 5
            custom_trigger_tooltip = {
                tooltip = thangoya_lvl_5_mil_adv_tt #I have to make this, unfortunately
                employed_advisor = {
                    category = MIL
                    skill = 5
                }
            }
            has_country_modifier = thangoya_shields_of_thangoya
            has_country_modifier = thangoya_half_ton_horsemen
        }
        
        effect = {
            remove_country_modifier = thangoya_shields_of_thangoya
            remove_country_modifier = thangoya_half_ton_horsemen
            add_country_modifier = {
                name = thangoya_seven_races_army
                duration = -1
            }
            set_country_flag = thangoya_drill_exercises
        }
    }
}

thangoya_4 = {
    slot = 4
    generic = no
    ai = yes
    has_country_shield = yes
    
    potential = {
        tag = Z62 #Thangoya
    }
    
    
    thangoya_4_5 = {
        icon = mission_rice_farming
        position = 5
        
        required_missions = { }
        
        provinces_to_highlight = {
            province_group = sikai_townships_group
            if = {
                limit = { ROOT = { thirabnir_mission = yes } } #Thangoya
                NOT = { units_in_province = 1 }
            }
            else = { devastation = 0.01 } #The tooltip rounds the number but the trigger works as intended
        }
    
        trigger = {
            4779 = { has_province_modifier = chi_wellspring_1 } #Haiban
            if = {
                limit = { thirabnir_mission = yes }
                manpower_percentage = 0.8
                sikai_townships_group = {
                    type = all
                    units_in_province = 1
                }
            }
            else = {
                NOT = { war_exhaustion = 0.01 }
                sikai_townships_group = {
                    type = all
                    NOT = { devastation = 0.01 } #The tooltip rounds the number but the trigger works as intended
                }
                custom_trigger_tooltip = { #The "spoiler"
                    tooltip = thangoya_4_5_tt
                    always = yes
                }
            }
        }
        
        effect = {
            add_stability = 1
            4775 = { add_permanent_claim = ROOT } #Patu #Thangoya 
            4776 = { add_permanent_claim = ROOT } #Tawantad #Thangoya 
            4759 = { add_permanent_claim = ROOT } #Hinmeuong #Thangoya
            phaktai_area = { add_permanent_claim = ROOT }
            4942 = { add_permanent_claim = ROOT } #Phomaban
            custom_tooltip = thangoya_thirabnir_mission_tt
            if = {
                limit = { thirabnir_mission = yes }
                custom_tooltip = BONUS_REWARD_YES
            }
            else = { custom_tooltip = BONUS_REWARD_NO }
            tooltip = {
                add_yearly_manpower = -1
                #For the sake of clarity
                ngoen_area = { limit = { province_group = sikai_townships_group } add_prosperity = 100 } 
                phakphon_area = { add_prosperity = 100 }
                thirabnir_area = { add_prosperity = 100 }
                kaiden_area = { add_prosperity = 100 }
            }
            hidden_effect = {
                if = {
                    limit = { thirabnir_mission = yes }
                    add_yearly_manpower = -1
                    sikai_townships_group = {
                        add_prosperity = 100
                    }
                }
            }
        }
    }

	thangoya_4_6 = {
        icon = mission_dwarf
        position = 6
        
        required_missions = {
            thangoya_4_5
			thangoya_5_5
        }
        
        provinces_to_highlight = {
            OR = {
                area = phaktai_area
                province_id = 4775 #Patu
                province_id = 4776 #Tawantad
                province_id = 4759 #Hinmeuong
                province_id = 4942 #Phomaban
            }
            if = {
                limit = { ROOT = { khao_elnak_mission = yes } } #Thangoya
                NOT = { country_or_non_sovereign_subject_holds = ROOT } #Thangoya
            }
            else = { NOT = { owned_by = Y88 } } #Hinphat
        }
    
        trigger = {
            if = {
                limit = { khao_elnak_mission = yes }
                phaktai_area = {
                    type = all
                    country_or_non_sovereign_subject_holds = ROOT #Thangoya
                }
                4775 = { country_or_non_sovereign_subject_holds = ROOT } #Patu #Thangoya 
                4776 = { country_or_non_sovereign_subject_holds = ROOT } #Tawantad #Thangoya 
                4759 = { country_or_non_sovereign_subject_holds = ROOT } #Hinmeuong #Thangoya 
                4942 = { country_or_non_sovereign_subject_holds = ROOT } #Phomaban #Thangoya 
                if = {
                    limit = { exists = Y63 } #Verkal Ozovar
                    Y63 = { #Verkal Ozovar
                        has_100_opinion_improved_relation = { target = ROOT } #Thangoya
                        has_spy_network_from = { who = ROOT value = 40 } #Thangoya
                    }
                }
                
                if = {
                    limit = { exists = R83 } #Semifire
                    R83 = { #Semifire
                        has_100_opinion_improved_relation = { target = ROOT } #Thangoya
                    }
                }
                OR = {
                    4775 = { #Patu
                        custom_trigger_tooltip = {
                            tooltip = thangoya_seat_in_parliament_tt
                            has_seat_in_parliament = yes
                        }    
                    }
                    Y88 = { #Hinphat
                        is_subject_of = PREV #Thangoya
                    }
                }
            }
            else = {
                Y88 = { #Hinphat
                    is_subject_of = PREV #Thangoya
                    4775 = { country_or_non_sovereign_subject_holds = Y88 } #Patu #Hinphat 
                    4776 = { country_or_non_sovereign_subject_holds = Y88 } #Tawantad #Hinphat 
                    4759 = { country_or_non_sovereign_subject_holds = Y88 } #Hinmeuong #Hinphat 
                    4942 = { country_or_non_sovereign_subject_holds = Y88 } #Phomaban #Hinphat
                    phaktai_area = {
                        type = all
                        country_or_non_sovereign_subject_holds = Y88 #Hinphat
                    }
                }
                NOT = { exists = Y87 } #Tidtam
                NOT = { exists = Y56 } #Pheuon Duan
                custom_trigger_tooltip = { #The "spoiler"
                    tooltip = thangoya_4_6_tt
                    always = yes
                }
            }
        }
        
        effect = {
            kasainam_area = { add_permanent_claim = ROOT }
            ngaopho_area = { add_permanent_claim = ROOT }
            yemakaibo_area = { add_permanent_claim = ROOT }
            ananhu_area = { add_permanent_claim = ROOT }
            phonan_area = { add_permanent_claim = ROOT }
            4674 = { add_permanent_claim = ROOT } #Mo Hoang

            custom_tooltip = thangoya_khao_elnak_mission_tt
            if = {
                limit = { khao_elnak_mission = yes }
                custom_tooltip = BONUS_REWARD_YES
            }
            else = { custom_tooltip = BONUS_REWARD_NO }
            tooltip = {
                if = {
                    limit = { exists = Y63 } #Verkal Ozovar
                    Y63 = { country_event = { id = thangoya_event.11 } } #Verkal Ozovar
                }
                if = {
                    limit = { exists = R83 } #Semifire
                    R83 = { country_event = { id = thangoya_event.12 } } #Semifire
                }
            }

            custom_tooltip = feitenEmpty
            custom_tooltip = thangoya_no_mission_tt
            if = {
                limit = { khao_elnak_mission = no }
                custom_tooltip = BONUS_REWARD_YES
            }
            else = { custom_tooltip = BONUS_REWARD_NO }
            tooltip = {
                add_country_modifier = {
                    name = thangoya_autonomous_subjects
                    duration = 7300
                }
                6300 = { add_permanent_claim = ROOT } #Semifire
            }

            hidden_effect = {
                if = {
                    limit = { khao_elnak_mission = yes }
                    if = {
                        limit = { exists = Y63 } #Verkal Ozovar
                        Y63 = { country_event = { id = thangoya_event.11 } }
                    }
                    if = {
                        limit = { exists = R83 } #Semifire
                        R83 = { country_event = { id = thangoya_event.12 } }
                    }
                }
                else = {
                    add_country_modifier = {
                        name = thangoya_autonomous_subjects
                        duration = 7300
                    }
                    6300 = { add_permanent_claim = ROOT } #Semifire
                }
            }
        }
    }

	thangoya_4_8 = {
        icon = mission_swedish_peasantry
        position = 8
        
        required_missions = {
            thangoya_4_6
        }
        
        provinces_to_highlight = { 
            OR = {
                AND = {
                    OR = {
                        area = ananhu_area
                        area = phonan_area
                        province_id = 4764 #Mo Hoang
                    }
                    NOT = { province_id = 4763 } #Hubai Mong
                    NOT = { province_id = 4758 } #Ananhu Sa
                    NOT = { has_province_modifier = autonomy_increased }
                }
                AND = {
                    OR = {
                        province_id = 4763 #Hubai Mong
                        province_id = 4758 #Ananhu Sa
                    } 
                    NOT = { has_province_modifier = autonomy_increased }
                    has_seat_in_parliament = no
                }
            }
        }
    
        trigger = {
            ananhu_area = {
                owned_by = ROOT #Thangoya #Specifically here so that people don't selfsabotage by releasing subjects
                has_province_modifier = autonomy_increased
            }
            phonan_area = {
                owned_by = ROOT #Thangoya #Specifically here so that people don't selfsabotage by releasing subjects
                has_province_modifier = autonomy_increased
            }
            4764 = { #Mo Hoang
                owned_by = ROOT #Thangoya #Specifically here so that people don't selfsabotage by releasing subjects
                has_province_modifier = autonomy_increased
            }
            accepted_culture = phonan
            4763 = { #Hubai Mong
                custom_trigger_tooltip = {
                    tooltip = thangoya_seat_in_parliament_tt
                    has_seat_in_parliament = yes
                }
            }
            4758 = { #Ananhu Sa
                custom_trigger_tooltip = {
                    tooltip = thangoya_seat_in_parliament_tt
                    has_seat_in_parliament = yes
                }    
            } 
        }
        
        effect = {
            4764 = { #Mo Hoang
                change_culture = phonan 
                add_nationalism = -10
            } 
            ananhu_area = { add_nationalism = -10 }
            phonan_area = { add_nationalism = -10 }
            nui_phom_area = { add_permanent_claim = ROOT }
            khom_ma_area = { add_permanent_claim = ROOT }
            hoangdesinh_area = { add_permanent_claim = ROOT }
        }
    }

	thangoya_4_9 = {
        icon = mission_develop_nevas_port
        position = 9
        
        required_missions = {
            thangoya_4_8
        }
        
        provinces_to_highlight = {
            OR = {
                AND = {
                    OR = {
                        area = nui_phom_area
                        area = khom_ma_area
                        area = hoangdesinh_area
                    }
                    NOT = { country_or_non_sovereign_subject_holds = ROOT } #Thangoya
                }
                AND = {
                    OR = {
                        province_id = 4701 #Cay Cam Sinh
                        province_id = 4764 #Mo Hoang
                    }
                    NOT = { country_or_non_sovereign_subject_holds = ROOT } #Thangoya
                    has_seat_in_parliament = no
                }
            }
        }
    
        trigger = {
            nui_phom_area = { type = all country_or_non_sovereign_subject_holds = ROOT } #Thangoya
            khom_ma_area = { type = all country_or_non_sovereign_subject_holds = ROOT } #Thangoya
            hoangdesinh_area = { type = all country_or_non_sovereign_subject_holds = ROOT } #Thangoya
            4701 = { #Cay Cam Sinh
                custom_trigger_tooltip = {
                    tooltip = thangoya_seat_in_parliament_tt
                    has_seat_in_parliament = yes
                }    
            } 
            4764 = { #Mo Hoang
                custom_trigger_tooltip = {
                    tooltip = thangoya_seat_in_parliament_tt
                    has_seat_in_parliament = yes
                }    
            } 
            navy_size_percentage = 0.75
            if = {
                limit = { azkare_mission = yes }
                num_of_light_ship = 20
                custom_trigger_tooltip = {
                    tooltip = thangoya_main_port_tt
                    home_trade_node = {
                        province_id = 1364 #Cay Cam Sinh
                        trade_share = {
                            country = ROOT #Thangoya
                            share = 50
                        }
                    }
                }
                4701 = { has_any_ongoing_construction = no } #Cay Cam Sinh
                4699 = { has_any_ongoing_construction = no } #Bihon Caung
            }
            else = {
                1364 = { #Cay Cam Sinh
                    trade_share = {
                        country = ROOT #Thangoya
                        share = 50
                    }
                }
                custom_trigger_tooltip = { #The "spoiler"
                    tooltip = thangoya_4_9_tt
                    always = yes
                }
            }
        }
        
        effect = {
            nagon_area = { add_permanent_claim = ROOT } #Thangoya
            loratana_area = { add_permanent_claim = ROOT } #Thangoya
            add_country_modifier = {
                name = thangoya_new_trading_doctrine
                duration = -1
            }
            custom_tooltip = thangoya_azkare_mission_tt
            if = {
                limit = { azkare_mission = yes }
                custom_tooltip = BONUS_REWARD_YES
            }
            else = { custom_tooltip = BONUS_REWARD_NO }
            tooltip = {
                4701 = { #Cay Cam Sinh
                    remove_building = shipyard
                    add_building_construction = {
                        building = grand_shipyard
                        cost = 0
                        speed = 1
                    }
                }
                4699 = { #Bihon Caung
                    remove_building = shipyard
                    add_building_construction = {
                        building = grand_shipyard
                        cost = 0
                        speed = 1
                    }
                }
            }
            hidden_effect = {
                if = {
                    limit = { azkare_mission = yes }
                    4701 = { #Cay Cam Sinh
                        remove_building = shipyard
                        add_building_construction = {
                            building = grand_shipyard
                            cost = 0
                            speed = 1
                        }
                    }
                    4699 = { #Bihon Caung
                        remove_building = shipyard
                        add_building_construction = {
                            building = grand_shipyard
                            cost = 0
                            speed = 1
                        }
                    }
                }
            }
        }
    }

	thangoya_4_10 = {
        icon = hand-picked_bureaucrats
        position = 10
        
        required_missions = {
            thangoya_4_9
			thangoya_5_9
        }
        
        provinces_to_highlight = {
            region = thidinkai_region
            NOT = { is_core = ROOT } #Thangoya
        }
    
        trigger = {
            thidinkai_region = { type = all country_or_non_sovereign_subject_holds = ROOT }
            has_country_modifier = racial_focus_harimari
            calc_true_if = {
                all_owned_province = {
                    NOT = { province_group = sikai_townships_group }
                    has_building = courthouse
                }
                amount = 15
            }
        }
        
        effect = {
            set_government_rank = 3
            set_all_tolerance_to_coexisting_or_higher = yes
        }
    }

	thangoya_4_12 = {
        icon = all_bases_covered
        position = 12
        
        required_missions = {
            thangoya_4_10
        }
    
        trigger = {
            high_tolerance_harpy_race_trigger = yes
            high_tolerance_harimari_race_trigger = yes
            high_tolerance_hobgoblin_race_trigger = yes
            high_tolerance_dwarven_race_trigger = yes
            high_tolerance_elven_race_trigger = yes
            high_tolerance_kobold_race_trigger = yes
            current_size_of_parliament = 25
            republican_tradition = 95
        }
        
        effect = {
            add_country_modifier = {
                name = thangoya_home_of_all_races
                duration = -1
            }
        }
    }
}

thangoya_5 = {
    slot = 5
    generic = no
    ai = yes
    has_country_shield = yes
    
    potential = {
        tag = Z62 #Thangoya
    }
    
    
    thangoya_5_5 = {
        icon = mission_italian_condottiere
        position = 5
        
        required_missions = {}
    
        trigger = {
            if = { 
                limit = { khao_elnak_mission = yes }
                OR = {
                    AND = {
                        is_subject_of = Y58 #Lot Dekkhang
                        has_opinion = {
                            who = Y58 #Lot Dekkhang
                            value = 150
                        }
                    }
                    AND = {
                        has_spy_network_in = {
                            who = Y58 #Lot Dekkhang
                            value = 50
                        }
                        OR = {
                            has_spawned_supported_rebels = Y58 #Lot Dekkhang
                            Y58 = { rebel_progress_at_least = { value = 100 } } #In case the rebels have no way of spawning
                        } 
                    }
                }
                else = {
                    OR = {
                        is_rival = Y58 #Lot Dekkhang
                        NOT = { exists = Y58 } #Lot Dekkhang
                    }
                    army_size = Y58 #Lot Dekkhang
                    custom_trigger_tooltip = { #The "spoiler"
                        tooltip = thangoya_5_5_tt
                        always = yes
                    }
                }
            }
        }
        
        effect = {
            custom_tooltip = thangoya_no_mission_tt
            if = {
                limit = { khao_elnak_mission = no }
                custom_tooltip = BONUS_REWARD_YES
            }
            else = { custom_tooltip = BONUS_REWARD_NO }
            tooltip = {
                dekphre_area = { add_permanent_claim = ROOT }
                banhlubei_area = { add_permanent_claim = ROOT }
                khung_btei_area = { add_permanent_claim = ROOT }
                middle_telebei_area = { add_permanent_claim = ROOT }
            }

            custom_tooltip = feitenEmpty
            custom_tooltip = thangoya_khao_elnak_mission_tt
            if = {
                limit = { khao_elnak_mission = yes }
                custom_tooltip = BONUS_REWARD_YES
            }
            else = { custom_tooltip = BONUS_REWARD_NO }
            tooltip = {
                custom_tooltip = thangoya_vassal_if_tt
                if = {
                    limit = { 
                        is_subject_of = Y58 #Lot Dekkhang
                        has_opinion = {
                            who = Y58 #Lot Dekkhang
                            value = 150
                        }
                    }
                    custom_tooltip = BONUS_REWARD_YES
                }
                else = { custom_tooltip = BONUS_REWARD_NO }
                add_country_modifier = {
                    name = thangoya_contacts_with_daulophs
                    duration = 9125
                }

                custom_tooltip = thangoya_mya_saetae_ruler
                if = {
                    limit = { dynasty = "Saetae" }
                    custom_tooltip = BONUS_REWARD_YES
                }
                else = { custom_tooltip = BONUS_REWARD_NO }
                tooltip = {
                    country_event = { id = thangoya_event.6 } 
                }

                custom_tooltip = thangoya_no_mya_saetae_ruler
                if = {
                    limit = { NOT = { dynasty = "Saetae" } }
                    custom_tooltip = BONUS_REWARD_YES
                }
                else = { custom_tooltip = BONUS_REWARD_NO }
                tooltip = {
                    country_event = { id = thangoya_event.8 } 
                }
            }
            hidden_effect = {
                if = { 
                    limit = { khao_elnak_mission = yes }
                    if = {
                        limit = {
                            is_subject_of = Y58 #Lot Dekkhang
                            has_opinion = {
                                who = Y58 #Lot Dekkhang
                                value = 150
                            }
                        }
                        add_country_modifier = {
                            name = thangoya_contacts_with_daulophs
                            duration = 9125
                        }
                    }
                    else_if = {
                        limit = { dynasty = "Saetae" }
                        country_event = { id = thangoya_event.6 }
                    }
                    else = { country_event = { id = thangoya_event.8 } }
                }
                else = {
                    dekphre_area = { add_permanent_claim = ROOT }
                    banhlubei_area = { add_permanent_claim = ROOT }
                    khung_btei_area = { add_permanent_claim = ROOT }
                    middle_telebei_area = { add_permanent_claim = ROOT }
                }
            }
        }
    }

	thangoya_5_6 = {
        icon = mission_se_along_the_river
        position = 6
        
        required_missions = {
            thangoya_5_5
        }
        
        provinces_to_highlight = {
            if = {
                limit = { ROOT = { is_subject_of = Y58 } } #Thangoya #Lot Dekkhang
                OR = {
                    area = banhlubei_area
                    area = khung_btei_area
                    area = middle_telebei_area
                }
                NOT = { owned_by = Y58 } #Lot Dekkhang
            }
            else = {
                OR = {
                    area = dekphre_area
                    area = banhlubei_area
                    area = khung_btei_area
                    area = middle_telebei_area
                }
                NOT = { country_or_non_sovereign_subject_holds = ROOT } #Thangoya
            }
        }
    
        trigger = {
            if = {
                limit = { is_subject_of = Y58 } #Lot Dekkhang
                khung_btei_area = { owned_by = Y58 } #Lot Dekkhang
                banhlubei_area = { owned_by = Y58 } #Lot Dekkhang
                middle_telebei_area = { owned_by = Y58 } #Lot Dekkhang
            }
            else = {
                dekphre_area = { country_or_non_sovereign_subject_holds = ROOT } #Thangoya
                khung_btei_area = { country_or_non_sovereign_subject_holds = ROOT } #Thangoya
                banhlubei_area = { country_or_non_sovereign_subject_holds = ROOT } #Thangoya
                middle_telebei_area = { country_or_non_sovereign_subject_holds = ROOT } #Thangoya
                4779 = {
                    province_has_center_of_trade_of_level = 1 
                    OR = {
                        has_state_edict = edict_protect_trade
                        AND = {
                            owned_by = Y58 #Lot Dekkhang
                            Y58 = { has_divert_trade = yes } #Lot Dekkhang
                        }
                    }
                }
                4941 = {
                    OR = {
                        has_state_edict = edict_protect_trade
                        AND = {
                            owned_by = Y58 #Lot Dekkhang
                            Y58 = { has_divert_trade = yes } #Lot Dekkhang
                        }
                    }
                }
                4594 = {
                    OR = {
                        has_state_edict = edict_protect_trade
                        AND = {
                            owned_by = Y58 #Lot Dekkhang
                            Y58 = { has_divert_trade = yes } #Lot Dekkhang
                        }
                    }
                }
            }
        }
        
        effect = {
            custom_tooltip = thangoya_haiban_cot_upgrade_tt
            4779 = { 
                add_trade_modifier = {
                    who = ROOT #Haiban
                    duration = -1
                    power = 50
                    key = thangoya_breadbasket_of_haless
                }
            }
            hidden_effect = {
                4779 = {
                    if = {
                        limit = { NOT = { province_has_center_of_trade_of_level = 2 } }
                        add_center_of_trade_level = 1
                    }
                    else = {
                        ROOT = { add_dip_power = 50 } #Thangoya
                    }
                }
                4941 = {
                    if = {
                        limit = { NOT = { province_has_center_of_trade_of_level = 2 } }
                        add_center_of_trade_level = 1
                    }
                    else = {
                        ROOT = { add_dip_power = 50 } #Thangoya
                    }
                }
                4594 = {
                    if = {
                        limit = { NOT = { province_has_center_of_trade_of_level = 2 } }
                        add_center_of_trade_level = 1
                    }
                    else = {
                        ROOT = { add_dip_power = 50 } #Thangoya
                    }
                }
            }
        }
    }

	thangoya_5_7 = {
        icon = mission_heated_battle
        position = 7
        
        required_missions = {
            thangoya_4_6
        }
        
        provinces_to_highlight = {
            OR = {
                area = ngaopho_area
                area = kasainam_area
                area = yemakaibo_area
            }
            NOT = { 
                country_or_non_sovereign_subject_holds = ROOT #Thangoya
                units_in_province = 1 #Instead of autonomous rebel suppression, I guess
            } 
        }
    
        trigger = {
            ngaopho_area = { 
                type = all
                country_or_non_sovereign_subject_holds = ROOT #Thangoya
                num_of_units_in_province = { amount = 1 } #Instead of autonomous rebel suppression, I guess
            } 
            kasainam_area = { 
                type = all
                country_or_non_sovereign_subject_holds = ROOT #Thangoya
                num_of_units_in_province = { amount = 1 } #Instead of autonomous rebel suppression, I guess
            } 
            yemakaibo_area = { 
                type = all
                country_or_non_sovereign_subject_holds = ROOT #Thangoya
                num_of_units_in_province = { amount = 1 } #Instead of autonomous rebel suppression, I guess
            } 
            NOT = { exists = Y71 } #Kudet Kai
            4751 = { #Nirakvonkai
                has_seat_in_parliament = yes
                num_of_units_in_province = { amount = 20 } #Instead of autonomous rebel suppression, I guess
            }
        }
        
        effect = {
            4751 = {
                spawn_rebels = {
                    type = nationalist_rebels
                    size = 2
                    culture = bokai
                    separatists_target = Y71
                }
            }
            ngaopho_area = { 
                add_province_modifier = {
                    name = thangoya_crackdown_on_bokai
                    duration = 7300
                }
            }
            kasainam_area = { 
                add_province_modifier = {
                    name = thangoya_crackdown_on_bokai
                    duration = 7300
                }
            }
            yemakaibo_area = { 
                add_province_modifier = {
                    name = thangoya_crackdown_on_bokai
                    duration = 7300
                }
            }
            binhrunghin_area = { add_permanent_claim = ROOT } #Thangoya
            thuongidut_area = { add_permanent_claim = ROOT } #Thangoya
            zyujyut_bokai_provinces = { add_permanent_claim = ROOT } #Thangoya
        }
    }

	thangoya_5_9 = {
        icon = mission_conquer_5_states
        position = 9
        
        required_missions = {
            thangoya_5_7
        }
        
        provinces_to_highlight = {
            OR = {
                area = binhrunghin_area
                area = thuongidut_area
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT } #Thangoya
        }
    
        trigger = {
            binhrunghin_area = { country_or_non_sovereign_subject_holds = ROOT } #Thangoya
            thuongidut_area = { country_or_non_sovereign_subject_holds = ROOT } #Thangoya
            NOT = { exists = Y72 } #Chien Binhrung
            4955 = { #Keoaden
                custom_trigger_tooltip = {
                    tooltip = thangoya_seat_in_parliament_tt
                    has_seat_in_parliament = yes
                }    
            } 
            num_of_cavalry = 8
            num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
                base_production = 10
                trade_goods = copper
                is_city = yes
                value = 3
            }
            num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
                base_production = 8
                trade_goods = gems
                is_city = yes
                value = 3
            }
            trade_goods_produced_amount = {
                trade_goods = gold
                amount = 3
            }
        }
        
        effect = {
            sirtan_area = { add_permanent_claim = ROOT } #Thangoya
            remove_country_modifier = thangoya_purebred_lancers
            add_country_modifier = {
                name = thangoya_half_ton_horsemen
                duration = -1
            }
        }
    }
}
