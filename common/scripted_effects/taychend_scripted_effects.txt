update_taychend_glory = {
	if = {
		limit = {
			check_variable = {
				which = TaychendGlory
				value = 500
			}
		}
		set_variable = { #Cannot go over 500
			which = TaychendGlory
			value = 500
		}
		change_personal_deity = taychend_glory_5
	}
	else_if = {
		limit = {
			check_variable = {
				which = TaychendGlory
				value = 400
			}
		}
		change_personal_deity = taychend_glory_5
	}
	else_if = {
		limit = {
			check_variable = {
				which = TaychendGlory
				value = 300
			}
		}
		change_personal_deity = taychend_glory_4
	}
	else_if = {
		limit = {
			check_variable = {
				which = TaychendGlory
				value = 200
			}
		}
		change_personal_deity = taychend_glory_3
	}
	else_if = {
		limit = {
			check_variable = {
				which = TaychendGlory
				value = 100
			}
		}
		change_personal_deity = taychend_glory_2
	}
	else_if = {
		limit = {
			check_variable = {
				which = TaychendGlory
				value = 0
			}
		}
		change_personal_deity = taychend_glory_1
	}
	else = {
		change_personal_deity = taychend_glory_1
		set_variable = { #Cannot go under 0
			which = TaychendGlory
			value = 0
		}
	}
}

taychend_capacity_release = {
	custom_tooltip = taychend_capacity_release_tt
	hidden_effect = {
		while = {
			limit = {
				governing_capacity_percentage = 1.01
				any_owned_province = {
					any_core_country = { exists = no }
					NOT = { has_province_flag = taychend_capital_area }
				}
			}
			random_owned_province = {
				limit = {
					any_core_country = { exists = no }
					NOT = { has_province_flag = taychend_capital_area }
				}
				random_core_country = {
					limit = { exists = no }
					ROOT = { create_vassal = PREV }
					change_religion = gods_of_the_taychend
				}
			}
		}
	}
}

taychend_capacity_feed = {
	custom_tooltip = taychend_capacity_feed_tt
	hidden_effect = {
		while = {
			limit = {
				governing_capacity_percentage = 1.01
				any_owned_province = { 
					any_core_country = { is_subject_of = ROOT }
					NOT = { has_province_flag = taychend_capital_area }	
				}
			}
			random_owned_province = {
				limit = { 
					any_core_country = { is_subject_of = ROOT }
					NOT = { has_province_flag = taychend_capital_area }	
				}
				random_core_country = {
					limit = { is_subject_of = ROOT }
					PREV = { cede_province = PREV }
				}
			}
		}
		while = {
			limit = {
				governing_capacity_percentage = 1.01
				any_owned_province = { 
					any_neighbor_province = { owner = { is_subject_of = ROOT } }
					NOT = { has_province_flag = taychend_capital_area }	
				}
			}
			random_owned_province = {
				limit = { 
					any_neighbor_province = { owner = { is_subject_of = ROOT } }
					NOT = { has_province_flag = taychend_capital_area }
				}
				set_province_flag = taychend_giving
				random_neighbor_province = {
					limit = { owner = { is_subject_of = ROOT } }
					owner = {
						random_province = {
							limit = { has_province_flag = taychend_giving }
							clr_province_flag = taychend_giving
							cede_province = PREV
						}
					}
				}
			}
		}
	}
}

taychend_ruler_general = {
	if = {
		limit = { NOT = { is_monarch_leader = yes } }
		if = {
			limit = { is_female = yes }
			convert_female_ruler_to_general = yes
		}
		else_if = { 
			limit = { army_tradition = 80 }
			convert_ruler_to_general = 80
		}
		else_if = { 
			limit = { army_tradition = 60 }
			convert_ruler_to_general = 60
		}
		else_if = { 
			limit = { army_tradition = 40 }
			convert_ruler_to_general = 40
		}
		else = { 
			convert_ruler_to_general = 20
		}
	}
	if = {
		limit = { has_country_flag = taychend_regency }
		custom_tooltip = taychend_kid_ruler_future_general
	}
}

gain_taychend_glory_effect = {
	custom_tooltip = gain_$amount$_glory_tt
	hidden_effect = {
		change_variable = {
			which = TaychendGlory
			value = $amount$
		}
		update_taychend_glory = yes
	}
}

lose_taychend_glory_effect = {
	custom_tooltip = lose_$amount$_glory_tt
	hidden_effect = {
		subtract_variable = {
			which = TaychendGlory
			value = $amount$
		}
		update_taychend_glory = yes
	}
}