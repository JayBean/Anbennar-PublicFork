

clr_mandate_modifiers = {
	remove_country_modifier = lessons_aakhet_reform_modifier

	update_sorrow_province_count = yes
}

update_sorrow_province_modifiers = {

	#reforms
	if = {
		limit = { empire_of_china_reform_passed = mend_broken_reform }
		add_province_modifier = { name = mend_broken_reform_modifier duration = -1 hidden = yes }
	}
	if = {
		limit = { has_global_flag = feed_land_reform_passed }
		add_province_modifier = { name = feed_land_reform_modifier duration = -1 hidden = yes }
	}
	if = {
		limit = { has_global_flag = exploit_land_reform_passed }
		add_province_modifier = { name = exploit_land_reform_modifier duration = -1 hidden = yes }
	}

	#decrees
	if = {
		limit = { owner = { is_emperor_of_china = yes } empire_of_china_has_active_decree = plenty_decree }
		add_province_modifier = { name = plenty_decree_modifier duration = 3650 hidden = yes }
	}
	if = {
		limit = { owner = { is_emperor_of_china = yes } empire_of_china_has_active_decree = commerce_decree }
		add_province_modifier = { name = commerce_decree_modifier duration = 3650 hidden = yes }
	}
	if = {
		limit = { owner = { is_emperor_of_china = yes } empire_of_china_has_active_decree = waves_decree area = coast_of_tears_area }
		add_province_modifier = { name = waves_decree_modifier duration = 3650 hidden = yes }
	}
	if = {
		limit = { owner = { is_emperor_of_china = yes } empire_of_china_has_active_decree = prosperity_decree }
		add_province_modifier = { name = prosperity_decree_modifier duration = 3650 hidden = yes }
	}
	if = {
		limit = { owner = { is_emperor_of_china = yes } empire_of_china_has_active_decree = salvation_decree }
		add_province_modifier = { name = salvation_decree_modifier duration = 3650 hidden = yes }
	}
	if = {
		limit = { owner = { is_emperor_of_china = yes } empire_of_china_has_active_decree = defiance_decree }
		add_province_modifier = { name = defiance_decree_modifier duration = 3650 hidden = yes }
	}
}



update_sorrow_province_count = {
	remove_country_modifier = mandate_unowned_khet
	remove_country_modifier = mandate_unowned_nirat
	remove_country_modifier = mandate_unowned_koroshesh
	remove_country_modifier = mandate_unowned_golkora
	remove_country_modifier = mandate_unowned_niramit

	remove_country_modifier = mandate_unowned_sorrow_1
	remove_country_modifier = mandate_unowned_sorrow_2
	remove_country_modifier = mandate_unowned_sorrow_3
	remove_country_modifier = mandate_unowned_sorrow_4
	remove_country_modifier = mandate_unowned_sorrow_5
	remove_country_modifier = mandate_unowned_sorrow_6
	remove_country_modifier = mandate_unowned_sorrow_7
	remove_country_modifier = mandate_unowned_sorrow_8
	remove_country_modifier = mandate_unowned_sorrow_9
	remove_country_modifier = mandate_unowned_sorrow_10
	remove_country_modifier = mandate_unowned_sorrow_11
	remove_country_modifier = mandate_unowned_sorrow_12
	remove_country_modifier = mandate_unowned_sorrow_13
	remove_country_modifier = mandate_unowned_sorrow_14
	remove_country_modifier = mandate_unowned_sorrow_15
	remove_country_modifier = mandate_unowned_sorrow_16
	remove_country_modifier = mandate_unowned_sorrow_17
	remove_country_modifier = mandate_unowned_sorrow_18
	remove_country_modifier = mandate_unowned_sorrow_19
	remove_country_modifier = mandate_unowned_sorrow_20
	remove_country_modifier = mandate_unowned_sorrow_21
	remove_country_modifier = mandate_unowned_sorrow_22
	remove_country_modifier = mandate_unowned_sorrow_23
	remove_country_modifier = mandate_unowned_sorrow_24
	remove_country_modifier = mandate_unowned_sorrow_25
	remove_country_modifier = mandate_unowned_sorrow_26
	remove_country_modifier = mandate_unowned_sorrow_27
	remove_country_modifier = mandate_unowned_sorrow_28
	remove_country_modifier = mandate_unowned_sorrow_29
	remove_country_modifier = mandate_unowned_sorrow_30

	if = {
		limit = { is_emperor_of_china = yes }
		if = {
			limit = { NOT = { owns = 475 } }
			add_country_modifier = { name = mandate_unowned_khet duration = -1 hidden = yes }
		}
		if = {
			limit = { NOT = { owns = 473 } }
			add_country_modifier = { name = mandate_unowned_nirat duration = -1 hidden = yes }
		}
		if = {
			limit = { NOT = { owns = 463 } }
			add_country_modifier = { name = mandate_unowned_koroshesh duration = -1 hidden = yes }
		}
		if = {
			limit = { NOT = { owns = 479 } }
			add_country_modifier = { name = mandate_unowned_golkora duration = -1 hidden = yes }
		}
		if = {
			limit = { NOT = { owns = 5481 } }
			add_country_modifier = { name = mandate_unowned_niramit duration = -1 hidden = yes }
		}

		set_variable = { unowned_sorrow = 0 }
		mothers_sorrow_group = {
			limit = { NOT = { owned_by = PREV } }
			PREV = { change_variable = { unowned_sorrow = 1 } }
		}
		if = {
			limit = { check_variable = { unowned_sorrow = 30 } }
			add_country_modifier = { name = mandate_unowned_sorrow_30 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 29 } }
			add_country_modifier = { name = mandate_unowned_sorrow_29 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 28 } }
			add_country_modifier = { name = mandate_unowned_sorrow_28 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 27 } }
			add_country_modifier = { name = mandate_unowned_sorrow_27 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 26 } }
			add_country_modifier = { name = mandate_unowned_sorrow_26 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 25 } }
			add_country_modifier = { name = mandate_unowned_sorrow_25 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 24 } }
			add_country_modifier = { name = mandate_unowned_sorrow_24 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 23 } }
			add_country_modifier = { name = mandate_unowned_sorrow_23 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 22 } }
			add_country_modifier = { name = mandate_unowned_sorrow_22 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 21 } }
			add_country_modifier = { name = mandate_unowned_sorrow_21 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 20 } }
			add_country_modifier = { name = mandate_unowned_sorrow_20 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 19 } }
			add_country_modifier = { name = mandate_unowned_sorrow_19 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 18 } }
			add_country_modifier = { name = mandate_unowned_sorrow_18 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 17 } }
			add_country_modifier = { name = mandate_unowned_sorrow_17 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 16 } }
			add_country_modifier = { name = mandate_unowned_sorrow_16 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 15 } }
			add_country_modifier = { name = mandate_unowned_sorrow_15 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 14 } }
			add_country_modifier = { name = mandate_unowned_sorrow_14 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 13 } }
			add_country_modifier = { name = mandate_unowned_sorrow_13 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 12 } }
			add_country_modifier = { name = mandate_unowned_sorrow_12 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 11 } }
			add_country_modifier = { name = mandate_unowned_sorrow_11 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 10 } }
			add_country_modifier = { name = mandate_unowned_sorrow_10 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 9 } }
			add_country_modifier = { name = mandate_unowned_sorrow_9 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 8 } }
			add_country_modifier = { name = mandate_unowned_sorrow_8 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 7 } }
			add_country_modifier = { name = mandate_unowned_sorrow_7 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 6 } }
			add_country_modifier = { name = mandate_unowned_sorrow_6 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 5 } }
			add_country_modifier = { name = mandate_unowned_sorrow_5 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 4 } }
			add_country_modifier = { name = mandate_unowned_sorrow_4 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 3 } }
			add_country_modifier = { name = mandate_unowned_sorrow_3 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 2 } }
			add_country_modifier = { name = mandate_unowned_sorrow_2 duration = -1 hidden = yes }
		}
		else_if = {
			limit = { check_variable = { unowned_sorrow = 1 } }
			add_country_modifier = { name = mandate_unowned_sorrow_1 duration = -1 hidden = yes }
		}
	}

	
}





#I'm putting this here because i can
change_aakhet_approval = {
	custom_tooltip = change_aakhet_approval_tooltip_$value$
	custom_tooltip = aakhetist_current_approval_tooltip
	hidden_effect = {
		change_variable = { aakhet_approval = $value$ }
	
		#overflow and not host
		if = {
			limit = { 
				check_variable = { aakhet_approval = 101 } 
				NOT = {
					has_global_flag = aakhet_hostless
					has_country_flag = current_aakhet_host
					overlord = { has_country_flag = current_aakhet_host } 
				}
			}
			set_variable = { which = aakhet_overflow which = aakhet_approval }
			change_variable = { aakhet_overflow = -100 }
			if = {
				limit = { check_variable = { aakhet_overflow = 30 } }
				event_target:aakhet_host = { set_country_flag = aakhet_reduction_30 country_event = { id = aakhetist.02 } }
			}
			else_if = {
				limit = { check_variable = { aakhet_overflow = 25 } }
				event_target:aakhet_host = { set_country_flag = aakhet_reduction_25 country_event = { id = aakhetist.02 } }
			}
			else_if = {
				limit = { check_variable = { aakhet_overflow = 20 } }
				event_target:aakhet_host = { set_country_flag = aakhet_reduction_20 country_event = { id = aakhetist.02 } }
			}
			else_if = {
				limit = { check_variable = { aakhet_overflow = 15 } }
				event_target:aakhet_host = { set_country_flag = aakhet_reduction_15 country_event = { id = aakhetist.02 } }
			}
			else_if = {
				limit = { check_variable = { aakhet_overflow = 10 } }
				event_target:aakhet_host = { set_country_flag = aakhet_reduction_10 country_event = { id = aakhetist.02 } }
			}
			else_if = {
				limit = { check_variable = { aakhet_overflow = 5 } }
				event_target:aakhet_host = { set_country_flag = aakhet_reduction_5 country_event = { id = aakhetist.02 } }
			}
			set_variable = { aakhet_approval = 100 }
			set_variable = { aakhet_overflow = 0 }
		}
		#just overflow
		if = {
			limit = { 
				check_variable = { aakhet_approval = 101 }
				OR = { 
					has_country_flag = current_aakhet_host
					overlord = { has_country_flag = current_aakhet_host } 
				}
			}
			set_variable = { aakhet_approval = 100 }
		}
		#Aakhet is hostless
		if = {
			limit = {
				check_variable = { aakhet_approval = 101 }
				has_global_flag = aakhet_hostless
			}
			set_variable = { aakhet_approval = 100 }
			country_event = { id = aakhetist.01 }
		}
		#below 0 and not host
		if = {
			limit = { 
				NOT = {
					check_variable = { aakhet_approval = 1 } 
					has_country_flag = current_aakhet_host 
				}
			}
			set_variable = { aakhet_approval = 0 }
		}
		#below 0 and host
		if = {
			limit = { 
				NOT = { check_variable = { aakhet_approval = 1 } }
				has_country_flag = current_aakhet_host 
			}
			set_variable = { aakhet_approval = 0 }
			country_event = { id = aakhetist.03 }
		}
	}
}