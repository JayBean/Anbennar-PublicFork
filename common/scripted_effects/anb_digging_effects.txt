
the_fallen_invasion_army = {
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { artillery = PREV }
	H94 = { artillery = PREV }
	H94 = { artillery = PREV }
	H94 = { artillery = PREV }
	H94 = { artillery = PREV }
	H94 = { artillery = PREV }
	H94 = { artillery = PREV }
	H94 = { artillery = PREV }
	H94 = { artillery = PREV }
	H94 = { artillery = PREV }
}

the_fallen_invasion_infiltrator = {
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
	H94 = { infantry = PREV }
}


define_hold_to_repair = {
	random_owned_province = {
		limit = { OR = { has_province_modifier = ruined_hold has_province_modifier = partially_ruined_hold has_province_modifier = damaged_hold } NOT = { has_construction = building has_construction = missionary has_construction = colonist has_construction = culture has_construction = great_project has_province_flag = repair_@ROOT has_province_modifier = blorc_plunder_camp } is_city = yes is_core = ROOT }
		set_province_flag = option_repair_1_@ROOT
		set_province_flag = repair_@ROOT
		save_event_target_as = repair1
		setup_restoration_speed = yes
	}
	random_owned_province = {
		limit = { OR = { has_province_modifier = ruined_hold has_province_modifier = partially_ruined_hold has_province_modifier = damaged_hold } NOT = { has_construction = building has_construction = missionary has_construction = colonist has_construction = culture has_construction = great_project has_province_flag = repair_@ROOT has_province_modifier = blorc_plunder_camp } is_city = yes is_core = ROOT }
		set_province_flag = option_repair_2_@ROOT
		set_province_flag = repair_@ROOT
		save_event_target_as = repair2
		setup_restoration_speed = yes
	}
	random_owned_province = {
		limit = { OR = { has_province_modifier = ruined_hold has_province_modifier = partially_ruined_hold has_province_modifier = damaged_hold } NOT = { has_construction = building has_construction = missionary has_construction = colonist has_construction = culture has_construction = great_project has_province_flag = repair_@ROOT has_province_modifier = blorc_plunder_camp } is_city = yes is_core = ROOT }
		set_province_flag = option_repair_3_@ROOT
		set_province_flag = repair_@ROOT
		save_event_target_as = repair3
		setup_restoration_speed = yes
	}
	random_owned_province = {
		limit = { OR = { has_province_modifier = ruined_hold has_province_modifier = partially_ruined_hold has_province_modifier = damaged_hold } NOT = { has_construction = building has_construction = missionary has_construction = colonist has_construction = culture has_construction = great_project has_province_flag = repair_@ROOT has_province_modifier = blorc_plunder_camp } is_city = yes is_core = ROOT }
		set_province_flag = option_repair_4_@ROOT
		set_province_flag = repair_@ROOT
		save_event_target_as = repair4
		setup_restoration_speed = yes
	}
	random_owned_province = {
		limit = { OR = { has_province_modifier = ruined_hold has_province_modifier = partially_ruined_hold has_province_modifier = damaged_hold } NOT = { has_construction = building has_construction = missionary has_construction = colonist has_construction = culture has_construction = great_project has_province_flag = repair_@ROOT has_province_modifier = blorc_plunder_camp } is_city = yes is_core = ROOT }
		set_province_flag = option_repair_5_@ROOT
		set_province_flag = repair_@ROOT
		save_event_target_as = repair5
		setup_restoration_speed = yes
	}
	random_owned_province = {
		limit = { OR = { has_province_modifier = ruined_hold has_province_modifier = partially_ruined_hold has_province_modifier = damaged_hold } NOT = { has_construction = building has_construction = missionary has_construction = colonist has_construction = culture has_construction = great_project has_province_flag = repair_@ROOT has_province_modifier = blorc_plunder_camp } is_city = yes is_core = ROOT }
		set_province_flag = option_repair_6_@ROOT
		set_province_flag = repair_@ROOT
		save_event_target_as = repair6
		setup_restoration_speed = yes
	}
}

setup_restoration_speed = {
	hidden_effect = {
		set_variable = { globalCost = 0 }
		set_variable = { globalTime = 0 }
		set_variable = { localCost = 0 }
		set_variable = { localTime = 0 }
		set_variable = { testCost = 0 }
		set_variable = { testTime = 0 }
		set_variable = { Cost = 0 }
		set_variable = { Time = 0 }
		trigger_switch = {
			on_trigger = development
			
			100 = { set_variable = { speed = 35 } }
			97 = { set_variable = { speed = 34 } }
			94 = { set_variable = { speed = 33 } }
			91 = { set_variable = { speed = 32 } }
			88 = { set_variable = { speed = 31 } }
			85 = { set_variable = { speed = 30 } }
			82 = { set_variable = { speed = 29 } }
			79 = { set_variable = { speed = 28 } }
			76 = { set_variable = { speed = 27 } }
			73 = { set_variable = { speed = 26 } }
			70 = { set_variable = { speed = 25 } }
			67 = { set_variable = { speed = 24 } }
			64 = { set_variable = { speed = 23 } }
			61 = { set_variable = { speed = 22 } }
			58 = { set_variable = { speed = 21 } }
			55 = { set_variable = { speed = 20 } }
			52 = { set_variable = { speed = 19 } }
			49 = { set_variable = { speed = 18 } }
			46 = { set_variable = { speed = 17 } }
			43 = { set_variable = { speed = 16 } }
			40 = { set_variable = { speed = 15 } }
			37 = { set_variable = { speed = 14 } }
			34 = { set_variable = { speed = 13 } }
			31 = { set_variable = { speed = 12 } }
			28 = { set_variable = { speed = 11 } }
			25 = { set_variable = { speed = 10 } }
			22 = { set_variable = { speed = 9 } }
			19 = { set_variable = { speed = 8 } }
			16 = { set_variable = { speed = 7 } }
			13 = { set_variable = { speed = 6 } }
			10 = { set_variable = { speed = 5 } }
			7 = { set_variable = { speed = 4 } }
			4 = { set_variable = { speed = 3 } }
			3 = { set_variable = { speed = 2 } }
		}
		if = {
			limit = { has_coexisting_dwarven_pop_trigger = yes }
			multiply_variable = { speed = 0.9 }
		}
		if = {
			limit = { has_integrated_dwarven_pop_trigger = yes }
			multiply_variable = { speed = 0.8 }
		}
		if = {
			limit = { is_capital = yes }
			multiply_variable = { speed = 0.5 }
		}
		if = {
			limit = { owner = { NOT = { num_of_cities = 2 } } }
			multiply_variable = { speed = 0.2 }
		}
		if = {
			limit = { has_province_modifier = ruined_hold }
			multiply_variable = { speed = 1.2 }
		}
		if = {
			limit = { has_province_modifier = partially_ruined_hold }
			multiply_variable = { speed = 0.9 }
		}
		if = {
			limit = { has_province_modifier = damaged_hold }
			multiply_variable = { speed = 0.8 }
		}
		if = {
			limit = { owner = { has_country_modifier = how_to_dig } }
			multiply_variable = { speed = 0.95 }
		}
		if = {
			limit = { owner = { has_country_flag = remnant_dig } }
			multiply_variable = { speed = 0.95 }
		}
		if = {
			limit = { owner = { NOT = { has_country_modifier = dwarven_administration } } }
			multiply_variable = { speed = 1.5 }
		}
		if = {
			limit = { owner = { has_age_ability = ab_dwarven_reclamation } }
			multiply_variable = { speed = 0.8 }
		}
	}
	if = {
		limit = { check_variable = { speed = 30 } }
		set_variable = { speed = 30 }
	}
	if = {
		limit = { NOT = { check_variable = { speed = 5 } } }
		set_variable = { speed = 5 }
	}
	multiply_variable = { speed = 0.001 }
	multiply_variable = { speed = 1000 }#Final Cost in Ducats
	export_to_variable = {
		which = globalCost
		value = modifier:build_cost
		who = PREV
	}
	export_to_variable = {
		which = globalTime
		value = modifier:build_time
		who = PREV
	}
	export_to_variable = {
		which = localCost
		value = modifier:local_build_cost
	}
	export_to_variable = {
		which = localTime
		value = modifier:local_build_time
	}
	change_variable = {
		which = localCost
		which = globalCost
	}
	change_variable = {
		which = localTime
		which = globalTime
	}

	#cap time to -90%
	if = {
		limit = { NOT = { check_variable = { localTime = -0.910 } } }
		set_variable = { localTime = -0.900 }
	}
	
	change_variable = { Cost = 1 }
	change_variable = { Time = 1 }
	change_variable = { which = Cost which = localCost }
	change_variable = { which = Time which = localTime }
	
	set_variable = { which = finalCost which = speed }
	multiply_variable = { which = finalCost which = finalCost }
	divide_variable = { finalCost = 10 }
	divide_variable = { finalCost = 2 }
	multiply_variable = { finalCost = 100 } #speed?/10/2x100
	multiply_variable = { which = finalCost which = Cost }
	multiply_variable = { finalCost = 0.001 }
	multiply_variable = { finalCost = 1000 }#Final Cost in Ducats
	
	set_variable = { which = finalTime which = speed }
	multiply_variable = { which = finalTime which = Time } #Final Time in Years
}

repair_hold = {
	# custom_tooltip = see_speed_value
	hidden_effect = { cancel_construction = yes }
	if = {
		limit = { has_province_modifier = ruined_hold }
		trigger_switch = {
			on_trigger = development
			
			100 = { owner = { add_mil_power = -500 add_dip_power = -500 add_adm_power = -500 } }
			90 = { owner = { add_mil_power = -450 add_dip_power = -450 add_adm_power = -450 } }
			80 = { owner = { add_mil_power = -400 add_dip_power = -400 add_adm_power = -400 } }
			70 = { owner = { add_mil_power = -350 add_dip_power = -350 add_adm_power = -350 } }
			60 = { owner = { add_mil_power = -300 add_dip_power = -300 add_adm_power = -300 } }
			50 = { owner = { add_mil_power = -250 add_dip_power = -250 add_adm_power = -250 } }
			40 = { owner = { add_mil_power = -200 add_dip_power = -200 add_adm_power = -200 } }
			30 = { owner = { add_mil_power = -150 add_dip_power = -150 add_adm_power = -150 } }
			20 = { owner = { add_mil_power = -100 add_dip_power = -100 add_adm_power = -100 } }
			10 = { owner = { add_mil_power = -50 add_dip_power = -50 add_adm_power = -50 } }
			3 = { owner = { add_mil_power = -50 add_dip_power = -50 add_adm_power = -50 } }
		}
	}
	else_if = {
		limit = { has_province_modifier = partially_ruined_hold }
		trigger_switch = {
			on_trigger = development
			
			100 = { owner = { add_mil_power = -400 add_dip_power = -400 add_adm_power = -400 } }
			90 = { owner = { add_mil_power = -350 add_dip_power = -350 add_adm_power = -350 } }
			80 = { owner = { add_mil_power = -325 add_dip_power = -325 add_adm_power = -325 } }
			70 = { owner = { add_mil_power = -300 add_dip_power = -300 add_adm_power = -300 } }
			60 = { owner = { add_mil_power = -250 add_dip_power = -250 add_adm_power = -250 } }
			50 = { owner = { add_mil_power = -200 add_dip_power = -200 add_adm_power = -200 } }
			40 = { owner = { add_mil_power = -175 add_dip_power = -175 add_adm_power = -175 } }
			30 = { owner = { add_mil_power = -150 add_dip_power = -150 add_adm_power = -150 } }
			20 = { owner = { add_mil_power = -100 add_dip_power = -100 add_adm_power = -100 } }
			10 = { owner = { add_mil_power = -50 add_dip_power = -50 add_adm_power = -50 } }
			3 = { owner = { add_mil_power = -50 add_dip_power = -50 add_adm_power = -50 } }
		}
	}
	else_if = {
		limit = { has_province_modifier = damaged_hold }
		trigger_switch = {
			on_trigger = development
			
			100 = { owner = { add_mil_power = -300 add_dip_power = -300 add_adm_power = -300 } }
			90 = { owner = { add_mil_power = -275 add_dip_power = -275 add_adm_power = -275 } }
			80 = { owner = { add_mil_power = -250 add_dip_power = -250 add_adm_power = -250 } }
			70 = { owner = { add_mil_power = -225 add_dip_power = -225 add_adm_power = -225 } }
			60 = { owner = { add_mil_power = -175 add_dip_power = -175 add_adm_power = -175 } }
			50 = { owner = { add_mil_power = -125 add_dip_power = -125 add_adm_power = -125 } }
			40 = { owner = { add_mil_power = -100 add_dip_power = -100 add_adm_power = -100 } }
			30 = { owner = { add_mil_power = -75 add_dip_power = -75 add_adm_power = -75 } }
			20 = { owner = { add_mil_power = -50 add_dip_power = -50 add_adm_power = -50 } }
			10 = { owner = { add_mil_power = -50 add_dip_power = -50 add_adm_power = -50 } }
			3 = { owner = { add_mil_power = -50 add_dip_power = -50 add_adm_power = -50 } }
		}
	}
	# custom_tooltip = see_speed_value
	custom_tooltip = cost_hold_restoration_tooltip
	hidden_effect = {
		cap_digging_speed = yes
		if = { limit = { check_variable = { speed = 35 } } add_building_construction = { building = restoring_hold speed = 35 cost = 6125 } }
		else_if = { limit = { check_variable = { speed = 34 } } add_building_construction = { building = restoring_hold speed = 34 cost = 5780 } }
		else_if = { limit = { check_variable = { speed = 33 } } add_building_construction = { building = restoring_hold speed = 33 cost = 5445 } }
		else_if = { limit = { check_variable = { speed = 32 } } add_building_construction = { building = restoring_hold speed = 32 cost = 5120 } }
		else_if = { limit = { check_variable = { speed = 31 } } add_building_construction = { building = restoring_hold speed = 31 cost = 4805 } }
		else_if = { limit = { check_variable = { speed = 30 } } add_building_construction = { building = restoring_hold speed = 30 cost = 4500 } }
		else_if = { limit = { check_variable = { speed = 29 } } add_building_construction = { building = restoring_hold speed = 29 cost = 4205 } }
		else_if = { limit = { check_variable = { speed = 28 } } add_building_construction = { building = restoring_hold speed = 28 cost = 3920 } }
		else_if = { limit = { check_variable = { speed = 27 } } add_building_construction = { building = restoring_hold speed = 27 cost = 3645 } }
		else_if = { limit = { check_variable = { speed = 26 } } add_building_construction = { building = restoring_hold speed = 26 cost = 3380 } }
		else_if = { limit = { check_variable = { speed = 25 } } add_building_construction = { building = restoring_hold speed = 25 cost = 3125 } }
		else_if = { limit = { check_variable = { speed = 24 } } add_building_construction = { building = restoring_hold speed = 24 cost = 2880 } }
		else_if = { limit = { check_variable = { speed = 23 } } add_building_construction = { building = restoring_hold speed = 23 cost = 2645 } }
		else_if = { limit = { check_variable = { speed = 22 } } add_building_construction = { building = restoring_hold speed = 22 cost = 2420 } }
		else_if = { limit = { check_variable = { speed = 21 } } add_building_construction = { building = restoring_hold speed = 21 cost = 2205 } }
		else_if = { limit = { check_variable = { speed = 20 } } add_building_construction = { building = restoring_hold speed = 20 cost = 2000 } }
		else_if = { limit = { check_variable = { speed = 19 } } add_building_construction = { building = restoring_hold speed = 19 cost = 1805 } }
		else_if = { limit = { check_variable = { speed = 18 } } add_building_construction = { building = restoring_hold speed = 18 cost = 1620 } }
		else_if = { limit = { check_variable = { speed = 17 } } add_building_construction = { building = restoring_hold speed = 17 cost = 1445 } }
		else_if = { limit = { check_variable = { speed = 16 } } add_building_construction = { building = restoring_hold speed = 16 cost = 1280 } }
		else_if = { limit = { check_variable = { speed = 15 } } add_building_construction = { building = restoring_hold speed = 15 cost = 1125 } }
		else_if = { limit = { check_variable = { speed = 14 } } add_building_construction = { building = restoring_hold speed = 14 cost = 980 } }
		else_if = { limit = { check_variable = { speed = 13 } } add_building_construction = { building = restoring_hold speed = 13 cost = 845 } }
		else_if = { limit = { check_variable = { speed = 12 } } add_building_construction = { building = restoring_hold speed = 12 cost = 720 } }
		else_if = { limit = { check_variable = { speed = 11 } } add_building_construction = { building = restoring_hold speed = 11 cost = 605 } }
		else_if = { limit = { check_variable = { speed = 10 } } add_building_construction = { building = restoring_hold speed = 10 cost = 500 } }
		else_if = { limit = { check_variable = { speed = 9 } } add_building_construction = { building = restoring_hold speed = 9 cost = 405 } }
		else_if = { limit = { check_variable = { speed = 8 } } add_building_construction = { building = restoring_hold speed = 8 cost = 320 } }
		else_if = { limit = { check_variable = { speed = 7 } } add_building_construction = { building = restoring_hold speed = 7 cost = 245 } }
		else_if = { limit = { check_variable = { speed = 6 } } add_building_construction = { building = restoring_hold speed = 6 cost = 180 } }
		else = { limit = { check_variable = { speed = 5 } } add_building_construction = { building = restoring_hold speed = 5 cost = 125 } }
		uncap_digging_speed = yes
		set_province_flag = being_restored
	}
}

repair_hold_ai = { #They're so dumb it's insane
	set_province_flag = being_restored
	cancel_construction = yes
	trigger_switch = {
		on_trigger = development
		
		120 = { add_building_construction = { building = restoring_hold speed = 23 cost = 500 } }
		115 = { add_building_construction = { building = restoring_hold speed = 22 cost = 400 } }
		110 = { add_building_construction = { building = restoring_hold speed = 21 cost = 400 } }
		105 = { add_building_construction = { building = restoring_hold speed = 20 cost = 400 } }
		100 = { add_building_construction = { building = restoring_hold speed = 19 cost = 400 } }
		95 = { add_building_construction = { building = restoring_hold speed = 18 cost = 400 } }
		90 = { add_building_construction = { building = restoring_hold speed = 17 cost = 300 } }
		85 = { add_building_construction = { building = restoring_hold speed = 16 cost = 300 } }
		80 = { add_building_construction = { building = restoring_hold speed = 15 cost = 300 } }
		75 = { add_building_construction = { building = restoring_hold speed = 14 cost = 300 } }
		70 = { add_building_construction = { building = restoring_hold speed = 13 cost = 300 } }
		65 = { add_building_construction = { building = restoring_hold speed = 12 cost = 200 } }
		60 = { add_building_construction = { building = restoring_hold speed = 11 cost = 200 } }
		55 = { add_building_construction = { building = restoring_hold speed = 10 cost = 200 } }
		50 = { add_building_construction = { building = restoring_hold speed = 9 cost = 200 } }
		45 = { add_building_construction = { building = restoring_hold speed = 8 cost = 200 } }
		40 = { add_building_construction = { building = restoring_hold speed = 7 cost = 100 } }
		35 = { add_building_construction = { building = restoring_hold speed = 6 cost = 100 } }
		20 = { add_building_construction = { building = restoring_hold speed = 5 cost = 100 } }
		15 = { add_building_construction = { building = restoring_hold speed = 4 cost = 100 } }
		10 = { add_building_construction = { building = restoring_hold speed = 3 cost = 100 } }
		3 = { add_building_construction = { building = restoring_hold speed = 2 cost = 100 } }
		1 = { add_building_construction = { building = restoring_hold speed = 1 cost = 100 } }
	}
}

restored_hold = {
	remove_province_modifier = damaged_hold
	remove_province_modifier = partially_ruined_hold
	hidden_effect = { clr_province_flag = being_restored }
	if = {
		limit = { has_province_modifier = ruined_hold }
		trigger_switch = {
			on_trigger = development
			100 = { add_permanent_province_modifier = { name = dig_8 duration = -1 } }
			90 = { add_permanent_province_modifier = { name = dig_7 duration = -1 } }
			80 = { add_permanent_province_modifier = { name = dig_6 duration = -1 } }
			70 = { add_permanent_province_modifier = { name = dig_5 duration = -1 } }
			60 = { add_permanent_province_modifier = { name = dig_4 duration = -1 } }
			50 = { add_permanent_province_modifier = { name = dig_3 duration = -1 } }
			40 = { add_permanent_province_modifier = { name = dig_2 duration = -1 } }
			3 = { add_permanent_province_modifier = { name = dig_1 duration = -1 } }
		}
		remove_province_modifier = ruined_hold
	}
}

define_hold_to_clear = {
	random_owned_province = {
		limit = { has_province_modifier = infested_hold is_city = yes NOT = { has_province_flag = infested_@ROOT } }
		set_province_flag = option_infested_1_@ROOT
		set_province_flag = infested_@ROOT
		save_event_target_as = infested1
	}
	random_owned_province = {
		limit = { has_province_modifier = infested_hold is_city = yes NOT = { has_province_flag = infested_@ROOT } }
		set_province_flag = option_infested_2_@ROOT
		set_province_flag = infested_@ROOT
		save_event_target_as = infested2
	}
	random_owned_province = {
		limit = { has_province_modifier = infested_hold is_city = yes NOT = { has_province_flag = infested_@ROOT } }
		set_province_flag = option_infested_3_@ROOT
		set_province_flag = infested_@ROOT
		save_event_target_as = infested3
	}
	random_owned_province = {
		limit = { has_province_modifier = infested_hold is_city = yes NOT = { has_province_flag = infested_@ROOT } }
		set_province_flag = option_infested_4_@ROOT
		set_province_flag = infested_@ROOT
		save_event_target_as = infested4
	}
}

infested_hold_clearing = {
	trigger_switch = {
		on_trigger = development
		
		35 = { spawn_rebels = { type = cave_orc_rebel culture = black_orc size = 1 } spawn_rebels = { type = cave_orc_rebel culture = black_orc size = 1 } spawn_rebels = { type = cave_orc_rebel culture = black_orc size = 1 } }
		20 = { spawn_rebels = { type = cave_orc_rebel culture = black_orc size = 1 } spawn_rebels = { type = cave_orc_rebel culture = black_orc size = 1 } }
		3 = { spawn_rebels = { type = cave_orc_rebel culture = black_orc size = 1 } }
	}
	remove_province_modifier = infested_hold
	add_permanent_province_modifier = {
		name = ruined_hold
		duration = -1
	}
	hidden_effect = {
		owner = {
			every_owned_province = {
				limit = { has_province_flag = infested_@ROOT }
				clr_province_flag = infested_@ROOT
				clr_province_flag = option_infested_1_@ROOT
				clr_province_flag = option_infested_2_@ROOT
				clr_province_flag = option_infested_3_@ROOT
				clr_province_flag = option_infested_4_@ROOT
			}
			clr_country_flag = open_infested_hold_menu
		}
	}
}
setup_digging_deeper_capital = {
	hidden_effect = {
		# trigger_switch = {
			# on_trigger = has_province_modifier
			
			# dig_1 = { set_variable = { speed = 10 } }
			# dig_2 = { set_variable = { speed = 20 } }
			# dig_3 = { set_variable = { speed = 25 } }
			# dig_4 = { set_variable = { speed = 30 } }
			# dig_5 = { set_variable = { speed = 35 } }
			# dig_6 = { set_variable = { speed = 40 } }
			# dig_7 = { set_variable = { speed = 45 } }
			# dig_8 = { set_variable = { speed = 50 } }
			# dig_9 = { set_variable = { speed = 55 } }
			# dig_10 = { set_variable = { speed = 60 } }
		# }
		if = {
			limit = { has_province_modifier = dig_1 }
			set_variable = { speed = 10 }
		}
		else_if = {
			limit = { has_province_modifier = dig_2 }
			set_variable = { speed = 20 }
		}
		else_if = {
			limit = { has_province_modifier = dig_3 }
			set_variable = { speed = 25 }
		}
		else_if = {
			limit = { has_province_modifier = dig_4 }
			set_variable = { speed = 30 }
		}
		else_if = {
			limit = { has_province_modifier = dig_5 }
			set_variable = { speed = 35 }
		}
		else_if = {
			limit = { has_province_modifier = dig_6 }
			set_variable = { speed = 40 }
		}
		else_if = {
			limit = { has_province_modifier = dig_7 }
			set_variable = { speed = 45 }
		}
		else_if = {
			limit = { has_province_modifier = dig_8 }
			set_variable = { speed = 50 }
		}
		else_if = {
			limit = { has_province_modifier = dig_9 }
			set_variable = { speed = 55 }
		}
		else_if = {
			limit = { has_province_modifier = dig_10 }
			set_variable = { speed = 60 }
		}
		set_variable = { globalCost = 0 }
		set_variable = { globalTime = 0 }
		set_variable = { localCost = 0 }
		set_variable = { localTime = 0 }
		set_variable = { testCost = 0 }
		set_variable = { testTime = 0 }
		set_variable = { Cost = 0 }
		set_variable = { Time = 0 }

		if = {
			limit = { has_province_modifier = easy_rock }
			multiply_variable = { speed = 0.8 }
		}
		
		if = {
			limit = { has_terrain = dwarven_hold continent = serpentspine }
			multiply_variable = { speed = 0.8 }
		}
		if = {
			limit = { province_id = 4119 }
			multiply_variable = { speed = 0.9 }
		}
		if = {
			limit = { province_id = 4311 }
			multiply_variable = { speed = 0.95 }
		}
		if = {
			limit = { owner = { has_country_flag = dig_through } }
			multiply_variable = { speed = 0.8 }
		}
		if = {
			limit = { owner = { has_country_flag = remnant_dig } }
			multiply_variable = { speed = 0.9 }
		}
		if = {
			limit = { owner = { has_country_flag = not_dig_through } }
			multiply_variable = { speed = 1.2 }
		}
		if = {
			limit = { owner = { has_country_modifier = how_to_dig } }
			multiply_variable = { speed = 0.9 }
		}
		if = {
			limit = { owner = { has_country_modifier = dadv_digging_expert } }
			multiply_variable = { speed = 0.9 }
		}
		if = {
			limit = { owner = { NOT = { has_country_modifier = dwarven_administration } } }
			multiply_variable = { speed = 1.5 }
		}
		if = {
			limit = { owner = { has_age_ability = ab_dwarven_reclamation } }
			multiply_variable = { speed = 0.8 }
		}
		if = {
			limit = { check_variable = { speed = 80 } }
			set_variable = { speed = 80 }
		}
		if = {
			limit = { NOT = { check_variable = { speed = 10 } } }
			set_variable = { speed = 10 }
		}
		multiply_variable = { speed = 0.001 }
		multiply_variable = { speed = 1000 }#Final Cost in Ducats
		export_to_variable = {
			which = globalCost
			value = modifier:build_cost
			who = PREV
		}
		export_to_variable = {
			which = globalTime
			value = modifier:build_time
			who = PREV
		}
		export_to_variable = {
			which = localCost
			value = modifier:local_build_cost
		}
		export_to_variable = {
			which = localTime
			value = modifier:local_build_time
		}
		change_variable = {
			which = localCost
			which = globalCost
		}
		change_variable = {
			which = localTime
			which = globalTime
		}

		#cap time to -90%
		if = {
			limit = { NOT = { check_variable = { localTime = -0.910 } } }
			set_variable = { localTime = -0.900 }
		}
		
		change_variable = { Cost = 1 }
		change_variable = { Time = 1 }
		change_variable = { which = Cost which = localCost }
		change_variable = { which = Time which = localTime }
		
		set_variable = { which = finalCost which = speed }
		multiply_variable = { which = finalCost which = finalCost }
		multiply_variable = { which = finalCost which = Cost }
		multiply_variable = { finalCost = 0.001 }
		multiply_variable = { finalCost = 1000 }#Final Cost in Ducats
		
		set_variable = { which = finalTime which = speed }
		multiply_variable = { which = finalTime which = Time } #Final Time in Years
	}
}

binary_ad1 = {
	if = {
		limit = {
			check_variable = {
				which = $variable$
				value = $value$
			}
		}
		owner = {
			add_treasury = -$value$
		}
		
		subtract_variable = {
			which = $variable$
			value = $value$
		}
	}
}

dig_rebate = { #reddit.com/r/eu4/comments/dy7lyv
	set_variable = {
		which = temp
		which = finalCost
	}
	divide_variable = {
		temp = 2
	}
	
	binary_ad1 = { variable = temp	value = 4096 }
	binary_ad1 = { variable = temp	value = 2048 }
	binary_ad1 = { variable = temp	value = 1024 }
	binary_ad1 = { variable = temp	value = 512	 }
	binary_ad1 = { variable = temp	value = 256	 }
	binary_ad1 = { variable = temp	value = 128	 }
	binary_ad1 = { variable = temp	value = 64	 }
	binary_ad1 = { variable = temp	value = 32	 }
	binary_ad1 = { variable = temp	value = 16	 }
	binary_ad1 = { variable = temp	value = 8	 }
	binary_ad1 = { variable = temp	value = 4	 }
	binary_ad1 = { variable = temp	value = 2	 }
	binary_ad1 = { variable = temp	value = 1	 }
}

cap_digging_speed = { #caps the speed to -90% local build time
	if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -2 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.95 } } }
		add_province_modifier = { name = digging_speedcap_100 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_10 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.95 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.90 } } }
		add_province_modifier = { name = digging_speedcap_100 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_5 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.90 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.85 } } }
		add_province_modifier = { name = digging_speedcap_100 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.85 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.80 } } }
		add_province_modifier = { name = digging_speedcap_50 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_40 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_5 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.80 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.75 } } }
		add_province_modifier = { name = digging_speedcap_50 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_40 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.75 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.70 } } }
		add_province_modifier = { name = digging_speedcap_40 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_40 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_5 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.70 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.65 } } }
		add_province_modifier = { name = digging_speedcap_40 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_40 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.65 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.60 } } }
		add_province_modifier = { name = digging_speedcap_40 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_30 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_5 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.60 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.55 } } }
		add_province_modifier = { name = digging_speedcap_40 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_30 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.55 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.50 } } }
		add_province_modifier = { name = digging_speedcap_40 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_20 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_5 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.50 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.45 } } }
		add_province_modifier = { name = digging_speedcap_40 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_20 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.45 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.40 } } }
		add_province_modifier = { name = digging_speedcap_50 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_5 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.40 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.35 } } }
		add_province_modifier = { name = digging_speedcap_50 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.35 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.30 } } }
		add_province_modifier = { name = digging_speedcap_40 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_5 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.30 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.25 } } }
		add_province_modifier = { name = digging_speedcap_40 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.25 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.20 } } }
		add_province_modifier = { name = digging_speedcap_30 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_5 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.20 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.15 } } }
		add_province_modifier = { name = digging_speedcap_30 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.15 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.1 } } }
		add_province_modifier = { name = digging_speedcap_20 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_5 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.10 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.05 } } }
		add_province_modifier = { name = digging_speedcap_20 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.05 } NOT = { has_local_modifier_value = { which = local_build_time value = -1.00 } } }
		add_province_modifier = { name = digging_speedcap_10 duration = 1 hidden = yes } add_province_modifier = { name = digging_speedcap_5 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -1.00 } NOT = { has_local_modifier_value = { which = local_build_time value = -0.95 } } }
		add_province_modifier = { name = digging_speedcap_10 duration = 1 hidden = yes }
	}
	else_if = {
		limit = { has_local_modifier_value = { which = local_build_time value = -0.95 } NOT = { has_local_modifier_value = { which = local_build_time value = -0.90 } } }
		add_province_modifier = { name = digging_speedcap_5 duration = 1 hidden = yes }
	}
}
uncap_digging_speed = {
	remove_province_modifier = digging_speedcap_5
	remove_province_modifier = digging_speedcap_10
	remove_province_modifier = digging_speedcap_20
	remove_province_modifier = digging_speedcap_30
	remove_province_modifier = digging_speedcap_40
	remove_province_modifier = digging_speedcap_50
	remove_province_modifier = digging_speedcap_100
}

start_digging_deeper = {
	hidden_effect = { cancel_construction = yes cap_digging_speed = yes }
	custom_tooltip = cost_capital_dig_tooltip
	hidden_effect = {
			 if = { limit = { check_variable = { speed =	80	} } add_building_construction = { building = digging_deeper speed =	160	cost =	6400	} }
		else_if = { limit = { check_variable = { speed =	79	} } add_building_construction = { building = digging_deeper speed =	158	cost =	6241	} }
		else_if = { limit = { check_variable = { speed =	78	} } add_building_construction = { building = digging_deeper speed =	156	cost =	6084	} }
		else_if = { limit = { check_variable = { speed =	77	} } add_building_construction = { building = digging_deeper speed =	154	cost =	5929	} }
		else_if = { limit = { check_variable = { speed =	76	} } add_building_construction = { building = digging_deeper speed =	152	cost =	5776	} }
		else_if = { limit = { check_variable = { speed =	75	} } add_building_construction = { building = digging_deeper speed =	150	cost =	5625	} }
		else_if = { limit = { check_variable = { speed =	74	} } add_building_construction = { building = digging_deeper speed =	148	cost =	5476	} }
		else_if = { limit = { check_variable = { speed =	73	} } add_building_construction = { building = digging_deeper speed =	146	cost =	5329	} }
		else_if = { limit = { check_variable = { speed =	72	} } add_building_construction = { building = digging_deeper speed =	144	cost =	5184	} }
		else_if = { limit = { check_variable = { speed =	71	} } add_building_construction = { building = digging_deeper speed =	142	cost =	5041	} }
		else_if = { limit = { check_variable = { speed =	70	} } add_building_construction = { building = digging_deeper speed =	140	cost =	4900	} }
		else_if = { limit = { check_variable = { speed =	69	} } add_building_construction = { building = digging_deeper speed =	138	cost =	4761	} }
		else_if = { limit = { check_variable = { speed =	68	} } add_building_construction = { building = digging_deeper speed =	136	cost =	4624	} }
		else_if = { limit = { check_variable = { speed =	67	} } add_building_construction = { building = digging_deeper speed =	134	cost =	4489	} }
		else_if = { limit = { check_variable = { speed =	66	} } add_building_construction = { building = digging_deeper speed =	132	cost =	4356	} }
		else_if = { limit = { check_variable = { speed =	65	} } add_building_construction = { building = digging_deeper speed =	130	cost =	4225	} }
		else_if = { limit = { check_variable = { speed =	64	} } add_building_construction = { building = digging_deeper speed =	128	cost =	4096	} }
		else_if = { limit = { check_variable = { speed =	63	} } add_building_construction = { building = digging_deeper speed =	126	cost =	3969	} }
		else_if = { limit = { check_variable = { speed =	62	} } add_building_construction = { building = digging_deeper speed =	124	cost =	3844	} }
		else_if = { limit = { check_variable = { speed =	61	} } add_building_construction = { building = digging_deeper speed =	122	cost =	3721	} }
		else_if = { limit = { check_variable = { speed =	60	} } add_building_construction = { building = digging_deeper speed =	120	cost =	3600	} }
		else_if = { limit = { check_variable = { speed =	59	} } add_building_construction = { building = digging_deeper speed =	118	cost =	3481	} }
		else_if = { limit = { check_variable = { speed =	58	} } add_building_construction = { building = digging_deeper speed =	116	cost =	3364	} }
		else_if = { limit = { check_variable = { speed =	57	} } add_building_construction = { building = digging_deeper speed =	114	cost =	3249	} }
		else_if = { limit = { check_variable = { speed =	56	} } add_building_construction = { building = digging_deeper speed =	112	cost =	3136	} }
		else_if = { limit = { check_variable = { speed =	55	} } add_building_construction = { building = digging_deeper speed =	110	cost =	3025	} }
		else_if = { limit = { check_variable = { speed =	54	} } add_building_construction = { building = digging_deeper speed =	108	cost =	2916	} }
		else_if = { limit = { check_variable = { speed =	53	} } add_building_construction = { building = digging_deeper speed =	106	cost =	2809	} }
		else_if = { limit = { check_variable = { speed =	52	} } add_building_construction = { building = digging_deeper speed =	104	cost =	2704	} }
		else_if = { limit = { check_variable = { speed =	51	} } add_building_construction = { building = digging_deeper speed =	102	cost =	2601	} }
		else_if = { limit = { check_variable = { speed =	50	} } add_building_construction = { building = digging_deeper speed =	100	cost =	2500	} }
		else_if = { limit = { check_variable = { speed =	49	} } add_building_construction = { building = digging_deeper speed =	98	cost =	2401	} }
		else_if = { limit = { check_variable = { speed =	48	} } add_building_construction = { building = digging_deeper speed =	96	cost =	2304	} }
		else_if = { limit = { check_variable = { speed =	47	} } add_building_construction = { building = digging_deeper speed =	94	cost =	2209	} }
		else_if = { limit = { check_variable = { speed =	46	} } add_building_construction = { building = digging_deeper speed =	92	cost =	2116	} }
		else_if = { limit = { check_variable = { speed =	45	} } add_building_construction = { building = digging_deeper speed =	90	cost =	2025	} }
		else_if = { limit = { check_variable = { speed =	44	} } add_building_construction = { building = digging_deeper speed =	88	cost =	1936	} }
		else_if = { limit = { check_variable = { speed =	43	} } add_building_construction = { building = digging_deeper speed =	86	cost =	1849	} }
		else_if = { limit = { check_variable = { speed =	42	} } add_building_construction = { building = digging_deeper speed =	84	cost =	1764	} }
		else_if = { limit = { check_variable = { speed =	41	} } add_building_construction = { building = digging_deeper speed =	82	cost =	1681	} }
		else_if = { limit = { check_variable = { speed =	40	} } add_building_construction = { building = digging_deeper speed =	80	cost =	1600	} }
		else_if = { limit = { check_variable = { speed =	39	} } add_building_construction = { building = digging_deeper speed =	78	cost =	1521	} }
		else_if = { limit = { check_variable = { speed =	38	} } add_building_construction = { building = digging_deeper speed =	76	cost =	1444	} }
		else_if = { limit = { check_variable = { speed =	37	} } add_building_construction = { building = digging_deeper speed =	74	cost =	1369	} }
		else_if = { limit = { check_variable = { speed =	36	} } add_building_construction = { building = digging_deeper speed =	72	cost =	1296	} }
		else_if = { limit = { check_variable = { speed =	35	} } add_building_construction = { building = digging_deeper speed =	70	cost =	1225	} }
		else_if = { limit = { check_variable = { speed =	34	} } add_building_construction = { building = digging_deeper speed =	68	cost =	1156	} }
		else_if = { limit = { check_variable = { speed =	33	} } add_building_construction = { building = digging_deeper speed =	66	cost =	1089	} }
		else_if = { limit = { check_variable = { speed =	32	} } add_building_construction = { building = digging_deeper speed =	64	cost =	1024	} }
		else_if = { limit = { check_variable = { speed =	31	} } add_building_construction = { building = digging_deeper speed =	62	cost =	961 	} }
		else_if = { limit = { check_variable = { speed =	30	} } add_building_construction = { building = digging_deeper speed =	60	cost =	900 	} }
		else_if = { limit = { check_variable = { speed =	29	} } add_building_construction = { building = digging_deeper speed =	58	cost =	841 	} }
		else_if = { limit = { check_variable = { speed =	28	} } add_building_construction = { building = digging_deeper speed =	56	cost =	784 	} }
		else_if = { limit = { check_variable = { speed =	27	} } add_building_construction = { building = digging_deeper speed =	54	cost =	729 	} }
		else_if = { limit = { check_variable = { speed =	26	} } add_building_construction = { building = digging_deeper speed =	52	cost =	676 	} }
		else_if = { limit = { check_variable = { speed =	25	} } add_building_construction = { building = digging_deeper speed =	50	cost =	625 	} }
		else_if = { limit = { check_variable = { speed =	24	} } add_building_construction = { building = digging_deeper speed =	48	cost =	576 	} }
		else_if = { limit = { check_variable = { speed =	23	} } add_building_construction = { building = digging_deeper speed =	46	cost =	529 	} }
		else_if = { limit = { check_variable = { speed =	22	} } add_building_construction = { building = digging_deeper speed =	44	cost =	484 	} }
		else_if = { limit = { check_variable = { speed =	21	} } add_building_construction = { building = digging_deeper speed =	42	cost =	441 	} }
		else_if = { limit = { check_variable = { speed =	20	} } add_building_construction = { building = digging_deeper speed =	40	cost =	400 	} }
		else_if = { limit = { check_variable = { speed =	19	} } add_building_construction = { building = digging_deeper speed =	38	cost =	361 	} }
		else_if = { limit = { check_variable = { speed =	18	} } add_building_construction = { building = digging_deeper speed =	36	cost =	324 	} }
		else_if = { limit = { check_variable = { speed =	17	} } add_building_construction = { building = digging_deeper speed =	34	cost =	289 	} }
		else_if = { limit = { check_variable = { speed =	16	} } add_building_construction = { building = digging_deeper speed =	32	cost =	256 	} }
		else_if = { limit = { check_variable = { speed =	15	} } add_building_construction = { building = digging_deeper speed =	30	cost =	225 	} }
		else_if = { limit = { check_variable = { speed =	14	} } add_building_construction = { building = digging_deeper speed =	28	cost =	196 	} }
		else_if = { limit = { check_variable = { speed =	13	} } add_building_construction = { building = digging_deeper speed =	26	cost =	169 	} }
		else_if = { limit = { check_variable = { speed =	12	} } add_building_construction = { building = digging_deeper speed =	24	cost =	144 	} }
		else_if = { limit = { check_variable = { speed =	11	} } add_building_construction = { building = digging_deeper speed =	22	cost =	121 	} }
		else	= {													add_building_construction = { building = digging_deeper speed =	20	cost =	100 	} }
		uncap_digging_speed = yes
		set_variable = { cons_prog = 0.5 }
		
		random_list = {
			5 = { set_province_flag = strike_1 }
			5 = { set_province_flag = strike_2 }
			5 = { set_province_flag = strike_3 }
			5 = { set_province_flag = strike_4 }
			5 = { set_province_flag = strike_5 }
			5 = { set_province_flag = strike_6 }
			5 = { set_province_flag = strike_7 }
			5 = { set_province_flag = strike_8 }
			5 = { set_province_flag = strike_9 }
			5 = { set_province_flag = strike_10 }
			5 = { set_province_flag = strike_11 }
			5 = { set_province_flag = strike_12 }
			5 = { set_province_flag = strike_13 }
			5 = { set_province_flag = strike_14 }
			5 = { set_province_flag = strike_15 }
			5 = { set_province_flag = strike_16 }
			5 = { set_province_flag = strike_17 }
			5 = { set_province_flag = strike_18 }
			5 = { set_province_flag = strike_19 }
			5 = { set_province_flag = strike_20 }
		}
		
		random_list = {
			5 = { set_province_flag = swear_1 }
			5 = { set_province_flag = swear_2 }
			5 = { set_province_flag = swear_3 }
			5 = { set_province_flag = swear_4 }
			5 = { set_province_flag = swear_5 }
			5 = { set_province_flag = swear_6 }
			5 = { set_province_flag = swear_7 }
			5 = { set_province_flag = swear_8 }
			5 = { set_province_flag = swear_9 }
			5 = { set_province_flag = swear_10 }
			5 = { set_province_flag = swear_11 }
			5 = { set_province_flag = swear_12 }
			5 = { set_province_flag = swear_13 }
			5 = { set_province_flag = swear_14 }
			5 = { set_province_flag = swear_15 }
			5 = { set_province_flag = swear_16 }
			5 = { set_province_flag = swear_17 }
			5 = { set_province_flag = swear_18 }
			5 = { set_province_flag = swear_19 }
			5 = { set_province_flag = swear_20 }
		}
	}
}

upgrade_hold_capital = {
	trigger_switch = {
		on_trigger = has_province_modifier
		
		dig_1 = { remove_province_modifier = dig_1 add_permanent_province_modifier = { name = dig_2 duration = -1 } }
		dig_2 = { remove_province_modifier = dig_2 add_permanent_province_modifier = { name = dig_3 duration = -1 } }
		dig_3 = { remove_province_modifier = dig_3 add_permanent_province_modifier = { name = dig_4 duration = -1 } }
		dig_4 = { remove_province_modifier = dig_4 add_permanent_province_modifier = { name = dig_5 duration = -1 } }
		dig_5 = { remove_province_modifier = dig_5 add_permanent_province_modifier = { name = dig_6 duration = -1 } }
		dig_6 = { remove_province_modifier = dig_6 add_permanent_province_modifier = { name = dig_7 duration = -1 } }
		dig_7 = { remove_province_modifier = dig_7 add_permanent_province_modifier = { name = dig_8 duration = -1 } }
		dig_8 = { remove_province_modifier = dig_8 add_permanent_province_modifier = { name = dig_9 duration = -1 } }
		dig_9 = { remove_province_modifier = dig_9 add_permanent_province_modifier = { name = dig_10 duration = -1 } }
		dig_10 = { 
			if = {
				limit = { 
					OR = {
						province_id = 4119 #amldihr
						province_id = 4311 #gronstunad
					}
				}
				remove_province_modifier = dig_10 
				add_permanent_province_modifier = { name = dig_11 duration = -1 } 
			}
		}
	}
	
	hidden_effect = { 
		owner = {
			clr_country_flag = is_digging
			clr_country_flag = dig_prod
			clr_country_flag = dig_manpower
			clr_country_flag = dig_culture
			clr_country_flag = dig_explosive
			remove_country_modifier = dig_prod
			remove_country_modifier = dig_manpower
			remove_country_modifier = dig_explosive
		}
	}
}

define_hold_that_can_dig = {
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_1_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold1
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_2_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold2
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_3_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold3
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_4_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold4
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_5_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold5
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_6_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold6
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_7_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold7
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_8_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold8
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_9_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold9
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_10_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold10
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_11_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold11
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_12_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold12
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_13_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold13
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_14_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold14
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_15_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold15
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_16_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold16
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_17_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold17
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_18_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold18
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_19_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold19
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_20_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold20
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_21_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold21
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_22_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold22
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_23_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold23
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_24_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold24
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_25_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold25
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_26_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold26
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_27_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold27
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_28_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold28
		setup_digging_deeper_non_capital = yes
	}
	random_owned_province = {
		limit = { can_upgrade_hold = yes NOT = { has_province_flag = hold_@ROOT } }
		set_province_flag = option_hold_29_@ROOT
		set_province_flag = hold_@ROOT
		save_event_target_as = hold29
		setup_digging_deeper_non_capital = yes
	}

}

setup_digging_deeper_non_capital = {
	hidden_effect = {
		set_variable = { globalCost = 0 }
		set_variable = { globalTime = 0 }
		set_variable = { localCost = 0 }
		set_variable = { localTime = 0 }
		set_variable = { testCost = 0 }
		set_variable = { testTime = 0 }
		set_variable = { Cost = 0 }
		set_variable = { Time = 0 }
		trigger_switch = {
			on_trigger = has_province_modifier
			
			dig_1 = { set_variable = { speed = 20 } }
			dig_2 = { set_variable = { speed = 20 } }
			dig_3 = { set_variable = { speed = 30 } }
			dig_4 = { set_variable = { speed = 40 } }
			dig_5 = { set_variable = { speed = 50 } }
			dig_6 = { set_variable = { speed = 60 } }
			dig_7 = { set_variable = { speed = 70 } }
			dig_8 = { set_variable = { speed = 80 } }
			dig_9 = { set_variable = { speed = 80 } }
			dig_10 = { set_variable = { speed = 90 } }
		}
		
		if = {
			limit = { has_province_modifier = easy_rock }
			multiply_variable = { speed = 0.8 }
		}
		if = {
			limit = { owner = { has_country_flag = dig_through } }
			multiply_variable = { speed = 0.8 }
		}
		if = {
			limit = { 676 = { has_province_modifier = the_harpylen_dam owned_by = owner } }
			multiply_variable = { speed = 0.8 }
		}
		if = {
			limit = { owner = { tag = I24 } } #Aul-Dwarov
			multiply_variable = { speed = 0.8 }
		}
		if = {
			limit = { owner = { has_age_ability = ab_dwarven_reclamation } }
			multiply_variable = { speed = 0.8 }
		}
		
		if = {
			limit = { check_variable = { speed = 90 } }
			set_variable = { speed = 90 }
		}
		if = {
			limit = { NOT = { check_variable = { speed = 10 } } }
			set_variable = { speed = 10 }
		}
		multiply_variable = { speed = 0.001 }
		multiply_variable = { speed = 1000 }
		export_to_variable = {
			which = globalCost
			value = modifier:build_cost
			who = PREV
		}
		export_to_variable = {
			which = globalTime
			value = modifier:build_time
			who = PREV
		}
		export_to_variable = {
			which = localCost
			value = modifier:local_build_cost
		}
		export_to_variable = {
			which = localTime
			value = modifier:local_build_time
		}
		change_variable = {
			which = localCost
			which = globalCost
		}
		change_variable = {
			which = localTime
			which = globalTime
		}

		#cap time to -90%
		if = {
			limit = { NOT = { check_variable = { localTime = -0.910 } } }
			set_variable = { localTime = -0.900 }
		}
		
		change_variable = { Cost = 1 }
		change_variable = { Time = 1 }
		change_variable = { which = Cost which = localCost }
		change_variable = { which = Time which = localTime }
		
		set_variable = { finalCost = 1.5 }
		multiply_variable = { which = finalCost which = speed }
		multiply_variable = { which = finalCost which = speed }
		multiply_variable = { which = finalCost which = Cost }
		multiply_variable = { finalCost = 0.001 }
		multiply_variable = { finalCost = 1000 }#Final Cost in Ducats
		
		set_variable = { which = finalTime which = speed }
		multiply_variable = { which = finalTime which = Time } #Final Time in Years
	}
}


start_digging_deeper_non_capital = {
	hidden_effect = { cancel_construction = yes cap_digging_speed = yes }
	custom_tooltip = cost_capital_dig_tooltip
	hidden_effect = {
		if = { limit = { check_variable = { speed = 90 } } add_building_construction = { building = digging_deeper speed = 90 cost = 12150 } }
		else_if = { limit = { check_variable = { speed = 89 } } add_building_construction = { building = digging_deeper speed = 89 cost = 11882 } }
		else_if = { limit = { check_variable = { speed = 88 } } add_building_construction = { building = digging_deeper speed = 88 cost = 11616 } }
		else_if = { limit = { check_variable = { speed = 87 } } add_building_construction = { building = digging_deeper speed = 87 cost = 11354 } }
		else_if = { limit = { check_variable = { speed = 86 } } add_building_construction = { building = digging_deeper speed = 86 cost = 11094 } }
		else_if = { limit = { check_variable = { speed = 85 } } add_building_construction = { building = digging_deeper speed = 85 cost = 10838 } }
		else_if = { limit = { check_variable = { speed = 84 } } add_building_construction = { building = digging_deeper speed = 84 cost = 10584 } }
		else_if = { limit = { check_variable = { speed = 83 } } add_building_construction = { building = digging_deeper speed = 83 cost = 10334 } }
		else_if = { limit = { check_variable = { speed = 82 } } add_building_construction = { building = digging_deeper speed = 82 cost = 10086 } }
		else_if = { limit = { check_variable = { speed = 81 } } add_building_construction = { building = digging_deeper speed = 81 cost = 9842 } }
		else_if = { limit = { check_variable = { speed = 80 } } add_building_construction = { building = digging_deeper speed = 80 cost = 9600 } }
		else_if = { limit = { check_variable = { speed = 79 } } add_building_construction = { building = digging_deeper speed = 79 cost = 9362 } }
		else_if = { limit = { check_variable = { speed = 78 } } add_building_construction = { building = digging_deeper speed = 78 cost = 9126 } }
		else_if = { limit = { check_variable = { speed = 77 } } add_building_construction = { building = digging_deeper speed = 77 cost = 8894 } }
		else_if = { limit = { check_variable = { speed = 76 } } add_building_construction = { building = digging_deeper speed = 76 cost = 8664 } }
		else_if = { limit = { check_variable = { speed = 75 } } add_building_construction = { building = digging_deeper speed = 75 cost = 8438 } }
		else_if = { limit = { check_variable = { speed = 74 } } add_building_construction = { building = digging_deeper speed = 74 cost = 8214 } }
		else_if = { limit = { check_variable = { speed = 73 } } add_building_construction = { building = digging_deeper speed = 73 cost = 7994 } }
		else_if = { limit = { check_variable = { speed = 72 } } add_building_construction = { building = digging_deeper speed = 72 cost = 7776 } }
		else_if = { limit = { check_variable = { speed = 71 } } add_building_construction = { building = digging_deeper speed = 71 cost = 7562 } }
		else_if = { limit = { check_variable = { speed = 70 } } add_building_construction = { building = digging_deeper speed = 70 cost = 7350 } }
		else_if = { limit = { check_variable = { speed = 69 } } add_building_construction = { building = digging_deeper speed = 69 cost = 7142 } }
		else_if = { limit = { check_variable = { speed = 68 } } add_building_construction = { building = digging_deeper speed = 68 cost = 6936 } }
		else_if = { limit = { check_variable = { speed = 67 } } add_building_construction = { building = digging_deeper speed = 67 cost = 6734 } }
		else_if = { limit = { check_variable = { speed = 66 } } add_building_construction = { building = digging_deeper speed = 66 cost = 6534 } }
		else_if = { limit = { check_variable = { speed = 65 } } add_building_construction = { building = digging_deeper speed = 65 cost = 6338 } }
		else_if = { limit = { check_variable = { speed = 64 } } add_building_construction = { building = digging_deeper speed = 64 cost = 6144 } }
		else_if = { limit = { check_variable = { speed = 63 } } add_building_construction = { building = digging_deeper speed = 63 cost = 5954 } }
		else_if = { limit = { check_variable = { speed = 62 } } add_building_construction = { building = digging_deeper speed = 62 cost = 5766 } }
		else_if = { limit = { check_variable = { speed = 61 } } add_building_construction = { building = digging_deeper speed = 61 cost = 5582 } }
		else_if = { limit = { check_variable = { speed = 60 } } add_building_construction = { building = digging_deeper speed = 60 cost = 5400 } }
		else_if = { limit = { check_variable = { speed = 59 } } add_building_construction = { building = digging_deeper speed = 59 cost = 5222 } }
		else_if = { limit = { check_variable = { speed = 58 } } add_building_construction = { building = digging_deeper speed = 58 cost = 5046 } }
		else_if = { limit = { check_variable = { speed = 57 } } add_building_construction = { building = digging_deeper speed = 57 cost = 4874 } }
		else_if = { limit = { check_variable = { speed = 56 } } add_building_construction = { building = digging_deeper speed = 56 cost = 4704 } }
		else_if = { limit = { check_variable = { speed = 55 } } add_building_construction = { building = digging_deeper speed = 55 cost = 4538 } }
		else_if = { limit = { check_variable = { speed = 54 } } add_building_construction = { building = digging_deeper speed = 54 cost = 4374 } }
		else_if = { limit = { check_variable = { speed = 53 } } add_building_construction = { building = digging_deeper speed = 53 cost = 4214 } }
		else_if = { limit = { check_variable = { speed = 52 } } add_building_construction = { building = digging_deeper speed = 52 cost = 4056 } }
		else_if = { limit = { check_variable = { speed = 51 } } add_building_construction = { building = digging_deeper speed = 51 cost = 3902 } }
		else_if = { limit = { check_variable = { speed = 50 } } add_building_construction = { building = digging_deeper speed = 50 cost = 3750 } }
		else_if = { limit = { check_variable = { speed = 49 } } add_building_construction = { building = digging_deeper speed = 49 cost = 3602 } }
		else_if = { limit = { check_variable = { speed = 48 } } add_building_construction = { building = digging_deeper speed = 48 cost = 3456 } }
		else_if = { limit = { check_variable = { speed = 47 } } add_building_construction = { building = digging_deeper speed = 47 cost = 3314 } }
		else_if = { limit = { check_variable = { speed = 46 } } add_building_construction = { building = digging_deeper speed = 46 cost = 3174 } }
		else_if = { limit = { check_variable = { speed = 45 } } add_building_construction = { building = digging_deeper speed = 45 cost = 3038 } }
		else_if = { limit = { check_variable = { speed = 44 } } add_building_construction = { building = digging_deeper speed = 44 cost = 2904 } }
		else_if = { limit = { check_variable = { speed = 43 } } add_building_construction = { building = digging_deeper speed = 43 cost = 2774 } }
		else_if = { limit = { check_variable = { speed = 42 } } add_building_construction = { building = digging_deeper speed = 42 cost = 2646 } }
		else_if = { limit = { check_variable = { speed = 41 } } add_building_construction = { building = digging_deeper speed = 41 cost = 2522 } }
		else_if = { limit = { check_variable = { speed = 40 } } add_building_construction = { building = digging_deeper speed = 40 cost = 2400 } }
		else_if = { limit = { check_variable = { speed = 39 } } add_building_construction = { building = digging_deeper speed = 39 cost = 2282 } }
		else_if = { limit = { check_variable = { speed = 38 } } add_building_construction = { building = digging_deeper speed = 38 cost = 2166 } }
		else_if = { limit = { check_variable = { speed = 37 } } add_building_construction = { building = digging_deeper speed = 37 cost = 2054 } }
		else_if = { limit = { check_variable = { speed = 36 } } add_building_construction = { building = digging_deeper speed = 36 cost = 1944 } }
		else_if = { limit = { check_variable = { speed = 35 } } add_building_construction = { building = digging_deeper speed = 35 cost = 1838 } }
		else_if = { limit = { check_variable = { speed = 34 } } add_building_construction = { building = digging_deeper speed = 34 cost = 1734 } }
		else_if = { limit = { check_variable = { speed = 33 } } add_building_construction = { building = digging_deeper speed = 33 cost = 1634 } }
		else_if = { limit = { check_variable = { speed = 32 } } add_building_construction = { building = digging_deeper speed = 32 cost = 1536 } }
		else_if = { limit = { check_variable = { speed = 31 } } add_building_construction = { building = digging_deeper speed = 31 cost = 1442 } }
		else_if = { limit = { check_variable = { speed = 30 } } add_building_construction = { building = digging_deeper speed = 30 cost = 1350 } }
		else_if = { limit = { check_variable = { speed = 29 } } add_building_construction = { building = digging_deeper speed = 29 cost = 1262 } }
		else_if = { limit = { check_variable = { speed = 28 } } add_building_construction = { building = digging_deeper speed = 28 cost = 1176 } }
		else_if = { limit = { check_variable = { speed = 27 } } add_building_construction = { building = digging_deeper speed = 27 cost = 1094 } }
		else_if = { limit = { check_variable = { speed = 26 } } add_building_construction = { building = digging_deeper speed = 26 cost = 1014 } }
		else_if = { limit = { check_variable = { speed = 25 } } add_building_construction = { building = digging_deeper speed = 25 cost = 938 } }
		else_if = { limit = { check_variable = { speed = 24 } } add_building_construction = { building = digging_deeper speed = 24 cost = 864 } }
		else_if = { limit = { check_variable = { speed = 23 } } add_building_construction = { building = digging_deeper speed = 23 cost = 794 } }
		else_if = { limit = { check_variable = { speed = 22 } } add_building_construction = { building = digging_deeper speed = 22 cost = 726 } }
		else_if = { limit = { check_variable = { speed = 21 } } add_building_construction = { building = digging_deeper speed = 21 cost = 662 } }
		else_if = { limit = { check_variable = { speed = 20 } } add_building_construction = { building = digging_deeper speed = 20 cost = 600 } }
		else_if = { limit = { check_variable = { speed = 19 } } add_building_construction = { building = digging_deeper speed = 19 cost = 542 } }
		else_if = { limit = { check_variable = { speed = 18 } } add_building_construction = { building = digging_deeper speed = 18 cost = 486 } }
		else_if = { limit = { check_variable = { speed = 17 } } add_building_construction = { building = digging_deeper speed = 17 cost = 434 } }
		else_if = { limit = { check_variable = { speed = 16 } } add_building_construction = { building = digging_deeper speed = 16 cost = 384 } }
		else_if = { limit = { check_variable = { speed = 15 } } add_building_construction = { building = digging_deeper speed = 15 cost = 338 } }
		else_if = { limit = { check_variable = { speed = 14 } } add_building_construction = { building = digging_deeper speed = 14 cost = 294 } }
		else_if = { limit = { check_variable = { speed = 13 } } add_building_construction = { building = digging_deeper speed = 13 cost = 254 } }
		else_if = { limit = { check_variable = { speed = 12 } } add_building_construction = { building = digging_deeper speed = 12 cost = 216 } }
		else_if = { limit = { check_variable = { speed = 11 } } add_building_construction = { building = digging_deeper speed = 11 cost = 182 } }
		else = { add_building_construction = { building = digging_deeper speed = 10 cost = 150 } }
		uncap_digging_speed = yes
		random_list = {
			5 = { set_province_flag = strike_1 }
			5 = { set_province_flag = strike_2 }
			5 = { set_province_flag = strike_3 }
			5 = { set_province_flag = strike_4 }
			5 = { set_province_flag = strike_5 }
			5 = { set_province_flag = strike_6 }
			5 = { set_province_flag = strike_7 }
			5 = { set_province_flag = strike_8 }
			5 = { set_province_flag = strike_9 }
			5 = { set_province_flag = strike_10 }
			5 = { set_province_flag = strike_11 }
			5 = { set_province_flag = strike_12 }
			5 = { set_province_flag = strike_13 }
			5 = { set_province_flag = strike_14 }
			5 = { set_province_flag = strike_15 }
			5 = { set_province_flag = strike_16 }
			5 = { set_province_flag = strike_17 }
			5 = { set_province_flag = strike_18 }
			5 = { set_province_flag = strike_19 }
			5 = { set_province_flag = strike_20 }
		}
		
		random_list = {
			5 = { set_province_flag = swear_1 }
			5 = { set_province_flag = swear_2 }
			5 = { set_province_flag = swear_3 }
			5 = { set_province_flag = swear_4 }
			5 = { set_province_flag = swear_5 }
			5 = { set_province_flag = swear_6 }
			5 = { set_province_flag = swear_7 }
			5 = { set_province_flag = swear_8 }
			5 = { set_province_flag = swear_9 }
			5 = { set_province_flag = swear_10 }
			5 = { set_province_flag = swear_11 }
			5 = { set_province_flag = swear_12 }
			5 = { set_province_flag = swear_13 }
			5 = { set_province_flag = swear_14 }
			5 = { set_province_flag = swear_15 }
			5 = { set_province_flag = swear_16 }
			5 = { set_province_flag = swear_17 }
			5 = { set_province_flag = swear_18 }
			5 = { set_province_flag = swear_19 }
			5 = { set_province_flag = swear_20 }
		}
	}
}

clr_digging_menu = {
	every_owned_province = {
		limit = { has_province_flag = hold_@ROOT }
		clr_province_flag = option_hold_1_@ROOT
		clr_province_flag = option_hold_2_@ROOT
		clr_province_flag = option_hold_3_@ROOT
		clr_province_flag = option_hold_4_@ROOT
		clr_province_flag = option_hold_5_@ROOT
		clr_province_flag = option_hold_6_@ROOT
		clr_province_flag = option_hold_7_@ROOT
		clr_province_flag = option_hold_8_@ROOT
		clr_province_flag = option_hold_9_@ROOT
		clr_province_flag = option_hold_10_@ROOT
		clr_province_flag = option_hold_11_@ROOT
		clr_province_flag = option_hold_12_@ROOT
		clr_province_flag = option_hold_13_@ROOT
		clr_province_flag = option_hold_14_@ROOT
		clr_province_flag = option_hold_15_@ROOT
		clr_province_flag = option_hold_16_@ROOT
		clr_province_flag = option_hold_17_@ROOT
		clr_province_flag = option_hold_18_@ROOT
		clr_province_flag = option_hold_19_@ROOT
		clr_province_flag = option_hold_20_@ROOT
		clr_province_flag = option_hold_21_@ROOT
		clr_province_flag = option_hold_22_@ROOT
		clr_province_flag = option_hold_23_@ROOT
		clr_province_flag = option_hold_24_@ROOT
		clr_province_flag = option_hold_25_@ROOT
		clr_province_flag = option_hold_26_@ROOT
		clr_province_flag = option_hold_27_@ROOT
		clr_province_flag = option_hold_28_@ROOT
		clr_province_flag = option_hold_29_@ROOT
		clr_province_flag = hold_@ROOT
	}
	clr_country_flag = hold_operation_menu
}

upgrade_hold = {
	trigger_switch = {
		on_trigger = has_province_modifier
		
		dig_1 = { remove_province_modifier = dig_1 add_permanent_province_modifier = { name = dig_2 duration = -1 } }
		dig_2 = { remove_province_modifier = dig_2 add_permanent_province_modifier = { name = dig_3 duration = -1 } }
		dig_3 = { remove_province_modifier = dig_3 add_permanent_province_modifier = { name = dig_4 duration = -1 } }
		dig_4 = { remove_province_modifier = dig_4 add_permanent_province_modifier = { name = dig_5 duration = -1 } }
		dig_5 = { remove_province_modifier = dig_5 add_permanent_province_modifier = { name = dig_6 duration = -1 } }
		dig_6 = { remove_province_modifier = dig_6 add_permanent_province_modifier = { name = dig_7 duration = -1 } }
		dig_7 = { remove_province_modifier = dig_7 add_permanent_province_modifier = { name = dig_8 duration = -1 } }
		dig_8 = { remove_province_modifier = dig_8 add_permanent_province_modifier = { name = dig_9 duration = -1 } }
		dig_9 = { remove_province_modifier = dig_9 add_permanent_province_modifier = { name = dig_10 duration = -1 } }
		dig_10 = { 
			if = {
				limit = { 
					OR = {
						province_id = 4119 #amldihr
						province_id = 4311 #gronstunad
					}
				}
				remove_province_modifier = dig_10 
				add_permanent_province_modifier = { name = dig_11 duration = -1 } 
			}
		}
	}
}

clr_cavern_exploration = {
	hidden_effect = {
		clr_country_flag = cave_1 
		clr_country_flag = cave_2 
		clr_country_flag = cave_3 
		clr_country_flag = cave_4 
		clr_country_flag = cave_5 
		clr_country_flag = cave_6 
		clr_country_flag = cave_7 
		clr_country_flag = cave_8 
		clr_country_flag = cave_9 
		clr_country_flag = cave_10
		clr_country_flag = cave_11
		clr_country_flag = cave_12
		clr_country_flag = cave_13
		clr_country_flag = cave_14
		clr_country_flag = cave_15
		clr_country_flag = cave_16
		clr_country_flag = cave_17
		clr_country_flag = cave_18
		clr_country_flag = cave_19
		clr_country_flag = cave_20
		clr_country_flag = cave_21
		clr_country_flag = cave_22
		clr_country_flag = cave_23
		clr_country_flag = cave_24
		clr_country_flag = cave_25
		clr_country_flag = exploring_cavern
	}
}

amlharaz_hold_vote = {
	every_subject_country = {
		limit = { is_subject_of_type = amlharaz_hold }
		if = {
			limit = {
				OR = {
					AND = { has_country_flag = for_amlharaz I24 = { has_country_flag = enacted_amlharaz } }
					AND = { has_country_flag = against_amlharaz I24 = { has_country_flag = denied_amlharaz } }
				}
			}
			amlharaz_happy = yes
			clr_country_flag = for_amlharaz
		}
		else = {
			amlharaz_not_happy = yes
			clr_country_flag = against_amlharaz
		}
	}
}

amlharaz_not_happy = {
	trigger_switch = {
		on_trigger = has_country_modifier
		
		amlharaz_liberty_desire_1 = { remove_country_modifier = amlharaz_liberty_desire_1 add_country_modifier = { name = amlharaz_liberty_desire_0 duration = -1 } }
		amlharaz_liberty_desire_2 = { remove_country_modifier = amlharaz_liberty_desire_2 add_country_modifier = { name = amlharaz_liberty_desire_1 duration = -1 } }
		amlharaz_liberty_desire_3 = { remove_country_modifier = amlharaz_liberty_desire_3 add_country_modifier = { name = amlharaz_liberty_desire_2 duration = -1 } }
		amlharaz_liberty_desire_4 = { remove_country_modifier = amlharaz_liberty_desire_4 add_country_modifier = { name = amlharaz_liberty_desire_3 duration = -1 } }
		amlharaz_liberty_desire_5 = { remove_country_modifier = amlharaz_liberty_desire_5 add_country_modifier = { name = amlharaz_liberty_desire_4 duration = -1 } }
		amlharaz_liberty_desire_6 = { remove_country_modifier = amlharaz_liberty_desire_6 add_country_modifier = { name = amlharaz_liberty_desire_5 duration = -1 } }
		amlharaz_liberty_desire_7 = { remove_country_modifier = amlharaz_liberty_desire_7 add_country_modifier = { name = amlharaz_liberty_desire_6 duration = -1 } }
		amlharaz_liberty_desire_8 = { remove_country_modifier = amlharaz_liberty_desire_8 add_country_modifier = { name = amlharaz_liberty_desire_7 duration = -1 } }
		amlharaz_liberty_desire_9 = { remove_country_modifier = amlharaz_liberty_desire_9 add_country_modifier = { name = amlharaz_liberty_desire_8 duration = -1 } }
		amlharaz_liberty_desire_10 = { remove_country_modifier = amlharaz_liberty_desire_10 add_country_modifier = { name = amlharaz_liberty_desire_9 duration = -1 } }
		amlharaz_liberty_desire_11 = { remove_country_modifier = amlharaz_liberty_desire_11 add_country_modifier = { name = amlharaz_liberty_desire_10 duration = -1 } }
		amlharaz_liberty_desire_12 = { remove_country_modifier = amlharaz_liberty_desire_12 add_country_modifier = { name = amlharaz_liberty_desire_11 duration = -1 } }
		amlharaz_liberty_desire_13 = { remove_country_modifier = amlharaz_liberty_desire_13 add_country_modifier = { name = amlharaz_liberty_desire_12 duration = -1 } }
		amlharaz_liberty_desire_14 = { remove_country_modifier = amlharaz_liberty_desire_14 add_country_modifier = { name = amlharaz_liberty_desire_13 duration = -1 } }
		amlharaz_liberty_desire_15 = { remove_country_modifier = amlharaz_liberty_desire_15 add_country_modifier = { name = amlharaz_liberty_desire_14 duration = -1 } }
		amlharaz_liberty_desire_16 = { remove_country_modifier = amlharaz_liberty_desire_16 add_country_modifier = { name = amlharaz_liberty_desire_15 duration = -1 } }
		amlharaz_liberty_desire_17 = { remove_country_modifier = amlharaz_liberty_desire_17 add_country_modifier = { name = amlharaz_liberty_desire_16 duration = -1 } }
		amlharaz_liberty_desire_18 = { remove_country_modifier = amlharaz_liberty_desire_18 add_country_modifier = { name = amlharaz_liberty_desire_17 duration = -1 } }
		amlharaz_liberty_desire_19 = { remove_country_modifier = amlharaz_liberty_desire_19 add_country_modifier = { name = amlharaz_liberty_desire_18 duration = -1 } }
		amlharaz_liberty_desire_20 = { remove_country_modifier = amlharaz_liberty_desire_20 add_country_modifier = { name = amlharaz_liberty_desire_19 duration = -1 } }
	}
}

amlharaz_happy = {
	trigger_switch = {
		on_trigger = has_country_modifier
		
		amlharaz_liberty_desire_19 = { remove_country_modifier = amlharaz_liberty_desire_19 add_country_modifier = { name = amlharaz_liberty_desire_20 duration = -1 } }
		amlharaz_liberty_desire_18 = { remove_country_modifier = amlharaz_liberty_desire_18 add_country_modifier = { name = amlharaz_liberty_desire_19 duration = -1 } }
		amlharaz_liberty_desire_17 = { remove_country_modifier = amlharaz_liberty_desire_17 add_country_modifier = { name = amlharaz_liberty_desire_18 duration = -1 } }
		amlharaz_liberty_desire_16 = { remove_country_modifier = amlharaz_liberty_desire_16 add_country_modifier = { name = amlharaz_liberty_desire_17 duration = -1 } }
		amlharaz_liberty_desire_15 = { remove_country_modifier = amlharaz_liberty_desire_15 add_country_modifier = { name = amlharaz_liberty_desire_16 duration = -1 } }
		amlharaz_liberty_desire_14 = { remove_country_modifier = amlharaz_liberty_desire_14 add_country_modifier = { name = amlharaz_liberty_desire_15 duration = -1 } }
		amlharaz_liberty_desire_13 = { remove_country_modifier = amlharaz_liberty_desire_13 add_country_modifier = { name = amlharaz_liberty_desire_14 duration = -1 } }
		amlharaz_liberty_desire_12 = { remove_country_modifier = amlharaz_liberty_desire_12 add_country_modifier = { name = amlharaz_liberty_desire_13 duration = -1 } }
		amlharaz_liberty_desire_11 = { remove_country_modifier = amlharaz_liberty_desire_11 add_country_modifier = { name = amlharaz_liberty_desire_12 duration = -1 } }
		amlharaz_liberty_desire_10 = { remove_country_modifier = amlharaz_liberty_desire_10 add_country_modifier = { name = amlharaz_liberty_desire_11 duration = -1 } }
		amlharaz_liberty_desire_9 = { remove_country_modifier = amlharaz_liberty_desire_9 add_country_modifier = { name = amlharaz_liberty_desire_10 duration = -1 } }
		amlharaz_liberty_desire_8 = { remove_country_modifier = amlharaz_liberty_desire_8 add_country_modifier = { name = amlharaz_liberty_desire_9 duration = -1 } }
		amlharaz_liberty_desire_7 = { remove_country_modifier = amlharaz_liberty_desire_7 add_country_modifier = { name = amlharaz_liberty_desire_8 duration = -1 } }
		amlharaz_liberty_desire_6 = { remove_country_modifier = amlharaz_liberty_desire_6 add_country_modifier = { name = amlharaz_liberty_desire_7 duration = -1 } }
		amlharaz_liberty_desire_5 = { remove_country_modifier = amlharaz_liberty_desire_5 add_country_modifier = { name = amlharaz_liberty_desire_6 duration = -1 } }
		amlharaz_liberty_desire_4 = { remove_country_modifier = amlharaz_liberty_desire_4 add_country_modifier = { name = amlharaz_liberty_desire_5 duration = -1 } }
		amlharaz_liberty_desire_3 = { remove_country_modifier = amlharaz_liberty_desire_3 add_country_modifier = { name = amlharaz_liberty_desire_4 duration = -1 } }
		amlharaz_liberty_desire_2 = { remove_country_modifier = amlharaz_liberty_desire_2 add_country_modifier = { name = amlharaz_liberty_desire_3 duration = -1 } }
		amlharaz_liberty_desire_1 = { remove_country_modifier = amlharaz_liberty_desire_1 add_country_modifier = { name = amlharaz_liberty_desire_2 duration = -1 } }
		amlharaz_liberty_desire_0 = { remove_country_modifier = amlharaz_liberty_desire_0 add_country_modifier = { name = amlharaz_liberty_desire_1 duration = -1 } }
	}
}

save_yearly_income = { #Saves income for 0.5 1 1.5 2 3 5 7 9 years of income

	set_variable = { HalfYearOfIncome = 0}
	set_variable = { YearOfIncome = 0}
	set_variable = { OneAndHalfYearOfIncome = 0}
	set_variable = { 2YearOfIncome = 0}
	set_variable = { 3YearOfIncome = 0}
	set_variable = { 5YearOfIncome = 0}
	set_variable = { 7YearOfIncome = 0}
	set_variable = { 9YearOfIncome = 0}
	
	#Save yearly income at this point
	export_to_variable = {
		which = YearOfIncome
		value = years_of_income
		who = ROOT
	}
	
	
	#Do the same for other years of income, way easier than re-calculating it every time
	export_to_variable = {
		which = 2YearOfIncome
		value = years_of_income
		who = ROOT
	}
	
	#Turn it negative and slightly increase it to make up for the negative income modifiers for hoardcurse
	multiply_variable = {
		which = 2YearOfIncome
		value = 2
	}
	
	export_to_variable = {
		which = 3YearOfIncome
		value = years_of_income
		who = ROOT
	}
	
	#Turn it negative and slightly increase it to make up for the negative income modifiers for hoardcurse
	multiply_variable = {
		which = 3YearOfIncome
		value = 3
	}

	export_to_variable = {
		which = 5YearOfIncome
		value = years_of_income
		who = ROOT
	}

	#Turn it negative and slightly increase it to make up for the negative income modifiers for hoardcurse
	multiply_variable = {
		which = 5YearOfIncome
		value = 5
	}

	export_to_variable = {
		which = 7YearOfIncome
		value = years_of_income
		who = ROOT
	}

	#Turn it negative and slightly increase it to make up for the negative income modifiers for hoardcurse
	multiply_variable = {
		which = 7YearOfIncome
		value = 7
	}

	export_to_variable = {
		which = 9YearOfIncome
		value = years_of_income
		who = ROOT
	}

	#Turn it negative and slightly increase it to make up for the negative income modifiers for hoardcurse
	multiply_variable = {
		which = 9YearOfIncome
		value = 9
	}

	export_to_variable = {
		which = OneAndHalfYearOfIncome
		value = years_of_income
		who = ROOT
	}

	#Turn it negative and slightly increase it to make up for the negative income modifiers for hoardcurse
	multiply_variable = {
		which = OneAndHalfYearOfIncome
		value = 1.5
	}

	export_to_variable = {
		which = HalfYearOfIncome
		value = years_of_income
		who = ROOT
	}

	#Turn it negative and slightly increase it to make up for the negative income modifiers for hoardcurse
	divide_variable  = {
		which = HalfYearOfIncome
		value = 2
	}
}

set_province_historical_culture = {
	trigger_switch = {
		on_trigger = area
		amldihr_area = { add_core = I01  change_culture = kronium_dwarf }  
		krakdhum_area = {  add_core = I02  change_culture = quartz_dwarf }
		vazhatun_area = {  add_core = I03  change_culture = sapphire_dwarf }
		orlazam_area = {  add_core = I04  change_culture = ramsteel_dwarf }
		mithradhum_area = {  add_core = I05  change_culture = mithril_dwarf }
		railyard_area = {  add_core = I06  change_culture = dagrite_dwarf }
		khugdihr_area = {  add_core = I07  change_culture = agate_dwarf }
		orldhum_area = {  add_core = I08  change_culture = platinum_dwarf }
		stunad_kozenad_area = {  add_core = I09  change_culture = opal_dwarf }
		jorkad_junction_area = {  add_core = I10  change_culture = lead_dwarf }
		shazstundihr_area = {  add_core = I11  change_culture = marble_dwarf }
		orlghelovar_area = {  add_core = I12  change_culture = cobalt_dwarf }
		stunad_skomdihr_area = {  add_core = I13  change_culture = flint_dwarf }
		vazumbrog_area = {  add_core = I14  change_culture = titanium_dwarf }
		hehos_legacy_area = {  add_core = I15  change_culture = pyrite_dwarf }
		gor_burad_area = {  add_core = I16  change_culture = basalt_dwarf }
		ozumbrog_area = {  add_core = I17  change_culture = topaz_dwarf }
		grozumdihr_area = {  add_core = I18  change_culture = peridot_dwarf }
		ovdal_az_an_area = {  add_core = I19  change_culture = granite_dwarf }
		hul_az_krakazol_area = {  add_core = I20  change_culture = amethyst_dwarf }
		tuwad_area = {  add_core = I21  change_culture = emerald_dwarf }
		gronstunad_area = { add_core = I22  change_culture = jade_dwarf }
		dromak_area = {  add_core = I25  change_culture = malachite_dwarf }
		arg_ordstun_area = {  add_core = H76  change_culture = diamond_dwarf }
		ovdal_lodhum_area = {  add_core = H77  change_culture = garnet_dwarf }
		verkal_gulan_area = {  add_core = F47  change_culture = gold_dwarf }
		kanzad_area = {  add_core = H79  change_culture = amber_dwarf }
		seghdihr_area = {  add_core = H78  change_culture = citrine_dwarf }
	}
}

set_base_value = {
	set_variable = { #100% base cost
		which = $which$
		value = 1
	}

	export_to_variable = {
		variable_name = apowerCost
		value = modifier:all_power_cost
		who = owner
	}
	change_variable = { #power cost modifiers
		which = $which$
		which = apowerCost
	}

	export_to_variable = {
		variable_name = devCost
		value = modifier:development_cost
		who = owner
	}
	change_variable = { #country dev modifiers
		which = $which$
		which = devCost
	}

	export_to_variable = {
		variable_name = ldevCost
		value = modifier:local_development_cost
	}
	change_variable = { #province dev modifiers
		which = $which$
		which = ldevCost
	}

	if = { #dev efficiency from adm tech affects base cost by -10%
		limit = {
			owner = { adm_tech = 27 }
		}
		multiply_variable = {
			which = $which$
			value = 35
		}
	}
	else_if  = {
		limit = {
			owner = { adm_tech = 23 }
		}
		multiply_variable = {
			which = $which$
			value = 40
		}
	}
	else_if  = {
		limit = {
			owner = { adm_tech = 17 }
		}
		multiply_variable = {
			which = $which$
			value = 45
		}
	}
	else = {
		multiply_variable = {
			which = $which$
			value = 50
		}
	}
}
add_power = { #reddit.com/r/eu4/comments/dy7lyv
	set_variable = {
		which = temp
		which = provDevCost
	}

	binary_ad20 = { variable = temp	addcommand = $power$	valueAdd = 1024 	valueSub = -1024 }
	binary_ad20 = { variable = temp	addcommand = $power$	valueAdd = 512		valueSub = -512 }
	binary_ad20 = { variable = temp	addcommand = $power$	valueAdd = 256		valueSub = -256 }
	binary_ad20 = { variable = temp	addcommand = $power$	valueAdd = 128		valueSub = -128 }
	binary_ad20 = { variable = temp	addcommand = $power$	valueAdd = 64		valueSub = -64 }
	binary_ad20 = { variable = temp	addcommand = $power$	valueAdd = 32		valueSub = -32 }
	binary_ad20 = { variable = temp	addcommand = $power$	valueAdd = 16		valueSub = -16 }
	binary_ad20 = { variable = temp	addcommand = $power$	valueAdd = 8		valueSub = -8 }
	binary_ad20 = { variable = temp	addcommand = $power$	valueAdd = 4		valueSub = -4 }
	binary_ad20 = { variable = temp	addcommand = $power$	valueAdd = 2		valueSub = -2 }
	binary_ad20 = { variable = temp	addcommand = $power$	valueAdd = 1		valueSub = -1 }
	#log = dev_info.4
}

binary_ad20 = {
	if = {
		limit = {
			check_variable = {
				which = $variable$
				value = $valueAdd$
			}
		}
		owner = {
			add_$addcommand$_power = $valueSub$
		}

		subtract_variable = {
			which = $variable$
			value = $valueAdd$
		}
	}
}

increase_runelink_upkeep = {
	if = {
		limit = { has_province_modifier = runelink_upkeep_1 }
		remove_province_modifier = runelink_upkeep_1
		add_permanent_province_modifier = {
			name = runelink_upkeep_2
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_2 }
		remove_province_modifier = runelink_upkeep_2
		add_permanent_province_modifier = {
			name = runelink_upkeep_3
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_3 }
		remove_province_modifier = runelink_upkeep_3
		add_permanent_province_modifier = {
			name = runelink_upkeep_4
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_4 }
		remove_province_modifier = runelink_upkeep_4
		add_permanent_province_modifier = {
			name = runelink_upkeep_5
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_5 }
		remove_province_modifier = runelink_upkeep_5
		add_permanent_province_modifier = {
			name = runelink_upkeep_6
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_6 }
		remove_province_modifier = runelink_upkeep_6
		add_permanent_province_modifier = {
			name = runelink_upkeep_7
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_7 }
		remove_province_modifier = runelink_upkeep_7
		add_permanent_province_modifier = {
			name = runelink_upkeep_8
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_8 }
		remove_province_modifier = runelink_upkeep_8
		add_permanent_province_modifier = {
			name = runelink_upkeep_9
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_9 }
		remove_province_modifier = runelink_upkeep_9
		add_permanent_province_modifier = {
			name = runelink_upkeep_10
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_10 }
		remove_province_modifier = runelink_upkeep_10
		add_permanent_province_modifier = {
			name = runelink_upkeep_11
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_11 }
		remove_province_modifier = runelink_upkeep_11
		add_permanent_province_modifier = {
			name = runelink_upkeep_12
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_12 }
		remove_province_modifier = runelink_upkeep_12
		add_permanent_province_modifier = {
			name = runelink_upkeep_13
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_13 }
		remove_province_modifier = runelink_upkeep_13
		add_permanent_province_modifier = {
			name = runelink_upkeep_14
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_14 }
		remove_province_modifier = runelink_upkeep_14
		add_permanent_province_modifier = {
			name = runelink_upkeep_15
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_15 }
		remove_province_modifier = runelink_upkeep_15
		add_permanent_province_modifier = {
			name = runelink_upkeep_16
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_16 }
		remove_province_modifier = runelink_upkeep_16
		add_permanent_province_modifier = {
			name = runelink_upkeep_17
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_17 }
		remove_province_modifier = runelink_upkeep_17
		add_permanent_province_modifier = {
			name = runelink_upkeep_18
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_18 }
		remove_province_modifier = runelink_upkeep_18
		add_permanent_province_modifier = {
			name = runelink_upkeep_19
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_19 }
		remove_province_modifier = runelink_upkeep_19
		add_permanent_province_modifier = {
			name = runelink_upkeep_20
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_20 }
		remove_province_modifier = runelink_upkeep_20
		add_permanent_province_modifier = {
			name = runelink_upkeep_21
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_21 }
		remove_province_modifier = runelink_upkeep_21
		add_permanent_province_modifier = {
			name = runelink_upkeep_22
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_22 }
		remove_province_modifier = runelink_upkeep_22
		add_permanent_province_modifier = {
			name = runelink_upkeep_23
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_23 }
		remove_province_modifier = runelink_upkeep_23
		add_permanent_province_modifier = {
			name = runelink_upkeep_24
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_24 }
		remove_province_modifier = runelink_upkeep_24
		add_permanent_province_modifier = {
			name = runelink_upkeep_25
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_25 }
		remove_province_modifier = runelink_upkeep_25
		add_permanent_province_modifier = {
			name = runelink_upkeep_26
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_26 }
		remove_province_modifier = runelink_upkeep_26
		add_permanent_province_modifier = {
			name = runelink_upkeep_27
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_27 }
		remove_province_modifier = runelink_upkeep_27
		add_permanent_province_modifier = {
			name = runelink_upkeep_28
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_28 }
		remove_province_modifier = runelink_upkeep_28
		add_permanent_province_modifier = {
			name = runelink_upkeep_29
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_29 }
		remove_province_modifier = runelink_upkeep_29
		add_permanent_province_modifier = {
			name = runelink_upkeep_30
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_30 }
		remove_province_modifier = runelink_upkeep_30
		add_permanent_province_modifier = {
			name = runelink_upkeep_31
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_31 }
		remove_province_modifier = runelink_upkeep_31
		add_permanent_province_modifier = {
			name = runelink_upkeep_32
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_32 }
		remove_province_modifier = runelink_upkeep_32
		add_permanent_province_modifier = {
			name = runelink_upkeep_33
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_33 }
		remove_province_modifier = runelink_upkeep_33
		add_permanent_province_modifier = {
			name = runelink_upkeep_34
			duration = -1
		}
	}
	else_if = {
		limit = { has_province_modifier = runelink_upkeep_34 }
		remove_province_modifier = runelink_upkeep_34
		add_permanent_province_modifier = {
			name = runelink_upkeep_35
			duration = -1
		}
	}
}

runedemand_effect = {
	if = {
		limit = { owner = { check_variable = { runeSize = 7 } } }
		add_base_production = -2
		add_base_manpower = -2
		add_base_tax = -3
	}
	else_if = {
		limit = { owner = { check_variable = { runeSize = 6 } } }
		add_base_production = -2
		add_base_manpower = -2
		add_base_tax = -2
	}
	else_if = {
		limit = { owner = { check_variable = { runeSize = 5 } } }
		add_base_production = -2
		add_base_manpower = -1
		add_base_tax = -2
	}
	else_if = {
		limit = { owner = { check_variable = { runeSize = 4 } } }
		add_base_production = -1
		add_base_manpower = -1
		add_base_tax = -2
	}
	else_if = {
		limit = { owner = { check_variable = { runeSize = 3 } } }
		add_base_production = -1
		add_base_manpower = -1
		add_base_tax = -1
	}
	else_if = {
		limit = { owner = { check_variable = { runeSize = 2 } } }
		add_base_production = -1
		add_base_manpower = -1
	}
	else_if = {
		limit = { owner = { check_variable = { runeSize = 1 } } }
		add_base_production = -1
	}
}

define_expedition_target = {
	random_owned_province = {
		limit = { is_city = yes has_province_modifier = expedition_target owned_by = ROOT controlled_by = ROOT NOT = { has_province_flag = expedition_@ROOT has_province_flag = sent_expedition_@ROOT } }
		set_province_flag = expedition_@ROOT
		save_event_target_as = expedition1
	}
	random_owned_province = {
		limit = { is_city = yes has_province_modifier = expedition_target owned_by = ROOT controlled_by = ROOT NOT = { has_province_flag = expedition_@ROOT has_province_flag = sent_expedition_@ROOT } }
		set_province_flag = expedition_@ROOT
		save_event_target_as = expedition2
	}
	random_owned_province = {
		limit = { is_city = yes has_province_modifier = expedition_target owned_by = ROOT controlled_by = ROOT NOT = { has_province_flag = expedition_@ROOT has_province_flag = sent_expedition_@ROOT } }
		set_province_flag = expedition_@ROOT
		save_event_target_as = expedition3
	}
	random_owned_province = {
		limit = { is_city = yes has_province_modifier = expedition_target owned_by = ROOT controlled_by = ROOT NOT = { has_province_flag = expedition_@ROOT has_province_flag = sent_expedition_@ROOT } }
		set_province_flag = expedition_@ROOT
		save_event_target_as = expedition4
	}
	random_owned_province = {
		limit = { is_city = yes has_province_modifier = expedition_target owned_by = ROOT controlled_by = ROOT NOT = { has_province_flag = expedition_@ROOT has_province_flag = sent_expedition_@ROOT } }
		set_province_flag = expedition_@ROOT
		save_event_target_as = expedition5
	}
	random_owned_province = {
		limit = { is_city = yes has_province_modifier = expedition_target owned_by = ROOT controlled_by = ROOT NOT = { has_province_flag = expedition_@ROOT has_province_flag = sent_expedition_@ROOT } }
		set_province_flag = expedition_@ROOT
		save_event_target_as = expedition6
	}
	random_owned_province = {
		limit = { is_city = yes has_province_modifier = expedition_target owned_by = ROOT controlled_by = ROOT NOT = { has_province_flag = expedition_@ROOT has_province_flag = sent_expedition_@ROOT } }
		set_province_flag = expedition_@ROOT
		save_event_target_as = expedition7
	}
	random_owned_province = {
		limit = { is_city = yes has_province_modifier = expedition_target owned_by = ROOT controlled_by = ROOT NOT = { has_province_flag = expedition_@ROOT has_province_flag = sent_expedition_@ROOT } }
		set_province_flag = expedition_@ROOT
		save_event_target_as = expedition8
	}
	random_owned_province = {
		limit = { is_city = yes has_province_modifier = expedition_target owned_by = ROOT controlled_by = ROOT NOT = { has_province_flag = expedition_@ROOT has_province_flag = sent_expedition_@ROOT } }
		set_province_flag = expedition_@ROOT
		save_event_target_as = expedition9
	}
	random_owned_province = {
		limit = { is_city = yes has_province_modifier = expedition_target owned_by = ROOT controlled_by = ROOT NOT = { has_province_flag = expedition_@ROOT has_province_flag = sent_expedition_@ROOT } }
		set_province_flag = expedition_@ROOT
		save_event_target_as = expedition10
	}
}

generate_party_stats = {
	hidden_effect = {
		set_variable = { partyEffectiveness = 100 }
		owner = { 
			export_to_variable = {
				which = partyEffectiveness
				value = modifier:discipline
			}
			multiply_variable = { partyEffectiveness = 100 }
		}
		owner = { ROOT = { change_variable = { which = partyEffectiveness which = PREV } } }
		owner = { 
			export_to_variable = {
				which = partyMorale
				value = trigger_value:land_morale
			}
		}
		owner = { ROOT = { set_variable = { which = partyMorale which = PREV } } }
		
		if = {
			limit = { check_variable = { partyMorale = 10 } }
			set_variable = { partyMorale = 10 }
		}
		if = {
			limit = { NOT = { check_variable = { partyMorale = 0 } } }
			set_variable = { partyMorale = 0 }
		}
	}
}

generate_ai_party = {
	#Basic stats
	generate_party_stats = yes
	set_variable = { partyMorale = 7 }
	set_variable = { partyManpower = 5000 }
	set_variable = { partySupplies = 80 }
	random_list = {
		20 = { multiply_variable = { partyEffectiveness = 0.8 } }
		20 = { multiply_variable = { partyEffectiveness = 0.9 } }
		20 = { multiply_variable = { partyEffectiveness = 1 } }
		20 = { multiply_variable = { partyEffectiveness = 1.1 } }
		20 = { multiply_variable = { partyEffectiveness = 1.2 } }
	}
	random_list = {
		20 = { multiply_variable = { partyMorale = 1.1 } }
		20 = { multiply_variable = { partyMorale = 1.2 } }
		20 = { multiply_variable = { partyMorale = 1.3 } }
		20 = { multiply_variable = { partyMorale = 1.4 } }
		20 = { multiply_variable = { partyMorale = 1.5 } }
	}
	random_list = {
		20 = { multiply_variable = { partyManpower = 1.1 } }
		20 = { multiply_variable = { partyManpower = 1.2 } }
		20 = { multiply_variable = { partyManpower = 1.3 } }
		20 = { multiply_variable = { partyManpower = 1.4 } }
		20 = { multiply_variable = { partyManpower = 1.5 } }
	}
	random_list = {
		20 = { multiply_variable = { partySupplies = 0.8 } }
		20 = { multiply_variable = { partySupplies = 0.9 } }
		20 = { multiply_variable = { partySupplies = 1 } }
		20 = { multiply_variable = { partySupplies = 1.1 } }
		20 = { multiply_variable = { partySupplies = 1.2 } }
	}
	#Racial Shit
	if = {
		limit = { owner = { has_country_modifier = goblin_military } }
		multiply_variable = { partyManpower = 1.5 }
		multiply_variable = { partyEffectiveness = 1.1 }
		multiply_variable = { partyMorale = 1.2 }
		multiply_variable = { partySupplies = 0.8 }
	}
	if = {
		limit = { owner = { has_country_modifier = dwarven_military } }
		multiply_variable = { partyManpower = 1.2 }
		multiply_variable = { partyEffectiveness = 1.3 }
		multiply_variable = { partyMorale = 1.2 }
		multiply_variable = { partySupplies = 1.2 }
	}
	if = {
		limit = { owner = { has_country_modifier = orcish_military } }
		multiply_variable = { partyManpower = 0.9 }
		multiply_variable = { partyEffectiveness = 1.1 }
		multiply_variable = { partyMorale = 1.3 }
		multiply_variable = { partySupplies = 1 }
	}
	if = {
		limit = { owner = { has_country_modifier = kobold_military } }
		multiply_variable = { partyManpower = 1.4 }
		multiply_variable = { partyEffectiveness = 0.8 }
		multiply_variable = { partyMorale = 1.2 }
		multiply_variable = { partySupplies = 1 }
	}
	
	#Rewards
	set_variable = { which = partyRewards  which = lowLootEstimate }
	random_list = {
		20 = { multiply_variable = { partyRewards = 0.8 } }
		20 = { multiply_variable = { partyRewards = 0.9 } }
		20 = { multiply_variable = { partyRewards = 1 } }
		20 = { multiply_variable = { partyRewards = 1.1 } }
		20 = { multiply_variable = { partyRewards = 1.2 } }
	}
	
	#Sanity Check
	if = {
		limit = { check_variable = { which = partyRewards which = highLootEstimate } }
		divide_variable = { partyRewards = 2 }
	}
	if = {
		limit = { check_variable = { partyRewards = 1000 } }
		set_variable = { partyRewards = 1000 }
	}
	if = {
		limit = { check_variable = { partySupplies = 100 } }
		set_variable = { partySupplies = 100 }
	}
	if = {
		limit = { check_variable = { partyManpower = 10000 } }
		set_variable = { partyManpower = 10000 }
	}
	if = {
		limit = { check_variable = { partyEffectiveness = 200 } }
		set_variable = { partyEffectiveness = 200 }
	}
	set_province_flag = generated_party_stats_@ROOT
}

generate_expedition = {
	hidden_effect = {
		if = {
			limit = { has_province_flag = generated_expedition }
		}
		else = {
			set_province_flag = generated_expedition
			
			set_variable = { nbFloor = 1 }
			set_variable = { clearedFloor = 0 }
			set_variable = { progressFloor = 0 }
			set_variable = { nbEncounters = 0 }
			set_variable = { dangerLevel = 1 } #1 = Bronze 2 = Silver 3 = Gold 4 = Platinum 5 = Mithril
			set_variable = { partyLoot = 0 }
			divide_variable = { partyManpower = 100 }
			multiply_variable = { partyManpower = 100 }
			set_variable = { partyRewards = 0 }
			set_variable = { partySupplies = 0 }
			set_variable = { partyManpower = 0 }
			generate_party_stats = yes
			
			#####################
			### Numbers of Floors
			#####################
			#Fixed Shit
			if = {
				limit = { region = tree_of_stone_region } 						# Expeditions are bigger and harder in this region
				change_variable = { nbFloor = 1 }
			}
			if = {
				limit = { has_terrain = dwarven_hold }							# Holds are deeper
				change_variable = { nbFloor = 2 }
			}
			if = {
				limit = { has_terrain = dwarven_hold_surface }					# Surface hold ar less deep
				change_variable = { nbFloor = 1 }
			}
			
			#Random Shit
			random = {
				chance = 50
				change_variable = { nbFloor = 1 }
			}
			random = {
				chance = 25
				change_variable = { nbFloor = 1 }
			}
			random_list = {
				50 = { }
				40 = { change_variable = { nbFloor = 1 } }
				10 = { change_variable = { nbFloor = 2 } }
			}
			
			random = {
				chance = 40
				multiply_variable = { nbFloor = 1.5 }
			}
			
			random = {
				chance = 25
				multiply_variable = { nbFloor = 1.5 }
			}
			random = {
				chance = 20
				multiply_variable = { nbFloor = 1.5 }
			}
			random = {
				chance = 15
				multiply_variable = { nbFloor = 1.5 }
			}
			
			if = {
				limit = { has_terrain = cavern }
				random = {
					chance = 80
					change_variable = { nbFloor = 1 }
				}
				random_list = {
					50 = { }
					40 = { multiply_variable = { nbFloor = 1.5 } }
					10 = { multiply_variable = { nbFloor = 2 } }
				}
			}
			
			if = {
				limit = { 
					OR = {
						has_terrain = dwarven_hold
						has_terrain = dwarven_hold_surface
					}
				}
				random = {
					chance = 50
					change_variable = { nbFloor = 1 }
				}
				random = {
					chance = 30
					change_variable = { nbFloor = 1 }
				}
				random = {
					chance = 20
					change_variable = { nbFloor = 1 }
				}
				random = {
					chance = 15
					change_variable = { nbFloor = 1 }
				}
			}
			
			#####################
			###   Danger Level
			#####################
			#Fixed Shit
			if = {
				limit = { region = tree_of_stone_region }						# Expeditions are bigger and harder in this region
				change_variable = { dangerLevel = 1 }
			}
			if = {
				limit = { has_terrain = dwarven_hold }							# Hold are dangerous
				change_variable = { dangerLevel = 1.5 }
			}
			else_if = {
				limit = { has_terrain = dwarven_hold_surface }					# Hold are dangerous
				change_variable = { dangerLevel = 1 }
			}
			else_if = {
				limit = { 
					has_terrain = cavern
					all_neighbor_province = { has_terrain = cavern }			# Deep Caverns are harder
				}
				change_variable = { dangerLevel = 1 }
			}
			
			if = {																# Expedition with dwarovkron gems are harder
				limit = { has_province_flag = seeded }
				change_variable = { dangerLevel = 1.5 }
			}
			
			#Random Shit
			if = {
				limit = { has_terrain = dwarven_hold }
				random = {
					chance = 50
					change_variable = { dangerLevel = 1 }
				}
			}
			else_if = {
				limit = { 
					has_terrain = cavern
					all_neighbor_province = { has_terrain = cavern }			# Deep Caverns are harder
				}
				random = {
					chance = 50
					change_variable = { dangerLevel = 1 }
				}
			}
			random = {
				chance = 45
				change_variable = { dangerLevel = 1 }
			}
			random = {
				chance = 15
				change_variable = { dangerLevel = 1 }
			}
			random = {
				chance = 10
				change_variable = { dangerLevel = 1 }
			}
			random_list = {
				60 = { }
				25 = { change_variable = { dangerLevel = 1 } }
				15 = { change_variable = { dangerLevel = 2 } }
			}
			
			random = {
				chance = 20
				multiply_variable = { dangerLevel = 1.5 }
			}
			random = {
				chance = 10
				multiply_variable = { dangerLevel = 1.5 }
			}
			random = {
				chance = 5
				multiply_variable = { dangerLevel = 1.5 }
			}
			
			# Khugdihr MT
			if = {
				limit = { has_province_flag = khug_expedition_2_created }
				set_variable = { dangerLevel = 5 } 
			}
			# Loot Estimate
			loot_estimate = yes
			
			#####################
			###  Sanity Checks
			#####################
			if = {
				limit = { check_variable = { nbFloor = 7 } }
				set_variable = { nbFloor = 7 }
			}
			if = {
				limit = { check_variable = { dangerLevel = 5 } }
				set_variable = { dangerLevel = 5 }
			}
			
			if = {
				limit = { check_variable = { partyMorale = 10 } }
				set_variable = { partyMorale = 10 }
			}
			if = {
				limit = { NOT = { check_variable = { partyMorale = 0 } } }
				set_variable = { partyMorale = 0 }
			}
			
			divide_variable = { nbFloor = 1000 }
			multiply_variable = { nbFloor = 1000 }
			
			divide_variable = { dangerLevel = 1000 }
			multiply_variable = { dangerLevel = 1000 }
			
			divide_variable = { partyEffectiveness = 1000 }
			multiply_variable = { partyEffectiveness = 1000 }
		}
	}
}

change_party_manpower = {
	[[add_tooltip]
		custom_tooltip = add_$add$_party_manpower_tooltip
	]
	[[remove_tooltip]
		custom_tooltip = remove_$loss$_party_manpower_tooltip
	]
	hidden_effect = {
		[[add_expedition]		# YOU SHOULD NEVER USE THAT ONE
			set_variable = { foo = 0 }
			while = {
				limit = {
					NOT = { check_variable = { foo = $add_expedition$ } }
					NOT = { check_variable = { partyManpower = 10000 } }
					infantry_in_province = 1
					infantry_in_province = owner
				}
				kill_units = { who = owner type = infantry amount = 1 }
				change_variable = { partyManpower = 1000 }
				change_variable = { foo = 1 }
			}
		]
		[[add] 					# USE THAT ONE FOR ENCOUNTER
			change_variable = { partyManpower = $add$ }
		]
		[[add_percent]			# If you want to add 10% manpower, do add_percent = 1.10
			multiply_variable = { partyManpower = $add_percent$ }
		]
		[[loss]
			subtract_variable = { partyManpower = $loss$ }
		]
		
		[[loss_percent]			# If you want to remove 10% manpower, do loss_percent = 0.10
			set_variable = { foo = 1 }
			subtract_variable = { foo = $loss_percent$ }
			multiply_variable = { which = partyManpower which = foo }
		]
		
		if = {
			limit = { NOT = { check_variable = { partyManpower = 0 } } }
			set_variable = { partyManpower = 0 }
		}
		
		divide_variable = { partyManpower = 1000 }
		multiply_variable = { partyManpower = 1000 }
	}
}

change_party_morale = {
	[[add_tooltip]
		custom_tooltip = add_$add$_party_morale_tooltip
	]
	[[remove_tooltip]
		custom_tooltip = remove_$loss$_party_morale_tooltip
	]
	hidden_effect = {
		[[add]
			change_variable = { partyMorale = $add$ }
		]
		[[loss]
			subtract_variable = { partyMorale = $loss$ }
		]
		if = {
			limit = { NOT = { check_variable = { partyMorale = 0 } } }
			set_variable = { partyMorale = 0 }
		}
		if = {
			limit = { check_variable = { partyMorale = 30 } }
			set_variable = { partyMorale = 30 }
		}
	}
}

change_party_effectiveness = {
	[[add_tooltip]
		custom_tooltip = add_$add$_party_effectiveness_tooltip
	]
	[[remove_tooltip]
		custom_tooltip = remove_$loss$_party_effectiveness_tooltip
	]
	hidden_effect = {
		[[add]
			change_variable = { partyEffectiveness = $add$ }
		]
		[[loss]
			subtract_variable = { partyEffectiveness = $loss$ }
		]
		divide_variable = { partyEffectiveness = 1000 }
		multiply_variable = { partyEffectiveness = 1000 }
		if = {
			limit = { check_variable = { partyEffectiveness = 200 } }
			set_variable = { partyEffectiveness = 200 }
		}
		if = {
			limit = { NOT = { check_variable = { partyEffectiveness = 0 } } }
			set_variable = { partyEffectiveness = 0 }
		}
	}
}

change_party_rewards = {
	[[add_tooltip]
		custom_tooltip = add_$add$_party_rewards_tooltip
	]
	[[remove_tooltip]
		custom_tooltip = remove_$loss$_party_rewards_tooltip
	]
	hidden_effect = {
		[[add]
			change_variable = { partyRewards = $add$ }
		]
		[[loss]
			subtract_variable = { partyRewards = $loss$ }
		]
		if = {
			limit = { check_variable = { partyRewards = 2000 } }
			set_variable = { partyRewards = 2000 }
		}
		if = {
			limit = { NOT = { check_variable = { partyRewards = 0 } } }
			set_variable = { partyRewards = 0 }
		}
	}
}

change_party_supplies = {
	[[add_tooltip]
		custom_tooltip = add_$add$_party_supplies_tooltip
	]
	[[remove_tooltip]
		custom_tooltip = remove_$loss$_party_supplies_tooltip
	]
	hidden_effect = {
		[[add]
			change_variable = { partySupplies = $add$ }
		]
		[[loss]
			subtract_variable = { partySupplies = $loss$ }
		]
		if = {
			limit = { check_variable = { partySupplies = 100 } }
			set_variable = { partySupplies = 100 }
		}
		if = {
			limit = { NOT = { check_variable = { partySupplies = 0 } } }
			set_variable = { partySupplies = 0 }
		}
	}
}

change_party_loot = {
	[[add_tooltip]
		custom_tooltip = add_$add$_party_loot_tooltip
	]
	[[remove_tooltip]
		custom_tooltip = remove_$loss$_party_loot_tooltip
	]
	hidden_effect = {
		[[add]
			change_variable = { partyLoot = $add$ }
		]
		[[loss]
			subtract_variable = { partyLoot = $loss$ }
		]
		if = {
			limit = { NOT = { check_variable = { partyLoot = 0 } } }
			set_variable = { partyLoot = 0 }
		}
	}
}

# If progress must be faster for OPM or other, lossSupplies and lossMorale MUST BE ADJUSTED TOO
# At 100 progress, you finish a floors
progress_advancement = {
	# OPM only
	if = {
		limit = { owner = { NOT = { num_of_cities = 2 } } }
		set_variable = { addProgress = 14 }		# ~7 months/floors at this rate, max ~4 years
		
		#Supplies
		set_variable = { lossSupplies = 1.95 }
		#Morale
		set_variable = { lossMorale = 0.17 }		#Need 8.4 morale at least to complete Floor 7
	}
	# Remnant Colonial option
	else_if = {
		limit = { owner = { has_country_modifier = remnant_colonial } }
		set_variable = { addProgress = 8 }	# ~12 months/floors at this rate, max ~7 years
		
		#Supplies
		set_variable = { lossSupplies = 1.11 }
		#Morale
		set_variable = { lossMorale = 0.12 }	#Need 10.5 morale at least to complete Floor 7
	}
	# Other dude
	else = {
		set_variable = { addProgress = 4.4 }	 # ~22 months/floors at this rate, max ~13 years
		
		#Supplies
		set_variable = { lossSupplies = 0.62 }
		#Morale
		set_variable = { lossMorale = 0.07 }	#Need 12.6 morale at least to complete Floor 7
	}
	
	# Supplies lost
	random = {
		chance = 20
		multiply_variable = { lossSupplies = 1.1 }
	}
	
	random = {
		chance = 20
		multiply_variable = { lossSupplies = 0.9 }
	}
	
	if = {
		limit = { owner = { ruler_has_personality = careful_personality } }
		
		random = {
			chance = 20
			multiply_variable = { lossSupplies = 0.9 }
		}
	}
	
	# Rewards Effects
	
	if = {
		limit = { check_variable = { partyRewards = 2000 } }
		multiply_variable = { lossMorale = 0.8 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 1900 } }
		multiply_variable = { lossMorale = 0.81 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 1800 } }
		multiply_variable = { lossMorale = 0.83 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 1700 } }
		multiply_variable = { lossMorale = 0.84 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 1600 } }
		multiply_variable = { lossMorale = 0.85 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 1500 } }
		multiply_variable = { lossMorale = 0.86 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 1400 } }
		multiply_variable = { lossMorale = 0.87 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 1300 } }
		multiply_variable = { lossMorale = 0.88 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 1200 } }
		multiply_variable = { lossMorale = 0.89 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 1100 } }
		multiply_variable = { lossMorale = 0.90 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 1000 } }
		multiply_variable = { lossMorale = 0.91 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 900 } }
		multiply_variable = { lossMorale = 0.92 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 800 } }
		multiply_variable = { lossMorale = 0.93 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 700 } }
		multiply_variable = { lossMorale = 0.94 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 600 } }
		multiply_variable = { lossMorale = 0.95 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 500 } }
		multiply_variable = { lossMorale = 0.96 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 400 } }
		multiply_variable = { lossMorale = 0.97 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 300 } }
		multiply_variable = { lossMorale = 0.98 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 200 } }
		multiply_variable = { lossMorale = 0.99 }
	}
	else_if = {
		limit = { check_variable = { partyRewards = 100 } }
		multiply_variable = { lossMorale = 1 }
	}
	
	#Attrition
	multiply_variable = { partyManpower = 0.999 }
	random = {
		chance = 15
		change_variable = { partyManpower = -2 }
	}
	
	#Starvation
	if = {
		limit = { NOT = { check_variable = { partySupplies = 0.1 } } }
		multiply_variable = { partyManpower = 0.80 }
		change_variable = { partyManpower = -500 }
	}
	
	#Low Morale/Desertion
	if = {
		limit = { NOT = { check_variable = { partyMorale = 0.1 } } }
		multiply_variable = { partyManpower = 0.85 }
		change_variable = { partyManpower = -200 }
	}
	
	#Lack of Organisation
	if = {
		limit = { NOT = { check_variable = { partyEffectiveness = 50 } } }
		multiply_variable = { partyManpower = 0.95 }
		change_variable = { partyManpower = -50 }
	}
	
	# Danger Random Losses
	random_list = {
		90 = { }
		10 = {
			modifier = { factor = 0 NOT = { check_variable = { dangerLevel = 2 } } }
			modifier = { factor = 0 check_variable = { dangerLevel = 3 } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 110 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 115 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 120 } } }
			random_list = {
				33 = { multiply_variable = { partyManpower = 0.99 } }
				33 = { multiply_variable = { lossSupplies = 1.01 } }
				33 = { multiply_variable = { lossMorale = 1.01 } }
			}
		}
		10 = {
			modifier = { factor = 0 NOT = { check_variable = { dangerLevel = 3 } } }
			modifier = { factor = 0 check_variable = { dangerLevel = 4 } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 125 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 130 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 135 } } }
			random_list = {
				33 = { multiply_variable = { partyManpower = 0.98 } }
				33 = { multiply_variable = { lossSupplies = 1.02 } }
				33 = { multiply_variable = { lossMorale = 1.02 } }
			}
		}
		10 = {
			modifier = { factor = 0 NOT = { check_variable = { dangerLevel = 4 } } }
			modifier = { factor = 0 check_variable = { dangerLevel = 5 } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 140 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 145 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 150 } } }
			random_list = {
				33 = { multiply_variable = { partyManpower = 0.97 } }
				33 = { multiply_variable = { lossSupplies = 1.03 } }
				33 = { multiply_variable = { lossMorale = 1.03 } }
			}
		}
		10 = {
			modifier = { factor = 0 NOT = { check_variable = { dangerLevel = 5 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 155 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 160 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 165 } } }
			random_list = {
				33 = { multiply_variable = { partyManpower = 0.97 } }
				33 = { multiply_variable = { lossSupplies = 1.03 } }
				33 = { multiply_variable = { lossMorale = 1.03 } }
			}
		}
	}
	
	# Random Progress
	random_list = {
		10 = {
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 45 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 50 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 55 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 60 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 65 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 70 } } }
			multiply_variable = { addProgress = 0.5 }
		}
		10 = {
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 75 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 80 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 85 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 90 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 95 } } }
			modifier = { factor = 1.5 NOT = { check_variable = { partyEffectiveness = 100 } } }
			multiply_variable = { addProgress = 0.75 }
		}
		50 = { }
		10 = {
			modifier = { factor = 0 NOT = { check_variable = { partyEffectiveness = 105 } } }
			modifier = { factor = 1.5 check_variable = { partyEffectiveness = 105 } }
			modifier = { factor = 1.5 check_variable = { partyEffectiveness = 110 } }
			modifier = { factor = 1.5 check_variable = { partyEffectiveness = 115 } }
			modifier = { factor = 1.5 check_variable = { partyEffectiveness = 120 } }
			modifier = { factor = 1.5 check_variable = { partyEffectiveness = 125 } }
			modifier = { factor = 1.5 check_variable = { partyEffectiveness = 130 } }
			multiply_variable = { addProgress = 1.25 }
		}
		10 = {
			modifier = { factor = 0 NOT = { check_variable = { partyEffectiveness = 135 } } }
			modifier = { factor = 2 check_variable = { partyEffectiveness = 135 } }
			modifier = { factor = 2 check_variable = { partyEffectiveness = 140 } }
			modifier = { factor = 2 check_variable = { partyEffectiveness = 145 } }
			modifier = { factor = 2 check_variable = { partyEffectiveness = 150 } }
			modifier = { factor = 2 check_variable = { partyEffectiveness = 155 } }
			modifier = { factor = 2 check_variable = { partyEffectiveness = 160 } }
			multiply_variable = { addProgress = 1.5 }
		}
		10 = {
			modifier = { factor = 0 NOT = { check_variable = { partyEffectiveness = 165 } } }
			modifier = { factor = 3 check_variable = { partyEffectiveness = 165 } }
			modifier = { factor = 3 check_variable = { partyEffectiveness = 170 } }
			modifier = { factor = 3 check_variable = { partyEffectiveness = 175 } }
			modifier = { factor = 3 check_variable = { partyEffectiveness = 180 } }
			modifier = { factor = 3 check_variable = { partyEffectiveness = 185 } }
			modifier = { factor = 3 check_variable = { partyEffectiveness = 190 } }
			multiply_variable = { addProgress = 1.75 }
		}
		1 = {
			modifier = { factor = 0 NOT = { check_variable = { partyEffectiveness = 195 } } }
			modifier = { factor = 7000 check_variable = { partyEffectiveness = 195 } }
			multiply_variable = { addProgress = 2 }
		}
	}
	
	# Misc shit
	if = {
		limit = { owner = { has_idea_group = exploration_ideas } }
		multiply_variable = { addProgress = 1.2 }
	}
	
	if = {
		limit = { owner = { has_age_ability = ab_dwarven_reclamation } }
		multiply_variable = { addProgress = 2 }
	}
	
	if = {
		limit = { owner = { NOT = { num_of_cities = 2 } } }
		random = {
			chance = 20
			change_party_effectiveness = { loss = 1 }
		}
	}
	else = {
		random = {
			chance = 7
			change_party_effectiveness = { loss = 1 }
		}
	}
	
	
	# Racial shit
	if = {
		limit = { owner = { NOT = { has_country_modifier = dwarven_administration } } }
		if = {
			limit = { owner = { OR = { has_country_modifier = goblin_administration has_country_modifier = kobold_administration } } }
			multiply_variable = { addProgress = 0.9 }
		}
		else = {
			multiply_variable = { addProgress = 0.8 }
		}
	}

	subtract_variable = { which = partyMorale which = lossMorale }
	subtract_variable = { which = partySupplies which = lossSupplies }
	change_variable = { which = progressFloor which = addProgress }
	
	#Sanity
	if = {
		limit = { NOT = { check_variable = { partyMorale = 0 } } }
		set_variable = { partyMorale = 0 }
	}
	if = {
		limit = { NOT = { check_variable = { partySupplies = 0 } } }
		set_variable = { partySupplies = 0 }
	}
	if = {
		limit = { NOT = { check_variable = { partyManpower = 0 } } }
		set_variable = { partyManpower = 0 }
	}
	else = {
		divide_variable = { partyManpower = 1000 }
		multiply_variable = { partyManpower = 1000 }
	}
}

set_adk_effect = {
	if = {
		limit = { check_variable = { dangerLevel = 5 } }
		random_list = {
			20 = { set_variable = { temp_adk = 3 } }
			60 = { set_variable = { temp_adk = 2 } }
			25 = { set_variable = { temp_adk = 1 } }
		}
	}
	else_if = {
		limit = { check_variable = { dangerLevel = 4 } }
		random_list = {
			10 = { set_variable = { temp_adk = 3 } }
			50 = { set_variable = { temp_adk = 2 } }
			40 = { set_variable = { temp_adk = 1 } }
			10 = { set_variable = { temp_adk = 0 } }
		}
	}
	else_if = {
		limit = { check_variable = { dangerLevel = 3 } }
		random_list = {
			5 = { set_variable = { temp_adk = 3 } }
			40 = { set_variable = { temp_adk = 2 } }
			55 = { set_variable = { temp_adk = 1 } }
			20 = { set_variable = { temp_adk = 0 } }
		}
	}
	else_if = {
		limit = { check_variable = { dangerLevel = 2 } }
		random_list = {
			1 = { set_variable = { temp_adk = 3 } }
			30 = { set_variable = { temp_adk = 2 } }
			69 = { set_variable = { temp_adk = 1 } }
			30 = { set_variable = { temp_adk = 0 } }
		}
	}
	else = {
		random_list = {
			1 = { set_variable = { temp_adk = 3 } }
			20 = { set_variable = { temp_adk = 2 } }
			79 = { set_variable = { temp_adk = 1 } }
			40 = { set_variable = { temp_adk = 0 } }
		}
	}
}

add_adk_effect = {
	custom_tooltip = gain_$add$_adk_tooltip
	hidden_effect = {
		change_variable = { ancientDwarvenKnowledge = $add$ }
		divide_variable = { ancientDwarvenKnowledge = 1000 }
		multiply_variable = { ancientDwarvenKnowledge = 1000 }
	}
}

increase_remnant_faction_readiness = {
	[[Dig]
		custom_tooltip = increase_readiness_dig_$size$
		increase_remnant_faction_readiness_helper = { $size$ = yes remFact = Dig }
	]
	[[Army]
		custom_tooltip = increase_readiness_army_$size$
		increase_remnant_faction_readiness_helper = { $size$ = yes remFact = Army }
	]
	[[Colonial]
		custom_tooltip = increase_readiness_colonial_$size$
		increase_remnant_faction_readiness_helper = { $size$ = yes remFact = Colonial }
	]
}

increase_remnant_faction_readiness_helper = {
	hidden_effect = {
		[[small]
			change_variable = { awakening$remFact$ = 5 }
		]
		[[normal]
			change_variable = { awakening$remFact$ = 7.5 }
		]
		[[big]
			change_variable = { awakening$remFact$ = 10 }
		]
	}
}

increase_remnant_react = {
	hidden_effect = {
		[[small]
			change_variable = { awakeningReact = 5 }
		]
		[[normal]
			change_variable = { awakeningReact = 10 }
		]
		[[big]
			change_variable = { awakeningReact = 15 }
		]
		if = {
			limit = { check_variable = { awakeningReact = 100 } }
			country_event = { id = diggy_remnant_stagnation.3 }
		}
	}
}

add_loot_effect = {
	set_variable = { addLoot = 75 }
	if = {
		limit = { is_variable_equal = { which = clearedFloor value = 1 } }
		change_variable = { addLoot = 10 }
		random = {
			chance = 25
			change_variable = { addLoot = 10 }
		}
	}
	else_if = {
		limit = { is_variable_equal = { which = clearedFloor value = 2 } }
		change_variable = { addLoot = 20 }
		random = {
			chance = 25
			change_variable = { addLoot = 20 }
		}
	}
	else_if = {
		limit = { is_variable_equal = { which = clearedFloor value = 3 } }
		change_variable = { addLoot = 30 }
		random = {
			chance = 25
			change_variable = { addLoot = 30 }
		}
	}
	else_if = {
		limit = { is_variable_equal = { which = clearedFloor value = 4 } }
		change_variable = { addLoot = 40 }
		random = {
			chance = 25
			change_variable = { addLoot = 40 }
		}
	}
	else_if = {
		limit = { is_variable_equal = { which = clearedFloor value = 5 } }
		change_variable = { addLoot = 50 }
		random = {
			chance = 25
			change_variable = { addLoot = 50 }
		}
	}
	else_if = {
		limit = { is_variable_equal = { which = clearedFloor value = 6 } }
		change_variable = { addLoot = 60 }
		random = {
			chance = 25
			change_variable = { addLoot = 60 }
		}
	}
	if = {
		limit = { has_terrain = dwarven_hold }
		change_variable = { addLoot = 50 }
	}
	if = {
		limit = { has_terrain = dwarven_hold_surface }
		change_variable = { addLoot = 25 }
	}
	if = {
		limit = { check_variable = { dangerLevel = 5 } }
		change_variable = { addLoot = 175 }
		random = {
			chance = 50
			change_variable = { addLoot = 25 }
		}
		random = {
			chance = 25
			change_variable = { addLoot = 50 }
		}
		random = {
			chance = 50
			subtract_variable = { addLoot = 50 }
		}
	}
	else_if = {
		limit = { check_variable = { dangerLevel = 4 } }
		change_variable = { addLoot = 150 }
		random = {
			chance = 50
			change_variable = { addLoot = 20 }
		}
		random = {
			chance = 25
			change_variable = { addLoot = 40 }
		}
		random = {
			chance = 50
			subtract_variable = { addLoot = 40 }
		}
	}
	else_if = {
		limit = { check_variable = { dangerLevel = 3 } }
		change_variable = { addLoot = 125 }
		random = {
			chance = 50
			change_variable = { addLoot = 15 }
		}
		random = {
			chance = 25
			change_variable = { addLoot = 30 }
		}
		random = {
			chance = 50
			subtract_variable = { addLoot = 30 }
		}
	}
	else_if = {
		limit = { check_variable = { dangerLevel = 2 } }
		change_variable = { addLoot = 100 }
		random = {
			chance = 50
			change_variable = { addLoot = 10 }
		}
		random = {
			chance = 25
			change_variable = { addLoot = 20 }
		}
		random = {
			chance = 50
			subtract_variable = { addLoot = 20 }
		}
	}
	else = {
		change_variable = { addLoot = 75 }
		random = {
			chance = 50
			change_variable = { addLoot = 5 }
		}
		random = {
			chance = 25
			change_variable = { addLoot = 10 }
		}
		random = {
			chance = 50
			subtract_variable = { addLoot = 10 }
		}
	}
	change_variable = { which = partyLoot which = addLoot }
}

loot_estimate = {
	if = {
		limit = { check_variable = { dangerLevel = 5 } }
		set_variable = { lowLootEstimate = 200 }
	}
	else_if = {
		limit = { check_variable = { dangerLevel = 4 } }
		set_variable = { lowLootEstimate = 175 }
	}
	else_if = {
		limit = { check_variable = { dangerLevel = 3 } }
		set_variable = { lowLootEstimate = 150 }
	}
	else_if = {
		limit = { check_variable = { dangerLevel = 2 } }
		set_variable = { lowLootEstimate = 125 }
	}
	else = {
		set_variable = { lowLootEstimate = 100 }
	}
	
	multiply_variable = { which = lowLootEstimate which = nbFloor }
	random_list = {
		30 = { multiply_variable = { lowLootEstimate = 1.3 } }
		30 = { multiply_variable = { lowLootEstimate = 0.7 } }
		30 = { multiply_variable = { lowLootEstimate = 1.2 } }
		30 = { multiply_variable = { lowLootEstimate = 0.8 } }
	}
	random = {
		chance = 50
		change_variable = { lowLootEstimate = 150 }
	}
	random = {
		chance = 50
		subtract_variable = { lowLootEstimate = 150 }
	}
	
	set_variable = { which = highLootEstimate which = lowLootEstimate }
	multiply_variable = { highLootEstimate = 2 }
	
	random_list = {
		30 = { multiply_variable = { highLootEstimate = 1.3 } }
		30 = { multiply_variable = { highLootEstimate = 0.7 } }
		30 = { multiply_variable = { highLootEstimate = 1.2 } }
		30 = { multiply_variable = { highLootEstimate = 0.8 } }
	}
	random = {
		chance = 50
		change_variable = { highLootEstimate = 150 }
	}
	random = {
		chance = 50
		subtract_variable = { highLootEstimate = 150 }
	}
	
	# Trim
	
	divide_variable = { lowLootEstimate = 1000 }
	multiply_variable = { lowLootEstimate = 1000 }
	
	divide_variable = { highLootEstimate = 1000 }
	multiply_variable = { highLootEstimate = 1000 }
}

clear_expedition_effect = {
	set_variable = { nbFloor = 0 }
	set_variable = { clearedFloor = 0 }
	set_variable = { progressFloor = 0 }
	set_variable = { nbEncounters = 0 }
	set_variable = { dangerLevel = 0 }
	set_variable = { partyEffectiveness = 0 }
	set_variable = { partyManpower = 0 }
	set_variable = { partyRewards = 0 }
	set_variable = { partySupplies = 0 }
	set_variable = { partyManpower = 0 }
	set_variable = { partyLoot = 0 }
	set_variable = { addLoot = 0 }
	set_variable = { lossMorale = 0 }
	set_variable = { lossSupplies = 0 }
	set_variable = { addProgress = 0 }
	set_variable = { cashLoot = 0 }
	set_variable = { manaLoot = 0 }
	set_variable = { foo = 0 }
	set_variable = { ancientDwarvenKnowledge = 0 }
	set_variable = { temp_adk = 0 }
	
	clr_province_flag = sent_expedition_@owner
	clr_province_flag = expedition_in_progress
	clr_province_flag = generated_party_stats_@ROOT
	clr_province_flag = generated_expedition
	owner = { clr_country_flag = expedition_happening }
	
	#Encounter flags
	clr_province_flag = encounter_drunk_dwarf
	clr_province_flag = encounter_mushroom_people
	clr_province_flag = encounter_friendly_slimes
	clr_province_flag = encounter_remnant_camp
	clr_province_flag = encounter_bugbears
	#Expedition reward flags
	clr_province_flag = expedition_big_vein
	clr_province_flag = expedition_mages_happy
	clr_province_flag = expedition_mages_unhappy
	clr_province_flag = expedition_dwarf_colonists_join
	clr_province_flag = expedition_slime_colony
	clr_province_flag = expedition_remnant_dev
	clr_province_flag = expedition_bugbear_tribe
	REB = { subtract_variable = { nbExpedition = 1 } }
}

expedition_dead_effect = {
	set_variable = { clearedFloor = 0 }
	set_variable = { progressFloor = 0 }
	set_variable = { partyEffectiveness = 0 }
	set_variable = { partyManpower = 0 }
	set_variable = { partyRewards = 0 }
	set_variable = { partySupplies = 0 }
	set_variable = { partyManpower = 0 }
	set_variable = { partyLoot = 0 }
	set_variable = { addLoot = 0 }
	set_variable = { lossMorale = 0 }
	set_variable = { lossSupplies = 0 }
	set_variable = { addProgress = 0 }
	set_variable = { cashLoot = 0 }
	set_variable = { manaLoot = 0 }
	set_variable = { foo = 0 }
	set_variable = { ancientDwarvenKnowledge = 0 }
	set_variable = { temp_adk = 0 }
	
	clr_province_flag = sent_expedition_@owner
	clr_province_flag = expedition_in_progress
	clr_province_flag = generated_party_stats_@ROOT
	owner = { clr_country_flag = expedition_happening }
	
	#Encounter flags
	clr_province_flag = encounter_drunk_dwarf
	clr_province_flag = encounter_mushroom_people
	clr_province_flag = encounter_friendly_slimes
	clr_province_flag = encounter_remnant_camp
	clr_province_flag = encounter_bugbears
	#Expedition reward flags
	clr_province_flag = expedition_big_vein
	clr_province_flag = expedition_mages_happy
	clr_province_flag = expedition_mages_unhappy
	clr_province_flag = expedition_dwarf_colonists_join
	clr_province_flag = expedition_slime_colony
	clr_province_flag = expedition_remnant_dev
	clr_province_flag = expedition_bugbear_tribe
}

currency_effect_expedition = { #currency (#takeFrom) #addTo #which/value
	hidden_effect = {
[[mana]
		set_variable = { which = foo which = manaLoot }
]
[[cash]
		set_variable = { which = foo which = cashLoot }
]
		if = {
			limit = {
				check_variable = { which = foo value = 0 }
			}
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=while val=819.2 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=409.6 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=204.8 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=102.4 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=51.2 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=25.6 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=12.8 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=6.4 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=3.2 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=1.6 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=0.8 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=0.4 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=0.2 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=0.1 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=0.05 }
			currency_helper_expedition = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=0.025 }
		}
		else = {
			multiply_variable = { which = foo value = -1 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=while val=819.2 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=409.6 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=204.8 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=102.4 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=51.2 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=25.6 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=12.8 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=6.4 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=3.2 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=1.6 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=0.8 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=0.4 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=0.2 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=0.1 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=0.05 }
			currency_helper_expedition = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=0.025 }
		}
		set_variable = { which = foo value = 0 }
	}
}
currency_helper_expedition = {
	$type$ = {
		limit = {
			check_variable = { which = foo value = $val$ }
		}
		subtract_variable = { which = foo value = $val$ }
[[addTo]
		$addTo$ = { add_$currency$ = $val$ }
]
[[takeFrom]
		$takeFrom$ = { add_$currency$ = -$val$ }
]
	}
}

continue_expedition = {
	hidden_effect = { province_event = { id = diggy_expedition.2000 days = 30 } }
}

# This shit if for special rewards, like modifiers and other shit like that.
# This trigger at the end of the expeditions.
special_reward_expedition = {
	
	# Militarisation
	
	if = {
		limit = { owner = { NOT = { num_of_cities = 2 } } }
		if = {
			limit = { check_variable = { dangerLevel = 5 } }
			owner = { add_militarised_society = 25 }
		}
		else_if = {
			limit = { check_variable = { dangerLevel = 4 } }
			owner = { add_militarised_society = 20 }
		}
		else_if = {
			limit = { check_variable = { dangerLevel = 3 } }
			owner = { add_militarised_society = 15 }
		}
		else_if = {
			limit = { check_variable = { dangerLevel = 2 } }
			owner = { add_militarised_society = 10 }
		}
		else_if = {
			limit = { check_variable = { dangerLevel = 1 } }
			owner = { add_militarised_society = 5 }
		}
	}
	else = {
		if = {
			limit = { check_variable = { dangerLevel = 5 } }
			owner = { add_militarised_society = 12.5 }
		}
		else_if = {
			limit = { check_variable = { dangerLevel = 4 } }
			owner = { add_militarised_society = 10 }
		}
		else_if = {
			limit = { check_variable = { dangerLevel = 3 } }
			owner = { add_militarised_society = 7.5 }
		}
		else_if = {
			limit = { check_variable = { dangerLevel = 2 } }
			owner = { add_militarised_society = 5 }
		}
		else_if = {
			limit = { check_variable = { dangerLevel = 1 } }
			owner = { add_militarised_society = 2.5 }
		}
	}
	
	# Ancient Dwarven Knowledge
	if = {
		limit = { check_variable = { ancientDwarvenKnowledge = 1 } }
		custom_tooltip = add_adk_tooltip
		hidden_effect = {
			owner = { change_variable = { which = ancientDwarvenKnowledge which = PREV } }
		}
	}
	
	# Prestige
	if = {
		limit = { check_variable = { dangerLevel = 5 } }
		owner = { add_prestige_excess_to_splendour_effect = { VAL = 25 } }
	}
	else_if = {
		limit = { check_variable = { dangerLevel = 4 } }
		owner = { add_prestige_excess_to_splendour_effect = { VAL = 15 } }
	}
	else_if = {
		limit = { check_variable = { dangerLevel = 3 } }
		owner = { add_prestige_excess_to_splendour_effect = { VAL = 10 } }
	}
	else_if = {
		limit = { check_variable = { dangerLevel = 2 } }
		owner = { add_prestige_excess_to_splendour_effect = { VAL = 5 } }
	}
	else = {
		owner = { add_prestige_excess_to_splendour_effect = { VAL = 2.5 } }
	}
	
	#Dwarovkron
	if = {
		limit = { has_province_flag = dwarovkron_amethyst }
		hidden_effect = { clr_province_flag = dwarovkron_amethyst clr_province_flag = seeded }
		owner = {
			hidden_effect = {
				add_country_modifier = {
					name = dwarovkron_amethyst
					duration = -1
				}
				capital_scope = { set_province_flag = dwarovkron_amethyst }
			}
			country_event = { id = diggy.71 }
		}
	}
	if = {
		limit = { has_province_flag = dwarovkron_diamond }
		hidden_effect = { clr_province_flag = dwarovkron_diamond clr_province_flag = seeded }
		owner = {
			hidden_effect = {
				add_country_modifier = {
					name = dwarovkron_diamond
					duration = -1
				}
				capital_scope = { set_province_flag = dwarovkron_diamond }
			}
			country_event = { id = diggy.72 }
		}
	}
	if = {
		limit = { has_province_flag = dwarovkron_citrine }
		hidden_effect = { clr_province_flag = dwarovkron_citrine clr_province_flag = seeded }
		owner = {
			hidden_effect = {
				add_country_modifier = {
					name = dwarovkron_citrine
					duration = -1
				}
				capital_scope = { set_province_flag = dwarovkron_citrine }
			}
			country_event = { id = diggy.73 }
		}
	}
	if = {
		limit = { has_province_flag = dwarovkron_ruby }
		hidden_effect = { clr_province_flag = dwarovkron_ruby clr_province_flag = seeded }
		owner = {
			hidden_effect = {
				add_country_modifier = {
					name = dwarovkron_ruby
					duration = -1
				}
				capital_scope = { set_province_flag = dwarovkron_ruby }
			}
			country_event = { id = diggy.74 }
		}
	}

	#Encounters
	if = {
		limit = { 
			AND = {
				has_province_flag = expedition_mages_happy
				owner = { has_estate = estate_mages }
			}
		}
		owner = { add_estate_loyalty = { estate = estate_mages loyalty = 10 } }
	}
	if = {
		limit = { 
			AND = {
				has_province_flag = expedition_mages_unhappy
				owner = { has_estate = estate_mages }
			}
		}
		owner = { add_estate_loyalty = { estate = estate_mages loyalty = -10 } }
	}
	if = {
		limit = { 
			AND = {
				has_province_flag = expedition_big_vein
				OR = {
					trade_goods = iron
					trade_goods = copper
					trade_goods = gold
					trade_goods = mithril
					trade_goods = gems
				}
			}
		}
		add_permanent_province_modifier = { name = expedition_big_vein_modifier duration = -1 }
	}
	if = {
		limit = { has_province_flag = expedition_dwarf_colonists_join }
		owner = {
			random_owned_province = {
				limit = { province_group = hold_province }
				random_list = {
					33 = { add_base_tax = 2 }
					33 = { add_base_production = 2 }
					33 = { add_base_manpower = 2 }
				}
			}
		}
	}
	if = {
		limit = { has_province_flag = expedition_slime_colony }
		add_permanent_province_modifier = { name = expedition_slime_colony_modifier duration = -1 }
	}
	

	if = {
		limit = { has_province_flag = expedition_remnant_dev }
		if = {
			limit = { province_group = hold_province }
			add_base_tax = 2
			add_base_production = 2
			add_base_manpower = 2
			add_local_autonomy = 80
		}
		else = {
			add_base_tax = 3
			add_base_production = 2
			add_base_manpower = 3
			add_local_autonomy = 50
		}
	}
	if = {
		limit = { has_province_flag = expedition_bugbear_tribe }
		add_permanent_province_modifier = { name = expedition_bugbear_tribe_modifier duration = -1 }
	}

	# Khugdihr MT
	if = {
		limit = { has_province_flag = khug_expedition_1_created }
		owner = { country_event = { id = flavour_khug.16 } }
	}
	if = {
		limit = { has_province_flag = khug_expedition_2_created }
		owner = { country_event = { id = flavour_khug.5 } }
	}
}

##########################
### Encounter Tutorial ###
##########################

# REQUIRED
# base_success = Success chance of the good option [Required]
# added_success_modifier = If you want to add any modifier to the success chance [Optional]
# success_id = The id number of the event you want to launch for the good option [Required]
#
# REQUIRED
# base_failure = Success chance of the failure option [Required]
# added_failure_modifier = If you want to add any modifier to the failure chance [Optional]
# failure_id = The id number of the event you want to launch for the bad option [Required]
#
# OPTIONAL
# special_option = Success chance of the special option [Required]
# special_modifier = Modifier of the special success chance [Optional]
# special_id = The id number of the event you want to launch for the bad option [Required]
# special_trigger = Trigger for the special option to appear [Optional]
#
# OPTIONAL
# special_option_2 = Success chance of the special option [Required]
# special_modifier_2 = Modifier of the special success chance [Optional]
# special_id_2 = The id number of the event you want to launch for the bad option [Required]
# special_trigger_2 = Trigger for the special option to appear [Optional]

# Some example
# encounter_effect = {
# 	base_success = 80
# 	success_id = 51
# 	
# 	base_failure = 20
# 	added_failure_modifier = " modifier = { factor = 5 owner = { NOT = { MIL = 6 } } } "
# 	failure_id = 52
# }
#
# encounter_effect = {
# 	base_success = 50
# 	added_success_modifier = "
# 		modifier = { factor = 2 check_variable = { partyMorale = 10 } }
# 		modifier = { factor = 2 check_variable = { partyMorale = 15 } }
# 	"
# 	success_id = 71
# 	
# 	base_failure = 50
# 	failure_id = 72
# 	
# 	special_option = 50
# 	special_modifier = "
# 		modifier = { factor = 1.2 check_variable = { partyEffectiveness = 105 } }
# 		modifier = { factor = 1.2 check_variable = { partyEffectiveness = 110 } }
# 		modifier = { factor = 1.2 check_variable = { partyEffectiveness = 115 } }
# 		modifier = { factor = 1.2 check_variable = { partyEffectiveness = 120 } }
# 	"
# 	special_trigger = " trigger = { check_variable = { partyEffectiveness = 145 } } "
# 	special_id = 73
# }
# GDOC Tutorial: https://docs.google.com/document/d/1URD8a9Ma1hLpcbwris1W6X-r5iwCpnZQKgoBy0g7jU4/edit?usp=sharing

encounter_effect = {
	random_list = {
		#Success
		$base_success$ = {
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 105 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 110 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 115 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 120 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 125 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 130 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 135 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 135 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 140 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 145 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 150 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 155 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 160 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 165 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 170 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 175 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 180 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 185 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 190 } }
			modifier = { factor = 1.2 check_variable = { partyEffectiveness = 195 } }
			#Racial shit
			modifier = { factor = 1.2 owner = { has_country_modifier = kobold_administration } has_terrain = cavern }
			modifier = { factor = 1.2 owner = { has_country_modifier = goblin_administration } has_terrain = cavern }
			modifier = { factor = 1.2 owner = { has_country_modifier = dwarven_administration } OR = { has_terrain = dwarven_hold has_terrain = dwarven_hold_surface } }
			[[added_success_modifier]
				$added_success_modifier$
			]
			
			province_event = { id = diggy_encounter.$success_id$ }
		}
		#Failure
		$base_failure$ = {
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 100 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 95 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 90 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 85 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 80 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 75 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 70 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 65 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 60 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 55 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 50 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 45 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 40 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 35 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 30 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 25 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 20 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 15 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 10 } } }
			modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 5 } } }
			modifier = { factor = 100 NOT = { check_variable = { partyEffectiveness = 1 } } }
			modifier = { factor = 1.2 check_variable = { dangerLevel = 2 } }
			modifier = { factor = 1.2 check_variable = { dangerLevel = 3 } }
			modifier = { factor = 1.2 check_variable = { dangerLevel = 4 } }
			modifier = { factor = 1.2 check_variable = { dangerLevel = 5 } }
			[[added_failure_modifier]
				$added_failure_modifier$
			]
			
			province_event = { id = diggy_encounter.$failure_id$ }
		}
		#Special
		[[special_option]
			$special_option$ = {
				$special_trigger$
				$special_modifier$
				$special_event$
			}
		]
		
		[[special_option_2]
			$special_option_2$ = {
				$special_trigger_2$
				$special_modifier_2$
				$special_event_2$
			}
		]
	}
}


# This where other type of encounter should be added for other type of expedition.
# The province_event linked should be the controller event of all the other expedition. Look at DiggyDiggyEncounters.txt for more information, or https://docs.google.com/document/d/1URD8a9Ma1hLpcbwris1W6X-r5iwCpnZQKgoBy0g7jU4/edit?usp=sharing
launch_encounter = {
	if = {
		limit = { continent = serpentspine }
		province_event = { id = diggy_encounter.0 }
	}
}

define_hold_to_duel = {
	random_owned_province = {
		limit = { has_province_modifier = infested_hold NOT = { has_province_flag = duel_@ROOT province_id = 4218 province_id = 4147 } }
		set_province_flag = option_duel_1_@ROOT
		set_province_flag = duel_@ROOT
		save_event_target_as = duel1
	}
	random_owned_province = {
		limit = { has_province_modifier = infested_hold NOT = { has_province_flag = duel_@ROOT province_id = 4218 province_id = 4147 } }
		set_province_flag = option_duel_2_@ROOT
		set_province_flag = duel_@ROOT
		save_event_target_as = duel2
	}
	random_owned_province = {
		limit = { has_province_modifier = infested_hold NOT = { has_province_flag = duel_@ROOT province_id = 4218 province_id = 4147 } }
		set_province_flag = option_duel_3_@ROOT
		set_province_flag = duel_@ROOT
		save_event_target_as = duel3
	}
	random_owned_province = {
		limit = { has_province_modifier = infested_hold NOT = { has_province_flag = duel_@ROOT province_id = 4218 province_id = 4147 } }
		set_province_flag = option_duel_4_@ROOT
		set_province_flag = duel_@ROOT
		save_event_target_as = duel4
	}
}

define_hold_to_plunder = {
	random_owned_province = {
		limit = { OR = { has_terrain = dwarven_hold has_terrain = dwarven_hold_surface } is_core = ROOT is_capital = no NOT = { has_province_flag = plunder_@ROOT has_province_modifier = blorc_plunder_camp has_province_modifier = infested_hold } }
		set_province_flag = option_plunder_1_@ROOT
		set_province_flag = plunder_@ROOT
		save_event_target_as = blorc_plunder1
	}
	random_owned_province = {
		limit = { OR = { has_terrain = dwarven_hold has_terrain = dwarven_hold_surface } is_core = ROOT  is_capital = no NOT = { has_province_flag = plunder_@ROOT has_province_modifier = blorc_plunder_camp has_province_modifier = infested_hold } }
		set_province_flag = option_plunder_2_@ROOT
		set_province_flag = plunder_@ROOT
		save_event_target_as = blorc_plunder2
	}
	random_owned_province = {
		limit = { OR = { has_terrain = dwarven_hold has_terrain = dwarven_hold_surface } is_core = ROOT is_capital = no NOT = { has_province_flag = plunder_@ROOT has_province_modifier = blorc_plunder_camp has_province_modifier = infested_hold } }
		set_province_flag = option_plunder_3_@ROOT
		set_province_flag = plunder_@ROOT
		save_event_target_as = blorc_plunder3
	}
	random_owned_province = {
		limit = { OR = { has_terrain = dwarven_hold has_terrain = dwarven_hold_surface } is_core = ROOT is_capital = no NOT = { has_province_flag = plunder_@ROOT has_province_modifier = blorc_plunder_camp has_province_modifier = infested_hold } }
		set_province_flag = option_plunder_4_@ROOT
		set_province_flag = plunder_@ROOT
		save_event_target_as = blorc_plunder4
	}
	random_owned_province = {
		limit = { OR = { has_terrain = dwarven_hold has_terrain = dwarven_hold_surface } is_core = ROOT is_capital = no NOT = { has_province_flag = plunder_@ROOT has_province_modifier = blorc_plunder_camp has_province_modifier = infested_hold } }
		set_province_flag = option_plunder_5_@ROOT
		set_province_flag = plunder_@ROOT
		save_event_target_as = blorc_plunder5
	}
	random_owned_province = {
		limit = { OR = { has_terrain = dwarven_hold has_terrain = dwarven_hold_surface } is_core = ROOT is_capital = no NOT = { has_province_flag = plunder_@ROOT has_province_modifier = blorc_plunder_camp has_province_modifier = infested_hold } }
		set_province_flag = option_plunder_6_@ROOT
		set_province_flag = plunder_@ROOT
		save_event_target_as = blorc_plunder6
	}
	random_owned_province = {
		limit = { OR = { has_terrain = dwarven_hold has_terrain = dwarven_hold_surface } is_core = ROOT is_capital = no NOT = { has_province_flag = plunder_@ROOT has_province_modifier = blorc_plunder_camp has_province_modifier = infested_hold } }
		set_province_flag = option_plunder_7_@ROOT
		set_province_flag = plunder_@ROOT
		save_event_target_as = blorc_plunder7
	}
	random_owned_province = {
		limit = { OR = { has_terrain = dwarven_hold has_terrain = dwarven_hold_surface } is_core = ROOT is_capital = no NOT = { has_province_flag = plunder_@ROOT has_province_modifier = blorc_plunder_camp has_province_modifier = infested_hold } }
		set_province_flag = option_plunder_8_@ROOT
		set_province_flag = plunder_@ROOT
		save_event_target_as = blorc_plunder8
	}
	random_owned_province = {
		limit = { OR = { has_terrain = dwarven_hold has_terrain = dwarven_hold_surface } is_core = ROOT is_capital = no NOT = { has_province_flag = plunder_@ROOT has_province_modifier = blorc_plunder_camp has_province_modifier = infested_hold } }
		set_province_flag = option_plunder_9_@ROOT
		set_province_flag = plunder_@ROOT
		save_event_target_as = blorc_plunder9
	}
	random_owned_province = {
		limit = { OR = { has_terrain = dwarven_hold has_terrain = dwarven_hold_surface } is_core = ROOT is_capital = no NOT = { has_province_flag = plunder_@ROOT has_province_modifier = blorc_plunder_camp has_province_modifier = infested_hold } }
		set_province_flag = option_plunder_10_@ROOT
		set_province_flag = plunder_@ROOT
		save_event_target_as = blorc_plunder10
	}
}

seed_dwarovkron = {
	random_province = {
		limit = { NOT = { has_province_flag = seeded } continent = serpentspine has_province_modifier = expedition_target }
		set_province_flag = dwarovkron_amethyst
		set_province_flag = seeded
	}
	
	random_province = {
		limit = { NOT = { has_province_flag = seeded } region = serpentreach_region has_province_modifier = expedition_target }
		set_province_flag = dwarovkron_diamond
		set_province_flag = seeded
	}
	
	random_province = {
		limit = { NOT = { has_province_flag = seeded } region = middle_dwarovar_region has_province_modifier = expedition_target }
		set_province_flag = dwarovkron_citrine
		set_province_flag = seeded
	}
	
	random_province = {
		limit = { NOT = { has_province_flag = seeded } region = west_dwarovar_region has_province_modifier = expedition_target }
		set_province_flag = dwarovkron_ruby
		set_province_flag = seeded
	}
	
	4311 = { #Gronstunad
		set_province_flag = dwarovkron_jade
		owner = { 
			add_country_modifier = {
				name = dwarovkron_jade
				duration = -1
			}
			country_event = {
				id = diggy.75
				days = 2
			}
		}
	}
	
	2973 = { #Ovdal Lodhum
		set_province_flag = dwarovkron_sapphire
		owner = { 
			add_country_modifier = {
				name = dwarovkron_sapphire
				duration = -1
			}
			country_event = {
				id = diggy.76
				days = 2
			}
		}
	}
	
	4119 = { #Amldihr
		set_province_flag = dwarovkron_crown
		owner = { 
			add_country_modifier = {
				name = dwarovkron_crown
				duration = -1
			}
			country_event = {
				id = diggy.70
				days = 2
			}
		}
	}
}

spawn_dungeon_effect = {
	trigger_switch = {
		on_trigger = province_id
		4125 = { $origin$ = { move_great_project = { type = $type$  province = 4125 instant = $instant$ } } }
		4129 = { $origin$ = { move_great_project = { type = $type$  province = 4129 instant = $instant$ } } }
		4123 = { $origin$ = { move_great_project = { type = $type$  province = 4123 instant = $instant$ } } }
		4142 = { $origin$ = { move_great_project = { type = $type$  province = 4142 instant = $instant$ } } }
		4131 = { $origin$ = { move_great_project = { type = $type$  province = 4131 instant = $instant$ } } }
		4143 = { $origin$ = { move_great_project = { type = $type$  province = 4143 instant = $instant$ } } }
		4158 = { $origin$ = { move_great_project = { type = $type$  province = 4158 instant = $instant$ } } }
		4151 = { $origin$ = { move_great_project = { type = $type$  province = 4151 instant = $instant$ } } }
		4152 = { $origin$ = { move_great_project = { type = $type$  province = 4152 instant = $instant$ } } }
		4166 = { $origin$ = { move_great_project = { type = $type$  province = 4166 instant = $instant$ } } }
		4164 = { $origin$ = { move_great_project = { type = $type$  province = 4164 instant = $instant$ } } }
		4145 = { $origin$ = { move_great_project = { type = $type$  province = 4145 instant = $instant$ } } }
		4194 = { $origin$ = { move_great_project = { type = $type$  province = 4194 instant = $instant$ } } }
		4192 = { $origin$ = { move_great_project = { type = $type$  province = 4192 instant = $instant$ } } }
		4193 = { $origin$ = { move_great_project = { type = $type$  province = 4193 instant = $instant$ } } }
		4195 = { $origin$ = { move_great_project = { type = $type$  province = 4195 instant = $instant$ } } }
		4197 = { $origin$ = { move_great_project = { type = $type$  province = 4197 instant = $instant$ } } }
		4196 = { $origin$ = { move_great_project = { type = $type$  province = 4196 instant = $instant$ } } }
		4199 = { $origin$ = { move_great_project = { type = $type$  province = 4199 instant = $instant$ } } }
		4198 = { $origin$ = { move_great_project = { type = $type$  province = 4198 instant = $instant$ } } }
		4201 = { $origin$ = { move_great_project = { type = $type$  province = 4201 instant = $instant$ } } }
		4202 = { $origin$ = { move_great_project = { type = $type$  province = 4202 instant = $instant$ } } }
		4200 = { $origin$ = { move_great_project = { type = $type$  province = 4200 instant = $instant$ } } }
		4190 = { $origin$ = { move_great_project = { type = $type$  province = 4190 instant = $instant$ } } }
		4191 = { $origin$ = { move_great_project = { type = $type$  province = 4191 instant = $instant$ } } }
		4189 = { $origin$ = { move_great_project = { type = $type$  province = 4189 instant = $instant$ } } }
		4183 = { $origin$ = { move_great_project = { type = $type$  province = 4183 instant = $instant$ } } }
		4182 = { $origin$ = { move_great_project = { type = $type$  province = 4182 instant = $instant$ } } }
		4181 = { $origin$ = { move_great_project = { type = $type$  province = 4181 instant = $instant$ } } }
		4185 = { $origin$ = { move_great_project = { type = $type$  province = 4185 instant = $instant$ } } }
		4186 = { $origin$ = { move_great_project = { type = $type$  province = 4186 instant = $instant$ } } }
		4187 = { $origin$ = { move_great_project = { type = $type$  province = 4187 instant = $instant$ } } }
		4188 = { $origin$ = { move_great_project = { type = $type$  province = 4188 instant = $instant$ } } }
		4180 = { $origin$ = { move_great_project = { type = $type$  province = 4180 instant = $instant$ } } }
		4184 = { $origin$ = { move_great_project = { type = $type$  province = 4184 instant = $instant$ } } }
		4176 = { $origin$ = { move_great_project = { type = $type$  province = 4176 instant = $instant$ } } }
		4171 = { $origin$ = { move_great_project = { type = $type$  province = 4171 instant = $instant$ } } }
		4173 = { $origin$ = { move_great_project = { type = $type$  province = 4173 instant = $instant$ } } }
		4174 = { $origin$ = { move_great_project = { type = $type$  province = 4174 instant = $instant$ } } }
		4175 = { $origin$ = { move_great_project = { type = $type$  province = 4175 instant = $instant$ } } }
		6173 = { $origin$ = { move_great_project = { type = $type$  province = 6173 instant = $instant$ } } }
		6187 = { $origin$ = { move_great_project = { type = $type$  province = 6187 instant = $instant$ } } }
		6196 = { $origin$ = { move_great_project = { type = $type$  province = 6196 instant = $instant$ } } }
		6214 = { $origin$ = { move_great_project = { type = $type$  province = 6214 instant = $instant$ } } }
		4121 = { $origin$ = { move_great_project = { type = $type$  province = 4121 instant = $instant$ } } }
		4122 = { $origin$ = { move_great_project = { type = $type$  province = 4122 instant = $instant$ } } }
		4128 = { $origin$ = { move_great_project = { type = $type$  province = 4128 instant = $instant$ } } }
		4119 = { $origin$ = { move_great_project = { type = $type$  province = 4119 instant = $instant$ } } }
		4149 = { $origin$ = { move_great_project = { type = $type$  province = 4149 instant = $instant$ } } }
		4120 = { $origin$ = { move_great_project = { type = $type$  province = 4120 instant = $instant$ } } }
		4203 = { $origin$ = { move_great_project = { type = $type$  province = 4203 instant = $instant$ } } }
		4204 = { $origin$ = { move_great_project = { type = $type$  province = 4204 instant = $instant$ } } }
		4205 = { $origin$ = { move_great_project = { type = $type$  province = 4205 instant = $instant$ } } }
		4207 = { $origin$ = { move_great_project = { type = $type$  province = 4207 instant = $instant$ } } }
		4208 = { $origin$ = { move_great_project = { type = $type$  province = 4208 instant = $instant$ } } }
		4206 = { $origin$ = { move_great_project = { type = $type$  province = 4206 instant = $instant$ } } }
		4209 = { $origin$ = { move_great_project = { type = $type$  province = 4209 instant = $instant$ } } }
		4210 = { $origin$ = { move_great_project = { type = $type$  province = 4210 instant = $instant$ } } }
		4211 = { $origin$ = { move_great_project = { type = $type$  province = 4211 instant = $instant$ } } }
		2897 = { $origin$ = { move_great_project = { type = $type$  province = 2897 instant = $instant$ } } }
		2896 = { $origin$ = { move_great_project = { type = $type$  province = 2896 instant = $instant$ } } }
		2863 = { $origin$ = { move_great_project = { type = $type$  province = 2863 instant = $instant$ } } }
		2864 = { $origin$ = { move_great_project = { type = $type$  province = 2864 instant = $instant$ } } }
		2935 = { $origin$ = { move_great_project = { type = $type$  province = 2935 instant = $instant$ } } }
		2865 = { $origin$ = { move_great_project = { type = $type$  province = 2865 instant = $instant$ } } }
		2898 = { $origin$ = { move_great_project = { type = $type$  province = 2898 instant = $instant$ } } }
		2899 = { $origin$ = { move_great_project = { type = $type$  province = 2899 instant = $instant$ } } }
		2870 = { $origin$ = { move_great_project = { type = $type$  province = 2870 instant = $instant$ } } }
		2869 = { $origin$ = { move_great_project = { type = $type$  province = 2869 instant = $instant$ } } }
		4163 = { $origin$ = { move_great_project = { type = $type$  province = 4163 instant = $instant$ } } }
		2868 = { $origin$ = { move_great_project = { type = $type$  province = 2868 instant = $instant$ } } }
		4022 = { $origin$ = { move_great_project = { type = $type$  province = 4022 instant = $instant$ } } }
		2995 = { $origin$ = { move_great_project = { type = $type$  province = 2995 instant = $instant$ } } }
		4021 = { $origin$ = { move_great_project = { type = $type$  province = 4021 instant = $instant$ } } }
		4023 = { $origin$ = { move_great_project = { type = $type$  province = 4023 instant = $instant$ } } }
		4025 = { $origin$ = { move_great_project = { type = $type$  province = 4025 instant = $instant$ } } }
		4024 = { $origin$ = { move_great_project = { type = $type$  province = 4024 instant = $instant$ } } }
		4026 = { $origin$ = { move_great_project = { type = $type$  province = 4026 instant = $instant$ } } }
		2866 = { $origin$ = { move_great_project = { type = $type$  province = 2866 instant = $instant$ } } }
		2867 = { $origin$ = { move_great_project = { type = $type$  province = 2867 instant = $instant$ } } }
		2871 = { $origin$ = { move_great_project = { type = $type$  province = 2871 instant = $instant$ } } }
		4074 = { $origin$ = { move_great_project = { type = $type$  province = 4074 instant = $instant$ } } }
		4096 = { $origin$ = { move_great_project = { type = $type$  province = 4096 instant = $instant$ } } }
		4054 = { $origin$ = { move_great_project = { type = $type$  province = 4054 instant = $instant$ } } }
		4044 = { $origin$ = { move_great_project = { type = $type$  province = 4044 instant = $instant$ } } }
		4045 = { $origin$ = { move_great_project = { type = $type$  province = 4045 instant = $instant$ } } }
		4046 = { $origin$ = { move_great_project = { type = $type$  province = 4046 instant = $instant$ } } }
		4047 = { $origin$ = { move_great_project = { type = $type$  province = 4047 instant = $instant$ } } }
		4048 = { $origin$ = { move_great_project = { type = $type$  province = 4048 instant = $instant$ } } }
		4049 = { $origin$ = { move_great_project = { type = $type$  province = 4049 instant = $instant$ } } }
		4055 = { $origin$ = { move_great_project = { type = $type$  province = 4055 instant = $instant$ } } }
		4043 = { $origin$ = { move_great_project = { type = $type$  province = 4043 instant = $instant$ } } }
		2872 = { $origin$ = { move_great_project = { type = $type$  province = 2872 instant = $instant$ } } }
		2933 = { $origin$ = { move_great_project = { type = $type$  province = 2933 instant = $instant$ } } }
		4050 = { $origin$ = { move_great_project = { type = $type$  province = 4050 instant = $instant$ } } }
		4051 = { $origin$ = { move_great_project = { type = $type$  province = 4051 instant = $instant$ } } }
		4052 = { $origin$ = { move_great_project = { type = $type$  province = 4052 instant = $instant$ } } }
		4053 = { $origin$ = { move_great_project = { type = $type$  province = 4053 instant = $instant$ } } }
		2873 = { $origin$ = { move_great_project = { type = $type$  province = 2873 instant = $instant$ } } }
		2874 = { $origin$ = { move_great_project = { type = $type$  province = 2874 instant = $instant$ } } }
		2934 = { $origin$ = { move_great_project = { type = $type$  province = 2934 instant = $instant$ } } }
		4065 = { $origin$ = { move_great_project = { type = $type$  province = 4065 instant = $instant$ } } }
		4067 = { $origin$ = { move_great_project = { type = $type$  province = 4067 instant = $instant$ } } }
		4066 = { $origin$ = { move_great_project = { type = $type$  province = 4066 instant = $instant$ } } }
		4061 = { $origin$ = { move_great_project = { type = $type$  province = 4061 instant = $instant$ } } }
		4060 = { $origin$ = { move_great_project = { type = $type$  province = 4060 instant = $instant$ } } }
		4059 = { $origin$ = { move_great_project = { type = $type$  province = 4059 instant = $instant$ } } }
		4057 = { $origin$ = { move_great_project = { type = $type$  province = 4057 instant = $instant$ } } }
		4058 = { $origin$ = { move_great_project = { type = $type$  province = 4058 instant = $instant$ } } }
		2875 = { $origin$ = { move_great_project = { type = $type$  province = 2875 instant = $instant$ } } }
		2932 = { $origin$ = { move_great_project = { type = $type$  province = 2932 instant = $instant$ } } }
		4104 = { $origin$ = { move_great_project = { type = $type$  province = 4104 instant = $instant$ } } }
		2931 = { $origin$ = { move_great_project = { type = $type$  province = 2931 instant = $instant$ } } }
		2986 = { $origin$ = { move_great_project = { type = $type$  province = 2986 instant = $instant$ } } }
		2876 = { $origin$ = { move_great_project = { type = $type$  province = 2876 instant = $instant$ } } }
		2988 = { $origin$ = { move_great_project = { type = $type$  province = 2988 instant = $instant$ } } }
		4165 = { $origin$ = { move_great_project = { type = $type$  province = 4165 instant = $instant$ } } }
		4212 = { $origin$ = { move_great_project = { type = $type$  province = 4212 instant = $instant$ } } }
		4213 = { $origin$ = { move_great_project = { type = $type$  province = 4213 instant = $instant$ } } }
		4150 = { $origin$ = { move_great_project = { type = $type$  province = 4150 instant = $instant$ } } }
		4062 = { $origin$ = { move_great_project = { type = $type$  province = 4062 instant = $instant$ } } }
		4063 = { $origin$ = { move_great_project = { type = $type$  province = 4063 instant = $instant$ } } }
		4064 = { $origin$ = { move_great_project = { type = $type$  province = 4064 instant = $instant$ } } }
		2989 = { $origin$ = { move_great_project = { type = $type$  province = 2989 instant = $instant$ } } }
		2990 = { $origin$ = { move_great_project = { type = $type$  province = 2990 instant = $instant$ } } }
		2991 = { $origin$ = { move_great_project = { type = $type$  province = 2991 instant = $instant$ } } }
		4236 = { $origin$ = { move_great_project = { type = $type$  province = 4236 instant = $instant$ } } }
		4141 = { $origin$ = { move_great_project = { type = $type$  province = 4141 instant = $instant$ } } }
		4144 = { $origin$ = { move_great_project = { type = $type$  province = 4144 instant = $instant$ } } }
		2992 = { $origin$ = { move_great_project = { type = $type$  province = 2992 instant = $instant$ } } }
		2993 = { $origin$ = { move_great_project = { type = $type$  province = 2993 instant = $instant$ } } }
		2994 = { $origin$ = { move_great_project = { type = $type$  province = 2994 instant = $instant$ } } }
		2996 = { $origin$ = { move_great_project = { type = $type$  province = 2996 instant = $instant$ } } }
		2997 = { $origin$ = { move_great_project = { type = $type$  province = 2997 instant = $instant$ } } }
		2998 = { $origin$ = { move_great_project = { type = $type$  province = 2998 instant = $instant$ } } }
		4118 = { $origin$ = { move_great_project = { type = $type$  province = 4118 instant = $instant$ } } }
		4147 = { $origin$ = { move_great_project = { type = $type$  province = 4147 instant = $instant$ } } }
		4148 = { $origin$ = { move_great_project = { type = $type$  province = 4148 instant = $instant$ } } }
		4130 = { $origin$ = { move_great_project = { type = $type$  province = 4130 instant = $instant$ } } }
		2999 = { $origin$ = { move_great_project = { type = $type$  province = 2999 instant = $instant$ } } }
		3000 = { $origin$ = { move_great_project = { type = $type$  province = 3000 instant = $instant$ } } }
		3001 = { $origin$ = { move_great_project = { type = $type$  province = 3001 instant = $instant$ } } }
		3002 = { $origin$ = { move_great_project = { type = $type$  province = 3002 instant = $instant$ } } }
		3003 = { $origin$ = { move_great_project = { type = $type$  province = 3003 instant = $instant$ } } }
		4020 = { $origin$ = { move_great_project = { type = $type$  province = 4020 instant = $instant$ } } }
		4076 = { $origin$ = { move_great_project = { type = $type$  province = 4076 instant = $instant$ } } }
		4075 = { $origin$ = { move_great_project = { type = $type$  province = 4075 instant = $instant$ } } }
		4077 = { $origin$ = { move_great_project = { type = $type$  province = 4077 instant = $instant$ } } }
		4105 = { $origin$ = { move_great_project = { type = $type$  province = 4105 instant = $instant$ } } }
		4056 = { $origin$ = { move_great_project = { type = $type$  province = 4056 instant = $instant$ } } }
		4237 = { $origin$ = { move_great_project = { type = $type$  province = 4237 instant = $instant$ } } }
		4068 = { $origin$ = { move_great_project = { type = $type$  province = 4068 instant = $instant$ } } }
		4069 = { $origin$ = { move_great_project = { type = $type$  province = 4069 instant = $instant$ } } }
		4070 = { $origin$ = { move_great_project = { type = $type$  province = 4070 instant = $instant$ } } }
		4071 = { $origin$ = { move_great_project = { type = $type$  province = 4071 instant = $instant$ } } }
		4072 = { $origin$ = { move_great_project = { type = $type$  province = 4072 instant = $instant$ } } }
		4073 = { $origin$ = { move_great_project = { type = $type$  province = 4073 instant = $instant$ } } }
		2877 = { $origin$ = { move_great_project = { type = $type$  province = 2877 instant = $instant$ } } }
		2937 = { $origin$ = { move_great_project = { type = $type$  province = 2937 instant = $instant$ } } }
		2878 = { $origin$ = { move_great_project = { type = $type$  province = 2878 instant = $instant$ } } }
		4101 = { $origin$ = { move_great_project = { type = $type$  province = 4101 instant = $instant$ } } }
		4102 = { $origin$ = { move_great_project = { type = $type$  province = 4102 instant = $instant$ } } }
		2879 = { $origin$ = { move_great_project = { type = $type$  province = 2879 instant = $instant$ } } }
		2880 = { $origin$ = { move_great_project = { type = $type$  province = 2880 instant = $instant$ } } }
		4103 = { $origin$ = { move_great_project = { type = $type$  province = 4103 instant = $instant$ } } }
		2963 = { $origin$ = { move_great_project = { type = $type$  province = 2963 instant = $instant$ } } }
		2881 = { $origin$ = { move_great_project = { type = $type$  province = 2881 instant = $instant$ } } }
		2882 = { $origin$ = { move_great_project = { type = $type$  province = 2882 instant = $instant$ } } }
		2883 = { $origin$ = { move_great_project = { type = $type$  province = 2883 instant = $instant$ } } }
		4029 = { $origin$ = { move_great_project = { type = $type$  province = 4029 instant = $instant$ } } }
		2884 = { $origin$ = { move_great_project = { type = $type$  province = 2884 instant = $instant$ } } }
		4552 = { $origin$ = { move_great_project = { type = $type$  province = 4552 instant = $instant$ } } }
		4553 = { $origin$ = { move_great_project = { type = $type$  province = 4553 instant = $instant$ } } }
		2885 = { $origin$ = { move_great_project = { type = $type$  province = 2885 instant = $instant$ } } }
		4028 = { $origin$ = { move_great_project = { type = $type$  province = 4028 instant = $instant$ } } }
		4217 = { $origin$ = { move_great_project = { type = $type$  province = 4217 instant = $instant$ } } }
		2886 = { $origin$ = { move_great_project = { type = $type$  province = 2886 instant = $instant$ } } }
		2887 = { $origin$ = { move_great_project = { type = $type$  province = 2887 instant = $instant$ } } }
		2888 = { $origin$ = { move_great_project = { type = $type$  province = 2888 instant = $instant$ } } }
		4227 = { $origin$ = { move_great_project = { type = $type$  province = 4227 instant = $instant$ } } }
		4228 = { $origin$ = { move_great_project = { type = $type$  province = 4228 instant = $instant$ } } }
		4229 = { $origin$ = { move_great_project = { type = $type$  province = 4229 instant = $instant$ } } }
		4215 = { $origin$ = { move_great_project = { type = $type$  province = 4215 instant = $instant$ } } }
		4214 = { $origin$ = { move_great_project = { type = $type$  province = 4214 instant = $instant$ } } }
		4078 = { $origin$ = { move_great_project = { type = $type$  province = 4078 instant = $instant$ } } }
		2889 = { $origin$ = { move_great_project = { type = $type$  province = 2889 instant = $instant$ } } }
		2890 = { $origin$ = { move_great_project = { type = $type$  province = 2890 instant = $instant$ } } }
		2891 = { $origin$ = { move_great_project = { type = $type$  province = 2891 instant = $instant$ } } }
		4239 = { $origin$ = { move_great_project = { type = $type$  province = 4239 instant = $instant$ } } }
		4080 = { $origin$ = { move_great_project = { type = $type$  province = 4080 instant = $instant$ } } }
		4084 = { $origin$ = { move_great_project = { type = $type$  province = 4084 instant = $instant$ } } }
		4079 = { $origin$ = { move_great_project = { type = $type$  province = 4079 instant = $instant$ } } }
		4081 = { $origin$ = { move_great_project = { type = $type$  province = 4081 instant = $instant$ } } }
		4083 = { $origin$ = { move_great_project = { type = $type$  province = 4083 instant = $instant$ } } }
		4085 = { $origin$ = { move_great_project = { type = $type$  province = 4085 instant = $instant$ } } }
		4027 = { $origin$ = { move_great_project = { type = $type$  province = 4027 instant = $instant$ } } }
		2892 = { $origin$ = { move_great_project = { type = $type$  province = 2892 instant = $instant$ } } }
		2893 = { $origin$ = { move_great_project = { type = $type$  province = 2893 instant = $instant$ } } }
		4216 = { $origin$ = { move_great_project = { type = $type$  province = 4216 instant = $instant$ } } }
		4124 = { $origin$ = { move_great_project = { type = $type$  province = 4124 instant = $instant$ } } }
		4082 = { $origin$ = { move_great_project = { type = $type$  province = 4082 instant = $instant$ } } }
		4230 = { $origin$ = { move_great_project = { type = $type$  province = 4230 instant = $instant$ } } }
		4088 = { $origin$ = { move_great_project = { type = $type$  province = 4088 instant = $instant$ } } }
		4110 = { $origin$ = { move_great_project = { type = $type$  province = 4110 instant = $instant$ } } }
		4108 = { $origin$ = { move_great_project = { type = $type$  province = 4108 instant = $instant$ } } }
		4109 = { $origin$ = { move_great_project = { type = $type$  province = 4109 instant = $instant$ } } }
		4108 = { $origin$ = { move_great_project = { type = $type$  province = 4108 instant = $instant$ } } }
		4107 = { $origin$ = { move_great_project = { type = $type$  province = 4107 instant = $instant$ } } }
		4086 = { $origin$ = { move_great_project = { type = $type$  province = 4086 instant = $instant$ } } }
		4087 = { $origin$ = { move_great_project = { type = $type$  province = 4087 instant = $instant$ } } }
		4089 = { $origin$ = { move_great_project = { type = $type$  province = 4089 instant = $instant$ } } }
		4106 = { $origin$ = { move_great_project = { type = $type$  province = 4106 instant = $instant$ } } }
		4092 = { $origin$ = { move_great_project = { type = $type$  province = 4092 instant = $instant$ } } }
		4095 = { $origin$ = { move_great_project = { type = $type$  province = 4095 instant = $instant$ } } }
		4094 = { $origin$ = { move_great_project = { type = $type$  province = 4094 instant = $instant$ } } }
		2894 = { $origin$ = { move_great_project = { type = $type$  province = 2894 instant = $instant$ } } }
		2895 = { $origin$ = { move_great_project = { type = $type$  province = 2895 instant = $instant$ } } }
		2914 = { $origin$ = { move_great_project = { type = $type$  province = 2914 instant = $instant$ } } }
		4220 = { $origin$ = { move_great_project = { type = $type$  province = 4220 instant = $instant$ } } }
		4219 = { $origin$ = { move_great_project = { type = $type$  province = 4219 instant = $instant$ } } }
		4223 = { $origin$ = { move_great_project = { type = $type$  province = 4223 instant = $instant$ } } }
		4231 = { $origin$ = { move_great_project = { type = $type$  province = 4231 instant = $instant$ } } }
		4091 = { $origin$ = { move_great_project = { type = $type$  province = 4091 instant = $instant$ } } }
		4221 = { $origin$ = { move_great_project = { type = $type$  province = 4221 instant = $instant$ } } }
		4222 = { $origin$ = { move_great_project = { type = $type$  province = 4222 instant = $instant$ } } }
		4111 = { $origin$ = { move_great_project = { type = $type$  province = 4111 instant = $instant$ } } }
		4112 = { $origin$ = { move_great_project = { type = $type$  province = 4112 instant = $instant$ } } }
		4113 = { $origin$ = { move_great_project = { type = $type$  province = 4113 instant = $instant$ } } }
		4114 = { $origin$ = { move_great_project = { type = $type$  province = 4114 instant = $instant$ } } }
		4090 = { $origin$ = { move_great_project = { type = $type$  province = 4090 instant = $instant$ } } }
		4218 = { $origin$ = { move_great_project = { type = $type$  province = 4218 instant = $instant$ } } }
		4039 = { $origin$ = { move_great_project = { type = $type$  province = 4039 instant = $instant$ } } }
		4038 = { $origin$ = { move_great_project = { type = $type$  province = 4038 instant = $instant$ } } }
		4037 = { $origin$ = { move_great_project = { type = $type$  province = 4037 instant = $instant$ } } }
		4040 = { $origin$ = { move_great_project = { type = $type$  province = 4040 instant = $instant$ } } }
		4042 = { $origin$ = { move_great_project = { type = $type$  province = 4042 instant = $instant$ } } }
		4041 = { $origin$ = { move_great_project = { type = $type$  province = 4041 instant = $instant$ } } }
		2949 = { $origin$ = { move_great_project = { type = $type$  province = 2949 instant = $instant$ } } }
		4036 = { $origin$ = { move_great_project = { type = $type$  province = 4036 instant = $instant$ } } }
		2985 = { $origin$ = { move_great_project = { type = $type$  province = 2985 instant = $instant$ } } }
		2984 = { $origin$ = { move_great_project = { type = $type$  province = 2984 instant = $instant$ } } }
		2951 = { $origin$ = { move_great_project = { type = $type$  province = 2951 instant = $instant$ } } }
		2952 = { $origin$ = { move_great_project = { type = $type$  province = 2952 instant = $instant$ } } }
		4035 = { $origin$ = { move_great_project = { type = $type$  province = 4035 instant = $instant$ } } }
		2982 = { $origin$ = { move_great_project = { type = $type$  province = 2982 instant = $instant$ } } }
		2978 = { $origin$ = { move_great_project = { type = $type$  province = 2978 instant = $instant$ } } }
		2983 = { $origin$ = { move_great_project = { type = $type$  province = 2983 instant = $instant$ } } }
		2977 = { $origin$ = { move_great_project = { type = $type$  province = 2977 instant = $instant$ } } }
		2974 = { $origin$ = { move_great_project = { type = $type$  province = 2974 instant = $instant$ } } }
		2981 = { $origin$ = { move_great_project = { type = $type$  province = 2981 instant = $instant$ } } }
		2980 = { $origin$ = { move_great_project = { type = $type$  province = 2980 instant = $instant$ } } }
		2979 = { $origin$ = { move_great_project = { type = $type$  province = 2979 instant = $instant$ } } }
		4099 = { $origin$ = { move_great_project = { type = $type$  province = 4099 instant = $instant$ } } }
		2975 = { $origin$ = { move_great_project = { type = $type$  province = 2975 instant = $instant$ } } }
		4098 = { $origin$ = { move_great_project = { type = $type$  province = 4098 instant = $instant$ } } }
		2970 = { $origin$ = { move_great_project = { type = $type$  province = 2970 instant = $instant$ } } }
		2968 = { $origin$ = { move_great_project = { type = $type$  province = 2968 instant = $instant$ } } }
		2969 = { $origin$ = { move_great_project = { type = $type$  province = 2969 instant = $instant$ } } }
		4240 = { $origin$ = { move_great_project = { type = $type$  province = 4240 instant = $instant$ } } }
		2962 = { $origin$ = { move_great_project = { type = $type$  province = 2962 instant = $instant$ } } }
		2946 = { $origin$ = { move_great_project = { type = $type$  province = 2946 instant = $instant$ } } }
		2973 = { $origin$ = { move_great_project = { type = $type$  province = 2973 instant = $instant$ } } }
		2976 = { $origin$ = { move_great_project = { type = $type$  province = 2976 instant = $instant$ } } }
		2972 = { $origin$ = { move_great_project = { type = $type$  province = 2972 instant = $instant$ } } }
		2971 = { $origin$ = { move_great_project = { type = $type$  province = 2971 instant = $instant$ } } }
		2967 = { $origin$ = { move_great_project = { type = $type$  province = 2967 instant = $instant$ } } }
		2966 = { $origin$ = { move_great_project = { type = $type$  province = 2966 instant = $instant$ } } }
		2965 = { $origin$ = { move_great_project = { type = $type$  province = 2965 instant = $instant$ } } }
		2964 = { $origin$ = { move_great_project = { type = $type$  province = 2964 instant = $instant$ } } }
		2945 = { $origin$ = { move_great_project = { type = $type$  province = 2945 instant = $instant$ } } }
		2944 = { $origin$ = { move_great_project = { type = $type$  province = 2944 instant = $instant$ } } }
		2943 = { $origin$ = { move_great_project = { type = $type$  province = 2943 instant = $instant$ } } }
		2942 = { $origin$ = { move_great_project = { type = $type$  province = 2942 instant = $instant$ } } }
		4126 = { $origin$ = { move_great_project = { type = $type$  province = 4126 instant = $instant$ } } }
		4100 = { $origin$ = { move_great_project = { type = $type$  province = 4100 instant = $instant$ } } }
		4127 = { $origin$ = { move_great_project = { type = $type$  province = 4127 instant = $instant$ } } }
		2961 = { $origin$ = { move_great_project = { type = $type$  province = 2961 instant = $instant$ } } }
		2959 = { $origin$ = { move_great_project = { type = $type$  province = 2959 instant = $instant$ } } }
		2958 = { $origin$ = { move_great_project = { type = $type$  province = 2958 instant = $instant$ } } }
		2960 = { $origin$ = { move_great_project = { type = $type$  province = 2960 instant = $instant$ } } }
		2947 = { $origin$ = { move_great_project = { type = $type$  province = 2947 instant = $instant$ } } }
		2948 = { $origin$ = { move_great_project = { type = $type$  province = 2948 instant = $instant$ } } }
		2950 = { $origin$ = { move_great_project = { type = $type$  province = 2950 instant = $instant$ } } }
		4093 = { $origin$ = { move_great_project = { type = $type$  province = 4093 instant = $instant$ } } }
		2955 = { $origin$ = { move_great_project = { type = $type$  province = 2955 instant = $instant$ } } }
		2954 = { $origin$ = { move_great_project = { type = $type$  province = 2954 instant = $instant$ } } }
		2956 = { $origin$ = { move_great_project = { type = $type$  province = 2956 instant = $instant$ } } }
		2957 = { $origin$ = { move_great_project = { type = $type$  province = 2957 instant = $instant$ } } }
		4034 = { $origin$ = { move_great_project = { type = $type$  province = 4034 instant = $instant$ } } }
		4032 = { $origin$ = { move_great_project = { type = $type$  province = 4032 instant = $instant$ } } }
		4031 = { $origin$ = { move_great_project = { type = $type$  province = 4031 instant = $instant$ } } }
		4033 = { $origin$ = { move_great_project = { type = $type$  province = 4033 instant = $instant$ } } }
		4030 = { $origin$ = { move_great_project = { type = $type$  province = 4030 instant = $instant$ } } }
		2941 = { $origin$ = { move_great_project = { type = $type$  province = 2941 instant = $instant$ } } }
		4238 = { $origin$ = { move_great_project = { type = $type$  province = 4238 instant = $instant$ } } }
		2939 = { $origin$ = { move_great_project = { type = $type$  province = 2939 instant = $instant$ } } }
		2940 = { $origin$ = { move_great_project = { type = $type$  province = 2940 instant = $instant$ } } }
		2987 = { $origin$ = { move_great_project = { type = $type$  province = 2987 instant = $instant$ } } }
		4242 = { $origin$ = { move_great_project = { type = $type$  province = 4242 instant = $instant$ } } }
		4243 = { $origin$ = { move_great_project = { type = $type$  province = 4243 instant = $instant$ } } }
		4244 = { $origin$ = { move_great_project = { type = $type$  province = 4244 instant = $instant$ } } }
		4245 = { $origin$ = { move_great_project = { type = $type$  province = 4245 instant = $instant$ } } }
		4246 = { $origin$ = { move_great_project = { type = $type$  province = 4246 instant = $instant$ } } }
		4247 = { $origin$ = { move_great_project = { type = $type$  province = 4247 instant = $instant$ } } }
		4248 = { $origin$ = { move_great_project = { type = $type$  province = 4248 instant = $instant$ } } }
		4249 = { $origin$ = { move_great_project = { type = $type$  province = 4249 instant = $instant$ } } }
		4250 = { $origin$ = { move_great_project = { type = $type$  province = 4250 instant = $instant$ } } }
		4251 = { $origin$ = { move_great_project = { type = $type$  province = 4251 instant = $instant$ } } }
		4252 = { $origin$ = { move_great_project = { type = $type$  province = 4252 instant = $instant$ } } }
		4253 = { $origin$ = { move_great_project = { type = $type$  province = 4253 instant = $instant$ } } }
		4254 = { $origin$ = { move_great_project = { type = $type$  province = 4254 instant = $instant$ } } }
		4255 = { $origin$ = { move_great_project = { type = $type$  province = 4255 instant = $instant$ } } }
		4256 = { $origin$ = { move_great_project = { type = $type$  province = 4256 instant = $instant$ } } }
		4257 = { $origin$ = { move_great_project = { type = $type$  province = 4257 instant = $instant$ } } }
		4258 = { $origin$ = { move_great_project = { type = $type$  province = 4258 instant = $instant$ } } }
		4259 = { $origin$ = { move_great_project = { type = $type$  province = 4259 instant = $instant$ } } }
		4260 = { $origin$ = { move_great_project = { type = $type$  province = 4260 instant = $instant$ } } }
		4261 = { $origin$ = { move_great_project = { type = $type$  province = 4261 instant = $instant$ } } }
		4262 = { $origin$ = { move_great_project = { type = $type$  province = 4262 instant = $instant$ } } }
		4263 = { $origin$ = { move_great_project = { type = $type$  province = 4263 instant = $instant$ } } }
		4264 = { $origin$ = { move_great_project = { type = $type$  province = 4264 instant = $instant$ } } }
		4265 = { $origin$ = { move_great_project = { type = $type$  province = 4265 instant = $instant$ } } }
		4266 = { $origin$ = { move_great_project = { type = $type$  province = 4266 instant = $instant$ } } }
		4297 = { $origin$ = { move_great_project = { type = $type$  province = 4297 instant = $instant$ } } }
		4298 = { $origin$ = { move_great_project = { type = $type$  province = 4298 instant = $instant$ } } }
		4300 = { $origin$ = { move_great_project = { type = $type$  province = 4300 instant = $instant$ } } }
		4284 = { $origin$ = { move_great_project = { type = $type$  province = 4284 instant = $instant$ } } }
		4277 = { $origin$ = { move_great_project = { type = $type$  province = 4277 instant = $instant$ } } }
		4279 = { $origin$ = { move_great_project = { type = $type$  province = 4279 instant = $instant$ } } }
		4280 = { $origin$ = { move_great_project = { type = $type$  province = 4280 instant = $instant$ } } }
		4281 = { $origin$ = { move_great_project = { type = $type$  province = 4281 instant = $instant$ } } }
		4271 = { $origin$ = { move_great_project = { type = $type$  province = 4271 instant = $instant$ } } }
		4267 = { $origin$ = { move_great_project = { type = $type$  province = 4267 instant = $instant$ } } }
		4282 = { $origin$ = { move_great_project = { type = $type$  province = 4282 instant = $instant$ } } }
		4269 = { $origin$ = { move_great_project = { type = $type$  province = 4269 instant = $instant$ } } }
		4270 = { $origin$ = { move_great_project = { type = $type$  province = 4270 instant = $instant$ } } }
		4272 = { $origin$ = { move_great_project = { type = $type$  province = 4272 instant = $instant$ } } }
		4292 = { $origin$ = { move_great_project = { type = $type$  province = 4292 instant = $instant$ } } }
		4274 = { $origin$ = { move_great_project = { type = $type$  province = 4274 instant = $instant$ } } }
		4275 = { $origin$ = { move_great_project = { type = $type$  province = 4275 instant = $instant$ } } }
		4268 = { $origin$ = { move_great_project = { type = $type$  province = 4268 instant = $instant$ } } }
		4283 = { $origin$ = { move_great_project = { type = $type$  province = 4283 instant = $instant$ } } }
		4285 = { $origin$ = { move_great_project = { type = $type$  province = 4285 instant = $instant$ } } }
		4287 = { $origin$ = { move_great_project = { type = $type$  province = 4287 instant = $instant$ } } }
		4286 = { $origin$ = { move_great_project = { type = $type$  province = 4286 instant = $instant$ } } }
		4288 = { $origin$ = { move_great_project = { type = $type$  province = 4288 instant = $instant$ } } }
		4293 = { $origin$ = { move_great_project = { type = $type$  province = 4293 instant = $instant$ } } }
		4294 = { $origin$ = { move_great_project = { type = $type$  province = 4294 instant = $instant$ } } }
		4295 = { $origin$ = { move_great_project = { type = $type$  province = 4295 instant = $instant$ } } }
		4296 = { $origin$ = { move_great_project = { type = $type$  province = 4296 instant = $instant$ } } }
		4299 = { $origin$ = { move_great_project = { type = $type$  province = 4299 instant = $instant$ } } }
		4278 = { $origin$ = { move_great_project = { type = $type$  province = 4278 instant = $instant$ } } }
		4273 = { $origin$ = { move_great_project = { type = $type$  province = 4273 instant = $instant$ } } }
		4290 = { $origin$ = { move_great_project = { type = $type$  province = 4290 instant = $instant$ } } }
		4289 = { $origin$ = { move_great_project = { type = $type$  province = 4289 instant = $instant$ } } }
		4291 = { $origin$ = { move_great_project = { type = $type$  province = 4291 instant = $instant$ } } }
		4301 = { $origin$ = { move_great_project = { type = $type$  province = 4301 instant = $instant$ } } }
		4302 = { $origin$ = { move_great_project = { type = $type$  province = 4302 instant = $instant$ } } }
		4303 = { $origin$ = { move_great_project = { type = $type$  province = 4303 instant = $instant$ } } }
		4304 = { $origin$ = { move_great_project = { type = $type$  province = 4304 instant = $instant$ } } }
		4305 = { $origin$ = { move_great_project = { type = $type$  province = 4305 instant = $instant$ } } }
		4306 = { $origin$ = { move_great_project = { type = $type$  province = 4306 instant = $instant$ } } }
		4307 = { $origin$ = { move_great_project = { type = $type$  province = 4307 instant = $instant$ } } }
		4308 = { $origin$ = { move_great_project = { type = $type$  province = 4308 instant = $instant$ } } }
		4309 = { $origin$ = { move_great_project = { type = $type$  province = 4309 instant = $instant$ } } }
		4310 = { $origin$ = { move_great_project = { type = $type$  province = 4310 instant = $instant$ } } }
		4314 = { $origin$ = { move_great_project = { type = $type$  province = 4314 instant = $instant$ } } }
		4315 = { $origin$ = { move_great_project = { type = $type$  province = 4315 instant = $instant$ } } }
		4316 = { $origin$ = { move_great_project = { type = $type$  province = 4316 instant = $instant$ } } }
		4317 = { $origin$ = { move_great_project = { type = $type$  province = 4317 instant = $instant$ } } }
		4318 = { $origin$ = { move_great_project = { type = $type$  province = 4318 instant = $instant$ } } }
		4319 = { $origin$ = { move_great_project = { type = $type$  province = 4319 instant = $instant$ } } }
		4320 = { $origin$ = { move_great_project = { type = $type$  province = 4320 instant = $instant$ } } }
		4359 = { $origin$ = { move_great_project = { type = $type$  province = 4359 instant = $instant$ } } }
		4360 = { $origin$ = { move_great_project = { type = $type$  province = 4360 instant = $instant$ } } }
		4312 = { $origin$ = { move_great_project = { type = $type$  province = 4312 instant = $instant$ } } }
		4350 = { $origin$ = { move_great_project = { type = $type$  province = 4350 instant = $instant$ } } }
		4311 = { $origin$ = { move_great_project = { type = $type$  province = 4311 instant = $instant$ } } }
		4313 = { $origin$ = { move_great_project = { type = $type$  province = 4313 instant = $instant$ } } }
		4339 = { $origin$ = { move_great_project = { type = $type$  province = 4339 instant = $instant$ } } }
		4338 = { $origin$ = { move_great_project = { type = $type$  province = 4338 instant = $instant$ } } }
		4337 = { $origin$ = { move_great_project = { type = $type$  province = 4337 instant = $instant$ } } }
		4336 = { $origin$ = { move_great_project = { type = $type$  province = 4336 instant = $instant$ } } }
		4335 = { $origin$ = { move_great_project = { type = $type$  province = 4335 instant = $instant$ } } }
		4334 = { $origin$ = { move_great_project = { type = $type$  province = 4334 instant = $instant$ } } }
		4351 = { $origin$ = { move_great_project = { type = $type$  province = 4351 instant = $instant$ } } }
		4352 = { $origin$ = { move_great_project = { type = $type$  province = 4352 instant = $instant$ } } }
		4348 = { $origin$ = { move_great_project = { type = $type$  province = 4348 instant = $instant$ } } }
		4349 = { $origin$ = { move_great_project = { type = $type$  province = 4349 instant = $instant$ } } }
		4324 = { $origin$ = { move_great_project = { type = $type$  province = 4324 instant = $instant$ } } }
		4325 = { $origin$ = { move_great_project = { type = $type$  province = 4325 instant = $instant$ } } }
		4326 = { $origin$ = { move_great_project = { type = $type$  province = 4326 instant = $instant$ } } }
		4353 = { $origin$ = { move_great_project = { type = $type$  province = 4353 instant = $instant$ } } }
		4327 = { $origin$ = { move_great_project = { type = $type$  province = 4327 instant = $instant$ } } }
		4329 = { $origin$ = { move_great_project = { type = $type$  province = 4329 instant = $instant$ } } }
		4330 = { $origin$ = { move_great_project = { type = $type$  province = 4330 instant = $instant$ } } }
		4331 = { $origin$ = { move_great_project = { type = $type$  province = 4331 instant = $instant$ } } }
		4332 = { $origin$ = { move_great_project = { type = $type$  province = 4332 instant = $instant$ } } }
		4344 = { $origin$ = { move_great_project = { type = $type$  province = 4344 instant = $instant$ } } }
		4354 = { $origin$ = { move_great_project = { type = $type$  province = 4354 instant = $instant$ } } }
		4345 = { $origin$ = { move_great_project = { type = $type$  province = 4345 instant = $instant$ } } }
		4355 = { $origin$ = { move_great_project = { type = $type$  province = 4355 instant = $instant$ } } }
		4342 = { $origin$ = { move_great_project = { type = $type$  province = 4342 instant = $instant$ } } }
		4341 = { $origin$ = { move_great_project = { type = $type$  province = 4341 instant = $instant$ } } }
		4340 = { $origin$ = { move_great_project = { type = $type$  province = 4340 instant = $instant$ } } }
		4323 = { $origin$ = { move_great_project = { type = $type$  province = 4323 instant = $instant$ } } }
		4356 = { $origin$ = { move_great_project = { type = $type$  province = 4356 instant = $instant$ } } }
	}
}
