aelantiri_tech_group = {
	OR = {
		technology_group = tech_north_aelantiri
	}
}

ruler_save_spell_schools = {
	if = {
		limit = {
			is_abjuration_1 = yes
		}
		set_country_flag = saved_abjuration_1
	}
	if = {
		limit = {
			is_abjuration_2 = yes
		}
		set_country_flag = saved_abjuration_2
	}
	if = {
		limit = {
			is_abjuration_3 = yes
		}
		set_country_flag = saved_abjuration_3
	}
	
	if = {
		limit = {
			is_conjuration_1 = yes
		}
		set_country_flag = saved_conjuration_1
	}
	if = {
		limit = {
			is_conjuration_2 = yes
		}
		set_country_flag = saved_conjuration_2
	}
	if = {
		limit = {
			is_conjuration_3 = yes
		}
		set_country_flag = saved_conjuration_3
	}
	
	if = {
		limit = {
			is_divination_1 = yes
		}
		set_country_flag = saved_divination_1
	}
	if = {
		limit = {
			is_divination_2 = yes
		}
		set_country_flag = saved_divination_2
	}
	if = {
		limit = {
			is_divination_3 = yes
		}
		set_country_flag = saved_divination_3
	}
	
	if = {
		limit = {
			is_enchantment_1 = yes
		}
		set_country_flag = saved_enchantment_1
	}
	if = {
		limit = {
			is_enchantment_2 = yes
		}
		set_country_flag = saved_enchantment_2
	}
	if = {
		limit = {
			is_enchantment_3 = yes
		}
		set_country_flag = saved_enchantment_3
	}
	
	if = {
		limit = {
			is_evocation_1 = yes
		}
		set_country_flag = saved_evocation_1
	}
	if = {
		limit = {
			is_evocation_2 = yes
		}
		set_country_flag = saved_evocation_2
	}
	if = {
		limit = {
			is_evocation_3 = yes
		}
		set_country_flag = saved_evocation_3
	}
	
	if = {
		limit = {
			is_illusion_1 = yes
		}
		set_country_flag = saved_illusion_1
	}
	if = {
		limit = {
			is_illusion_2 = yes
		}
		set_country_flag = saved_illusion_2
	}
	if = {
		limit = {
			is_illusion_3 = yes
		}
		set_country_flag = saved_illusion_3
	}
	
	if = {
		limit = {
			is_necromancy_1 = yes
		}
		set_country_flag = saved_necromancy_1
	}
	if = {
		limit = {
			is_necromancy_2 = yes
		}
		set_country_flag = saved_necromancy_2
	}
	if = {
		limit = {
			is_necromancy_3 = yes
		}
		set_country_flag = saved_necromancy_3
	}
	
	if = {
		limit = {
			is_transmutation_1 = yes
		}
		set_country_flag = saved_transmutation_1
	}
	if = {
		limit = {
			is_transmutation_2 = yes
		}
		set_country_flag = saved_transmutation_2
	}
	if = {
		limit = {
			is_transmutation_3 = yes
		}
		set_country_flag = saved_transmutation_3
	}
	
}

ruler_give_saved_spell_schools = {
	if = {
		limit = {
			has_country_flag = saved_abjuration_1
		}
		set_ruler_flag = abjuration_1
	}
	if = {
		limit = {
			has_country_flag = saved_abjuration_2
		}
		set_ruler_flag = abjuration_1
		set_ruler_flag = abjuration_2
	}
	if = {
		limit = {
			has_country_flag = saved_abjuration_3
		}
		set_ruler_flag = abjuration_1
		set_ruler_flag = abjuration_2
		set_ruler_flag = abjuration_3
	}
	
	if = {
		limit = {
			has_country_flag = saved_conjuration_1
		}
		set_ruler_flag = conjuration_1
	}
	if = {
		limit = {
			has_country_flag = saved_conjuration_2
		}
		set_ruler_flag = conjuration_1
		set_ruler_flag = conjuration_2
	}
	if = {
		limit = {
			has_country_flag = saved_conjuration_3
		}
		set_ruler_flag = conjuration_1
		set_ruler_flag = conjuration_2
		set_ruler_flag = conjuration_3
	}
	
	if = {
		limit = {
			has_country_flag = saved_divination_1
		}
		set_ruler_flag = divination_1
	}
	if = {
		limit = {
			has_country_flag = saved_divination_2
		}
		set_ruler_flag = divination_1
		set_ruler_flag = divination_2
	}
	if = {
		limit = {
			has_country_flag = saved_divination_3
		}
		set_ruler_flag = divination_1
		set_ruler_flag = divination_2
		set_ruler_flag = divination_3
	}
	
	if = {
		limit = {
			has_country_flag = saved_enchantment_1
		}
		set_ruler_flag = enchantment_1
	}
	if = {
		limit = {
			has_country_flag = saved_enchantment_2
		}
		set_ruler_flag = enchantment_1
		set_ruler_flag = enchantment_2
	}
	if = {
		limit = {
			has_country_flag = saved_enchantment_3
		}
		set_ruler_flag = enchantment_1
		set_ruler_flag = enchantment_2
		set_ruler_flag = enchantment_3
	}
	
	if = {
		limit = {
			has_country_flag = saved_evocation_1
		}
		set_ruler_flag = evocation_1
	}
	if = {
		limit = {
			has_country_flag = saved_evocation_2
		}
		set_ruler_flag = evocation_1
		set_ruler_flag = evocation_2
	}
	if = {
		limit = {
			has_country_flag = saved_evocation_3
		}
		set_ruler_flag = evocation_1
		set_ruler_flag = evocation_2
		set_ruler_flag = evocation_3
	}
	
	if = {
		limit = {
			has_country_flag = saved_illusion_1
		}
		set_ruler_flag = illusion_1
	}
	if = {
		limit = {
			has_country_flag = saved_illusion_2
		}
		set_ruler_flag = illusion_1
		set_ruler_flag = illusion_2
	}
	if = {
		limit = {
			has_country_flag = saved_illusion_3
		}
		set_ruler_flag = illusion_1
		set_ruler_flag = illusion_2
		set_ruler_flag = illusion_3
	}
	
	if = {
		limit = {
			has_country_flag = saved_necromancy_1
		}
		set_ruler_flag = necromancy_1
	}
	if = {
		limit = {
			has_country_flag = saved_necromancy_2
		}
		set_ruler_flag = necromancy_1
		set_ruler_flag = necromancy_2
	}
	if = {
		limit = {
			has_country_flag = saved_necromancy_3
		}
		set_ruler_flag = necromancy_1
		set_ruler_flag = necromancy_2
		set_ruler_flag = necromancy_3
	}
	
	if = {
		limit = {
			has_country_flag = saved_transmutation_1
		}
		set_ruler_flag = transmutation_1
	}
	if = {
		limit = {
			has_country_flag = saved_transmutation_2
		}
		set_ruler_flag = transmutation_1
		set_ruler_flag = transmutation_2
	}
	if = {
		limit = {
			has_country_flag = saved_transmutation_3
		}
		set_ruler_flag = transmutation_1
		set_ruler_flag = transmutation_2
		set_ruler_flag = transmutation_3
	}
}

ruler_clear_saved_spell_schools = {
	clr_country_flag = saved_abjuration_1
	clr_country_flag = saved_abjuration_2
	clr_country_flag = saved_abjuration_3
	clr_country_flag = saved_conjuration_1
	clr_country_flag = saved_conjuration_2
	clr_country_flag = saved_conjuration_3
	clr_country_flag = saved_divination_1
	clr_country_flag = saved_divination_2
	clr_country_flag = saved_divination_3
	clr_country_flag = saved_enchantment_1
	clr_country_flag = saved_enchantment_2
	clr_country_flag = saved_enchantment_3
	clr_country_flag = saved_evocation_1
	clr_country_flag = saved_evocation_2
	clr_country_flag = saved_evocation_3
	clr_country_flag = saved_illusion_1
	clr_country_flag = saved_illusion_2
	clr_country_flag = saved_illusion_3
	clr_country_flag = saved_necromancy_1
	clr_country_flag = saved_necromancy_2
	clr_country_flag = saved_necromancy_3
	clr_country_flag = saved_transmutation_1
	clr_country_flag = saved_transmutation_2
	clr_country_flag = saved_transmutation_3
}

magic_project_clear_lichdom_flags = {
	set_ruler_flag = magic_project_lichdom_complete
	clr_ruler_flag = magic_project_lichdom_started
	clr_ruler_flag = magic_project_lichdom_1
	clr_ruler_flag = magic_project_lichdom_2
	clr_ruler_flag = magic_project_lichdom_3
	clr_ruler_flag = magic_project_lichdom_4
	clr_ruler_flag = magic_project_lichdom_5
	clr_ruler_flag = magic_project_lichdom_6
	clr_ruler_flag = magic_project_lichdom_7
	clr_ruler_flag = magic_project_lichdom_8
	clr_ruler_flag = magic_project_lichdom_9
	clr_ruler_flag = magic_project_lichdom_10
	
	clr_ruler_flag = magic_project_lichdom_1_adventurers
	clr_ruler_flag = magic_project_lichdom_1_state
	clr_ruler_flag = magic_project_lichdom_1_myself
	clr_ruler_flag = magic_project_lichdom_2_amulet
	clr_ruler_flag = magic_project_lichdom_2_box
	clr_ruler_flag = magic_project_lichdom_5_a
	clr_ruler_flag = magic_project_lichdom_5_b
	clr_ruler_flag = magic_project_lichdom_5_c
	clr_ruler_flag = magic_project_lichdom_6_a
	clr_ruler_flag = magic_project_lichdom_6_b
	clr_ruler_flag = magic_project_lichdom_6_c
	clr_ruler_flag = magic_project_lichdom_7_heart
	clr_ruler_flag = magic_project_lichdom_7_unicorn
	clr_ruler_flag = magic_project_lichdom_8_a
}

magic_project_clear_lichdom_government_flags = {
	clr_country_flag = wizard_king_magocracy
	clr_country_flag = original_gov_monarchy
	clr_country_flag = original_gov_republic
	clr_country_flag = original_gov_theocracy
	clr_country_flag = original_gov_clergy
	clr_country_flag = original_gov_monastic
	clr_country_flag = original_gov_secular
	clr_country_flag = original_gov_adventurer
	clr_country_flag = original_gov_rezankand
	clr_country_flag = original_gov_oracular
	clr_country_flag = original_gov_tribal
}

clear_spell_flags = {
	clr_country_flag = spell_1
	clr_country_flag = spell_2
	clr_country_flag = spell_3
	clr_country_flag = spell_4
	clr_country_flag = spell_5
	clr_country_flag = spell_6
	clr_country_flag = spell_7
	clr_country_flag = spell_8
	clr_country_flag = spell_9
	clr_country_flag = spell_10
}

calculate_lichdom_chance = {
	set_variable={
		which=$which$ value=0
	}
	
	if = {
		limit = {
			has_ruler_flag = magic_project_lichdom_2_box
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	if = {
		limit = {
			has_ruler_flag = magic_project_lichdom_5_b
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	if = {
		limit = {
			has_ruler_flag = magic_project_lichdom_5_c
		}
		change_variable = {
			which = $which$
			value = 2
		}
	}
	if = {
		limit = {
			has_ruler_flag = magic_project_lichdom_6_b
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	if = {
		limit = {
			has_ruler_flag = magic_project_lichdom_6_c
		}
		change_variable = {
			which = $which$
			value = 2
		}
	}
	if = {
		limit = {
			has_ruler_flag = magic_project_lichdom_7_unicorn
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	if = {
		limit = {
			has_ruler_flag = magic_project_lichdom_8_a
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
}

count_provinces_in_capital_area = {
	set_variable={
		which=$which$ value=0
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 1
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 2
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 4
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 6
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}	
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 8
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 10
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 12
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 14
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 16
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 18
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 20
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 22
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 24
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 26
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 28
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 30
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 32
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 34
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 36
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 38
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 40
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 42
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 44
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 46
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 48
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 50
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 1
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 60
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 10
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 70
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 10
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 80
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 10
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 90
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 10
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 100
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 10
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 110
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 10
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 120
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 10
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 140
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 10
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 160
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 10
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 180
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 10
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 200
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 10
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 225
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 25
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 250
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 25
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 275
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 25
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 300
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 25
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 325
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 25
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 350
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 25
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 375
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 25
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 400
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 25
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 425
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 25
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 450
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 25
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 475
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 25
		}
	}
	
	if = {
		limit = {
			num_of_owned_provinces_with = {
				value = 500
				is_in_capital_area = yes
			}
		}
		change_variable = {
			which = $which$
			value = 25
		}
	}
}

magic_ruler_give_contextual_spell_school = {
	#Yeah eventually lol
}

magic_ruler_give_random_spell_school = {
	random_list = {
		10 = {
			if = {
				limit = {
					is_abjuration_1 = yes
				}
				set_ruler_flag = abjuration_2
			}
			else_if = {
				limit = {
					is_abjuration_2 = yes
				}
				set_ruler_flag = abjuration_3
			}
			else = {
				set_ruler_flag = abjuration_1
			}
		}
		10 = {
			if = {
				limit = {
					is_conjuration_1 = yes
				}
				set_ruler_flag = conjuration_2
			}
			else_if = {
				limit = {
					is_conjuration_2 = yes
				}
				set_ruler_flag = conjuration_3
			}
			else = {
				set_ruler_flag = conjuration_1
			}
		}
		10 = {
			if = {
				limit = {
					is_divination_1 = yes
				}
				set_ruler_flag = divination_2
			}
			else_if = {
				limit = {
					is_divination_2 = yes
				}
				set_ruler_flag = divination_3
			}
			else = {
				set_ruler_flag = divination_1
			}
		}
		10 = {
			if = {
				limit = {
					is_enchantment_1 = yes
				}
				set_ruler_flag = enchantment_2
			}
			else_if = {
				limit = {
					is_enchantment_2 = yes
				}
				set_ruler_flag = enchantment_3
			}
			else = {
				set_ruler_flag = enchantment_1
			}
		}
		10 = {
			if = {
				limit = {
					is_evocation_1 = yes
				}
				set_ruler_flag = evocation_2
			}
			else_if = {
				limit = {
					is_evocation_2 = yes
				}
				set_ruler_flag = evocation_3
			}
			else = {
				set_ruler_flag = evocation_1
			}
		}
		10 = {
			if = {
				limit = {
					is_illusion_1 = yes
				}
				set_ruler_flag = illusion_2
			}
			else_if = {
				limit = {
					is_illusion_2 = yes
				}
				set_ruler_flag = illusion_3
			}
			else = {
				set_ruler_flag = illusion_1
			}
		}
		10 = {
			if = {
				limit = {
					is_necromancy_1 = yes
				}
				set_ruler_flag = necromancy_2
			}
			else_if = {
				limit = {
					is_necromancy_2 = yes
				}
				set_ruler_flag = necromancy_3
			}
			else = {
				set_ruler_flag = necromancy_1
			}
		}
		10 = {
			if = {
				limit = {
					is_transmutation_1 = yes
				}
				set_ruler_flag = transmutation_2
			}
			else_if = {
				limit = {
					is_transmutation_2 = yes
				}
				set_ruler_flag = transmutation_3
			}
			else = {
				set_ruler_flag = transmutation_1
			}
		}
	}
}

magic_ruler_give_random_adm_school = {
	random_list = {
		34 = {
			if = {
				limit = {
					is_conjuration_1 = yes
				}
				set_ruler_flag = conjuration_2
			}
			else_if = {
				limit = {
					is_conjuration_2 = yes
				}
				set_ruler_flag = conjuration_3
			}
			else = {
				set_ruler_flag = conjuration_1
			}
		}
		33 = {
			if = {
				limit = {
					is_transmutation_1 = yes
				}
				set_ruler_flag = transmutation_2
			}
			else_if = {
				limit = {
					is_transmutation_2 = yes
				}
				set_ruler_flag = transmutation_3
			}
			else = {
				set_ruler_flag = transmutation_1
			}
		}
		33 = {
			if = {
				limit = {
					is_divination_1 = yes
				}
				set_ruler_flag = divination_2
			}
			else_if = {
				limit = {
					is_divination_2 = yes
				}
				set_ruler_flag = divination_3
			}
			else = {
				set_ruler_flag = divination_1
			}
		}
	}
}

magic_ruler_give_random_dip_school = {
	random_list = {
		34 = {
			if = {
				limit = {
					is_abjuration_1 = yes
				}
				set_ruler_flag = abjuration_2
			}
			else_if = {
				limit = {
					is_abjuration_2 = yes
				}
				set_ruler_flag = abjuration_3
			}
			else = {
				set_ruler_flag = abjuration_1
			}
		}
		33 = {
			if = {
				limit = {
					is_enchantment_1 = yes
				}
				set_ruler_flag = enchantment_2
			}
			else_if = {
				limit = {
					is_enchantment_2 = yes
				}
				set_ruler_flag = enchantment_3
			}
			else = {
				set_ruler_flag = enchantment_1
			}
		}
		33 = {
			if = {
				limit = {
					is_necromancy_1 = yes
				}
				set_ruler_flag = necromancy_2
			}
			else_if = {
				limit = {
					is_necromancy_2 = yes
				}
				set_ruler_flag = necromancy_3
			}
			else = {
				set_ruler_flag = necromancy_1
			}
		}
	}
}

magic_ruler_give_random_mil_school = {
	random_list = {
		50 = {
			if = {
				limit = {
					is_evocation_1 = yes
				}
				set_ruler_flag = evocation_2
			}
			else_if = {
				limit = {
					is_evocation_2 = yes
				}
				set_ruler_flag = evocation_3
			}
			else = {
				set_ruler_flag = evocation_1
			}
		}
		50 = {
			if = {
				limit = {
					is_abjuration_1 = yes
				}
				set_ruler_flag = abjuration_2
			}
			else_if = {
				limit = {
					is_abjuration_2 = yes
				}
				set_ruler_flag = abjuration_3
			}
			else = {
				set_ruler_flag = abjuration_1
			}
		}
	}
}


clear_witch_king_points = {
	#variable is set in magic ruler initialization
	hidden_effect = {
		set_variable = {
			which = pointsWitchKing
			value = 0
		}
	}
}

increase_witch_king_points_small = {
	#variable is set in magic ruler initialization
	hidden_effect = {
		change_variable = {
			which = pointsWitchKing
			value = 1
		}
	}
}

increase_witch_king_points_medium = {
	#variable is set in magic ruler initialization
	hidden_effect = {
		change_variable = {
			which = pointsWitchKing
			value = 2
		}
	}
}

increase_witch_king_points_large = {
	#variable is set in magic ruler initialization
	hidden_effect = {
		change_variable = {
			which = pointsWitchKing
			value = 3
		}
	}
}

magic_project_clear_homunculus_flags = {
		hidden_effect = {
			clr_ruler_flag = magic_project_homunculus_started
			clr_ruler_flag = magic_project_homunculus_1
			clr_ruler_flag = magic_project_homunculus_2
			clr_ruler_flag = magic_project_homunculus_3
			clr_ruler_flag = magic_project_homunculus_4
			clr_ruler_flag = magic_project_homunculus_5
			clr_ruler_flag = magic_project_homunculus_complete
			
			clr_ruler_flag = homunculus_current_male
			clr_ruler_flag = homunculus_current_female
			clr_ruler_flag = homunculus_current_androgyne
			clr_ruler_flag = homunculus_current_humanlike
			clr_ruler_flag = homunculus_current_artificial
		}
}

casted_foresight_spell_flag = {
	if = {
		limit = { 
			has_ruler_flag = foresight_spell_1
			NOT = { has_ruler_flag = foresight_spell_2 }
		}
		set_ruler_flag = foresight_spell_2
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_2
			NOT = { has_ruler_flag = foresight_spell_3 }
		}
		set_ruler_flag = foresight_spell_3
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_3
			NOT = { has_ruler_flag = foresight_spell_4 }
		}
		set_ruler_flag = foresight_spell_4
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_4
			NOT = { has_ruler_flag = foresight_spell_5 }
		}
		set_ruler_flag = foresight_spell_5
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_5
			NOT = { has_ruler_flag = foresight_spell_6 }
		}
		set_ruler_flag = foresight_spell_6
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_6
			NOT = { has_ruler_flag = foresight_spell_7 }
		}
		set_ruler_flag = foresight_spell_7
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_7
			NOT = { has_ruler_flag = foresight_spell_8 }
		}
		set_ruler_flag = foresight_spell_8
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_8
			NOT = { has_ruler_flag = foresight_spell_9 }
		}
		set_ruler_flag = foresight_spell_9
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_9
			NOT = { has_ruler_flag = foresight_spell_10 }
		}
		set_ruler_flag = foresight_spell_10
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_10
			NOT = { has_ruler_flag = foresight_spell_11 }
		}
		set_ruler_flag = foresight_spell_11
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_11
			NOT = { has_ruler_flag = foresight_spell_12 }
		}
		set_ruler_flag = foresight_spell_12
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_12
			NOT = { has_ruler_flag = foresight_spell_13 }
		}
		set_ruler_flag = foresight_spell_13
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_13
			NOT = { has_ruler_flag = foresight_spell_14 }
		}
		set_ruler_flag = foresight_spell_14
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_14
			NOT = { has_ruler_flag = foresight_spell_15 }
		}
		set_ruler_flag = foresight_spell_15
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_15
			NOT = { has_ruler_flag = foresight_spell_16 }
		}
		set_ruler_flag = foresight_spell_16
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_16
			NOT = { has_ruler_flag = foresight_spell_17 }
		}
		set_ruler_flag = foresight_spell_17
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_17
			NOT = { has_ruler_flag = foresight_spell_18 }
		}
		set_ruler_flag = foresight_spell_18
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_18
			NOT = { has_ruler_flag = foresight_spell_19 }
		}
		set_ruler_flag = foresight_spell_19
	}
	else_if = {
		limit = { 
			has_ruler_flag = foresight_spell_19
			NOT = { has_ruler_flag = foresight_spell_20 }
		}
		set_ruler_flag = foresight_spell_20
	}
	else = {
		set_ruler_flag = foresight_spell_1
	}
}

apply_foresight_spell = {
	if = {
		limit = {
			#has_ruler_flag = foresight_spell_1
		}
		random_list = {
			99 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			1 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_2
		}
		random_list = {
			98 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			2 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_3
		}
		random_list = {
			97 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			3 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}

		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_4
		}
		random_list = {
			96 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			4 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_5
		}
		random_list = {
			95 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			5 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_6
		}
		random_list = {
			94 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			6 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_7
		}
		random_list = {
			93 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			7 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_8
		}
		random_list = {
			92 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			8 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_9
		}
		random_list = {
			91 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			9 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_10
		}
		random_list = {
			90 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			10 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_11
		}
		random_list = {
			85 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			15 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_12
		}
		random_list = {
			80 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			20 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_13
		}
		random_list = {
			75 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			25 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_14
		}
		random_list = {
			70 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			30 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_15
		}
		random_list = {
			65 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			35 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_16
		}
		random_list = {
			60 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			40 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_17
		}
		random_list = {
			55 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			45 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_18
		}
		random_list = {
			50 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			50 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_19
		}
		random_list = {
			40 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			60 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
	if = {
		limit = {
			has_ruler_flag = foresight_spell_20
		}
		random_list = {
			20 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight
					duration = 365
				}
			}
			80 = {
				add_ruler_modifier = {
					name = magic_realm_divination_foresight_madness
					duration = -1
				}
				change_adm = -6
				change_dip = -6
				change_mil = -6
			}
		}
	}
}

magic_study_clear_study_effects = {
	clr_ruler_flag = ruler_studying_abjuration
	clr_ruler_flag = ruler_studying_conjuration
	clr_ruler_flag = ruler_studying_divination
	clr_ruler_flag = ruler_studying_enchantment
	clr_ruler_flag = ruler_studying_evocation
	clr_ruler_flag = ruler_studying_illusion
	clr_ruler_flag = ruler_studying_necromancy
	clr_ruler_flag = ruler_studying_transmutation
	
	clr_ruler_flag = ruler_studying_help_from_mages_estate
	clr_ruler_flag = ruler_studying_help_from_advisor
	clr_ruler_flag = ruler_studying_library_archives
	clr_ruler_flag = ruler_studying_ancient_tome_found
	clr_ruler_flag = ruler_studying_magic_relic
	clr_ruler_flag = ruler_studying_magic_precursor_knowledge
	clr_ruler_flag = ruler_studying_magisterial_support
	clr_ruler_flag = ruler_studying_mana_1
	clr_ruler_flag = ruler_studying_mana_2
	clr_ruler_flag = ruler_studying_mana_3
	clr_ruler_flag = ruler_studying_gold_1
	clr_ruler_flag = ruler_studying_gold_2
	clr_ruler_flag = ruler_studying_gold_3
	clr_ruler_flag = ruler_studying_unregulated_research
	clr_ruler_flag = ruler_studying_unsafe_experiments
	clr_ruler_flag = ruler_studying_live_experiments
	clr_ruler_flag = ruler_studying_forbidden_knowledge
	clr_ruler_flag = ruler_studying_appealed_to_darker_powers
	
}

magic_study_level_up_abjuration = {
	if = {
		limit = { 
			has_ruler_flag = abjuration_1
			NOT = { has_ruler_flag = abjuration_2 }
		}
		set_ruler_flag = abjuration_2
	}
	else_if = {
		limit = { 
			has_ruler_flag = abjuration_2
			NOT = { has_ruler_flag = abjuration_3 }
		}
		set_ruler_flag = abjuration_3
	}
	else = {
		set_ruler_flag = abjuration_1
	}
}

magic_study_level_up_conjuration = {
	if = {
		limit = { 
			has_ruler_flag = conjuration_1
			NOT = { has_ruler_flag = conjuration_2 }
		}
		set_ruler_flag = conjuration_2
	}
	else_if = {
		limit = { 
			has_ruler_flag = conjuration_2
			NOT = { has_ruler_flag = conjuration_3 }
		}
		set_ruler_flag = conjuration_3
	}
	else = {
		set_ruler_flag = conjuration_1
	}
}

magic_study_level_up_divination = {
	if = {
		limit = { 
			has_ruler_flag = divination_1
			NOT = { has_ruler_flag = divination_2 }
		}
		set_ruler_flag = divination_2
	}
	else_if = {
		limit = { 
			has_ruler_flag = divination_2
			NOT = { has_ruler_flag = divination_3 }
		}
		set_ruler_flag = divination_3
	}
	else = {
		set_ruler_flag = divination_1
	}
}

magic_study_level_up_enchantment = {
	if = {
		limit = { 
			has_ruler_flag = enchantment_1
			NOT = { has_ruler_flag = enchantment_2 }
		}
		set_ruler_flag = enchantment_2
	}
	else_if = {
		limit = { 
			has_ruler_flag = enchantment_2
			NOT = { has_ruler_flag = enchantment_3 }
		}
		set_ruler_flag = enchantment_3
	}
	else = {
		set_ruler_flag = enchantment_1
	}
}

magic_study_level_up_evocation = {
	if = {
		limit = { 
			has_ruler_flag = evocation_1
			NOT = { has_ruler_flag = evocation_2 }
		}
		set_ruler_flag = evocation_2
	}
	else_if = {
		limit = { 
			has_ruler_flag = evocation_2
			NOT = { has_ruler_flag = evocation_3 }
		}
		set_ruler_flag = evocation_3
	}
	else = {
		set_ruler_flag = evocation_1
	}
}

magic_study_level_up_illusion = {
	if = {
		limit = { 
			has_ruler_flag = illusion_1
			NOT = { has_ruler_flag = illusion_2 }
		}
		set_ruler_flag = illusion_2
	}
	else_if = {
		limit = { 
			has_ruler_flag = illusion_2
			NOT = { has_ruler_flag = illusion_3 }
		}
		set_ruler_flag = illusion_3
	}
	else = {
		set_ruler_flag = illusion_1
	}
}

magic_study_level_up_necromancy = {
	if = {
		limit = { 
			has_ruler_flag = necromancy_1
			NOT = { has_ruler_flag = necromancy_2 }
		}
		set_ruler_flag = necromancy_2
	}
	else_if = {
		limit = { 
			has_ruler_flag = necromancy_2
			NOT = { has_ruler_flag = necromancy_3 }
		}
		set_ruler_flag = necromancy_3
	}
	else = {
		set_ruler_flag = necromancy_1
	}
}

magic_study_level_up_transmutation = {
	if = {
		limit = { 
			has_ruler_flag = transmutation_1
			NOT = { has_ruler_flag = transmutation_2 }
		}
		set_ruler_flag = transmutation_2
	}
	else_if = {
		limit = { 
			has_ruler_flag = transmutation_2
			NOT = { has_ruler_flag = transmutation_3 }
		}
		set_ruler_flag = transmutation_3
	}
	else = {
		set_ruler_flag = transmutation_1
	}
}

magic_study_level_up_mana = {
	if = {
		limit = { 
			has_ruler_flag = ruler_studying_mana_1
			NOT = { has_ruler_flag = ruler_studying_mana_2 }
		}
		set_ruler_flag = ruler_studying_mana_2
	}
	else_if = {
		limit = { 
			has_ruler_flag = ruler_studying_mana_2
			NOT = { has_ruler_flag = ruler_studying_mana_3 }
		}
		set_ruler_flag = ruler_studying_mana_3
	}
	else = {
		set_ruler_flag = ruler_studying_mana_1
	}
}

magic_study_level_up_gold = {
	if = {
		limit = { 
			has_ruler_flag = ruler_studying_gold_1
			NOT = { has_ruler_flag = ruler_studying_gold_2 }
		}
		set_ruler_flag = ruler_studying_gold_2
	}
	else_if = {
		limit = { 
			has_ruler_flag = ruler_studying_gold_2
			NOT = { has_ruler_flag = ruler_studying_gold_3 }
		}
		set_ruler_flag = ruler_studying_gold_3
	}
	else = {
		set_ruler_flag = ruler_studying_gold_1
	}
}

remove_siege_spells_from_province = {
	remove_province_modifier = siege_magic_elemental_besieger
	remove_province_modifier = siege_magic_giant_besieger
	remove_province_modifier = siege_magic_dragon_besieger
}

magic_casted_spell = {
#Eventually this would be spending spell slots, but for its a spell-a-month limit
	hidden_effect = {
		ROOT = {
			add_ruler_modifier = { 
				name = ruler_recently_casted_spell
				duration = 28 #a month
				desc = ruler_recently_casted_spell_desc
				#hidden = yes
			}
		}
	}
	if = {
		limit = { has_ruler_flag = magic_menu_opened }
			clr_ruler_flag = magic_menu_opened 
	}
}

open_single_menu = {
	set_ruler_flag = magic_menu_opened
}

close_single_menu = {
		if = {
			limit = { has_ruler_flag = magic_menu_opened }
			clr_ruler_flag = magic_menu_opened 
		}
}

clear_siege_magic_effects = {
	#remove_province_modifier = 
}

remove_government_name_changers = {
	clr_country_flag = is_a_county
	clr_country_flag = knightly_order_adventurer
}

clear_mage_organization_effect = {
	clr_country_flag = mage_organization_decentralized_flag
	clr_country_flag = mage_organization_centralized_flag
	clr_country_flag = mage_organization_magisterium_flag

	remove_country_modifier = mage_organization_decentralized
	remove_country_modifier = mage_organization_centralized
	remove_country_modifier = mage_organization_magisterium
}

count_provinces_with_farm_goods_effect = {	#it isnt an actual count its used for the Plant Growth spell, its in 2's til 50 then 10's til 100, 25's til 500
	set_variable={
		which=$which$ value=0
	}
	
	every_owned_province = {
	    limit = { province_with_farm_goods = yes }
	    ROOT = {
		    change_variable = { 
			    which = $which$ 
			    value = 1 
		    }
	    }
	}
}


count_provinces_owned_by_neighbours_effect = {
	set_variable={
		which=$which$ value=0
	}
	
	
	every_province = {
		limit = {
			owner = {
				is_neighbor_of = ROOT
			}
		}
		ROOT = {
		    change_variable = { 
			    which = $which$ 
			    value = 1 
		    }
	    }
	}
}

count_provinces_owned_by_war_enemies_effect = {
	set_variable = {
		which=$which$ 
		value=0
	}
	
	every_province = {
		limit = {
			owner = {
				war_with = ROOT
			}
		}
		ROOT = {
		    change_variable = { 
			    which = $which$ 
			    value = 1 
		    }
	    }
	}

}

count_provinces_owned_by_country_effect = {	
	set_variable = {
		which=$which$ 
		value=0
	}
	
	every_owned_province = {
		ROOT = {
		    change_variable = { 
			    which = $which$ 
			    value = 1 
		    }
	    }
	}
}

count_provinces_owned_by_rivals_effect = {	
	set_variable = {
		which=$which$ 
		value=0
	}
	
	every_province = {
		limit = {
			owner = {
				ROOT = { is_rival = PREV }
			}
		}
		ROOT = {
		    change_variable = { 
			    which = $which$ 
			    value = 1 
		    }
	    }
	}
}


randomize_leader_pips_nonmagical_effect = {	#more chances for low pips in the random list
	set_variable = {
		which=$which$ 
		value=0
	}
	export_to_variable = {
		which = $which$
		value = MIL	
		who = ROOT
	}
	
	# if = {
		# limit = {
			# army_tradition = 20
		# }
		# change_variable = {
			# which = $which$
			# value = 1
		# }
	# }
	# if = {
		# limit = {
			# army_tradition = 40
		# }
		# change_variable = {
			# which = $which$
			# value = 1
		# }
	# }
	# if = {
		# limit = {
			# army_tradition = 60
		# }
		# change_variable = {
			# which = $which$
			# value = 1
		# }
	# }
	# if = {
		# limit = {
			# army_tradition = 80
		# }
		# change_variable = {
			# which = $which$
			# value = 1
		# }
	# }
	# if = {
		# limit = {
			# army_tradition = 100
		# }
		# change_variable = {
			# which = $which$
			# value = 1
		# }
	# }
	
	random_list = {
		10 = {
			change_variable = {
				which = $which$
				value = 0
			}
		}
		10 = {
			subtract_variable = {
				which = $which$
				value = 1
			}
		}
		10 = {
			subtract_variable = {
				which = $which$
				value = 2
			}
		}
		10 = {
			subtract_variable = {
				which = $which$
				value = 3
			}
		}
		10 = {
			subtract_variable = {
				which = $which$
				value = 4
			}
		}
		10 = {
			subtract_variable = {
				which = $which$
				value = 5
			}
		}
		10 = {
			change_variable = {
				which = $which$
				value = 1
			}
		}
		10 = {
			change_variable = {
				which = $which$
				value = 2
			}
		}
		10 = {
			change_variable = {
				which = $which$
				value = 3
			}
		}
		10 = {
			subtract_variable = {
				which = $which$
				value = 1
			}
		}
	}
	
	#Invalid number checks
	if = {
		limit = {
			check_variable = {
				which = $which$
				value = 12	
			}
		}
		set_variable = {
			which = $which$
			value = 11	
		}
	}
	if = {
		limit = {
			check_variable = {
				which = $which$
				value = 0	
			}
			NOT = {
				check_variable = {
					which = $which$
					value = 1
				}
			}
		}
		set_variable = {
			which = $which$
			value = 0
		}
	}
}

randomize_leader_pips_magical_effect = {	#more chances for high pips in the random list
	set_variable={
		which=$which$ value=0
	}
	export_to_variable = {
		which = $which$
		value = MIL
		who = ROOT
	}

	
	# if = {
		# limit = {
			# army_tradition = 20
		# }
		# change_variable = {
			# which = $which$
			# value = 1
		# }
	# }
	# if = {
		# limit = {
			# army_tradition = 40
		# }
		# change_variable = {
			# which = $which$
			# value = 1
		# }
	# }
	# if = {
		# limit = {
			# army_tradition = 60
		# }
		# change_variable = {
			# which = $which$
			# value = 1
		# }
	# }
	# if = {
		# limit = {
			# army_tradition = 80
		# }
		# change_variable = {
			# which = $which$
			# value = 1
		# }
	# }
	# if = {
		# limit = {
			# army_tradition = 100
		# }
		# change_variable = {
			# which = $which$
			# value = 1
		# }
	# }
	
	
	random_list = {
		10 = {
			change_variable = {
				which = $which$
				value = 4
			}
		}
		10 = {
			change_variable = {
				which = $which$
				value = 4
			}
		}
		10 = {
			change_variable = {
				which = $which$
				value = 5
			}
		}
		10 = {
			change_variable = {
				which = $which$
				value = 6
			}
		}
		10 = {
			change_variable = {
				which = $which$
				value = 7
			}
		}
		10 = {
			change_variable = {
				which = $which$
				value = 8
			}
		}
		10 = {
			change_variable = {
				which = $which$
				value = 9
			}
		}
		10 = {
			change_variable = {
				which = $which$
				value = 10
			}
		}
		10 = {
			change_variable = {
				which = $which$
				value = 11
			}
		}
		10 = {
			change_variable = {
				which = $which$
				value = 12
			}
		}
	}
	
	#Invalid number checks
	if = {
		limit = {
			check_variable = {
				which = $which$
				value = 12	
			}
		}
		set_variable = {
			which = $which$
			value = 11	
		}
	}
	# if = {
		# limit = {
			# check_variable = {
				# which = $which$
				# value = 0	
			# }
			# NOT = {
				# check_variable = {
					# which = $which$
					# value = 1
				# }
			# }
		# }
		# set_variable = {
			# which = $which$
			# value = 0
		# }
	# }
}

set_add_relics_count = {
	hidden_effect = {
		REB = {
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = num_precursor_relics
							value = 0
						}
					}
				}
				set_variable = {
					which = num_precursor_relics
					value = 4
				}
			}
			else = {
				change_variable = {
					which = num_precursor_relics
					value = 1
				}
			}
		}
	}
}

set_add_damestear_count = {
	hidden_effect = {
		REB = {
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = num_damestear
							value = 0
						}
					}
				}
				set_variable = {
					which = num_damestear
					value = 1
				}
			}
			else = {
				change_variable = {
					which = num_damestear
					value = 1
				}
			}
		}
	}
}

set_rem_damestear_count = {
	hidden_effect = {
		REB = {
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = rem_damestear
							value = 0
						}
					}
				}
				set_variable = {
					which = rem_damestear
					value = 1
				}
			}
			else = {
				change_variable = {
					which = rem_damestear
					value = 1
				}
			}
		}
	}
}

set_add_orc_slaves_count = {
	hidden_effect = {
		REB = {
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = num_orc_slaves
							value = 0
						}
					}
				}
				set_variable = {
					which = num_orc_slaves
					value = 1
				}
			}
			else = {
				change_variable = {
					which = num_orc_slaves
					value = 1
				}
			}
		}
	}
}

set_add_ruin_count = {
	hidden_effect = {
		REB = {
			if = {
				limit = {
					NOT = {
						check_variable = {
							which = num_ruin
							value = 0
						}
					}
				}
				set_variable = {
					which = num_ruin
					value = 1
				}
			}
			else = {
				change_variable = {
					which = num_ruin
					value = 1
				}
			}
		}
	}
}

ynnic_barge_effect = {
	if = {
		limit = { capital_scope = { region = rzenta_region } }
		set_country_flag = ynn_barge_distance_3
		set_country_flag = ynn_dam_one
		1186 = { owner = { country_event = { id = ynn_barges.2 days = 50 random = 20 } } }
	}
	else_if = {
		limit = { capital_scope = { region = forest_of_the_cursed_ones_region } }
		set_country_flag = ynn_barge_distance_3
		set_country_flag = ynn_dam_two
		1165 = { owner = { country_event = { id = ynn_barges.2 days = 50 random = 20 } } }
	}
	else_if = {
		limit = { capital_scope = { province_group = west_dolindha } }
		set_country_flag = ynn_barge_distance_2
		set_country_flag = ynn_dam_one
		1186 = { owner = { country_event = { id = ynn_barges.2 days = 50 random = 20 } } }
	}
	else_if = {
		limit = { capital_scope = { province_group = east_dolindha } }
		set_country_flag = ynn_barge_distance_2
		set_country_flag = ynn_dam_two
		1165 = { owner = { country_event = { id = ynn_barges.2 days = 50 random = 20 } } }
	}
	else_if = {
		limit = { capital_scope = { region = epednan_expanse_region } }
		set_country_flag = ynn_barge_distance_2
		set_country_flag = ynn_dam_one
		1138 = { owner = { country_event = { id = ynn_barges.2 days = 50 random = 20 } } }
	}
	else_if = {
		limit = { capital_scope = { region = veykoda_region } }
		set_country_flag = ynn_barge_distance_2
		set_country_flag = ynn_dam_two
		1138 = { owner = { country_event = { id = ynn_barges.2 days = 50 random = 20 } } }
	}
	else_if = {
		limit = { capital_scope = { region = sarda_region } }
		set_country_flag = ynn_barge_distance_1
		set_country_flag = ynn_dam_three
		1138 = { owner = { country_event = { id = ynn_barges.2 days = 50 random = 20 } } }
	}
}


ynnic_barge_advance = {
	if = {
		limit = { has_country_flag = ynn_dam_one }
		1138 = { owner = { country_event = { id = ynn_barges.2 days = 50 random = 20 } } }
	}
	else_if = {
		limit = { has_country_flag = ynn_dam_two }
		1138 = { owner = { country_event = { id = ynn_barges.2 days = 50 random = 20 } } }
	}
	else_if = {
		limit = { has_country_flag = ynn_dam_three }
		1133 = { owner = { country_event = { id = ynn_barges.2 days = 50 random = 20 } } }
	}
	else_if = {
		limit = { has_country_flag = ynn_dam_four }
		1133 = { owner = { country_event = { id = ynn_barges.8 days = 10 random = 5 } } }
		ROOT = { country_event = { id = ynn_barges.9 days = 10 random = 5 } }
	}
}

ynn_barge_clear_flag = {
	clr_country_flag = little_barges
	clr_country_flag = normal_barges
	clr_country_flag = big_barges
	clr_country_flag = ynn_barge_distance_1
	clr_country_flag = ynn_barge_distance_2
	clr_country_flag = ynn_barge_distance_3
	clr_country_flag = ynn_dam_one
	clr_country_flag = ynn_dam_two
	clr_country_flag = ynn_dam_three
	clr_country_flag = ynn_dam_four
	clr_country_flag = ynn_reward_1
	clr_country_flag = ynn_reward_2
	clr_country_flag = ynn_reward_3
	clr_country_flag = ynn_reward_4
	clr_country_flag = ynn_reward_5
	clr_country_flag = ynn_reward_6
	clr_country_flag = ynn_reward_7
}

ynn_reward_setup = {
	if = {
		limit = {
			has_country_flag = little_barges
			has_country_flag = ynn_barge_distance_1
		}
		set_country_flag = ynn_reward_1
	}
	else_if = {
		limit = {
			has_country_flag = little_barges
			has_country_flag = ynn_barge_distance_2
		}
		set_country_flag = ynn_reward_2
	}
	else_if = {
		limit = {
			has_country_flag = little_barges
			has_country_flag = ynn_barge_distance_3
		}
		set_country_flag = ynn_reward_3
	}
	else_if = {
		limit = {
			has_country_flag = normal_barges
			has_country_flag = ynn_barge_distance_1
		}
		set_country_flag = ynn_reward_3
	}
	else_if = {
		limit = {
			has_country_flag = normal_barges
			has_country_flag = ynn_barge_distance_2
		}
		set_country_flag = ynn_reward_4
	}
	else_if = {
		limit = {
			has_country_flag = normal_barges
			has_country_flag = ynn_barge_distance_3
		}
		set_country_flag = ynn_reward_5
	}
	
	else_if = {
		limit = {
			has_country_flag = big_barges
			has_country_flag = ynn_barge_distance_1
		}
		set_country_flag = ynn_reward_5
	}
	else_if = {
		limit = {
			has_country_flag = big_barges
			has_country_flag = ynn_barge_distance_2
		}
		set_country_flag = ynn_reward_6
	}
	else_if = {
		limit = {
			has_country_flag = big_barges
			has_country_flag = ynn_barge_distance_3
		}
		set_country_flag = ynn_reward_7
	}
}

ynn_reward = {
	trigger_switch = {
		on_trigger = has_country_flag
		
		ynn_reward_1 = { add_prestige = 2 add_legitimacy = 2 }
		ynn_reward_2 = { add_prestige = 5 increase_legitimacy_small_effect = yes }
		ynn_reward_3 = { add_prestige = 5 increase_legitimacy_small_effect = yes  add_dip_power = 10 }
		ynn_reward_4 = { add_prestige = 5 increase_legitimacy_small_effect = yes  add_dip_power = 15 }
		ynn_reward_5 = { add_prestige = 10 increase_legitimacy_medium_effect = yes  add_dip_power = 20 }
		ynn_reward_6 = { add_prestige = 10 increase_legitimacy_medium_effect = yes  add_dip_power = 20 random = { chance = 50 add_stability_or_adm_power = yes } }
		ynn_reward_7 = { add_prestige = 15 increase_legitimacy_large_effect = yes  add_dip_power = 30 add_stability_or_adm_power = yes }
	}
}

rahen_remove_harimraj_reforms_effect = {
	remove_country_modifier = rahen_board_of_inquiry
	remove_country_modifier = rahen_restoring_ministry_1
	remove_country_modifier = rahen_restoring_ministry_2
	remove_country_modifier = rahen_restoring_ministry_3
	remove_country_modifier = rahen_restoring_ministry_4
	remove_country_modifier = rahen_raja_accompanying_diplomatic_missions
	remove_country_modifier = rahen_raja_restored_court_reputation_1
	remove_country_modifier = rahen_raja_restored_court_reputation_2
	remove_country_modifier = rahen_raja_restored_court_reputation_3
	remove_country_modifier = rahen_raja_restored_court_reputation_4
	remove_country_modifier = rahen_raja_restored_court_reputation_5
	clr_country_flag = rahen_ministries_disbanded_1
	clr_country_flag = rahen_ministries_disbanded_2
}

rahen_add_completed_reforms_flag = {
	if = {
		limit = {
			4411 = { 
				NOT = {
					has_province_modifier = rahen_corrupt_ministers
					has_province_modifier = rahen_powerful_nobility
					has_province_modifier = rahen_arrogant_foreign_office
					has_province_modifier = rahen_disloyal_officers
				} 
			}
		}
		set_country_flag = reformed_rahen_court
	}
}


blood_lotus_rebellion_spawns_headquarters = {
	random_owned_province = {
		limit = {
			OR = {
				culture_group = upper_raheni
				culture_group = middle_raheni
				culture_group = south_raheni
				has_human_minority_trigger = yes
			}
			NOT = {
				has_province_modifier = blood_lotus_guerrillas
				has_province_modifier = blood_lotus_guerrillas_hidden
				has_province_modifier = blood_lotus_sympathizers
			}
			superregion = rahen_superregion
			NOT = {
				calc_true_if = {
					region_for_scope_province = { has_province_modifier = blood_lotus_headquarter }
					amount = 2
				}
			}
		}
		add_province_modifier = {
			name = blood_lotus_headquarter
			duration = -1
		}
		spawn_rebels = {
			type = blood_lotus_rebel
			size = 2
			win = yes
		}
	}
}

blood_lotus_rebellion_spawns = {
	random_owned_province = {
		limit = {
			OR = {
				culture_group = upper_raheni
				culture_group = middle_raheni
				culture_group = south_raheni
				has_human_minority_trigger = yes
			}
			NOT = {
				has_province_modifier = blood_lotus_guerrillas
				has_province_modifier = blood_lotus_guerrillas_hidden
				has_province_modifier = blood_lotus_headquarter
			}
			superregion = rahen_superregion
		}
		add_province_modifier = {
			name = blood_lotus_guerrillas
			duration = -1
		}
	}
}

blood_lotus_rebellion_spawns_hidden = {
	random_owned_province = {
		limit = {
			OR = {
				culture_group = upper_raheni
				culture_group = middle_raheni
				culture_group = south_raheni
				has_human_minority_trigger = yes
			}
			NOT = {
				has_province_modifier = blood_lotus_guerrillas
				has_province_modifier = blood_lotus_guerrillas_hidden
				has_province_modifier = blood_lotus_headquarter
			}
			superregion = rahen_superregion
			has_province_modifier = blood_lotus_sympathizers
		}
		add_province_modifier = {
			name = blood_lotus_guerrillas_hidden
			duration = -1
			hidden = yes
		}
	}
}

blood_lotus_rebellion_spreads = {
	random_owned_province = {
		limit = {
			OR = {
				has_province_modifier = blood_lotus_guerrillas
				has_province_modifier = blood_lotus_headquarter
			}
			any_neighbor_province = { #To ensure that it can spread to a neighbouring province
				NOT = {
					has_province_modifier = blood_lotus_guerrillas
					has_province_modifier = blood_lotus_guerrillas_hidden
					has_province_modifier = blood_lotus_headquarter
				}
				superregion = rahen_superregion
				owned_by = ROOT
			}
			superregion = rahen_superregion
		}
		random_neighbor_province = {
			limit = {
				NOT = {
					has_province_modifier = blood_lotus_guerrillas
					has_province_modifier = blood_lotus_guerrillas_hidden
					has_province_modifier = blood_lotus_headquarter
				}
				superregion = rahen_superregion
				owned_by = ROOT
			}
			add_province_modifier = {
				name = blood_lotus_guerrillas
				duration = -1
			}
		}
	}
}

blood_lotus_rebellion_spreads_hidden = {
	random_owned_province = {
		limit = {
			OR = {
				has_province_modifier = blood_lotus_guerrillas_hidden
				has_province_modifier = blood_lotus_guerrillas
				has_province_modifier = blood_lotus_headquarter
			}
			any_neighbor_province = { #To ensure that it can spread to a neighbouring province
				NOT = {
					has_province_modifier = blood_lotus_guerrillas
					has_province_modifier = blood_lotus_guerrillas_hidden
					has_province_modifier = blood_lotus_headquarter
				}
				superregion = rahen_superregion
				owned_by = ROOT
				has_province_modifier = blood_lotus_sympathizers
			}
			superregion = rahen_superregion
		}
		random_neighbor_province = {
			limit = {
				NOT = {
					has_province_modifier = blood_lotus_guerrillas
					has_province_modifier = blood_lotus_guerrillas_hidden
					has_province_modifier = blood_lotus_headquarter
				}
				superregion = rahen_superregion
				owned_by = ROOT
				has_province_modifier = blood_lotus_sympathizers
			}
			add_province_modifier = {
				name = blood_lotus_guerrillas_hidden
				duration = -1
				hidden = yes
			}
		}
	}
}

blood_lotus_rebellion_moves = {
	random_owned_province = {
		limit = {
			OR = {
				has_province_modifier = blood_lotus_guerrillas
			}
			any_neighbor_province = { #To ensure that it can spread to a neighbouring province
				NOT = {
					has_province_modifier = blood_lotus_guerrillas
					has_province_modifier = blood_lotus_guerrillas_hidden
					has_province_modifier = blood_lotus_headquarter
				}
				superregion = rahen_superregion
				owned_by = ROOT
			}
			superregion = rahen_superregion
		}
		random_neighbor_province = {
			limit = {
				NOT = {
					has_province_modifier = blood_lotus_guerrillas
					has_province_modifier = blood_lotus_guerrillas_hidden
					has_province_modifier = blood_lotus_headquarter
				}
				superregion = rahen_superregion
				owned_by = ROOT
			}
			add_province_modifier = {
				name = blood_lotus_guerrillas
				duration = -1
			}
			PREV = { remove_province_modifier = blood_lotus_guerrillas }
		}
	}
}

blood_lotus_rebellion_moves_hidden = {
	random_owned_province = {
		limit = {
			OR = {
				has_province_modifier = blood_lotus_guerrillas_hidden
			}
			any_neighbor_province = { #To ensure that it can spread to a neighbouring province
				NOT = {
					has_province_modifier = blood_lotus_guerrillas
					has_province_modifier = blood_lotus_guerrillas_hidden
					has_province_modifier = blood_lotus_headquarter
				}
				superregion = rahen_superregion
				owned_by = ROOT
				has_province_modifier = blood_lotus_sympathizers
			}
			superregion = rahen_superregion
		}
		random_neighbor_province = {
			limit = {
				NOT = {
					has_province_modifier = blood_lotus_guerrillas
					has_province_modifier = blood_lotus_guerrillas_hidden
					has_province_modifier = blood_lotus_headquarter
				}
				superregion = rahen_superregion
				owned_by = ROOT
				has_province_modifier = blood_lotus_sympathizers
			}
			add_province_modifier = {
				name = blood_lotus_guerrillas_hidden
				duration = -1
				hidden = yes
			}
			PREV = { remove_province_modifier = blood_lotus_guerrillas_hidden }
		}
	}
}

blood_lotus_rebellion_hides = {
	random_owned_province = {
		limit = {
			OR = {
				has_province_modifier = blood_lotus_guerrillas
			}
			any_neighbor_province = { #To ensure that it can spread to a neighbouring province
				NOT = {
					has_province_modifier = blood_lotus_guerrillas
					has_province_modifier = blood_lotus_guerrillas_hidden
					has_province_modifier = blood_lotus_headquarter
				}
				superregion = rahen_superregion
				owned_by = ROOT
				has_province_modifier = blood_lotus_sympathizers
			}
			
			superregion = rahen_superregion
		}
		random_neighbor_province = {
			limit = {
				NOT = {
					has_province_modifier = blood_lotus_guerrillas
					has_province_modifier = blood_lotus_guerrillas_hidden
					has_province_modifier = blood_lotus_headquarter
				}
				superregion = rahen_superregion
				owned_by = ROOT
				has_province_modifier = blood_lotus_sympathizers
			}
			add_province_modifier = {
				name = blood_lotus_guerrillas_hidden
				duration = -1
				hidden = yes
			}
			PREV = { remove_province_modifier = blood_lotus_guerrillas }
		}
	}
}

blood_lotus_new_sympathizers = {
	random_owned_province = {
		limit = {
			OR = {
				culture_group = upper_raheni
				culture_group = middle_raheni
				culture_group = south_raheni
				has_human_minority_trigger = yes
			}
			NOT = {
				has_province_modifier = blood_lotus_sympathizers
				has_province_modifier = blood_lotus_headquarter
				has_province_modifier = blood_lotus_dissuaded_sympathizers
			}
			superregion = rahen_superregion
			owned_by = ROOT
		}
		area = {
			type = all
			limit = {
				OR = {
					culture_group = upper_raheni
					culture_group = middle_raheni
					culture_group = south_raheni
					has_human_minority_trigger = yes
				}
				NOT = {
					has_province_modifier = blood_lotus_sympathizers
					has_province_modifier = blood_lotus_headquarter
					has_province_modifier = blood_lotus_dissuaded_sympathizers
				}
				superregion = rahen_superregion
				owned_by = ROOT
			}
			add_province_modifier = {
				name = blood_lotus_sympathizers
				duration = -1
			}
		}
	}
}

clear_oracle_prophecy_flag = {
	clr_ruler_flag = prophecy_bad_outcome
	clr_ruler_flag = prophecy_grey_outcome
	clr_ruler_flag = prophecy_good_outcome
	clr_ruler_flag = prophecy_low_intensity
	clr_ruler_flag = prophecy_high_intensity
	clr_ruler_flag = oracle_prophecy_ongoing
}


harpy_define_pop_to_take = {
	random_province = {
		limit = { OR = { owned_by = ROOT owner = { is_subject_of = ROOT } } NOT = { has_province_flag = harpy_pop_@ROOT has_harpy_majority_trigger = yes } is_city = yes development = 4 }
		set_province_flag = option_harpy_pop_1_@ROOT
		set_province_flag = harpy_pop_@ROOT
		save_event_target_as = harpy_pop1
	}
	random_province = {
		limit = { OR = { owned_by = ROOT owner = { is_subject_of = ROOT } } NOT = { has_province_flag = harpy_pop_@ROOT has_harpy_majority_trigger = yes } is_city = yes development = 4 }
		set_province_flag = option_harpy_pop_2_@ROOT
		set_province_flag = harpy_pop_@ROOT
		save_event_target_as = harpy_pop2
	}
	random_province = {
		limit = { OR = { owned_by = ROOT owner = { is_subject_of = ROOT } } NOT = { has_province_flag = harpy_pop_@ROOT has_harpy_majority_trigger = yes } is_city = yes development = 4 }
		set_province_flag = option_harpy_pop_3_@ROOT
		set_province_flag = harpy_pop_@ROOT
		save_event_target_as = harpy_pop3
	}
	random_province = {
		limit = { OR = { owned_by = ROOT owner = { is_subject_of = ROOT } } NOT = { has_province_flag = harpy_pop_@ROOT has_harpy_majority_trigger = yes } is_city = yes development = 4 }
		set_province_flag = option_harpy_pop_4_@ROOT
		set_province_flag = harpy_pop_@ROOT
		save_event_target_as = harpy_pop4
	}
}

harpy_move_pop_to_capital_effect = {
	if = { 
		limit = { has_dwarven_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_dwarven_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_dwarven_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_elven_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_elven_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_elven_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_halfling_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_halfling_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_halfling_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_gnomish_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_gnomish_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_gnomish_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_half_orcish_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_half_orcish_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_half_orcish_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_kobold_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_kobold_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_kobold_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_orcish_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_orcish_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_orcish_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_gnollish_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_gnollish_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_gnollish_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_ruinborn_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_ruinborn_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_ruinborn_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_goblin_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_goblin_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_goblin_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_troll_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_troll_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_troll_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_half_elven_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_half_elven_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_half_elven_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_ogre_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_ogre_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_ogre_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_harimari_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_harimari_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_harimari_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_centaur_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_centaur_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_centaur_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_hobgoblin_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_hobgoblin_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_hobgoblin_minority_size_effect = yes
				}
			}
		}
	}
	else_if = {
		limit = { has_human_majority_trigger = yes }
		ROOT = {
			capital_scope = {
				if = {
					limit = { has_large_human_minority_trigger = yes }
					random_list = {
						33 = { add_base_tax = 1 }
						33 = { add_base_production = 1 }
						33 = { add_base_manpower = 1 }
					}
				}
				else = {
					add_human_minority_size_effect = yes
				}
			}
		}
	}
	random_list = {
		33 = { add_base_tax = -1 ROOT = { capital_scope = { add_base_tax = 1 } } }
		33 = { add_base_production = -1 ROOT = { capital_scope = { add_base_production = 1 } } }
		33 = { add_base_manpower = -1 ROOT = { capital_scope = { add_base_manpower = 1 } } }
	}
	if = {
		limit = { NOT = { owned_by = ROOT } }
		owner = { add_liberty_desire = 10 }
	}
	add_devastation = 5
}

harpy_define_raid_target = {
	random_owned_province = {
		limit = {
			any_province = {
				NOT = {
					province_distance = {
						who = PREV
						distance = 100
					}
				}
				NOT = {
					has_province_flag = harpy_raid_@ROOT
					owned_by = ROOT
					owner = { is_subject_of = ROOT }
					owner = { overlord_of = ROOT }
					alliance_with = ROOT
					has_terrain = cavern
					has_terrain = dwarven_road
					has_terrain = dwarven_hold
				}
				is_city = yes
				has_discovered = ROOT
			}
		}
		random_province = {
			limit = {
				NOT = {
					province_distance = {
						who = PREV
						distance = 100
					}
				}
				NOT = {
					has_province_flag = harpy_raid_@ROOT
					owned_by = ROOT
					owner = { is_subject_of = ROOT }
					owner = { overlord_of = ROOT }
					alliance_with = ROOT
					has_terrain = cavern
					has_terrain = dwarven_road
					has_terrain = dwarven_hold
				}
				is_city = yes
				has_discovered = ROOT
			}
			set_province_flag = option_harpy_raid_1_@ROOT
			set_province_flag = harpy_raid_@ROOT
			save_event_target_as = harpy_raid1
		}
	}
	random_owned_province = {
		limit = {
			any_province = {
				NOT = {
					province_distance = {
						who = PREV
						distance = 100
					}
				}
				NOT = {
					has_province_flag = harpy_raid_@ROOT
					owned_by = ROOT
					owner = { is_subject_of = ROOT }
					owner = { overlord_of = ROOT }
					alliance_with = ROOT
					has_terrain = cavern
					has_terrain = dwarven_road
					has_terrain = dwarven_hold
				}
				is_city = yes
				has_discovered = ROOT
			}
		}
		random_province = {
			limit = {
				NOT = {
					province_distance = {
						who = PREV
						distance = 100
					}
				}
				NOT = {
					has_province_flag = harpy_raid_@ROOT
					owned_by = ROOT
					owner = { is_subject_of = ROOT }
					owner = { overlord_of = ROOT }
					alliance_with = ROOT
					has_terrain = cavern
					has_terrain = dwarven_road
					has_terrain = dwarven_hold
				}
				is_city = yes
				has_discovered = ROOT
			}
			set_province_flag = option_harpy_raid_2_@ROOT
			set_province_flag = harpy_raid_@ROOT
			save_event_target_as = harpy_raid2
		}
	}
	random_owned_province = {
		limit = {
			any_province = {
				NOT = {
					province_distance = {
						who = PREV
						distance = 100
					}
				}
				NOT = {
					has_province_flag = harpy_raid_@ROOT
					owned_by = ROOT
					owner = { is_subject_of = ROOT }
					owner = { overlord_of = ROOT }
					alliance_with = ROOT
					has_terrain = cavern
					has_terrain = dwarven_road
					has_terrain = dwarven_hold
				}
				is_city = yes
				has_discovered = ROOT
			}
		}
		random_province = {
			limit = {
				NOT = {
					province_distance = {
						who = PREV
						distance = 100
					}
				}
				NOT = {
					has_province_flag = harpy_raid_@ROOT
					owned_by = ROOT
					owner = { is_subject_of = ROOT }
					owner = { overlord_of = ROOT }
					alliance_with = ROOT
					has_terrain = cavern
					has_terrain = dwarven_road
					has_terrain = dwarven_hold
				}
				is_city = yes
				has_discovered = ROOT
			}
			set_province_flag = option_harpy_raid_3_@ROOT
			set_province_flag = harpy_raid_@ROOT
			save_event_target_as = harpy_raid3
		}
	}
	random_owned_province = {
		limit = {
			any_province = {
				NOT = {
					province_distance = {
						who = PREV
						distance = 100
					}
				}
				NOT = {
					has_province_flag = harpy_raid_@ROOT
					owned_by = ROOT
					owner = { is_subject_of = ROOT }
					owner = { overlord_of = ROOT }
					alliance_with = ROOT
					has_terrain = cavern
					has_terrain = dwarven_road
					has_terrain = dwarven_hold
				}
				is_city = yes
				has_discovered = ROOT
			}
		}
		random_province = {
			limit = {
				NOT = {
					province_distance = {
						who = PREV
						distance = 100
					}
				}
				NOT = {
					has_province_flag = harpy_raid_@ROOT
					owned_by = ROOT
					owner = { is_subject_of = ROOT }
					owner = { overlord_of = ROOT }
					alliance_with = ROOT
					has_terrain = cavern
					has_terrain = dwarven_road
					has_terrain = dwarven_hold
				}
				is_city = yes
				has_discovered = ROOT
			}
			set_province_flag = option_harpy_raid_4_@ROOT
			set_province_flag = harpy_raid_@ROOT
			save_event_target_as = harpy_raid4
		}
	}
}

harpy_raid_effect = {
	if = {
		limit = { development = 50 }
		remove_loot = {
			who = ROOT
			amount = 25
		}
	}
	else_if = {
		limit = { development = 40 }
		remove_loot = {
			who = ROOT
			amount = 20
		}
	}
	else_if = {
		limit = { development = 35 }
		remove_loot = {
			who = ROOT
			amount = 17.5
		}
	}
	else_if = {
		limit = { development = 30 }
		remove_loot = {
			who = ROOT
			amount = 15
		}
	}
	else_if = {
		limit = { development = 25 }
		remove_loot = {
			who = ROOT
			amount = 12.5
		}
	}
	else_if = {
		limit = { development = 20 }
		remove_loot = {
			who = ROOT
			amount = 10
		}
	}
	else_if = {
		limit = { development = 15 }
		remove_loot = {
			who = ROOT
			amount = 7.5
		}
	}
	else_if = {
		limit = { development = 10 }
		remove_loot = {
			who = ROOT
			amount = 5
		}
	}
	else = {
		remove_loot = {
			who = ROOT
			amount = 2.5
		}
	}
	add_devastation = 10
	
	# if = { 
		# limit = { ROOT = { any_owned_province = { NOT = { feudalism = 100 } } } feudalism = 100 }
		# ROOT = { 
			# random_owned_province = {
				# limit = { NOT = { feudalism = 100 } }
				# add_institution_embracement = { which = feudalism value = 20 }
			# }
		# }
	# }
	if = { 
		limit = { ROOT = { capital_scope = { NOT = { feudalism = 100 } } } feudalism = 100 }
		ROOT = {
			capital_scope = { add_institution_embracement = { which = feudalism value = 10 } }
		}
	}
	# else_if = { 
		# limit = { ROOT = { any_owned_province = { NOT = { renaissance = 100 } } } renaissance = 100 }
		# ROOT = { 
			# random_owned_province = {
				# limit = { NOT = { renaissance = 100 } }
				# add_institution_embracement = { which = renaissance value = 20 }
			# }
		# }
	# }
	else_if = { 
		limit = { ROOT = { capital_scope = { NOT = { renaissance = 100 } } } renaissance = 100 }
		ROOT = {
			capital_scope = { add_institution_embracement = { which = renaissance value = 10 } }
		}
	}
	# else_if = { 
		# limit = { ROOT = { any_owned_province = { NOT = { new_world_i = 100 } } } new_world_i = 100 }
		# ROOT = { 
			# random_owned_province = {
				# limit = { NOT = { new_world_i = 100 } }
				# add_institution_embracement = { which = new_world_i value = 20 }
			# }
		# }
	# }
	else_if = { 
		limit = { ROOT = { capital_scope = { NOT = { new_world_i = 100 } } } new_world_i = 100 }
		ROOT = {
			capital_scope = { add_institution_embracement = { which = new_world_i value = 10 } }
		}
	}
	# else_if = { 
		# limit = { ROOT = { any_owned_province = { NOT = { printing_press = 100 } } } printing_press = 100 }
		# ROOT = { 
			# random_owned_province = {
				# limit = { NOT = { printing_press = 100 } }
				# add_institution_embracement = { which = printing_press value = 20 }
			# }
		# }
	# }
	else_if = { 
		limit = { ROOT = { capital_scope = { NOT = { printing_press = 100 } } } printing_press = 100 }
		ROOT = {
			capital_scope = { add_institution_embracement = { which = printing_press value = 10 } }
		}
	}
	# else_if = { 
		# limit = { ROOT = { any_owned_province = { NOT = { global_trade = 100 } } } global_trade = 100 }
		# ROOT = { 
			# random_owned_province = {
				# limit = { NOT = { global_trade = 100 } }
				# add_institution_embracement = { which = global_trade value = 20 }
			# }
		# }
	# }
	else_if = { 
		limit = { ROOT = { capital_scope = { NOT = { global_trade = 100 } } } global_trade = 100 }
		ROOT = {
			capital_scope = { add_institution_embracement = { which = global_trade value = 10 } }
		}
	}
	# else_if = { 
		# limit = { ROOT = { any_owned_province = { NOT = { manufactories = 100 } } } manufactories = 100 }
		# ROOT = { 
			# random_owned_province = {
				# limit = { NOT = { manufactories = 100 } }
				# add_institution_embracement = { which = manufactories value = 20 }
			# }
		# }
	# }
	else_if = { 
		limit = { ROOT = { capital_scope = { NOT = { manufactories = 100 } } } manufactories = 100 }
		ROOT = {
			capital_scope = { add_institution_embracement = { which = manufactories value = 10 } }
		}
	}
	# else_if = { 
		# limit = { ROOT = { any_owned_province = { NOT = { enlightenment = 100 } } } enlightenment = 100 }
		# ROOT = {
			# random_owned_province = {
				# limit = { NOT = { enlightenment = 100 } }
				# add_institution_embracement = { which = enlightenment value = 20 }
			# }
		# }
	# }
	else_if = { 
		limit = { ROOT = { capital_scope = { NOT = { enlightenment = 100 } } } enlightenment = 100 }
		ROOT = {
			capital_scope = { add_institution_embracement = { which = enlightenment value = 10 } }
		}
	}
	owner = { add_opinion = { who = ROOT modifier = the_hunt_raided_province } }
}

upgrade_kobold_hoard = {
	hidden_effect = {
		remove_province_modifier = kobold_hoard_1
		remove_province_modifier = kobold_hoard_2
		remove_province_modifier = kobold_hoard_3
		remove_province_modifier = kobold_hoard_4
		remove_province_modifier = kobold_hoard_5
		remove_province_modifier = kobold_hoard_6
		remove_province_modifier = kobold_hoard_7
		remove_province_modifier = kobold_hoard_8
		remove_province_modifier = kobold_hoard_9
		remove_province_modifier = kobold_hoard_10
		remove_province_modifier = kobold_hoard_11
		if = {
			limit = { REB = { check_variable = { dragon_cult_hoard = 75000 } } }
			add_permanent_province_modifier = {
				name = kobold_hoard_11
				duration = -1
			}
		}
		else_if = {
			limit = { REB = { check_variable = { dragon_cult_hoard = 60000 } } }
			add_permanent_province_modifier = {
				name = kobold_hoard_10
				duration = -1
			}
		}
		else_if = {
			limit = { REB = { check_variable = { dragon_cult_hoard = 50000 } } }
			add_permanent_province_modifier = {
				name = kobold_hoard_9
				duration = -1
			}
		}
		else_if = {
			limit = { REB = { check_variable = { dragon_cult_hoard = 40000 } } }
			add_permanent_province_modifier = {
				name = kobold_hoard_8
				duration = -1
			}
		}
		else_if = {
			limit = { REB = { check_variable = { dragon_cult_hoard = 30000 } } }
			add_permanent_province_modifier = {
				name = kobold_hoard_7
				duration = -1
			}
		}
		else_if = {
			limit = { REB = { check_variable = { dragon_cult_hoard = 20000 } } }
			add_permanent_province_modifier = {
				name = kobold_hoard_6
				duration = -1
			}
		}
		else_if = {
			limit = { REB = { check_variable = { dragon_cult_hoard = 10000 } } }
			add_permanent_province_modifier = {
				name = kobold_hoard_5
				duration = -1
			}
		}
		else_if = {
			limit = { REB = { check_variable = { dragon_cult_hoard = 7500 } } }
			add_permanent_province_modifier = {
				name = kobold_hoard_4
				duration = -1
			}
		}
		else_if = {
			limit = { REB = { check_variable = { dragon_cult_hoard = 3000 } } }
			add_permanent_province_modifier = {
				name = kobold_hoard_3
				duration = -1
			}
		}
		else_if = {
			limit = { REB = { check_variable = { dragon_cult_hoard = 1500 } } }
			add_permanent_province_modifier = {
				name = kobold_hoard_2
				duration = -1
			}
		}
		else_if = {
			limit = { REB = { check_variable = { dragon_cult_hoard = 0 } } }
			add_permanent_province_modifier = {
				name = kobold_hoard_1
				duration = -1
			}
		}
	}
}

adventurer_spawnable_starting_bonus = {
	trigger_switch = {
		on_trigger = total_development
		
		1000 = { $tag$ = { add_treasury = 2000 add_manpower = 30 } }
		700 = { $tag$ = { add_treasury = 1600 add_manpower = 23 } }
		600 = { $tag$ = { add_treasury = 1400 add_manpower = 21 } }
		500 = { $tag$ = { add_treasury = 1200 add_manpower = 18 } }
		400 = { $tag$ = { add_treasury = 1000 add_manpower = 15 } }
		350 = { $tag$ = { add_treasury = 700 add_manpower = 9 } }
		300 = { $tag$ = { add_treasury = 550 add_manpower = 7 } }
		250 = { $tag$ = { add_treasury = 450 add_manpower = 5 } }
		200 = { $tag$ = { add_treasury = 350 add_manpower = 4 } }
		150 = { $tag$ = { add_treasury = 250 add_manpower = 3 } }
		100 = { $tag$ = { add_treasury = 150 add_manpower = 2 } }
		50 = { $tag$ = { add_treasury = 50 add_manpower = 1 } }
	}
	
	while = {
		limit = { mil_tech_is_inferior = { tag=$tag$ } }
		$tag$ = { add_mil_tech = 1 }
	}
	
	while = {
		limit = { adm_tech_is_inferior = { tag=$tag$ } }
		$tag$ = { add_adm_tech = 1 }
	}
	
	while = {
		limit = { dip_tech_is_inferior = { tag=$tag$ } }
		$tag$ = { add_dip_tech = 1 }
	}
}

centaur_army_salgae = {
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
	cavalry = $tag$
}

clear_precursor_fragments_search = {
	hidden_effect = {
		clr_country_flag = pf_chain_1
		clr_country_flag = pf_chain_2
		clr_country_flag = pf_chain_3
		clr_country_flag = pf_chain_4
		clr_country_flag = pf_chain_5
		clr_country_flag = pf_chain_flag
		set_variable = { searchPoints = 0 }
	}
	trigger_switch = {
		on_trigger = has_country_modifier
		
		pf_glowing_city = { remove_country_modifier = pf_glowing_city  hidden_effect = { set_country_flag = pf_end_glowing_city_flag } }
		pf_dragon_house = { remove_country_modifier = pf_dragon_house  hidden_effect = { set_country_flag = pf_end_dragon_house_flag } }
		pf_elfenbride_manse = { remove_country_modifier = pf_elfenbride_manse  hidden_effect = { set_country_flag = pf_end_elfenbride_manse_flag } }
		pf_god_fragment_ruin = { remove_country_modifier = pf_god_fragment_ruin  hidden_effect = { set_country_flag = pf_end_god_fragment_ruin_flag } }
		pf_vault_ruin = { remove_country_modifier = pf_vault_ruin  hidden_effect = { set_country_flag = pf_end_vault_flag } }
		pf_portal_nexus_ruin = { remove_country_modifier = pf_portal_nexus_ruin  hidden_effect = { set_country_flag = pf_end_portal_nexus_flag } }
		pf_floating_city_crash_site = { remove_country_modifier = pf_floating_city_crash_site  hidden_effect = { set_country_flag = pf_end_floating_city_crash_site_flag } }
	}
}

destroy_province = {
	hidden_effect = {
		cede_province = ---
		set_province_flag = cant_colonize
		province_event = { id = anb_debug.3 days = 35 }
	}
}

decrease_monstrous_10 = {
	if = {
		limit = { has_country_flag = removing_monstrous has_country_modifier = monstrous_nation }
		custom_tooltip = decrease_monstrous_10_tooltip
		hidden_effect = { subtract_variable = { monstrousPoints = 10 } }
	}
}

decrease_monstrous_5 = {
	if = {
		limit = { has_country_flag = removing_monstrous has_country_modifier = monstrous_nation }
		custom_tooltip = decrease_monstrous_5_tooltip
		hidden_effect = { subtract_variable = { monstrousPoints = 5 } }
	}
}

decrease_monstrous_3 = {
	if = {
		limit = { has_country_flag = removing_monstrous has_country_modifier = monstrous_nation }
		custom_tooltip = decrease_monstrous_3_tooltip
		hidden_effect = { subtract_variable = { monstrousPoints = 3 } }
	}
}

decrease_monstrous_2 = {
	if = {
		limit = { has_country_flag = removing_monstrous has_country_modifier = monstrous_nation }
		custom_tooltip = decrease_monstrous_2_tooltip
		hidden_effect = { subtract_variable = { monstrousPoints = 2 } }
	}
}

decrease_monstrous_1 = {
	if = {
		limit = { has_country_flag = removing_monstrous has_country_modifier = monstrous_nation }
		custom_tooltip = decrease_monstrous_1_tooltip
		hidden_effect = { subtract_variable = { monstrousPoints = 1 } }
	}
}


increase_monstrous_5 = {
	if = {
		limit = { has_country_flag = removing_monstrous has_country_modifier = monstrous_nation }
		custom_tooltip = increase_monstrous_5_tooltip
		hidden_effect = { change_variable = { monstrousPoints = 5 } }
	}
}

increase_monstrous_3 = {
	if = {
		limit = { has_country_flag = removing_monstrous has_country_modifier = monstrous_nation }
		custom_tooltip = increase_monstrous_3_tooltip
		hidden_effect = { change_variable = { monstrousPoints = 3 } }
	}
}

increase_monstrous_2 = {
	if = {
		limit = { has_country_flag = removing_monstrous has_country_modifier = monstrous_nation }
		custom_tooltip = increase_monstrous_2_tooltip
		hidden_effect = { change_variable = { monstrousPoints = 2 } }
	}
}

increase_monstrous_1 = {
	if = {
		limit = { has_country_flag = removing_monstrous has_country_modifier = monstrous_nation }
		custom_tooltip = increase_monstrous_1_tooltip
		hidden_effect = { change_variable = { monstrousPoints = 1 } }
	}
}

reduce_legitimacy_huge_effect = {
	add_legitimacy = -50
	add_horde_unity = -50
	add_devotion = -50
	add_republican_tradition = -25
}

spawn_vampire_broken_masquerade = {
	if = {
		limit = { total_development = 500 }
		random_owned_province = {
			limit = { is_in_capital_area = yes is_capital = no }
			spawn_rebels = {
				type = vampires_nobles
				size = 3
			}
		}
	}
	else = {
		random_owned_province = {
			limit = { is_in_capital_area = yes is_capital = no }
			spawn_rebels = {
				type = vampires_nobles
				size = 2
			}
		}
	}
}

spawn_hideout_vampires = {
	if = {
		limit = { ROOT = { has_disaster = estate_vampires_restore_masquerade_disaster } }
		hidden_effect = { set_province_flag = can_clear_hideout }
		if = {
			limit = { ROOT = { total_development = 500 } }
			spawn_rebels = {
				type = vampires_nobles
				size = 3
				win = yes
			}
		}
		else = {
			spawn_rebels = {
				type = vampires_nobles
				size = 2
				win = yes
			}
		}
	}
	else_if = {
		limit = { ROOT = { has_disaster = estate_vampires_install_thrall_disaster } }
		if = {
			limit = { has_province_flag = hidding_vampire }
			province_event = { id = disaster_vampire_masquerade.19 }
		}
		else = {
			province_event = { id = disaster_vampire_masquerade.20 }
		}
	}
}

clr_vampire_hideout = {
	if = {
		limit = { NOT = { ROOT = { tag = REB } } }
		if = {
			limit = { FROM = { has_province_modifier = vampire_hideout has_province_flag = can_clear_hideout } }
			FROM = { remove_province_modifier = vampire_hideout }
			FROM = { clr_province_flag = can_clear_hideout }
		}
	}
}

clear_vampire_organization = {
	hidden_effect = {
		remove_estate_privilege = estate_vampires_organization_the_blood_court
		remove_estate_privilege = estate_vampires_organization_bloody_aristocracy
		remove_estate_privilege = estate_vampires_organization_vampiric_emigres
		remove_estate_privilege = estate_vampires_organization_vampires_lord
	}
}

clear_vampire_law = {
	hidden_effect = {
		remove_estate_privilege = estate_vampires_law_state_collusion_masquerade
		remove_estate_privilege = estate_vampires_law_traditional_masquerade
		remove_estate_privilege = estate_vampires_law_open_rule
	}
}

set_vampires_hideout_restore_masquerade = {
	hidden_effect = {
		set_variable = { hideout = 3 }
		set_variable = { x = 0 }
		if = {
			limit = {
				NOT = {
					estate_loyalty = {
						estate = estate_vampires
						loyalty = 80
					}
				}
			}
			change_variable = { hideout = 1 }
		}
		if = {
			limit = {
				NOT = {
					estate_loyalty = {
						estate = estate_vampires
						loyalty = 60
					}
				}
			}
			change_variable = { hideout = 1 }
		}
		if = {
			limit = {
				NOT = {
					estate_loyalty = {
						estate = estate_vampires
						loyalty = 40
					}
				}
			}
			change_variable = { hideout = 1 }
		}
		if = {
			limit = {
				NOT = {
					estate_loyalty = {
						estate = estate_vampires
						loyalty = 20
					}
				}
			}
			change_variable = { hideout = 1 }
		}
		if = {
			limit = {
				NOT = {
					estate_loyalty = {
						estate = estate_vampires
						loyalty = 10
					}
				}
			}
			change_variable = { hideout = 1 }
		}
		if = {
			limit = {
				NOT = {
					estate_loyalty = {
						estate = estate_vampires
						loyalty = 5
					}
				}
			}
			change_variable = { hideout = 1 }
		}
		while = {
			limit = { NOT = { check_variable = { which = x which = hideout } } }
			random_owned_province = {
				limit = { is_in_capital_area = yes is_capital = no NOT = { has_province_modifier = vampire_hideout } }
				add_province_modifier = {
					name = vampire_hideout
					duration = -1
				}
			}
			change_variable = { x = 1 }
		}
	}
}

set_vampires_hideout_install_thrall = {
	hidden_effect = {
		set_variable = { x = 0 }
		while = {
			limit = { NOT = { check_variable = { x = 5 } } }
			random_owned_province = {
				limit = { is_in_capital_area = yes is_capital = no NOT = { has_province_modifier = vampire_hideout } }
				add_province_modifier = {
					name = vampire_hideout
					duration = -1
				}
				set_province_flag = hidding_vampire
			}
			change_variable = { x = 1 }
		}
		
		while = {
			limit = { NOT = { check_variable = { x = 10 } } }
			random_owned_province = {
				limit = { is_in_capital_area = yes is_capital = no NOT = { has_province_modifier = vampire_hideout } }
				add_province_modifier = {
					name = vampire_hideout
					duration = -1
				}
			}
			change_variable = { x = 1 }
		}
	}
}

target_vampire_hideout = {
	set_country_flag = hideout_vampire_menu
	random_owned_province = {
		limit = { has_province_modifier = vampire_hideout NOT = { has_province_flag = target@ROOT } }
		set_province_flag = target@ROOT
		set_province_flag = target1@ROOT
		save_event_target_as = hideout_1
	}
	random_owned_province = {
		limit = { has_province_modifier = vampire_hideout NOT = { has_province_flag = target@ROOT } }
		set_province_flag = target@ROOT
		set_province_flag = target2@ROOT
		save_event_target_as = hideout_2
	}
	random_owned_province = {
		limit = { has_province_modifier = vampire_hideout NOT = { has_province_flag = target@ROOT } }
		set_province_flag = target@ROOT
		set_province_flag = target3@ROOT
		save_event_target_as = hideout_3
	}
	random_owned_province = {
		limit = { has_province_modifier = vampire_hideout NOT = { has_province_flag = target@ROOT } }
		set_province_flag = target@ROOT
		set_province_flag = target4@ROOT
		save_event_target_as = hideout_4
	}
	random_owned_province = {
		limit = { has_province_modifier = vampire_hideout NOT = { has_province_flag = target@ROOT } }
		set_province_flag = target@ROOT
		set_province_flag = target5@ROOT
		save_event_target_as = hideout_5
	}
	random_owned_province = {
		limit = { has_province_modifier = vampire_hideout NOT = { has_province_flag = target@ROOT } }
		set_province_flag = target@ROOT
		set_province_flag = target6@ROOT
		save_event_target_as = hideout_6
	}
	random_owned_province = {
		limit = { has_province_modifier = vampire_hideout NOT = { has_province_flag = target@ROOT } }
		set_province_flag = target@ROOT
		set_province_flag = target7@ROOT
		save_event_target_as = hideout_7
	}
	random_owned_province = {
		limit = { has_province_modifier = vampire_hideout NOT = { has_province_flag = target@ROOT } }
		set_province_flag = target@ROOT
		set_province_flag = target8@ROOT
		save_event_target_as = hideout_8
	}
	random_owned_province = {
		limit = { has_province_modifier = vampire_hideout NOT = { has_province_flag = target@ROOT } }
		set_province_flag = target@ROOT
		set_province_flag = target9@ROOT
		save_event_target_as = hideout_9
	}
}

clr_vampire_hideout_menu = {
	hidden_effect = {
		every_owned_province = {
			limit = { has_province_flag = target@ROOT }
			clr_province_flag = target@ROOT
			clr_province_flag = target1@ROOT
			clr_province_flag = target2@ROOT
			clr_province_flag = target3@ROOT
			clr_province_flag = target4@ROOT
			clr_province_flag = target5@ROOT
			clr_province_flag = target6@ROOT
			clr_province_flag = target7@ROOT
			clr_province_flag = target8@ROOT
			clr_province_flag = target9@ROOT
		}
		clr_country_flag = hideout_vampire_menu
	}
}

vampire_led_pretender_revolt = {
	hidden_effect = {
		ROOT = {
			set_variable = { hideout = 0 }
			every_owned_province = {
				limit = { has_province_modifier = vampire_hideout }
				ROOT = { change_variable = { hideout = 1 } }
			}
		}
	}
	if = {
		limit = { ROOT = { check_variable = { hideout = 9 } } }
		spawn_rebels = {
			type = pretender_rebels
			size = 10
			female = yes
		}
	}
	else_if = {
		limit = { ROOT = { check_variable = { hideout = 8 } } }
		spawn_rebels = {
			type = pretender_rebels
			size = 9
		}
	}
	else_if = {
		limit = { ROOT = { check_variable = { hideout = 7 } } }
		spawn_rebels = {
			type = pretender_rebels
			size = 8
			female = yes
		}
	}
	else_if = {
		limit = { ROOT = { check_variable = { hideout = 6 } } }
		spawn_rebels = {
			type = pretender_rebels
			size = 7
		}
	}
	else_if = {
		limit = { ROOT = { check_variable = { hideout = 5 } } }
		spawn_rebels = {
			type = pretender_rebels
			size = 6
			female = yes
		}
	}
	else_if = {
		limit = { ROOT = { check_variable = { hideout = 4 } } }
		spawn_rebels = {
			type = pretender_rebels
			size = 5
		}
	}
	else_if = {
		limit = { ROOT = { check_variable = { hideout = 3 } } }
		spawn_rebels = {
			type = pretender_rebels
			size = 4
			female = yes
		}
	}
	else_if = {
		limit = { ROOT = { check_variable = { hideout = 2 } } }
		spawn_rebels = {
			type = pretender_rebels
			size = 3
		}
	}
	else_if = {
		limit = { ROOT = { check_variable = { hideout = 1 } } }
		spawn_rebels = {
			type = pretender_rebels
			size = 2
			female = yes
		}
	}
	else_if = {
		limit = { ROOT = { check_variable = { hideout = 0 } } }
		spawn_rebels = {
			type = pretender_rebels
			size = 1
		}
	}
}

target_elector_elder_pact = {
	random_elector = {
		limit = {
			is_emperor = no
			NOT = { truce_with = ROOT }
		}
		save_event_target_as = elector_target
	}
	random_elector = {
		limit = {
			is_emperor = no
			NOT = { alliance_with = ROOT }
			NOT = { truce_with = ROOT }
		}
		save_event_target_as = elector_target
	}
	random_elector = {
		limit = { 
			is_emperor = no
			NOT = { alliance_with = ROOT }
			NOT = { truce_with = ROOT }
			is_at_war = no
		}
		save_event_target_as = elector_target
	}
	random_elector = {
		limit = { 
			is_emperor = no
			NOT = { alliance_with = ROOT }
			NOT = { truce_with = ROOT }
			is_at_war = no
			is_rival = ROOT
		}
		save_event_target_as = elector_target
	}
	random_elector = {
		limit = { 
			is_emperor = no
			NOT = { alliance_with = ROOT }
			NOT = { truce_with = ROOT }
			is_at_war = no
			army_strength = {
				who = ROOT
				value = 0.5
			}
		}
		save_event_target_as = elector_target
	}
	random_elector = {
		limit = { 
			is_emperor = no
			NOT = { alliance_with = ROOT }
			NOT = { truce_with = ROOT }
			is_at_war = no
			is_rival = ROOT
			army_strength = {
				who = ROOT
				value = 0.5
			}
		}
		save_event_target_as = elector_target
	}
	random_elector = {
		limit = { 
			is_emperor = no
			NOT = { alliance_with = ROOT }
			NOT = { truce_with = ROOT }
			is_at_war = no
			army_strength = {
				who = ROOT
				value = 1.0
			}
		}
		save_event_target_as = elector_target
	}
	random_elector = {
		limit = { 
			is_emperor = no
			NOT = { alliance_with = ROOT }
			NOT = { truce_with = ROOT }
			is_at_war = no
			is_rival = ROOT
			army_strength = {
				who = ROOT
				value = 1.0
			}
		}
		save_event_target_as = elector_target
	}
	random_elector = {
		limit = { 
			is_emperor = no
			NOT = { alliance_with = ROOT }
			NOT = { truce_with = ROOT }
			is_at_war = no
			army_strength = {
				who = ROOT
				value = 1.5
			}
		}
		save_event_target_as = elector_target
	}
	random_elector = {
		limit = { 
			is_emperor = no
			NOT = { alliance_with = ROOT }
			NOT = { truce_with = ROOT }
			is_at_war = no
			is_rival = ROOT
			army_strength = {
				who = ROOT
				value = 1.5
			}
		}
		save_event_target_as = elector_target
	}
}

abdicate_emperor_no_reelection = { #Use within emperor scope
	custom_tooltip = abdicate_emperor_no_reelection_tooltip
	hidden_effect = {
		export_to_variable = { #Save emperor's religion
			which = emperor_religion
			value = religion
			who = ROOT
		}
		
		set_country_flag = emperor_religion_change #So changing religion doesn't tank prestige and give conversion zeal modifier
		if = {
			limit = { hre_religion_treaty = yes }
			
			1 = { #Use province for global variable
				set_variable = {
					which = regent_court_electors
					value = 0
				}
				set_variable = {
					which = corinite_electors
					value = 0
				}
				set_variable = {
					which = ravelian_electors
					value = 0
				}
			}
		
			every_elector = { #Count number of electors for each religion
				set_country_flag = hre_elector #Save electors
				trigger_switch = {
					on_trigger = religion
					
					regent_court = { 1 = { change_variable = { which = regent_court_electors value = 1 } } }
					corinite = { 1 = { change_variable = { which = corinite_electors value = 1 } } }
					ravelian = { 1 = { change_variable = { which = ravelian_electors value = 1 } } }
				}
			}
			
			if = { #Num Regent Court electors >= Num of other religion electors
				limit = {
					1 = {
						check_variable = {
							which = regent_court_electors
							which = corinite_electors
						}
						check_variable = {
							which = regent_court_electors
							which = ravelian_electors
						}
					}
				}
				set_hre_religion = regent_court
				set_hre_religion_locked = yes #Have to lock religion to remove religious peace
				change_religion = cannorian_pantheon #Change emperor to dummy religion to remove emperorship
			}
			else_if = { #Num Corinite electors >= Num of Ravelian electors since know > Regent Court from the IF
				limit = {
					1 = {
						check_variable = {
							which = corinite_electors
							which = ravelian_electors
						}
					}
				}
				set_hre_religion = corinite
				set_hre_religion_locked = yes
				change_religion = cannorian_pantheon
			}
			else = { #If not above Ravelian has to have most electors
				set_hre_religion = ravelian
				set_hre_religion_locked = yes
				change_religion = cannorian_pantheon
			}
			
			set_hre_religion_treaty = yes #Reapply religious peace
			
			every_known_country = { #Reapply electorship to electors removed by locking religion
				limit = {
					has_country_flag = hre_elector
				}
				clr_country_flag = hre_elector
				if = {
					limit = { is_elector = no }
					elector = yes
				}
			}
		}
		else = {
			change_religion = cannorian_pantheon
		}
		
		change_religion = variable:emperor_religion #Change former emperor back to original religion
		clr_country_flag = emperor_religion_change
	}
}

#Using make_emperor during a league war will end the war with an unlocked religion
#Use another effect to determine the outcome
make_emperor = { #Use within scope for new emperor
	custom_tooltip = make_emperor_tooltip
	hidden_effect = {
		export_to_variable = { #Save future emperor's religion
			which = future_emperor_religion
			value = religion
			who = ROOT
		}
		if = { #Save empire's religion if not religious peace and usurper matches religion else religious peace
			limit = {
				hre_religion_treaty = no
				hre_religion = ROOT
			}
			set_country_flag = hre_has_religion
			trigger_switch = {
				on_trigger = hre_religion
				
				regent_court = { set_country_flag = regent_court_empire }
				corinite = { set_country_flag = corinite_empire }
				ravelian = { set_country_flag = ravelian_empire }
			}
			if = { #Save if empire religion isn't yet locked
				limit = { hre_religion_locked = no }
				set_country_flag = hre_unlocked_religion
			}
		}
		
		set_country_flag = emperor_religion_change #So changing religion doesn't tank prestige and give conversion zeal modifier
		every_elector = { #Save electors
			set_country_flag = hre_elector
		}
		
		set_hre_religion_treaty = yes #Have to set religious peace so empire isn't dismantled
		change_religion = cannorian_pantheon #Change future emperor to dummy religion so they are only option for emperor
		elector = yes #Need someone to vote you emperor with religious peace
		set_hre_religion = cannorian_pantheon
		set_hre_religion_locked = yes
		
		emperor = {
			export_to_variable = { #Save current emperor's religion
				which = emperor_religion
				value = religion
				who = emperor
			}
			set_country_flag = emperor_religion_change
			if = {
				limit = { religion = regent_court }
				change_religion = corinite
			}
			else = {
				change_religion = regent_court
			}
			change_religion = variable:emperor_religion
			clr_country_flag = emperor_religion_change
		}
		
		set_hre_religion_treaty = yes #Have to go through religious peace so new emperor stays emperor
		change_religion = variable:future_emperor_religion
		
		if = { #Change hre religion back
			limit = { has_country_flag = hre_has_religion }
			clr_country_flag = hre_has_religion
			trigger_switch = {
				on_trigger = has_country_flag
				
				regent_court_empire = { set_hre_religion = regent_court set_hre_religion_locked = yes clr_country_flag = regent_court_empire }
				corinite_empire = { set_hre_religion = corinite set_hre_religion_locked = yes clr_country_flag = corinite_empire }
				ravelian_empire = { set_hre_religion = ravelian set_hre_religion_locked = yes clr_country_flag = ravelian_empire }
			}
			if = { #Unlock hre religion if it wasn't locked before
				limit = { has_country_flag = hre_unlocked_religion }
				set_hre_religion_locked = no
				clr_country_flag = hre_unlocked_religion
			}
		}
		
		elector = no #Remove electorship that gave vote
		every_known_country = { #Reapply electorship to electors removed by locking religion
			limit = {
				has_country_flag = hre_elector
			}
			clr_country_flag = hre_elector
			if = {
				limit = { is_elector = no }
				elector = yes
			}
		}
		clr_country_flag = emperor_religion_change
	}
}

adventurer_legacy_effect = {
	if = {
		limit = { has_country_flag = adv_guild_integrated }
		add_country_modifier = {
			name = "legacy_of_adventurers_modifier"
			duration = 14600
		}
		add_country_modifier = {
			name = "organized_adventurer_administration"
			duration = 14600
		}
	}
	else = {
		add_country_modifier = {
			name = "legacy_of_adventurers_modifier"
			duration = 14600
		}
	}
	
	country_event = { id = estate_organization.1 days = 35 }		#choose magical organization for mage estate
	country_event = { id = estate_organization.4 days = 35 }		#choose organization for adventurer estate
	country_event = { id = estate_organization.5 days = 35 }		#choose organization for artificer estate
}

create_war_wizard_effect = {
	custom_tooltip = war_wizard_tooltip
	hidden_effect = {
		set_saved_name = {
			key = root_name_male
			type = advisor
			scope = ROOT
		}
		set_saved_name = {
			key = root_name_female
			type = advisor
			female = yes
			scope = ROOT
		}
		if = {
			limit = {
				army_tradition = 0.00
				NOT = { army_tradition = 20 }
			}
			random_list = {
				50 = {
					define_general = {
						shock = 6
						fire = 1
						manuever = 0
						siege = 3
						trait = war_wizard_personality
						name = root_name_male
					}
				}
				50 = {
					define_general = {
						shock = 6
						fire = 1
						manuever = 0
						siege = 3
						trait = war_wizard_personality
						female = yes
						name = root_name_female
					}
				}
			}
		}
		
		if = {
			limit = {
				army_tradition = 20
				NOT = { army_tradition = 40 }
			}
			random_list = {
				50 = {
					define_general = {
						shock = 7
						fire = 2
						manuever = 0
						siege = 4
						trait = war_wizard_personality
						name = root_name_male
					}
				}
				50 = {
					define_general = {
						shock = 7
						fire = 2
						manuever = 0
						siege = 4
						trait = war_wizard_personality
						female = yes
						name = root_name_female
					}
				}
			}
		}
		
		if = {
			limit = {
				army_tradition = 40
				NOT = { army_tradition = 60 }
			}
			random_list = {
				50 = {
					define_general = {
						shock = 8
						fire = 3
						manuever = 0
						siege = 5
						trait = war_wizard_personality
						name = root_name_male
					}
				}
				50 = {
					define_general = {
						shock = 8
						fire = 3
						manuever = 0
						siege = 5
						trait = war_wizard_personality
						female = yes
						name = root_name_female
					}
				}
			}
		}
		
		if = {
			limit = {
				army_tradition = 60
				NOT = { army_tradition = 80 }
			}
			random_list = {
				50 = {
					define_general = {
						shock = 9
						fire = 4
						manuever = 0
						siege = 5
						trait = war_wizard_personality
						name = root_name_male
					}
				}
				50 = {
					define_general = {
						shock = 9
						fire = 4
						manuever = 0
						siege = 5
						trait = war_wizard_personality
						female = yes
						name = root_name_female
					}
				}
			}
		}
		
		if = {
			limit = {
				army_tradition = 80
			}
			random_list = {
				50 = {
					define_general = {
						shock = 9
						fire = 4
						manuever = 0
						siege = 6
						trait = war_wizard_personality
						name = root_name_male
					}
				}
				50 = {
					define_general = {
						shock = 9
						fire = 4
						manuever = 0
						siege = 6
						trait = war_wizard_personality
						female = yes
						name = root_name_female
					}
				}
			}
		}
			
		clear_saved_name = root_name_male
		clear_saved_name = root_name_female
	}
}

clear_ramsteel_fire_shock_buffs_effect = {
	remove_country_modifier = ramsteel_shock_1
	remove_country_modifier = ramsteel_shock_2
	remove_country_modifier = ramsteel_shock_3
	remove_country_modifier = ramsteel_fire_1
	remove_country_modifier = ramsteel_fire_2
	remove_country_modifier = ramsteel_fire_3
}

currency_effect = { #currency (#takeFrom) #addTo #which/value
	hidden_effect = {
[[which]
		set_variable = { which = temp which = $which$ }
]
[[value]
		set_variable = { which = temp value = $value$ }
]
		if = {
			limit = {
				check_variable = { which = temp value = 0 }
			}
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=while val=819.2 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=409.6 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=204.8 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=102.4 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=51.2 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=25.6 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=12.8 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=6.4 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=3.2 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=1.6 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=0.8 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=0.4 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=0.2 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=0.1 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=0.05 }
			currency_helper = { currency=$currency$ [[addTo]addTo=$addTo$] [[takeFrom]takeFrom=$takeFrom$] type=if val=0.025 }
		}
		else = {
			multiply_variable = { which = temp value = -1 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=while val=819.2 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=409.6 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=204.8 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=102.4 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=51.2 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=25.6 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=12.8 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=6.4 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=3.2 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=1.6 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=0.8 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=0.4 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=0.2 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=0.1 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=0.05 }
			currency_helper = { currency=$currency$ [[addTo]takeFrom=$addTo$] [[takeFrom]addTo=$takeFrom$] type=if val=0.025 }
		}
		set_variable = { which = temp value = 0 }
	}
}
currency_helper = {
	$type$ = {
		limit = {
			check_variable = { which = temp value = $val$ }
		}
		subtract_variable = { which = temp value = $val$ }
[[addTo]
		$addTo$ = { add_$currency$ = $val$ }
]
[[takeFrom]
		$takeFrom$ = { add_$currency$ = -$val$ }
]
	}
}

jaddempire_move_court = {
	hidden_effect = {
		every_owned_province = { #remove the province modifiers from the previous court
			remove_province_modifier = jaddempire_court_seat
			remove_province_modifier = jaddempire_court_area
		}
	}
	$province_id$ = {
		trigger_switch = {
			on_trigger = province_id
			
			8 = { ROOT = { add_ruler_modifier = { name = jaddempire_anbenncost_capital duration = -1 } jaddempire_change_leaning_west_massive = yes } }
			565 = { ROOT = { add_ruler_modifier = { name = jaddempire_brasan_capital duration = -1 } jaddempire_change_leaning_west_large = yes } }
			601 = { ROOT = { add_ruler_modifier = { name = jaddempire_bulwar_capital duration = -1 } jaddempire_change_leaning_west_medium = yes } }
			625 = { ROOT = { add_ruler_modifier = { name = jaddempire_jaddanzar_capital duration = -1 } jaddempire_change_leaning_west_medium = yes } }
			643 = { ROOT = { add_ruler_modifier = { name = jaddempire_azka_sur_capital duration = -1 } jaddempire_change_leaning_west_small = yes } }
			
			2909 = { ROOT = { add_ruler_modifier =  { name = jaddempire_religious_capital duration = -1 } } } #Neutral
			
			4411 = { ROOT = { add_ruler_modifier = { name = jaddempire_dhenijansar_capital duration = -1 } jaddempire_change_leaning_east_medium = yes } }
			4420 = { ROOT = { add_ruler_modifier = { name = jaddempire_sramaya_capital duration = -1 } jaddempire_change_leaning_east_medium = yes } }
			4500 = { ROOT = { add_ruler_modifier = { name = jaddempire_aizt_ralare_capital duration = -1 } jaddempire_change_leaning_east_large = yes } }
			4871 = { ROOT = { add_ruler_modifier = { name = jaddempire_tianlou_capital duration = -1 } jaddempire_change_leaning_east_massive = yes } }
		}
		add_province_modifier = {
			name = jaddempire_court_seat
			duration = -1
		}
		move_capital_effect = yes
	}
}

jaddempire_change_leaning_west_tiny = {
	if = {
		limit = { OR = { tag = F46 was_tag = F46 } NOT = { has_country_flag = had_deioderan } }
		custom_tooltip = jaddempire_change_leaning_west_tiny_tt
		hidden_effect = {
			change_variable = { which = jaddariLeaning value = 1 }
		}
	}
}

jaddempire_change_leaning_west_small = {
	if = {
		limit = { OR = { tag = F46 was_tag = F46 } NOT = { has_country_flag = had_deioderan } }
		custom_tooltip = jaddempire_change_leaning_west_small_tt
		hidden_effect = {
			change_variable = { which = jaddariLeaning value = 2 }
		}
	}
}

jaddempire_change_leaning_west_medium = {
	if = {
		limit = { OR = { tag = F46 was_tag = F46 } NOT = { has_country_flag = had_deioderan } }
		custom_tooltip = jaddempire_change_leaning_west_medium_tt
		hidden_effect = {
			change_variable = { which = jaddariLeaning value = 3 }
		}
	}
}

jaddempire_change_leaning_west_large = {
	if = {
		limit = { OR = { tag = F46 was_tag = F46 } NOT = { has_country_flag = had_deioderan } }
		custom_tooltip = jaddempire_change_leaning_west_large_tt
		hidden_effect = {
			change_variable = { which = jaddariLeaning value = 5 }
		}
	}
}

jaddempire_change_leaning_west_massive = {
	if = {
		limit = { OR = { tag = F46 was_tag = F46 } NOT = { has_country_flag = had_deioderan } }
		custom_tooltip = jaddempire_change_leaning_west_massive_tt
		hidden_effect = {
			change_variable = { which = jaddariLeaning value = 10 }
		}
	}
}

jaddempire_change_leaning_east_tiny = {
	if = {
		limit = { OR = { tag = F46 was_tag = F46 } NOT = { has_country_flag = had_deioderan } }
		custom_tooltip = jaddempire_change_leaning_east_tiny_tt
		hidden_effect = {
			change_variable = { which = jaddariLeaning value = -1 }
		}
	}
}

jaddempire_change_leaning_east_small = {
	if = {
		limit = { OR = { tag = F46 was_tag = F46 } NOT = { has_country_flag = had_deioderan } }
		custom_tooltip = jaddempire_change_leaning_east_small_tt
		hidden_effect = {
			change_variable = { which = jaddariLeaning value = -2 }
		}
	}
}

jaddempire_change_leaning_east_medium = {
	if = {
		limit = { OR = { tag = F46 was_tag = F46 } NOT = { has_country_flag = had_deioderan } }
		custom_tooltip = jaddempire_change_leaning_east_medium_tt
		hidden_effect = {
			change_variable = { which = jaddariLeaning value = -3 }
		}
	}
}

jaddempire_change_leaning_east_large = {
	if = {
		limit = { OR = { tag = F46 was_tag = F46 } NOT = { has_country_flag = had_deioderan } }
		custom_tooltip = jaddempire_change_leaning_east_large_tt
		hidden_effect = {
			change_variable = { which = jaddariLeaning value = -5 }
		}
	}
}

jaddempire_change_leaning_east_massive = {
	if = {
		limit = { OR = { tag = F46 was_tag = F46 } NOT = { has_country_flag = had_deioderan } }
		custom_tooltip = jaddempire_change_leaning_east_massive_tt
		hidden_effect = {
			change_variable = { which = jaddariLeaning value = -10 }
		}
	}
}

jaddempire_remove_ruler_modifier = {
	hidden_effect = {
		remove_country_modifier = jaddempire_azka_sur_capital
		remove_country_modifier = jaddempire_bulwar_capital
		remove_country_modifier = jaddempire_religious_capital
		remove_country_modifier = jaddempire_brasan_capital
		remove_country_modifier = jaddempire_anbenncost_capital
		remove_country_modifier = jaddempire_dhenijansar_capital
		remove_country_modifier = jaddempire_sramaya_capital
		remove_country_modifier = jaddempire_sarisung_capital
		remove_country_modifier = jaddempire_tianlou_capital
		remove_country_modifier = jaddempire_jaddanzar_capital
	}
}

jaddari_deioderan_battle_counter_update = {
	if = {
		limit = { tag = F51 FROM = { tag = F99 } }
		change_variable = { which = jaddari_deioderan_battle_counter value = $value$ }
	}
}

jaddari_deioderan_dev_counter_update = {
	if = {
		limit = {
			owner = { tag = F51 has_disaster = jaddari_deioderan }
			OR = {
				AND = { owner = { capital_scope = { continent = asia } } OR = { continent = europe continent = africa } }
				AND = { owner = { capital_scope = { OR = { continent = europe continent = africa } } } continent = asia }
			}
		}
		change_variable = { which = jaddari_deioderan_dev_counter value = 1 }
	}
}

jaddari_close_sway_menu = {
	hidden_effect = {
		clr_country_flag = jaddari_deioderan_sway_menu_open
		if = {
			limit = { tag = F51 }
			F99 = {
				every_owned_province = {
					clr_province_flag = jaddari_sway_target_1
					clr_province_flag = jaddari_sway_target_2
					clr_province_flag = jaddari_sway_target_3
					clr_province_flag = jaddari_sway_target_4
				}
			}
		}
		else = {
			F51 = {
				every_owned_province = {
					clr_province_flag = jaddari_sway_target_1
					clr_province_flag = jaddari_sway_target_2
					clr_province_flag = jaddari_sway_target_3
					clr_province_flag = jaddari_sway_target_4
				}
			}
		}
	}
}

jaddari_attempt_to_sway_province = {
	if = {
		limit = { development = 50 }
		ROOT = { add_dip_power = -120 }
	}
	else_if = {
		limit = { development = 45 }
		ROOT = { add_dip_power = -100 }
	}
	else_if = {
		limit = { development = 40 }
		ROOT = { add_dip_power = -85 }
	}
	else_if = {
		limit = { development = 35 }
		ROOT = { add_dip_power = -75 }
	}
	else_if = {
		limit = { development = 30 }
		ROOT = { add_dip_power = -65 }
	}
	else_if = {
		limit = { development = 25 }
		ROOT = { add_dip_power = -55 }
	}
	else_if = {
		limit = { development = 20 }
		ROOT = { add_dip_power = -50 }
	}
	else_if = {
		limit = { development = 15 }
		ROOT = { add_dip_power = -45 }
	}
	else_if = {
		limit = { development = 10 }
		ROOT = { add_dip_power = -40 }
	}
	else_if = {
		limit = { development = 5 }
		ROOT = { add_dip_power = -35 }
	}
	else = {
		ROOT = { add_dip_power = -30 }
	}
	
	if = {
		limit = { monthly_dip = 12 }
		random_list = { #influenced by country dip gain
			0 = { add_province_modifier = { name = jaddari_failed_to_sway_province duration = 180 } }
			100 = { cede_province = ROOT if = { limit = { ROOT = { tag = F51 } } ROOT = { change_variable = { which = jaddari_deioderan_sway_counter value = 1 } } } }
		}
	}
	else_if = {
		limit = { monthly_dip = 11 }
		random_list = { #influenced by country dip gain
			5 = { add_province_modifier = { name = jaddari_failed_to_sway_province duration = 180 } }
			95 = { cede_province = ROOT if = { limit = { ROOT = { tag = F51 } } ROOT = { change_variable = { which = jaddari_deioderan_sway_counter value = 1 } } } }
		}
	}
	else_if = {
		limit = { monthly_dip = 10 }
		random_list = { #influenced by country dip gain
			10 = { add_province_modifier = { name = jaddari_failed_to_sway_province duration = 180 } }
			90 = { cede_province = ROOT if = { limit = { ROOT = { tag = F51 } } ROOT = { change_variable = { which = jaddari_deioderan_sway_counter value = 1 } } } }
		}
	}
	else_if = {
		limit = { monthly_dip = 9 }
		random_list = { #influenced by country dip gain
			20 = { add_province_modifier = { name = jaddari_failed_to_sway_province duration = 180 } }
			80 = { cede_province = ROOT if = { limit = { ROOT = { tag = F51 } } ROOT = { change_variable = { which = jaddari_deioderan_sway_counter value = 1 } } } }
		}
	}
	else_if = {
		limit = { monthly_dip = 8 }
		random_list = { #influenced by country dip gain
			30 = { add_province_modifier = { name = jaddari_failed_to_sway_province duration = 180 } }
			70 = { cede_province = ROOT if = { limit = { ROOT = { tag = F51 } } ROOT = { change_variable = { which = jaddari_deioderan_sway_counter value = 1 } } } }
		}
	}
	else_if = {
		limit = { monthly_dip = 7 }
		random_list = { #influenced by country dip gain
			40 = { add_province_modifier = { name = jaddari_failed_to_sway_province duration = 180 } }
			60 = { cede_province = ROOT if = { limit = { ROOT = { tag = F51 } } ROOT = { change_variable = { which = jaddari_deioderan_sway_counter value = 1 } } } }
		}
	}
	else_if = {
		limit = { monthly_dip = 6 }
		random_list = { #influenced by country dip gain
			50 = { add_province_modifier = { name = jaddari_failed_to_sway_province duration = 180 } }
			50 = { cede_province = ROOT if = { limit = { ROOT = { tag = F51 } } ROOT = { change_variable = { which = jaddari_deioderan_sway_counter value = 1 } } } }
		}
	}
	else_if = {
		limit = { monthly_dip = 5 }
		random_list = { #influenced by country dip gain
			60 = { add_province_modifier = { name = jaddari_failed_to_sway_province duration = 180 } }
			40 = { cede_province = ROOT if = { limit = { ROOT = { tag = F51 } } ROOT = { change_variable = { which = jaddari_deioderan_sway_counter value = 1 } } } }
		}
	}
	else_if = {
		limit = { monthly_dip = 4 }
		random_list = { #influenced by country dip gain
			70 = { add_province_modifier = { name = jaddari_failed_to_sway_province duration = 180 } }
			30 = { cede_province = ROOT if = { limit = { ROOT = { tag = F51 } } ROOT = { change_variable = { which = jaddari_deioderan_sway_counter value = 1 } } } }
		}
	}
	else = {
		limit = { monthly_dip = 4 }
		random_list = { #influenced by country dip gain
			80 = { add_province_modifier = { name = jaddari_failed_to_sway_province duration = 180 } }
			20 = { cede_province = ROOT if = { limit = { ROOT = { tag = F51 } } ROOT = { change_variable = { which = jaddari_deioderan_sway_counter value = 1 } } } }
		}
	}
	custom_tooltip = jaddari_attempt_to_sway_province_chance_tt
}

transfer_units_in_province_from_to = {
	$province$ = {
		while = {
			limit = { infantry_in_province = $from$ }
			kill_units = {
				who = $from$
				type = infantry
				amount = 1
			}
			infantry = $to$
		}
		while = {
			limit = { cavalry_in_province = $from$ }
			kill_units = {
				who = $from$
				type = cavalry
				amount = 1
			}
			cavalry = $to$
		}
		while = {
			limit = { artillery_in_province = $from$ }
			kill_units = {
				who = $from$
				type = artillery
				amount = 1
			}
			artillery = $to$
		}
	}
}

spawn_units_for = {
	hidden_effect = {
		set_variable = {
			which = spawn_unit_count value = $amount$
		}
		while = {
			limit = { check_variable = { which = spawn_unit_count value = 1 } }
			$who$ = { $type$ = PREV }
			change_variable = { which = spawn_unit_count value = -1 }
		}
	}
}

move_high_tolerance_pop_from_to = {
	if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_hobgoblin_pop_trigger = yes
					has_integrated_hobgoblin_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_hobgoblin_minority_size_effect = yes
			if = {
				limit = { OR = { has_hobgoblin_majority_trigger = yes has_large_hobgoblin_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_manpower = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_centaur_pop_trigger = yes
					has_integrated_centaur_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_centaur_minority_size_effect = yes
			if = {
				limit = { OR = { has_centaur_majority_trigger = yes has_large_centaur_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_manpower = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_ogre_pop_trigger = yes
					has_integrated_ogre_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_ogre_minority_size_effect = yes
			if = {
				limit = { OR = { has_ogre_majority_trigger = yes has_large_ogre_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_manpower = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_troll_pop_trigger = yes
					has_integrated_troll_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_troll_minority_size_effect = yes
			if = {
				limit = { OR = { has_troll_majority_trigger = yes has_large_troll_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_manpower = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_harpy_pop_trigger = yes
					has_integrated_harpy_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_harpy_minority_size_effect = yes
			if = {
				limit = { OR = { has_harpy_majority_trigger = yes has_large_harpy_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_tax = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_goblin_pop_trigger = yes
					has_integrated_goblin_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_goblin_minority_size_effect = yes
			if = {
				limit = { OR = { has_goblin_majority_trigger = yes has_large_goblin_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_tax = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_orcish_pop_trigger = yes
					has_integrated_orcish_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_orcish_minority_size_effect = yes
			if = {
				limit = { OR = { has_orcish_majority_trigger = yes has_large_orcish_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_manpower = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_gnollish_pop_trigger = yes
					has_integrated_gnollish_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_gnollish_minority_size_effect = yes
			if = {
				limit = { OR = { has_gnollish_majority_trigger = yes has_large_gnollish_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_manpower = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_kobold_pop_trigger = yes
					has_integrated_kobold_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_kobold_minority_size_effect = yes
			if = {
				limit = { OR = { has_kobold_majority_trigger = yes has_large_kobold_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_tax = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_ruinborn_pop_trigger = yes
					has_integrated_ruinborn_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_ruinborn_minority_size_effect = yes
			if = {
				limit = { OR = { has_ruinborn_majority_trigger = yes has_large_ruinborn_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_production = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_half_orcish_pop_trigger = yes
					has_integrated_half_orcish_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_half_orcish_minority_size_effect = yes
			if = {
				limit = { OR = { has_half_orcish_majority_trigger = yes has_large_half_orcish_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_tax = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_half_elven_pop_trigger = yes
					has_integrated_half_elven_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_half_elven_minority_size_effect = yes
			if = {
				limit = { OR = { has_half_elven_majority_trigger = yes has_large_half_elven_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_tax = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_harimari_pop_trigger = yes
					has_integrated_harimari_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_harimari_minority_size_effect = yes
			if = {
				limit = { OR = { has_harimari_majority_trigger = yes has_large_harimari_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_tax = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_halfling_pop_trigger = yes
					has_integrated_halfling_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_halfling_minority_size_effect = yes
			if = {
				limit = { OR = { has_halfling_majority_trigger = yes has_large_halfling_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_production = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_gnomish_pop_trigger = yes
					has_integrated_gnomish_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_gnomish_minority_size_effect = yes
			if = {
				limit = { OR = { has_gnomish_majority_trigger = yes has_large_gnomish_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_production = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_human_pop_trigger = yes
					has_integrated_human_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_human_minority_size_effect = yes
			if = {
				limit = { OR = { has_human_majority_trigger = yes has_large_human_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_tax = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_elven_pop_trigger = yes
					has_integrated_elven_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_elven_minority_size_effect = yes
			if = {
				limit = { OR = { has_elven_majority_trigger = yes has_large_elven_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_tax = 1
				}
			}
		}
	}
	else_if = {
		limit = {
			$from$ = {
				OR = {
					has_coexisting_dwarven_pop_trigger = yes
					has_integrated_dwarven_pop_trigger = yes
				}
			}
		}
		$to$ = {
			add_dwarven_minority_size_effect = yes
			if = {
				limit = { OR = { has_dwarven_majority_trigger = yes has_large_dwarven_minority_trigger = yes } }
				random = {
					chance = 50
					add_base_production = 1
				}
			}
		}
	}
	else = {
		add_treasury = 1
	}
}

calc_raj_total_dev = {
	4411 = {
		set_variable = {
			which = raj_total_dev
			value = 0
		}
		owner = {
			every_subject_country = {
				4411 = {
					export_to_variable = {
						which = raj_development_to_add
						value = total_development
						who = PREV
					}
					change_variable = {
						which = raj_total_dev
						which = raj_development_to_add
					}
				}
			}
			4411 = {
				export_to_variable = {
					which = raj_development_to_add
					value = total_development
					who = PREV
				}
				change_variable = {
					which = raj_total_dev
					which = raj_development_to_add
				}
			}
		}
	}
}

raj_cohesion_change = {
	hidden_effect = {
		4411 = {
			#Set amount to change by
			set_variable = {
				which = raj_cohesion_change_amount
				value = $amount$
			}
			multiply_variable = {
				which = raj_cohesion_change_amount
				value = 100.00
			}
			export_to_variable = {
				which = raj_development_to_add
				value = total_development
				who = PREV
			}
			multiply_variable = {
				which = raj_cohesion_change_amount
				which = raj_development_to_add
			}
			divide_variable = {
				which = raj_cohesion_change_amount
				which = raj_total_dev
			}
			
			change_variable = {
				which = raj_cohesion
				which = raj_cohesion_change_amount
			}
			
			if = {
				limit = {
					check_variable = { raj_cohesion = 100 }
				}
				set_variable = {
					which = raj_cohesion
					value = 100
				}
			}
			else_if = {
				limit = {
					NOT = { check_variable = { raj_cohesion = 0 } }
				}
				set_variable = {
					which = raj_cohesion
					value = 0
				}
			}
		}
	}
	if = {
		limit = { 
			variable_arithmetic_trigger = {
				export_to_variable = {
					which = raj_cohesion_change_amount
					value = $amount$
				}
				
				check_variable = { raj_cohesion_change_amount = 0 }
			}
		}
		if = {
			limit = {
				4411 = {
					variable_arithmetic_trigger = {
						export_to_variable = {
							which = raj_cohesion_change_amount
							value = $amount$
						}
						multiply_variable = {
							which = raj_cohesion_change_amount
							value = 100.00
						}
						export_to_variable = {
							which = raj_development_to_add
							value = total_development
							who = PREV
						}
						multiply_variable = {
							which = raj_cohesion_change_amount
							which = raj_development_to_add
						}
						divide_variable = {
							which = raj_cohesion_change_amount
							which = raj_total_dev
						}
						
						check_variable = { raj_cohesion_change_amount = 3 }
					}
				}
			}
			if = {
				limit = {
					4411 = {
						variable_arithmetic_trigger = {
							export_to_variable = {
								which = raj_cohesion_change_amount
								value = $amount$
							}
							multiply_variable = {
								which = raj_cohesion_change_amount
								value = 100.00
							}
							export_to_variable = {
								which = raj_development_to_add
								value = total_development
								who = PREV
							}
							multiply_variable = {
								which = raj_cohesion_change_amount
								which = raj_development_to_add
							}
							divide_variable = {
								which = raj_cohesion_change_amount
								which = raj_total_dev
							}
							
							check_variable = { raj_cohesion_change_amount = 10 }
						}
					}
				}
				if = {
					limit = {
						4411 = {
							variable_arithmetic_trigger = {
								export_to_variable = {
									which = raj_cohesion_change_amount
									value = $amount$
								}
								multiply_variable = {
									which = raj_cohesion_change_amount
									value = 100.00
								}
								export_to_variable = {
									which = raj_development_to_add
									value = total_development
									who = PREV
								}
								multiply_variable = {
									which = raj_cohesion_change_amount
									which = raj_development_to_add
								}
								divide_variable = {
									which = raj_cohesion_change_amount
									which = raj_total_dev
								}
								
								check_variable = { raj_cohesion_change_amount = 15 }
							}
						}
					}
					custom_tooltip = raj_cohesion_increase_gargantuan_tt
				}
				else = {
					custom_tooltip = raj_cohesion_increase_huge_tt
				}
			}
			else = {
				if = {
					limit = {
						4411 = {
							variable_arithmetic_trigger = {
								export_to_variable = {
									which = raj_cohesion_change_amount
									value = $amount$
								}
								multiply_variable = {
									which = raj_cohesion_change_amount
									value = 100.00
								}
								export_to_variable = {
									which = raj_development_to_add
									value = total_development
									who = PREV
								}
								multiply_variable = {
									which = raj_cohesion_change_amount
									which = raj_development_to_add
								}
								divide_variable = {
									which = raj_cohesion_change_amount
									which = raj_total_dev
								}
								
								check_variable = { raj_cohesion_change_amount = 6 }
							}
						}
					}
					custom_tooltip = raj_cohesion_increase_large_tt
				}
				else = {
					custom_tooltip = raj_cohesion_increase_medium_tt
				}
			}
		}
		else = {
			if = {
				limit = {
					4411 = {
						variable_arithmetic_trigger = {
							export_to_variable = {
								which = raj_cohesion_change_amount
								value = $amount$
							}
							multiply_variable = {
								which = raj_cohesion_change_amount
								value = 100.00
							}
							export_to_variable = {
								which = raj_development_to_add
								value = total_development
								who = PREV
							}
							multiply_variable = {
								which = raj_cohesion_change_amount
								which = raj_development_to_add
							}
							divide_variable = {
								which = raj_cohesion_change_amount
								which = raj_total_dev
							}
							
							check_variable = { raj_cohesion_change_amount = 1 }
						}
					}
				}
				custom_tooltip = raj_cohesion_increase_small_tt
			}
			else = {
				custom_tooltip = raj_cohesion_increase_tiny_tt
			}
		}
	}
	else = { #negative
		if = {
			limit = {
				4411 = {
					variable_arithmetic_trigger = {
						export_to_variable = {
							which = raj_cohesion_change_amount
							value = $amount$
						}
						multiply_variable = {
							which = raj_cohesion_change_amount
							value = 100.00
						}
						export_to_variable = {
							which = raj_development_to_add
							value = total_development
							who = PREV
						}
						multiply_variable = {
							which = raj_cohesion_change_amount
							which = raj_development_to_add
						}
						divide_variable = {
							which = raj_cohesion_change_amount
							which = raj_total_dev
						}
						
						check_variable = { raj_cohesion_change_amount = -3 }
					}
				}
			}
			if = {
				limit = {
					4411 = {
						variable_arithmetic_trigger = {
							export_to_variable = {
								which = raj_cohesion_change_amount
								value = $amount$
							}
							multiply_variable = {
								which = raj_cohesion_change_amount
								value = 100.00
							}
							export_to_variable = {
								which = raj_development_to_add
								value = total_development
								who = PREV
							}
							multiply_variable = {
								which = raj_cohesion_change_amount
								which = raj_development_to_add
							}
							divide_variable = {
								which = raj_cohesion_change_amount
								which = raj_total_dev
							}
							
							check_variable = { raj_cohesion_change_amount = -1 }
						}
					}
				}
				custom_tooltip = raj_cohesion_decrease_tiny_tt
			}
			else = {
				custom_tooltip = raj_cohesion_decrease_small_tt
			}
		}
		else = {
			if = {
				limit = {
					4411 = {
						variable_arithmetic_trigger = {
							export_to_variable = {
								which = raj_cohesion_change_amount
								value = $amount$
							}
							multiply_variable = {
								which = raj_cohesion_change_amount
								value = 100.00
							}
							export_to_variable = {
								which = raj_development_to_add
								value = total_development
								who = PREV
							}
							multiply_variable = {
								which = raj_cohesion_change_amount
								which = raj_development_to_add
							}
							divide_variable = {
								which = raj_cohesion_change_amount
								which = raj_total_dev
							}
							
							check_variable = { raj_cohesion_change_amount = -10 }
						}
					}
				}
				if = {
					limit = {
						4411 = {
							variable_arithmetic_trigger = {
								export_to_variable = {
									which = raj_cohesion_change_amount
									value = $amount$
								}
								multiply_variable = {
									which = raj_cohesion_change_amount
									value = 100.00
								}
								export_to_variable = {
									which = raj_development_to_add
									value = total_development
									who = PREV
								}
								multiply_variable = {
									which = raj_cohesion_change_amount
									which = raj_development_to_add
								}
								divide_variable = {
									which = raj_cohesion_change_amount
									which = raj_total_dev
								}
								
								check_variable = { raj_cohesion_change_amount = -6 }
							}
						}
					}
					custom_tooltip = raj_cohesion_decrease_medium_tt
				}
				else = {
					custom_tooltip = raj_cohesion_decrease_large_tt
				}
			}
			else = {
				if = {
					limit = {
						4411 = {
							variable_arithmetic_trigger = {
								export_to_variable = {
									which = raj_cohesion_change_amount
									value = $amount$
								}
								multiply_variable = {
									which = raj_cohesion_change_amount
									value = 100.00
								}
								export_to_variable = {
									which = raj_development_to_add
									value = total_development
									who = PREV
								}
								multiply_variable = {
									which = raj_cohesion_change_amount
									which = raj_development_to_add
								}
								divide_variable = {
									which = raj_cohesion_change_amount
									which = raj_total_dev
								}
								
								check_variable = { raj_cohesion_change_amount = -15 }
							}
						}
					}
					custom_tooltip = raj_cohesion_decrease_huge_tt
				}
				else = {
					custom_tooltip = raj_cohesion_decrease_gargantuan_tt
				}
			}
		}
	}
}

raj_cohesion_change_absolute = {
	hidden_effect = {
		4411 = {
			change_variable = {
				which = raj_cohesion
				value = $amount$
			}
			
			if = {
				limit = {
					check_variable = { raj_cohesion = 100 }
				}
				set_variable = {
					which = raj_cohesion
					value = 100
				}
			}
			else_if = {
				limit = {
					NOT = { check_variable = { raj_cohesion = 0 } }
				}
				set_variable = {
					which = raj_cohesion
					value = 0
				}
			}
		}
	}
	if = {
		limit = { 
			variable_arithmetic_trigger = {
				export_to_variable = {
					which = raj_cohesion_change_amount
					value = $amount$
				}
				
				check_variable = { raj_cohesion_change_amount = 0 }
			}
		}
		if = {
			limit = {
				4411 = {
					variable_arithmetic_trigger = {
						export_to_variable = {
							which = raj_cohesion_change_amount
							value = $amount$
						}
						
						check_variable = { raj_cohesion_change_amount = 3 }
					}
				}
			}
			if = {
				limit = {
					4411 = {
						variable_arithmetic_trigger = {
							export_to_variable = {
								which = raj_cohesion_change_amount
								value = $amount$
							}
							
							check_variable = { raj_cohesion_change_amount = 10 }
						}
					}
				}
				if = {
					limit = {
						4411 = {
							variable_arithmetic_trigger = {
								export_to_variable = {
									which = raj_cohesion_change_amount
									value = $amount$
								}
								
								check_variable = { raj_cohesion_change_amount = 15 }
							}
						}
					}
					custom_tooltip = raj_cohesion_increase_gargantuan_tt
				}
				else = {
					custom_tooltip = raj_cohesion_increase_huge_tt
				}
			}
			else = {
				if = {
					limit = {
						4411 = {
							variable_arithmetic_trigger = {
								export_to_variable = {
									which = raj_cohesion_change_amount
									value = $amount$
								}
								
								check_variable = { raj_cohesion_change_amount = 6 }
							}
						}
					}
					custom_tooltip = raj_cohesion_increase_large_tt
				}
				else = {
					custom_tooltip = raj_cohesion_increase_medium_tt
				}
			}
		}
		else = {
			if = {
				limit = {
					4411 = {
						variable_arithmetic_trigger = {
							export_to_variable = {
								which = raj_cohesion_change_amount
								value = $amount$
							}
							
							check_variable = { raj_cohesion_change_amount = 1 }
						}
					}
				}
				custom_tooltip = raj_cohesion_increase_small_tt
			}
			else = {
				custom_tooltip = raj_cohesion_increase_tiny_tt
			}
		}
	}
	else = { #negative
		if = {
			limit = {
				4411 = {
					variable_arithmetic_trigger = {
						export_to_variable = {
							which = raj_cohesion_change_amount
							value = $amount$
						}
						
						check_variable = { raj_cohesion_change_amount = -3 }
					}
				}
			}
			if = {
				limit = {
					4411 = {
						variable_arithmetic_trigger = {
							export_to_variable = {
								which = raj_cohesion_change_amount
								value = $amount$
							}
							
							check_variable = { raj_cohesion_change_amount = -1 }
						}
					}
				}
				custom_tooltip = raj_cohesion_decrease_tiny_tt
			}
			else = {
				custom_tooltip = raj_cohesion_decrease_small_tt
			}
		}
		else = {
			if = {
				limit = {
					4411 = {
						variable_arithmetic_trigger = {
							export_to_variable = {
								which = raj_cohesion_change_amount
								value = $amount$
							}
							
							check_variable = { raj_cohesion_change_amount = -10 }
						}
					}
				}
				if = {
					limit = {
						4411 = {
							variable_arithmetic_trigger = {
								export_to_variable = {
									which = raj_cohesion_change_amount
									value = $amount$
								}
								
								check_variable = { raj_cohesion_change_amount = -6 }
							}
						}
					}
					custom_tooltip = raj_cohesion_decrease_medium_tt
				}
				else = {
					custom_tooltip = raj_cohesion_decrease_large_tt
				}
			}
			else = {
				if = {
					limit = {
						4411 = {
							variable_arithmetic_trigger = {
								export_to_variable = {
									which = raj_cohesion_change_amount
									value = $amount$
								}
								
								check_variable = { raj_cohesion_change_amount = -15 }
							}
						}
					}
					custom_tooltip = raj_cohesion_decrease_huge_tt
				}
				else = {
					custom_tooltip = raj_cohesion_decrease_gargantuan_tt
				}
			}
		}
	}
}

remove_raj_mandate = {
	remove_country_modifier = raj_mandate_raja_protection
	remove_country_modifier = raj_mandate_right_to_expansion
	remove_country_modifier = raj_mandate_guaranteed_autonomy
	remove_country_modifier = raj_mandate_mercantile_preference
	remove_country_modifier = raj_mandate_sanctioned_armoury
	remove_country_modifier = raj_mandate_ministry_lectures
	remove_country_modifier = raj_mandate_senapti_primacy
	remove_country_modifier = raj_mandate_extended_prabhi_privileges
	remove_country_modifier = raj_mandate_territorial_limits
}

return_all_uncored_provinces = { #Make this also release nations that do not exist
	custom_tooltip = return_all_uncored_provinces_tt
	hidden_effect = {
		[[release_nations]
			every_owned_province = {
				limit = {
					NOT = { is_core = ROOT }
					any_core_country = {
						# exists = no
						NOT = { tag = ROOT }
						PREV = { previous_owner = PREV }
					}
				}
				save_event_target_as = province_to_cede
				cede_province = previous_owner
				owner = { change_religion = event_target:province_to_cede }
				if = {
					limit = { ROOT = { overlord = { has_reform = raja_reform } } }
					owner = {
						random_country = {
							limit = { overlord_of = ROOT }
							vassalize = PREV
						}
					}
				}
			}
		]
		every_owned_province = {
			limit = {
				NOT = { is_core = ROOT }
				any_country = {
					NOT = { tag = ROOT }
					PREV = { previous_owner = PREV }
				}
			}
			random_country = {
				limit = {
					NOT = { tag = ROOT }
					PREV = { previous_owner = PREV }
				}
				PREV = { cede_province = PREV }
			}
		}
	}
}

#Adenica
adenicaIncrementChivalryMissionCompleted = {
	hidden_effect = {
		change_variable = { adenicaChivalryMissionsCompleted = 1 }
	}
}