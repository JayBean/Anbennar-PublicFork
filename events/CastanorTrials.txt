namespace = castanortrials

country_event = { #Black Castanorian Trial
	id = castanortrials.12
	title = castanortrials.12.t
	desc = castanortrials.12.d
	picture = COURT_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_reform = dynastic_castanor_trials_reform
		has_regency = no
		has_consort_regency = no
		NOT = { has_country_flag = trials_of_castan_one_time_bypass }
	}
	
	option = { #Do Trial
		name = castanortrials.12.a
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				OR = {
					ruler_has_personality = righteous_personality
					ruler_has_personality = zealot_personality
					ruler_has_personality = bold_fighter_personality
					ruler_has_personality = naive_personality
				}
			}
		}
		if = {
			limit = { mission_completed = urviksten_gerudian_trials }
			custom_tooltip = urviksten_mission_completed_auto_win
			hidden_effect = { country_event = { id = castanortrials.104 } }
		}
		else = {
			hidden_effect = { country_event = { id = castanortrials.101 } }
		}
	}
	option = { #Don't do Trial
		name = castanortrials.12.b
		ai_chance = { 
			factor = 10
			modifier = {
				factor = 5
				OR = {
					ruler_has_personality = craven_personality
					ruler_has_personality = careful_personality
					ruler_has_personality = sinner_personality
				}
			}
			modifier = {
				factor = 0
				mission_completed = urviksten_gerudian_trials
			}
		}
		add_ruler_modifier = {
			name = castanortrials_refused_trial
			duration = -1
		}
	}
}

country_event = { #Trial Failalive
	id = castanortrials.15
	title = castanortrials.15.t
	desc = castanortrials.15.d
	picture = BAD_WITH_MONARCH_eventPicture
	
	is_triggered_only = yes
	
	# Dynastic
	option = {
		name = castanortrials.15.a
		trigger = { NOT = { has_reform = original_castanor_trials_reform } }
		castanor_trials_clear_trials_flags_effect = yes
		# If already Castanor/Black Castanor i.e. your legitimacy rests on the Trials
		if = {
			limit = { OR = { tag = B32 tag = Z34 } }
			add_legitimacy = -10
			add_prestige = -10
			reduce_stability_or_adm_power = yes
			add_ruler_modifier = { name = castanortrials_failed_alive duration = 7300 }
		}
		# Else if you're just an adventurer tryna do the trials
		else = {
			add_legitimacy = -5
			add_prestige = -5
			reduce_stability_or_adm_power = yes
		}
	}
	option = {
		name = castanortrials.15.b
		trigger = { NOT = { has_reform = original_castanor_trials_reform } }
		castanor_trials_clear_trials_flags_effect = yes
		# If already Castanor/Black Castanor i.e. your legitimacy rests on the Trials
		if = {
			limit = { OR = { tag = B32 tag = Z34 } }
			add_ruler_modifier = { name = castanortrials_failed_alive duration = 7300 }
			add_legitimacy = -20
			add_prestige = -20
		}
		# Else if you're just an adventurer tryna do the trials
		else = {
			add_legitimacy = -10
			add_prestige = -10
		}
	}

	option = {
		name = castanortrials.15.c
		trigger = { has_reform = original_castanor_trials_reform }
		hidden_effect = {
			random_list = {
				# One of the other candidates succeeds in the trials
				2 = {
					trigger = {
						NOT = { has_country_flag = castanor_trials_solo_candidate }
					}
					country_event = {
						id = castanortrials.95
					}
				}
				# None of the candidates succeeds in the trials
				1 = {
					castanor_trials_clear_candidate_flags_effect = yes
					castanor_trials_clear_trials_flags_effect = yes
				}
			}
		}
	}
}
country_event = { # Trail Faildead
	id = castanortrials.16
	title = castanortrials.16.t
	desc = castanortrials.16.d
	picture = KING_SICK_IN_BED_eventPicture
	
	is_triggered_only = yes
	
	# Dynastic
	option = {
		name = castanortrials.16.a
		trigger = { NOT = { has_reform = original_castanor_trials_reform } }
		castanor_trials_clear_trials_flags_effect = yes
		kill_ruler = yes
		reduce_stability_or_adm_power = yes
		# If already Castanor
		if = {
			limit = { OR = { tag = B32 tag = Z34 } }
			add_country_modifier = { name = castanortrials_failed_dead duration = 7300 }
		}
	}

	# OG
	option = {
		name = castanortrials.16.b
		trigger = { has_reform = original_castanor_trials_reform }
		hidden_effect = {
			random_list = {
				# One of the other candidates succeeds in the trials
				2 = {
					trigger = {
						NOT = { has_country_flag = castanor_trials_solo_candidate }
					}
					country_event = {
						id = castanortrials.95
					}
				}
				# None of the candidates succeeds in the trials
				1 = {
					castanor_trials_clear_candidate_flags_effect = yes
					castanor_trials_clear_trials_flags_effect = yes
				}
			}
		}
	}
}

### Regular Castanor Trials ###
# -> 199 are background/administrative events or flavour events
# 200 -> 299 are easy trials
# 300 -> 399 are medium trials
# 400 -> 499 are hard trials

# so that individual and multiple can't at once
country_event = {
	id = castanortrials.93
	title = castanortrials.95.t
	desc = castanortrials.95.desc
	picture = KING_SICK_IN_BED_eventPicture

	hidden = yes

	mean_time_to_happen = { months = 6 }

	trigger = {
		OR = {
			tag = B32
			tag = Z34
		}
		has_reform = original_castanor_trials_reform
		has_ruler = "(Castanorian Interregnum)"
		NOT = { has_country_flag = castanor_trials_in_progress }
	}

	option = {
		name = castanortrials.95.a
		random_list = {
			1 = { country_event = { id = castanortrials.96 } }
			1 = { country_event = { id = castanortrials.97 } }
		}
	}
}

country_event = {
	id = castanortrials.94
	title = castanortrials.95.t
	desc = castanortrials.95.desc
	picture = KING_SICK_IN_BED_eventPicture

	hidden = yes

	mean_time_to_happen = {
		days = 1
	}

	trigger = {
		has_country_flag = try_castanor_trials_decision_taken
	}

	option = {
		name = castanortrials.95.a
		country_event = {
			id = castanortrials.101
		}
		clr_country_flag = try_castanor_trials_decision_taken
	}
}

# One of other candidates win
country_event = {
	id = castanortrials.95
	title = castanortrials.95.t
	desc = castanortrials.95.desc
	picture = KING_SICK_IN_BED_eventPicture

	is_triggered_only = yes

	trigger = {
		OR = {
			tag = B32 # Castanor
			tag = Z34 # Black Castanor
		}
		has_reform = original_castanor_trials_reform
	}

	immediate = {
		hidden_effect = {
			random_list = {
				1 = {
					trigger = { 
						has_country_flag = castanor_trials_candidate_adventurer
						NOT = { has_country_flag = castanor_trials_candidate_adventurer_chosen }
					}
					set_country_flag = castanor_trials_candidate_adventurer_won
				}
				1 = {
					trigger = { 
						has_country_flag = castanor_trials_candidate_noble
						NOT = { has_country_flag = castanor_trials_candidate_noble_chosen }
					}
					set_country_flag = castanor_trials_candidate_noble_won
				}
				1 = {
					trigger = { 
						has_country_flag = castanor_trials_candidate_general
						NOT = { has_country_flag = castanor_trials_candidate_general_chosen }
					}
					set_country_flag = castanor_trials_candidate_general_won
				}
				1 = {
					trigger = { 
						has_country_flag = castanor_trials_candidate_merchant
						NOT = { has_country_flag = castanor_trials_candidate_merchant_chosen }
					}
					set_country_flag = castanor_trials_candidate_merchant_won
				}
				1 = {
					trigger = { 
						has_country_flag = castanor_trials_candidate_patrician
						NOT = { has_country_flag = castanor_trials_candidate_patrician_chosen }
					}
					set_country_flag = castanor_trials_candidate_patrician_won
				}
				1 = {
					trigger = { 
						has_country_flag = castanor_trials_candidate_dignitary
						NOT = { has_country_flag = castanor_trials_candidate_dignitary_chosen }
					}
					set_country_flag = castanor_trials_candidate_dignitary_won
				}
				1 = {
					trigger = { 
						has_country_flag = castanor_trials_candidate_academic
						NOT = { has_country_flag = castanor_trials_candidate_academic_chosen }
					}
					set_country_flag = castanor_trials_candidate_academic_won
				}
				1 = {
					trigger = { 
						has_country_flag = castanor_trials_candidate_peasant
						NOT = { has_country_flag = castanor_trials_candidate_peasant_chosen }
					}
					set_country_flag = castanor_trials_candidate_peasant_won
				}
				1 = {
					trigger = { 
						has_country_flag = castanor_trials_candidate_priest
						NOT = { has_country_flag = castanor_trials_candidate_priest_chosen }
					}
					set_country_flag = castanor_trials_candidate_priest_won
				}
				1 = {
					trigger = { 
						has_country_flag = castanor_trials_candidate_mage
						NOT = { has_country_flag = castanor_trials_candidate_mage_chosen }
					}
					set_country_flag = castanor_trials_candidate_mage_won
				}
			}
		}
	}

	option = {
		name = castanortrials.95.a
		country_event = {
			id = castanortrials.104
		}
	}
}

# One dude wants to try the trials
country_event = {
	id = castanortrials.96
	title = castanortrials.96.t
	desc = castanortrials.96.desc
	picture = KING_SICK_IN_BED_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_list = {
				# Plucky adventurer
				1 = {
					set_country_flag = castanor_trials_candidate_adventurer_chosen
				}
				# Powerful noble
				1 = {
					set_country_flag = castanor_trials_candidate_noble_chosen
				}
				# Renowned general
				1 = {
					set_country_flag = castanor_trials_candidate_general_chosen
				}
				# Rich merchant
				1 = {
					set_country_flag = castanor_trials_candidate_merchant_chosen
				}
				# Castonath patrician
				1 = {
					set_country_flag = castanor_trials_candidate_patrician_chosen
				}
				# Curious foreign dignitary
				1 = {
					set_country_flag = castanor_trials_candidate_dignitary_chosen
				}
				# Arrogant academic
				1 = {
					set_country_flag = castanor_trials_candidate_academic_chosen
				}
				# Naive peasant
				1 = {
					set_country_flag = castanor_trials_candidate_peasant_chosen
				}
				# Priest person
				1 = {
					set_country_flag = castanor_trials_candidate_priest_chosen
				}
				# Ambitious mage
				1 = {
					set_country_flag = castanor_trials_candidate_mage_chosen
				}
			}
		}
	}

	option = {
		name = castanortrials.96.a
		country_event = {
			id = castanortrials.101
		}
		set_country_flag = castanor_trials_solo_candidate
	}
}

# Crop of 3 candidates try their hand at the trials
country_event = {
	id = castanortrials.97
	title = castanortrials.97.t
	desc = castanortrials.97.desc
	picture = KING_SICK_IN_BED_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			# Pick 1st option
			random_list = {
				# Plucky adventurer
				1 = {
					set_country_flag = castanor_trials_candidate_adventurer
				}
				# Powerful noble
				1 = {
					set_country_flag = castanor_trials_candidate_noble
				}
				# Renowned general
				1 = {
					set_country_flag = castanor_trials_candidate_general
				}
				# Rich merchant
				1 = {
					set_country_flag = castanor_trials_candidate_merchant
				}
				# Castonath patrician
				1 = {
					set_country_flag = castanor_trials_candidate_patrician
				}
				# Curious foreign dignitary
				1 = {
					set_country_flag = castanor_trials_candidate_dignitary
				}
				# Arrogant academic
				1 = {
					set_country_flag = castanor_trials_candidate_academic
				}
				# Naive peasant
				1 = {
					set_country_flag = castanor_trials_candidate_peasant
				}
				# Priest person
				1 = {
					set_country_flag = castanor_trials_candidate_priest
				}
				# Ambitious mage
				1 = {
					set_country_flag = castanor_trials_candidate_mage
				}
			}
			# Pick 2nd option
			random_list = {
				# Plucky adventurer
				1 = {
					set_country_flag = castanor_trials_candidate_adventurer
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_adventurer }
					}
				}
				# Powerful noble
				1 = {
					set_country_flag = castanor_trials_candidate_noble
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_noble }
					}
				}
				# Renowned general
				1 = {
					set_country_flag = castanor_trials_candidate_general
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_general }
					}
				}
				# Rich merchant
				1 = {
					set_country_flag = castanor_trials_candidate_merchant
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_merchant }
					}
				}
				# Castonath patrician
				1 = {
					set_country_flag = castanor_trials_candidate_patrician
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_patrician }
					}
				}
				# Curious foreign dignitary
				1 = {
					set_country_flag = castanor_trials_candidate_dignitary
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_dignitary }
					}
				}
				# Arrogant academic
				1 = {
					set_country_flag = castanor_trials_candidate_academic
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_academic }
					}
				}
				# Naive peasant
				1 = {
					set_country_flag = castanor_trials_candidate_peasant
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_peasant }
					}
				}
				# Priest person
				1 = {
					set_country_flag = castanor_trials_candidate_priest
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_priest }
					}
				}
				# Ambitious mage
				1 = {
					set_country_flag = castanor_trials_candidate_mage
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_mage }
					}
				}
			}
			# Pick 3rd option
			random_list = {
				# Plucky adventurer
				1 = {
					set_country_flag = castanor_trials_candidate_adventurer
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_adventurer }
					}
				}
				# Powerful noble
				1 = {
					set_country_flag = castanor_trials_candidate_noble
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_noble }
					}
				}
				# Renowned general
				1 = {
					set_country_flag = castanor_trials_candidate_general
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_general }
					}
				}
				# Rich merchant
				1 = {
					set_country_flag = castanor_trials_candidate_merchant
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_merchant }
					}
				}
				# Castonath patrician
				1 = {
					set_country_flag = castanor_trials_candidate_patrician
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_patrician }
					}
				}
				# Curious foreign dignitary
				1 = {
					set_country_flag = castanor_trials_candidate_dignitary
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_dignitary }
					}
				}
				# Arrogant academic
				1 = {
					set_country_flag = castanor_trials_candidate_academic
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_academic }
					}
				}
				# Naive peasant
				1 = {
					set_country_flag = castanor_trials_candidate_peasant
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_peasant }
					}
				}
				# Priest person
				1 = {
					set_country_flag = castanor_trials_candidate_priest
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_priest }
					}
				}
				# Ambitious mage
				1 = {
					set_country_flag = castanor_trials_candidate_mage
					trigger = {
						NOT = { has_country_flag = castanor_trials_candidate_mage }
					}
				}
			}
		}
	}

	option = {
		name = castanortrials.97.a
		trigger = {
			has_country_flag = castanor_trials_candidate_adventurer
		}
		custom_tooltip = castanortrials_adventurer_pick_tt
		set_country_flag = castanor_trials_candidate_adventurer_chosen
	}
	option = {
		name = castanortrials.97.b
		trigger = {
			has_country_flag = castanor_trials_candidate_noble
		}
		custom_tooltip = castanortrials_noble_pick_tt
		set_country_flag = castanor_trials_candidate_noble_chosen
	}
	option = {
		name = castanortrials.97.c
		trigger = {
			has_country_flag = castanor_trials_candidate_general
		}
		custom_tooltip = castanortrials_general_pick_tt
		set_country_flag = castanor_trials_candidate_general_chosen
	}
	option = {
		name = castanortrials.97.d
		trigger = {
			has_country_flag = castanor_trials_candidate_merchant
		}
		custom_tooltip = castanortrials_merchant_pick_tt
		set_country_flag = castanor_trials_candidate_merchant_chosen
	}
	option = {
		name = castanortrials.97.e
		trigger = {
			has_country_flag = castanor_trials_candidate_patrician
		}
		custom_tooltip = castanortrials_patrician_pick_tt
		set_country_flag = castanor_trials_candidate_patrician_chosen
	}
	option = {
		name = castanortrials.97.f
		trigger = {
			has_country_flag = castanor_trials_candidate_dignitary
			NOT = { has_country_flag = patrician_castanor }
		}
		custom_tooltip = castanortrials_dignitary_pick_tt
		set_country_flag = castanor_trials_candidate_dignitary_chosen
	}
	option = {
		name = castanortrials.97.f2
		trigger = {
			has_country_flag = castanor_trials_candidate_dignitary
			has_country_flag = patrician_castanor
		}
		custom_tooltip = castanortrials_dignitary_patrician_pick_tt
		set_country_flag = castanor_trials_candidate_dignitary_chosen
	}
	option = {
		name = castanortrials.97.g
		trigger = {
			has_country_flag = castanor_trials_candidate_academic
		}
		custom_tooltip = castanortrials_academic_pick_tt
		set_country_flag = castanor_trials_candidate_academic_chosen
	}
	option = {
		name = castanortrials.97.h
		trigger = {
			has_country_flag = castanor_trials_candidate_peasant
			NOT = { has_country_flag = patrician_castanor }
		}
		custom_tooltip = castanortrials_peasant_pick_tt
		set_country_flag = castanor_trials_candidate_peasant_chosen
	}
	option = {
		name = castanortrials.97.h2
		trigger = {
			has_country_flag = castanor_trials_candidate_peasant
			has_country_flag = patrician_castanor
		}
		custom_tooltip = castanortrials_weak_scion_pick_tt
		set_country_flag = castanor_trials_candidate_peasant_chosen
	}
	option = {
		name = castanortrials.97.i
		trigger = {
			has_country_flag = castanor_trials_candidate_priest
		}
		custom_tooltip = castanortrials_priest_pick_tt
		set_country_flag = castanor_trials_candidate_priest_chosen
	}
	option = {
		name = castanortrials.97.j
		trigger = {
			has_country_flag = castanor_trials_candidate_mage
		}
		custom_tooltip = castanortrials_mage_pick_tt
		set_country_flag = castanor_trials_candidate_mage_chosen
	}
	after = {
		country_event = {
			id = castanortrials.101
		}
	}
}

# Choose between dynastic or original version of the trial
country_event = {
	id = castanortrials.98
	title = castanortrials.98.t
	desc = castanortrials.98.desc
	picture = KING_SICK_IN_BED_eventPicture

	is_triggered_only = yes

	trigger = {
		OR = {
			tag = B32
			tag = Z34
		}
	}

	option = {
		name = castanortrials.98.a
		add_government_reform = original_castanor_trials_reform
		set_dynasty = "'Castan'"
	}
	option = {
		name = castanortrials.98.b
		add_government_reform = dynastic_castanor_trials_reform
	}
}

# Fires the interregnum upon Castan's death
country_event = {
	id = castanortrials.99
	title = castanortrials.99.t
	desc = castanortrials.99.desc
	picture = KING_SICK_IN_BED_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			define_ruler = {
				name = "(Castanorian Interregnum)"
				adm = 0
				dip = 0
				mil = 0
				regency = yes
			}
		}
	}

	trigger = {
		OR = {
			tag = B32 # Castanor
			tag = Z34 # Black Castanor
		}
		has_reform = original_castanor_trials_reform
		NOT = { has_ruler = "(Castanorian Interregnum)" }
		NOT = { has_country_flag = next_castan_coronation }
		ruler_is_immortal = no
	}

	option = {
		name = castanortrials.99.a
		tooltip = {
			hidden_effect = {
				define_ruler = {
					name = "(Castanorian Interregnum)"
					adm = 0
					dip = 0
					mil = 0
					regency = yes
				}
			}
		}
		custom_tooltip = castanorInterregnumTT
		clr_country_flag = next_castan_coronation
	}
}

# Intro event
country_event = {
	id = castanortrials.101
	title = castanortrials.101.t
	desc = {
		desc = castanortrials.101.desc1
		trigger = {
			NOT = { tag = B32 }
			NOT = { tag = Z34 }
		}
	}
	desc = {
		desc = castanortrials.101.desc2
		trigger = {
			OR = {
				tag = B32
				tag = Z34
			}
			OR = {
				has_reform = dynastic_castanor_trials_reform
				has_country_flag = castanor_trials_solo_candidate
			}
		}
	}
	desc = {
		desc = castanortrials.101.desc3
		trigger = {
			OR = {
				tag = B32
				tag = Z34
			}
		}
	}
	picture = KING_SICK_IN_BED_eventPicture

	is_triggered_only = yes

	# Procs the first trial (easy)
	option = {
		name = castanortrials.101.a
		set_country_flag = castanor_trials_in_progress
		hidden_effect = {
			random_list = {
				# Rally cry
				1 = {
					country_event = {
						id = castanortrials.200
					}
				}
				# the Great
				1 = {
					country_event = {
						id = castanortrials.203
					}
				}
				# Dwarf-friend
				1 = {
					country_event = {
						id = castanortrials.204
					}
				}
				# Oath trial event (more likely cause there's 10 possible oaths)
				5 = {
					country_event = {
						id = castanortrials.205
					}
				}
			}
		}
	}
}

# Lead into 2nd trial
country_event = {
	id = castanortrials.102
	title = castanortrials.102.t
	desc = castanortrials.102.desc
	picture = event_Picture

	is_triggered_only = yes

	# Procs the second trial (medium)
	option = {
		name = castanortrials.102.a
		hidden_effect = {
			random_list = {
				# Realmbuilder sculture enchanted item thingy
				1 = {
					country_event = {
						id = castanortrials.300
					}
				}
				# Reconcile two forest spirits
				# 1 = {
				# 	country_event = {
				# 		id = castanortrials.305
				# 	}
				# }
				# Befriend a young wyvern
				1 = {
					country_event = {
						id = castanortrials.310
					}
				}
				# Jump around a rock 10 times
				1 = {
					country_event = {
						id = castanortrials.315
					}
				}
			}
		}
	}
}

# Lead into 3rd trial
country_event = {
	id = castanortrials.103
	title = castanortrials.103.t
	desc = castanortrials.103.desc
	picture = KING_SICK_IN_BED_eventPicture

	is_triggered_only = yes

	# Procs the third trial (hard)
	option = {
		name = castanortrials.103.a
		hidden_effect = {
			random_list = {
				1 = {
					country_event = {
						id = castanortrials.400
					}
				}
				1 = {
					country_event = {
						id = castanortrials.410
					}
				}
			}
		}
	}
}

# The coronation party
country_event = {
	id = castanortrials.104
	title = castanortrials.104.t
	desc = {
		trigger = { religion = ravelian }
		desc = castanortrials.104.descRavelian
	}
	desc = castanortrials.104.desc
	picture = HRE_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		# Set the winner
		if = {
			limit = {
				has_reform = original_castanor_trials_reform
				NOT = { has_country_flag = castanor_trials_candidate_adventurer_won }
				NOT = { has_country_flag = castanor_trials_candidate_noble_won }
				NOT = { has_country_flag = castanor_trials_candidate_general_won }
				NOT = { has_country_flag = castanor_trials_candidate_merchant_won }
				NOT = { has_country_flag = castanor_trials_candidate_patrician_won }
				NOT = { has_country_flag = castanor_trials_candidate_dignitary_won }
				NOT = { has_country_flag = castanor_trials_candidate_academic_won }
				NOT = { has_country_flag = castanor_trials_candidate_peasant_won }
				NOT = { has_country_flag = castanor_trials_candidate_priest_won }
				NOT = { has_country_flag = castanor_trials_candidate_mage_won }
			}
			trigger_switch = {
				on_trigger = has_country_flag
				castanor_trials_candidate_adventurer_chosen = {
					set_country_flag = castanor_trials_candidate_adventurer_won
				}
				castanor_trials_candidate_noble_chosen = {
					set_country_flag = castanor_trials_candidate_noble_won
				}
				castanor_trials_candidate_general_chosen = {
					set_country_flag = castanor_trials_candidate_general_won
				}
				castanor_trials_candidate_merchant_chosen = {
					set_country_flag = castanor_trials_candidate_merchant_won
				}
				castanor_trials_candidate_patrician_chosen = {
					set_country_flag = castanor_trials_candidate_patrician_won
				}
				castanor_trials_candidate_dignitary_chosen = {
					set_country_flag = castanor_trials_candidate_dignitary_won
				}
				castanor_trials_candidate_academic_chosen = {
					set_country_flag = castanor_trials_candidate_academic_won
				}
				castanor_trials_candidate_peasant_chosen = {
					set_country_flag = castanor_trials_candidate_peasant_won
				}
				castanor_trials_candidate_priest_chosen = {
					set_country_flag = castanor_trials_candidate_priest_won
				}
				castanor_trials_candidate_mage_chosen = {
					set_country_flag = castanor_trials_candidate_mage_won
				}
			}
		}
		
		# So that the interregnum doesn't fire + define Castan name and number
		if = {
			limit = { has_reform = original_castanor_trials_reform }
			set_country_flag = next_castan_coronation
			increase_castan_number = yes
			define_castan_name = yes
		}
	}
	# Stuff happens
	option = {
		name = castanortrials.104.a
		
		# Define a ruler based on the candidate who won
		define_new_castan = yes
		
		# Draw a map claims
		if = {
			limit = { has_country_flag = castanTheGreatArea1Chosen }
			custom_tooltip = castanor_the_great_trial_reward_tt
			event_target:castanor_claim_1 = {
				area = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_claim = ROOT }
					}
					add_claim = ROOT
				}
			}
			clr_country_flag = castanTheGreatArea1Chosen
		}
		else_if = {
			limit = { has_country_flag = castanTheGreatArea2Chosen }
			custom_tooltip = castanor_the_great_trial_reward_tt
			event_target:castanor_claim_2 = {
				area = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_claim = ROOT }
					}
					add_claim = ROOT
				}
			}
			clr_country_flag = castanTheGreatArea2Chosen
		}
		else_if = {
			limit = { has_country_flag = castanTheGreatArea3Chosen }
			custom_tooltip = castanor_the_great_trial_reward_tt
			event_target:castanor_claim_3 = {
				area = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_claim = ROOT }
					}
					add_claim = ROOT
				}
			}
			clr_country_flag = castanTheGreatArea3Chosen
		}
		
		# Opinion + trust for dwarf-friend trial
		if = {
			limit = { has_country_flag = dwarf_friend_trial_success_jewelry }
			custom_tooltip = castanor_dwarf_friend_trial_reward_tt
			random_known_country = {
				limit = { has_country_modifier = dwarven_administration }
				add_trust = {
					who = ROOT
					value = 10
					mutual = yes
				}
				add_opinion = {
					who = ROOT
					modifier = castanor_dwarf_friend_trial_jewelry_success
				}
			}
			add_prestige = 5
			custom_tooltip = castan_linebreak_tt
		}
		else_if = {
			limit = { has_country_flag = dwarf_friend_trial_success }
			custom_tooltip = castanor_dwarf_friend_trial_reward_tt
			random_known_country = {
				limit = { has_country_modifier = dwarven_administration }
			}
			add_prestige = 2
			custom_tooltip = castan_linebreak_tt
		}
		else_if = {
			limit = { has_country_flag = dwarf_friend_trial_success_shield }
			custom_tooltip = castanor_dwarf_friend_trial_reward_tt
			random_known_country = {
				limit = { has_country_modifier = dwarven_administration }
				add_trust = {
					who = ROOT
					value = 5
					mutual = yes
				}
				add_opinion = {
					who = ROOT
					modifier = castanor_dwarf_friend_trial_shield_success
				}
			}
			add_prestige = 3
			custom_tooltip = castan_linebreak_tt
		}
		else_if = {
			limit = { has_country_flag = dwarf_friend_trial_success_weapon }
			custom_tooltip = castanor_dwarf_friend_trial_reward_tt
			random_known_country = {
				limit = { has_country_modifier = dwarven_administration }
				add_trust = {
					who = ROOT
					value = 15
					mutual = yes
				}
				add_opinion = {
					who = ROOT
					modifier = castanor_dwarf_friend_trial_weapon_success
				}
			}
			add_prestige = 10
			custom_tooltip = castan_linebreak_tt
		}
		else_if = {
			limit = { has_country_flag = dwarf_friend_trial_fail }
			custom_tooltip = castanor_dwarf_friend_trial_reward_tt
			random_known_country = {
				limit = { has_country_modifier = dwarven_administration }
				add_opinion = {
					who = ROOT
					modifier = castanor_dwarf_friend_trial_fail
				}
			}
			add_prestige = -5
			custom_tooltip = castan_linebreak_tt
		}
		
		# Effects for passing the oath trial
		if = {
			limit = { has_country_flag = castan_oath_preserver_succeeded }
			add_ruler_modifier = {
				name = castan_oath_preserver
				duration = -1
			}
		}
		else_if = {
			limit = { has_country_flag = castan_oath_peacemaker_succeeded }
			random_known_country = {
				limit = { is_rival = ROOT }
				add_truce_with = ROOT
			}
		}
		else_if = {
			limit = { has_country_flag = castan_oath_righteous_succeeded }
			add_ruler_modifier = {
				name = castan_oath_righteous
				duration = -1
			}
		}
		else_if = {
			limit = { has_country_flag = castan_oath_old_succeeded }
			add_ruler_personality = righteous_personality
		}
		else_if = {
			limit = { has_country_flag = castan_oath_pious_succeeded }
			every_known_country = {
				limit = { has_matching_religion = ROOT }
				add_opinion = {
					who = ROOT
					modifier = castanor_pious_trial_succeed
					years = 10
				}
			}
		}
		else_if = {
			limit = { has_country_flag = castan_oath_youthful_succeeded }
			add_ruler_modifier = {
				name = castan_oath_youthful
				duration = -1
			}
		}
		else_if = {
			limit = { has_country_flag = castan_oath_compassionate_succeeded }
			add_ruler_modifier = {
				name = castan_oath_compassionate
				duration = -1
			}
		}
		else_if = {
			limit = { has_country_flag = castan_oath_unwavering_succeeded }
			add_ruler_modifier = {
				name = castan_oath_unwavering
				duration = -1
			}
			random_list = {
				1 = {
					increase_ruler_adm_effect = yes
				}
				1 = {
					increase_ruler_dip_effect = yes
				}
				1 = {
					increase_ruler_mil_effect = yes
				}
			}
		}
		else_if = {
			limit = { has_country_flag = castan_oath_sickly_succeeded }
			add_ruler_modifier = {
				name = castan_oath_sickly
				duration = -1
			}
		}
		else_if = {
			limit = { has_country_flag = castan_oath_cowardly_succeeded }
			add_ruler_modifier = {
				name = castan_oath_cowardly
				duration = -1
			}
		}
		
		# For completing the beastbane trial and succeeding in enchanting the item
		trigger_switch = {
			on_trigger = has_country_flag
			beastbane_trial_enchantment_adm_success = { custom_tooltip = beastbane_trial_enchantment_adm_success_tt increase_ruler_adm_effect = yes }
			beastbane_trial_enchantment_dip_success = { custom_tooltip = beastbane_trial_enchantment_dip_success_tt increase_ruler_dip_effect = yes }
			beastbane_trial_enchantment_mil_success = { custom_tooltip = beastbane_trial_enchantment_mil_success_tt increase_ruler_mil_effect = yes }
		}
		
		if = {
			limit = {
				NOT = { tag = B32 }
				NOT = { tag = Z34 }
				NOT = { has_country_flag = black_trials }
			}
			change_tag = B32
			hidden_effect = { restore_country_name = yes }
			custom_tooltip = tooltip_castanorian_culture_provinces
			hidden_effect = {
				every_owned_province = {
					limit = {
						has_owner_culture = yes
						owner = {
							culture_is_human = yes
						}
					}
					change_culture = castanorian
				}
			}
			primary_and_ruler_culture_change = { race = human new_culture = castanorian }
			remove_non_electors_emperors_from_empire_effect = yes
			if = {
				limit = {
					NOT = { government_rank = 3 }
				}
				set_government_rank = 3
			}
			if = {
				limit = { NOT = { government = monarchy } }
				change_government = monarchy
			}
			840 = {	#To North Citadel
				move_capital_effect = yes
			}
			hidden_effect = {
				every_owned_province = {
					limit = {
						has_owner_culture = yes
						owner = {
							culture_is_human = yes
						}
					}
					change_culture = castanorian
				}
			}
			country_event = {
				id = castanortrials.98
			}
			
			#Claims
			inner_castanor_region = {
				limit = {
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = B32
			}
			west_castanor_region = {
				limit = {
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = B32
			}
			south_castanor_region = {
				limit = {
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = B32
			}
			
			if = {
				limit = { has_custom_ideas = no }
				country_event = { id = ideagroups.1 } #Swap Ideas
			}
			
			add_prestige = 50
			add_country_modifier = {
				name = "centralization_modifier"
				duration = 7300
			}
			set_country_flag = formed_castanor_flag
			clr_country_flag = 	knightly_order_adventurer
#			country_event = { id = adventurer.2 days = 10}
			if = {
				limit = { has_custom_ideas = no }
				country_event = { id = ideagroups.1 } #Swap Ideas
			}
			set_variable = {
				which = maxAllowedDominions
				value = 2
			}
			swap_non_generic_missions = yes
		}
		
		# General effects
		random_list = {
			1 = {
				increase_ruler_adm_effect = yes
			}
			1 = {
				increase_ruler_dip_effect = yes
			}
			1 = {
				increase_ruler_mil_effect = yes
			}
		}
		add_stability_or_adm_power = yes
		add_prestige = 10
		add_ruler_modifier = {
			name = castanortrials_castan
			duration = -1
		}
	}
	after = {
		castanor_trials_clear_candidate_flags_effect = yes
		castanor_trials_clear_trials_flags_effect = yes
		
		# Fire only once - disaster
		hidden_effect = {
			if = {
				limit = { tag = B32 }
				country_event = {
					id = flavor_castanor.200
					days = 1825
					random = 365
				}
			}
		}
		
		clr_country_flag = castanor_trials_in_progress
		clr_country_flag = next_castan_coronation
		clr_country_flag = castanor_trials_solo_candidate
		clr_country_flag = black_trials
	}
}

# Easy Events #
# Rally cry - Castan XIII the Quiet
country_event = {
	id = castanortrials.200
	title = castanortrials.200.t
	desc = castanortrials.200.desc
	picture = EP_ISLAND_eventPicture

	is_triggered_only = yes

	# Magically enhance your yell
	option = {
		name = castanortrials.200.a
		hidden_effect = {
			if = {
				limit = { has_reform = original_castanor_trials_reform }
				random_list = {
					# Success
					10 = {
						modifier = {
							factor = 10
							has_country_flag = castanor_trials_candidate_priest_chosen
						}
						modifier = {
							factor = 10
							has_country_flag = castanor_trials_candidate_patrician_chosen
						}
						country_event = {
							id = castanortrials.201
						}
					}
					# Fail
					90 = {
						modifier = {
							factor = 0
							has_country_flag = castanor_trials_candidate_mage_chosen
						}
						modifier = {
							factor = 0
							has_country_flag = first_time_trying_trials
						}
						set_country_flag = castanQuietTrialFail
						castanor_trials_fail_effect = yes
					}
				}
			}
			else = {
				random_list = {
					# Success
					10 = {
						modifier = {
							factor = 10
							ruler_has_mage_personality = yes
						}
						modifier = {
							factor = 2
							is_illusion_1 = yes
						}
						modifier = {
							factor = 5
							is_illusion_2 = yes
						}
						modifier = {
							factor = 10  
							is_illusion_3 = yes
						}
						country_event = {
							id = castanortrials.201
						}
					}
					# Fail
					90 = {
						modifier = {
							factor = 0
							has_country_flag = first_time_trying_trials
						}
						set_country_flag = castanQuietTrialFail
						castanor_trials_fail_effect = yes
					}
				}
			}
		}
	}
	# Rig something up to amplify your yell
	option = {
		name = castanortrials.200.b
		hidden_effect = {
			if = {
				limit = { has_reform = original_castanor_trials_reform }
				random_list = {
					# Success
					50 = {
						modifier = {
							factor = 4
							has_country_flag = castanor_trials_candidate_academic_chosen
						}
						modifier = {
							factor = 2
							has_country_flag = castanor_trials_candidate_adventurer_chosen
						}
						country_event = {
							id = castanortrials.201
						}
					}
					# Fail
					50 = {
						set_country_flag = castanQuietTrialFail
						castanor_trials_fail_effect = yes
						modifier = {
							factor = 0
							has_country_flag = first_time_trying_trials
						}
					}
				}
			}
			else = {
				random_list = {
					# Success
					50 = {
						modifier = {
							factor = 2
							ruler_has_personality = scholar_personality
						}
						modifier = {
							factor = 2
							ruler_has_personality = free_thinker_personality
						}
						modifier = {
							factor = 5
							adm = 6
						}
						modifier = {
							factor = 2
							adm = 5
						}
						modifier = {
							factor = 2
							adm = 4
						}
						country_event = {
							id = castanortrials.201
						}
					}
					# Fail
					50 = {
						modifier = {
							factor = 2
							NOT = { adm = 3 }
						}
						modifier = {
							factor = 2
							NOT = { adm = 2 }
						}
						modifier = {
							factor = 2
							NOT = { adm = 1 }
						}
						modifier = {
							factor = 0
							has_country_flag = first_time_trying_trials
						}
						set_country_flag = castanQuietTrialFail
						castanor_trials_fail_effect = yes
					}
				}
			}
		}
	}
	# Just yell bro
	option = {
		name = castanortrials.200.c
		hidden_effect = {
			if = {
				limit = { has_reform = original_castanor_trials_reform }
				random_list = {
					# Success
					50 = {
						modifier = {
							factor = 3
							has_country_flag = castanor_trials_candidate_general_chosen
						}
						modifier = {
							factor = 3
							has_country_flag = castanor_trials_candidate_merchant_chosen
						}
						country_event = {
							id = castanortrials.201
						}
					}
					# Fail
					50 = {
						set_country_flag = castanQuietTrialFail
						castanor_trials_fail_effect = yes
						modifier = {
							factor = 0
							has_country_flag = first_time_trying_trials
						}
					}
				}
			}
			else = {
				random_list = {
					# Success
					50 = {
						modifier = {
							factor = 2
							ruler_has_personality = inspiring_leader_personality
						}
						modifier = {
							factor = 5
							mil = 6
						}
						modifier = {
							factor = 2
							mil = 5
						}
						modifier = {
							factor = 2
							mil = 4
						}
						country_event = {
							id = castanortrials.201
						}
					}
					# Fail
					50 = {
						modifier = {
							factor = 2
							NOT = { mil = 3 }
						}
						modifier = {
							factor = 2
							NOT = { mil = 2 }
						}
						modifier = {
							factor = 2
							NOT = { mil = 1 }
						}
						modifier = {
							factor = 0
							has_country_flag = first_time_trying_trials
						}
						set_country_flag = castanQuietTrialFail
						castanor_trials_fail_effect = yes
					}
				}
			}
		}
	}
}

# Rally cry success
country_event = {
	id = castanortrials.201
	title = castanortrials.201.t
	desc = castanortrials.201.desc
	picture = GOOD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	option = {
		name = castanortrials.201.a
		country_event = {
			id = castanortrials.102
		}
	}
}

# Draw map - Castan V the Great
country_event = {
	id = castanortrials.203
	title = castanortrials.203.t
	desc = castanortrials.203.desc
	picture = KING_SICK_IN_BED_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			# Pick one province for possible claim
			random_owned_province = {
				limit = {
					any_neighbor_province = {
						is_city = yes
						has_discovered = ROOT
						owner = {
							is_free_or_tributary_trigger = yes
							NOT = { tag = ROOT }
							NOT = { is_subject_of = ROOT }
							NOT = { overlord_of = ROOT }
							NOT = { alliance_with = ROOT }
						}
					}
				}
				random_neighbor_province = {
					limit = {
						is_city = yes
						has_discovered = ROOT
						owner = {
							is_free_or_tributary_trigger = yes
							NOT = { tag = ROOT }
							NOT = { is_subject_of = root }
							NOT = { overlord_of = root }
							NOT = { alliance_with = root }
						}
					}
					area = {
						set_province_flag = castanor_claim_1_flag
					}
					save_event_target_as = castanor_claim_1
				}
			}
			# Pick another province for possible claim
			random_owned_province = {
				limit = {
					any_neighbor_province = {
						NOT = { has_province_flag = castanor_claim_1_flag }
						is_city = yes
						has_discovered = root
						owner = {
							is_free_or_tributary_trigger = yes
							NOT = { tag = ROOT }
							NOT = { is_subject_of = root }
							NOT = { overlord_of = root }
							NOT = { alliance_with = root }
						}
					}
				}
				random_neighbor_province = {
					limit = {
						is_city = yes
						has_discovered = root
						owner = {
							is_free_or_tributary_trigger = yes
							NOT = { tag = ROOT }
							NOT = { is_subject_of = root }
							NOT = { overlord_of = root }
							NOT = { alliance_with = root }
						}
					}
					area = {
						set_province_flag = castanor_claim_2_flag
					}
					save_event_target_as = castanor_claim_2
				}
			}
			# Pick yet another province for possible claim
			random_owned_province = {
				limit = {
					any_neighbor_province = {
						NOT = { has_province_flag = castanor_claim_1_flag }
						NOT = { has_province_flag = castanor_claim_2_flag }
						is_city = yes
						has_discovered = root
						owner = {
							is_free_or_tributary_trigger = yes
							NOT = { tag = ROOT }
							NOT = { is_subject_of = root }
							NOT = { overlord_of = root }
							NOT = { alliance_with = root }
						}
					}
				}
				random_neighbor_province = {
					limit = {
						is_city = yes
						has_discovered = root
						owner = {
							is_free_or_tributary_trigger = yes
							NOT = { tag = ROOT }
							NOT = { is_subject_of = root }
							NOT = { overlord_of = root }
							NOT = { alliance_with = root }
						}
					}
					save_event_target_as = castanor_claim_3
				}
			}
		}
	}
	
	# Claims area 1
	option = {
		name = castanortrials.203.a
		goto = castanor_claim_1
		trigger = {
			has_saved_event_target = castanor_claim_1
		}
		custom_tooltip = castanTheGreatSuccessEffect1
		set_country_flag = castanTheGreatArea1Chosen
	}
	# Claims area 2
	option = {
		name = castanortrials.203.b
		trigger = {
			has_saved_event_target = castanor_claim_2
		}
		goto = castanor_claim_2
		custom_tooltip = castanTheGreatSuccessEffect2
		set_country_flag = castanTheGreatArea2Chosen
	}
	# Claims area 3
	option = {
		name = castanortrials.203.c
		trigger = {
			has_saved_event_target = castanor_claim_3
		}
		goto = castanor_claim_3
		custom_tooltip = castanTheGreatSuccessEffect3
		set_country_flag = castanTheGreatArea3Chosen
	}
	# Fallback if no possible claims
	option = {
		name = castanortrials.203.d
		trigger = {
			NOT = { has_saved_event_target = castanor_claim_1 }
			NOT = { has_saved_event_target = castanor_claim_2 }
			NOT = { has_saved_event_target = castanor_claim_3 }
		}
	}

	after = {
		every_owned_province = {
			clr_province_flag = castanor_claim_1_flag
			clr_province_flag = castanor_claim_2_flag
		}
		country_event = {
			id = castanortrials.102
		}
	}
}

# Forge a gift for a dwarf - Castan III Dwarf-friend
country_event = {
	id = castanortrials.204
	title = castanortrials.204.t
	desc = castanortrials.204.desc
	picture = KING_SICK_IN_BED_eventPicture

	is_triggered_only = yes

	# An ornate weapon
	option = {
		name = castanortrials.204.a
		custom_tooltip = dwarf_friend_trial_weapon_tt
		random_list = {
			25 = {
				custom_tooltip = dwarf_friend_trial_success_tt
				set_country_flag = dwarf_friend_trial_success_weapon
			}
			75 = {
				custom_tooltip = dwarf_friend_trial_fail_tt
				set_country_flag = dwarf_friend_trial_fail	
			}
		}
	}
	# A lovely piece of jewelry
	option = {
		name = castanortrials.204.b
		custom_tooltip = dwarf_friend_trial_jewelry_tt
		random_list = {
			50 = {
				custom_tooltip = dwarf_friend_trial_success_tt
				set_country_flag = dwarf_friend_trial_success_jewelry
			}
			50 = {
				custom_tooltip = dwarf_friend_trial_fail_tt
				set_country_flag = dwarf_friend_trial_fail
			}
		}
	}
	# A solid shield
	option = {
		name = castanortrials.204.c
		custom_tooltip = dwarf_friend_trial_shield_tt
		random_list = {
			75 = {
				custom_tooltip = dwarf_friend_trial_success_tt
				set_country_flag = dwarf_friend_trial_success_shield
			}
			25 = {
				custom_tooltip = dwarf_friend_trial_fail_tt
				set_country_flag = dwarf_friend_trial_fail
			}
		}
	}
	# Uhh.... a large stick is about the extent of my skills
	option = {
		name = castanortrials.204.d
		custom_tooltip = dwarf_friend_trial_success_tt
		set_country_flag = dwarf_friend_trial_success
	}
	after = {
		country_event = {
			id = castanortrials.102
		}
	}
}

# Oathstone event
country_event = {
	id = castanortrials.205
	title = castanortrials.205.t
	desc = castanortrials.205.desc
	picture = KING_SICK_IN_BED_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			# Pick first oath to display
			random_list = {
				# Castan VII The Preserver
				1 = {
					set_country_flag = castan_oath_option_preserver
				}
				# Castan IX Peacemaker
				1 = {
					set_country_flag = castan_oath_option_peacemaker
				}
				# Castan XI the Righteous
				1 = {
					set_country_flag = castan_oath_option_righteous
				}
				# Castan XI the Old
				1 = {
					set_country_flag = castan_oath_option_old
				}
				# Castan XII the Pious
				1 = {
					set_country_flag = castan_oath_option_pious
				}
				# Castan XX the Youthful
				1 = {
					set_country_flag = castan_oath_option_youthful
				}
				# Castan XXI the Compassionate
				1 = {
					set_country_flag = castan_oath_option_compassionate
				}
				# Castan XXVI the Unwavering
				1 = {
					set_country_flag = castan_oath_option_unwavering
				}
				# Castan XXVII the Sickly
				1 = {
					set_country_flag = castan_oath_option_sickly
				}
				# Castan XLII the Cowardly
				1 = {
					set_country_flag = castan_oath_option_cowardly
				}
			}
			# Second option
			random_list = {
				# Castan VII The Preserver
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_preserver }
					}
					set_country_flag = castan_oath_option_preserver
				}
				# Castan IX Peacemaker
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_peacemaker }
					}
					set_country_flag = castan_oath_option_peacemaker
				}
				# Castan X the Righteous
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_righteous }
					}
					set_country_flag = castan_oath_option_righteous
				}
				# Castan XI the Old
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_old }
					}
					set_country_flag = castan_oath_option_old
				}
				# Castan XII the Pious
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_pious }
					}
					set_country_flag = castan_oath_option_pious
				}
				# Castan XX the Youthful
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_youthful }
					}
					set_country_flag = castan_oath_option_youthful
				}
				# Castan XXI the Compassionate
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_compassionate }
					}
					set_country_flag = castan_oath_option_compassionate
				}
				# Castan XXVI the Unwavering
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_unwavering }
					}
					set_country_flag = castan_oath_option_unwavering
				}
				# Castan XXVII the Sickly
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_sickly }
					}
					set_country_flag = castan_oath_option_sickly
				}
				# Castan XLII the Cowardly
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_cowardly }
					}
					set_country_flag = castan_oath_option_cowardly
				}
			}
			# Third
			random_list = {
				# Castan VII The Preserver
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_preserver }
					}
					set_country_flag = castan_oath_option_preserver
				}
				# Castan IX Peacemaker
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_peacemaker }
					}
					set_country_flag = castan_oath_option_peacemaker
				}
				# Castan XI the Righteous
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_righteous }
					}
					set_country_flag = castan_oath_option_righteous
				}
				# Castan XI the Old
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_old }
					}
					set_country_flag = castan_oath_option_old
				}
				# Castan XII the Pious
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_pious }
					}
					set_country_flag = castan_oath_option_pious
				}
				# Castan XX the Youthful
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_youthful }
					}
					set_country_flag = castan_oath_option_youthful
				}
				# Castan XXI the Compassionate
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_compassionate }
					}
					set_country_flag = castan_oath_option_compassionate
				}
				# Castan XXVI the Unwavering
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_unwavering }
					}
					set_country_flag = castan_oath_option_unwavering
				}
				# Castan XXVII the Sickly
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_sickly }
					}
					set_country_flag = castan_oath_option_sickly
				}
				# Castan XLII the Cowardly
				1 = {
					trigger = {
						NOT = { has_country_flag = castan_oath_option_cowardly }
					}
					set_country_flag = castan_oath_option_cowardly
				}
			}
		}
	}

	option = {
		name = castanortrials.205.a
		trigger = {
			has_country_flag = castan_oath_option_preserver
		}
		custom_tooltip = castanortrials_oathstone_modifier_reward_tt
		tooltip = {
			add_country_modifier = {
				name = castan_oath_preserver
				duration = -1
			}
		}
		if = {
			limit = { has_reform = original_castanor_trials_reform }
			random_list = {
				# Succeed
				2 = {
					modifier = {
						factor = 2
						OR = {
							has_country_flag = castanor_trials_candidate_peasant_chosen
							has_country_flag = castanor_trials_candidate_noble_chosen
							has_country_flag = castanor_trials_candidate_general_chosen
						}
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_preserver_succeeded
				}
				# Fail
				1 = {
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
		else = {
			random_list = {
				# Succeed
				2 = {
					modifier = {
						factor = 2
						ruler_has_personality = inspiring_leader_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = just_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = righteous_personality
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_preserver_succeeded
				}
				# Fail
				1 = {
					modifier = {
						factor = 2
						ruler_has_personality = craven_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = malevolent_personality
					}
					modifier = {
						factor = 0
						has_country_flag = first_time_trying_trials
					}
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
	}
	option = {
		name = castanortrials.205.b
		trigger = {
			has_country_flag = castan_oath_option_peacemaker
		}
		custom_tooltip = castanortrials_oathstone_peacemaker_reward_tt
		if = {
			limit = { has_reform = original_castanor_trials_reform }
			random_list = {
				# Succeed
				5 = {
					modifier = {
						factor = 2
						OR = {
							has_country_flag = castanor_trials_candidate_dignitary_chosen
							has_country_flag = castanor_trials_candidate_priest_chosen
							has_country_flag = castanor_trials_candidate_merchant
						}
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_peacemaker_succeeded
				}
				# Fail
				1 = {
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
		else = {
			random_list = {
				# Succeed
				5 = {
					modifier = {
						factor = 2
						ruler_has_personality = kind_hearted_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = benevolent_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = careful_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = tolerant_personality
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_peacemaker_succeeded
				}
				# Fail
				1 = {
					modifier = {
						factor = 2
						ruler_has_personality = babbling_buffoon_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = cruel_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = malevolent_personality
					}
					modifier = {
						factor = 0
						has_country_flag = first_time_trying_trials
					}
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
	}
	option = {
		name = castanortrials.205.c
		trigger = {
			has_country_flag = castan_oath_option_righteous
		}
		custom_tooltip = castanortrials_oathstone_modifier_reward_tt
		tooltip = {
			add_country_modifier = {
				name = castan_oath_righteous
				duration = -1
			}
		}
		if = {
			limit = { has_reform = original_castanor_trials_reform }
			random_list = {
				# Succeed
				1 = {
					modifier = {
						factor = 2
						OR = {
							has_country_flag = castanor_trials_candidate_peasant_chosen
							has_country_flag = castanor_trials_candidate_priest_chosen
							has_country_flag = castanor_trials_candidate_general_chosen
						}
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_righteous_succeeded
				}
				# Fail
				1 = {
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
		else = {
			random_list = {
				# Succeed
				1 = {
					modifier = {
						factor = 2
						ruler_has_personality = lawgiver_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = righteous_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = just_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = incorruptible_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = zealot_personality
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_righteous_succeeded
				}
				# Fail
				1 = {
					modifier = {
						factor = 2
						ruler_has_personality = intricate_web_weaver_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = greedy_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = drunkard_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = sinner_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = embezzler_personality
					}
					modifier = {
						factor = 0
						has_country_flag = first_time_trying_trials
					}
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
	}
	option = {
		name = castanortrials.205.d
		trigger = {
			has_country_flag = castan_oath_option_old
		}
		custom_tooltip = castanortrials_oathstone_old_reward_tt
		if = {
			limit = { has_reform = original_castanor_trials_reform }
			random_list = {
				# Succeed
				2 = {
					modifier = {
						factor = 2
						OR = {
							has_country_flag = castanor_trials_candidate_adventurer_chosen
							has_country_flag = castanor_trials_candidate_mage_chosen
							has_country_flag = castanor_trials_candidate_general_chosen
						}
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_old_succeeded
				}
				# Fail
				1 = {
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
		else = {
			random_list = {
				# Succeed
				2 = {
					modifier = {
						factor = 2
						ruler_has_personality = inspiring_leader_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = bold_fighter_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = zealot_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = righteous_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = calm_personality
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_old_succeeded
				}
				# Fail
				1 = {
					modifier = {
						factor = 2
						ruler_has_personality = craven_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = naive_personality
					}
					modifier = {
						factor = 0
						has_country_flag = first_time_trying_trials
					}
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
	}
	option = {
		name = castanortrials.205.e
		trigger = {
			has_country_flag = castan_oath_option_pious
		}
		custom_tooltip = castanortrials_oathstone_pious_reward_tt
		if = {
			limit = { has_reform = original_castanor_trials_reform }
			random_list = {
				# Succeed
				4 = {
					modifier = {
						factor = 2
						OR = {
							has_country_flag = castanor_trials_candidate_priest_chosen
							has_country_flag = castanor_trials_candidate_peasant_chosen
						}
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_pious_succeeded
				}
				# Fail
				1 = {
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
		else = {
			random_list = {
				# Succeed
				4 = {
					modifier = {
						factor = 2
						ruler_has_personality = zealot_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = pious_personality
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_pious_succeeded
				}
				# Fail
				1 = {
					modifier = {
						factor = 2
						ruler_has_personality = sinner_personality
					}
					modifier = {
						factor = 0
						has_country_flag = first_time_trying_trials
					}
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
	}
	option = {
		name = castanortrials.205.f
		trigger = {
			has_country_flag = castan_oath_option_youthful
		}
		custom_tooltip = castanortrials_oathstone_modifier_reward_tt
		tooltip = {
			add_country_modifier = {
				name = castan_oath_youthful
				duration = -1
			}
		}
		if = {
			limit = { has_reform = original_castanor_trials_reform }
			random_list = {
				# Succeed
				5 = {
					modifier = {
						factor = 2
						OR = {
							has_country_flag = castanor_trials_candidate_merchant_chosen
							has_country_flag = castanor_trials_candidate_peasant_chosen
							has_country_flag = castanor_trials_candidate_patrician_chosen
						}
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_youthful_succeeded
				}
				# Fail
				1 = {
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
		else = {
			random_list = {
				# Succeed
				5 = {
					modifier = {
						factor = 2
						ruler_has_personality = well_advised_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = well_connected_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = naive_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = babbling_buffoon_personality
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_youthful_succeeded
				}
				# Fail
				1 = {
					modifier = {
						factor = 0
						has_country_flag = first_time_trying_trials
					}
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
	}
	option = {
		name = castanortrials.205.g
		trigger = {
			has_country_flag = castan_oath_option_compassionate
		}
		custom_tooltip = castanortrials_oathstone_modifier_reward_tt
		tooltip = {
			add_country_modifier = {
				name = castan_oath_compassionate
				duration = -1
			}
		}
		if = {
			limit = { has_reform = original_castanor_trials_reform }
			random_list = {
				# Succeed
				3 = {
					modifier = {
						factor = 2
						OR = {
							has_country_flag = castanor_trials_candidate_adventurer_chosen
							has_country_flag = castanor_trials_candidate_peasant_chosen
							has_country_flag = castanor_trials_candidate_priest_chosen
						}
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_compassionate_succeeded
				}
				# Fail
				1 = {
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
		else = {
			random_list = {
				# Succeed
				3 = {
					modifier = {
						factor = 2
						ruler_has_personality = kind_hearted_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = tolerant_personality
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_compassionate_succeeded
				}
				# Fail
				1 = {
					modifier = {
						factor = 2
						ruler_has_personality = malevolent_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = cruel_personality
					}
					modifier = {
						factor = 0
						has_country_flag = first_time_trying_trials
					}
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
	}
	option = {
		name = castanortrials.205.h
		trigger = {
			has_country_flag = castan_oath_option_unwavering
		}
		custom_tooltip = castanortrials_oathstone_modifier_reward_tt
		tooltip = {
			add_country_modifier = {
				name = castan_oath_unwavering
				duration = -1
			}
		}
		custom_tooltip = castanortrials_oathstone_unwavering_reward_tt
		if = {
			limit = { has_reform = original_castanor_trials_reform }
			random_list = {
				# Succeed
				1 = {
					modifier = {
						factor = 2
						OR = {
							has_country_flag = castanor_trials_candidate_academic_chosen
							has_country_flag = castanor_trials_candidate_mage_chosen
							has_country_flag = castanor_trials_candidate_noble_chosen
							has_country_flag = castanor_trials_candidate_merchant_chosen
						}
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_unwavering_succeeded
				}
				# Fail
				1 = {
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
		else = {
			random_list = {
				# Succeed
				4 = {
					modifier = {
						factor = 2
						ruler_has_personality = bold_fighter_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = obsessive_perfectionist_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = industrious_personality
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_unwavering_succeeded
				}
				# Fail
				1 = {
					modifier = {
						factor = 2
						ruler_has_personality = craven_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = careful_personality
					}
					modifier = {
						factor = 0
						has_country_flag = first_time_trying_trials
					}
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
	}
	option = {
		name = castanortrials.205.i
		trigger = {
			has_country_flag = castan_oath_option_sickly
		}
		custom_tooltip = castanortrials_oathstone_modifier_reward_tt
		tooltip = {
			add_country_modifier = {
				name = castan_oath_sickly
				duration = -1
			}
		}
		if = {
			limit = { has_reform = original_castanor_trials_reform }
			random_list = {
				# Succeed
				1 = {
					modifier = {
						factor = 2
						OR = {
							has_country_flag = castanor_trials_candidate_peasant_chosen
							has_country_flag = castanor_trials_candidate_mage_chosen
							has_country_flag = castanor_trials_candidate_merchant_chosen
						}
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_sickly_succeeded
				}
				# Fail
				2 = {
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
		else = {
			random_list = {
				# Succeed
				1 = {
					modifier = {
						factor = 2
						ruler_has_personality = scholar_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = strict_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = industrious_personality
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_sickly_succeeded
				}
				# Fail
				2 = {
					modifier = {
						factor = 2
						ruler_has_personality = drunkard_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = embezzler_personality
					}
					modifier = {
						factor = 0
						has_country_flag = first_time_trying_trials
					}
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
	}
	option = {
		name = castanortrials.205.j
		trigger = {
			has_country_flag = castan_oath_option_cowardly
		}
		custom_tooltip = castanortrials_oathstone_modifier_reward_tt
		tooltip = {
			add_country_modifier = {
				name = castan_oath_cowardly
				duration = -1
			}
		}

		if = {
			limit = { has_reform = original_castanor_trials_reform }
			random_list = {
				# Succeed
				3 = {
					modifier = {
						factor = 2
						OR = {
							has_country_flag = castanor_trials_candidate_academic_chosen
							has_country_flag = castanor_trials_candidate_dignitary_chosen
							has_country_flag = castanor_trials_candidate_merchant_chosen
						}
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_cowardly_succeeded
				}
				# Fail
				1 = {
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
		else = {
			random_list = {
				# Succeed
				3 = {
					modifier = {
						factor = 2
						ruler_has_personality = scholar_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = careful_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = architectural_visionary_personality
					}
					custom_tooltip = oathstone_trial_success_tt
					set_country_flag = castan_oath_cowardly_succeeded
				}
				# Fail
				1 = {
					modifier = {
						factor = 2
						ruler_has_personality = conqueror_personality
					}
					modifier = {
						factor = 2
						ruler_has_personality = greedy_personality
					}
					modifier = {
						factor = 0
						has_country_flag = first_time_trying_trials
					}
					custom_tooltip = oathstone_trial_fail_tt
					set_country_flag = oath_trial_failed
				}
			}
		}
	}

	after = {
		if = {
			limit = { has_country_flag = oath_trial_failed }
			castanor_trials_fail_effect = yes
		}
		else = {
			country_event = {
				id = castanortrials.206
			}
		}
	}
}

# Oathstone success
country_event = {
	id =  castanortrials.206
	title = castanortrials.206.t
	desc = castanortrials.206.desc
	picture = KING_SICK_IN_BED_eventPicture

	is_triggered_only = yes

	option = {
		name = castanortrials.206.a
		country_event = {
			id = castanortrials.102
		}
	}
}

# Medium Events #
# Trial of Castan IV Realmbuilder - pick material/gem
country_event = {
	id = castanortrials.300
	title = castanortrials.300.t
	desc = castanortrials.300.desc
	picture = LUKASA_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = { set_variable = { trialPoints = 0 } }
	}

	# Best option
	option = {
		name = castanortrials.300.a
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 3 } }
				1 = { change_variable = { trialPoints = 4 } }
			}
			set_country_flag = castanortrials_gem_picked
		}
		add_treasury = -200
	}
	# Meh option
	option = {
		name = castanortrials.300.b
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 1 } }
				1 = { change_variable = { trialPoints = 2 } }
				1 = { change_variable = { trialPoints = 3 } }
			}
			set_country_flag = castanortrials_mithril_picked
		}
		add_treasury = -50
	}
	# Bad option
	option = {
		name = castanortrials.300.c
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 0 } }
				1 = { change_variable = { trialPoints = 1 } }
			}
			set_country_flag = castanortrials_rock_picked
		}
	}
	after = {
		log = "Points after first event: [Root.trialPoints.GetValue]"
		country_event = {
			id = castanortrials.301
		}
	}
}
# Trial of Castan IV Realmbuilder - pick your enchantment
country_event = {
	id = castanortrials.301
	title = castanortrials.301.t
	desc = castanortrials.301.desc
	picture = LUKASA_eventPicture

	is_triggered_only = yes

	# Bad option
	option = {
		name = castanortrials.301.a
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 0 } }
				1 = { change_variable = { trialPoints = 1 } }
			}
		}
	}
	# Best option
	option = {
		name = castanortrials.301.b
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 3 } }
				1 = { change_variable = { trialPoints = 4 } }
			}
		}
	}
	# Meh option
	option = {
		name = castanortrials.301.c
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 1 } }
				1 = { change_variable = { trialPoints = 2 } }
				1 = { change_variable = { trialPoints = 3 } }
			}
		}
	}
	after = {
		log = "Points after second event: [Root.trialPoints.GetValue]"
		country_event = {
			id = castanortrials.302
		}
	}
}
# Trial of Castan IV Realmbuilder - where to place the dang thing 
country_event = {
	id = castanortrials.302
	title = castanortrials.302.t
	desc = castanortrials.302.desc
	picture = LUKASA_eventPicture

	is_triggered_only = yes

	# Periphery
	option = {
		name = castanortrials.302.a
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 1 } }
				1 = { change_variable = { trialPoints = 2 } }
				1 = { change_variable = { trialPoints = 3 } }
			}
		}
	}
	# Foundations
	option = {
		name = castanortrials.302.b
		hidden_effect = {
			if = { limit = { has_country_flag = castanortrials_rock_picked }
				random_list = {
					1 = { change_variable = { trialPoints = 3 } }
					1 = { change_variable = { trialPoints = 4 } }
				}
			}
			else = {
				random_list = {
					1 = { change_variable = { trialPoints = 1 } }
					1 = { change_variable = { trialPoints = 2 } }
					1 = { change_variable = { trialPoints = 3 } }
				}
			}
		}
	}
	# Atop
	option = {
		name = castanortrials.302.c
		hidden_effect = {
			if = { limit = { has_country_flag = castanortrials_rock_picked }
				random_list = {
					1 = { change_variable = { trialPoints = 0 } }
					1 = { change_variable = { trialPoints = 1 } }
				}
			}
			else = {
				random_list = {
					1 = { change_variable = { trialPoints = 1 } }
					1 = { change_variable = { trialPoints = 2 } }
					1 = { change_variable = { trialPoints = 3 } }
				}
			}
		}
	}
	after = {
		log = "Points after third event: [Root.trialPoints.GetValue]"
		if = {
			limit = {
				OR = {
					check_variable = { trialPoints = 7 }
					has_country_flag = first_time_trying_trials
				}
			}
			country_event = {
				id = castanortrials.303 # Success
			}
		}
		else = {
			castanor_trials_fail_effect = yes
			set_country_flag = realmbuilder_trial_failed
		}
		clr_country_flag = castanortrials_rock_picked
		clr_country_flag = castanortrials_gem_picked
		clr_country_flag = castanortrials_mithril_picked
	}
}
# Trial of Castan IV Realmbuilder - Success
country_event = {
	id = castanortrials.303
	title = castanortrials.303.t
	desc = castanortrials.303.desc
	picture = GOOD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Nice
	option = {
		name = castanortrials.303.a
		country_event = {
			id = castanortrials.103
		}
	}
}

# Trial of Castan XIV the Conciliator - make peace between two feuding forest spirits
# 
country_event = {
	id = castanortrials.305
	title = castanortrials.305.t
	desc = castanortrials.305.desc
	picture = ACCUSATION_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = { set_variable = { trialPoints = 0 } }
	}

	# Bad option
	option = {
		name = castanortrials.305.a
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 0 } }
				1 = { change_variable = { trialPoints = 1 } }
			}
		}
	}
	# Meh option
	option = {
		name = castanortrials.305.b
		trigger = {
			if = {
				limit = { has_reform = original_castanor_trials_reform }
				OR = {
					has_country_flag = castanor_trials_candidate_dignitary_chosen
					has_country_flag = castanor_trials_candidate_noble_chosen
					has_country_flag = castanor_trials_candidate_merchant_chosen
					has_country_flag = castanor_trials_candidate_patrician
				}
			}
			else = {
				OR = {
					dip = 3
					ruler_has_personality = charismatic_negotiator_personality
					ruler_has_personality = silver_tongue_personality
				}
			}
		}

		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 1 } }
				1 = { change_variable = { trialPoints = 2 } }
				1 = { change_variable = { trialPoints = 3 } }
			}
		}
	}
	# Best option
	option = {
		name = castanortrials.305.c
		trigger = {
			if = {
				limit = { has_reform = original_castanor_trials_reform }
				has_country_flag = castanor_trials_candidate_dignitary_chosen
			}
			else = {
				OR = {
					dip = 5
					ruler_has_personality = charismatic_negotiator_personality
					ruler_has_personality = silver_tongue_personality
				}
			}
		}
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 3 } }
				1 = { change_variable = { trialPoints = 4 } }
			}
		}
	}
	after = {
		country_event = {
			id = castanortrials.306
		}
	}
}
# 
country_event = {
	id = castanortrials.306
	title = castanortrials.306.t
	desc = castanortrials.306.desc
	picture = ACCUSATION_eventPicture

	is_triggered_only = yes

	# Meh option
	option = {
		name = castanortrials.306.a
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 1 } }
				1 = { change_variable = { trialPoints = 2 } }
				1 = { change_variable = { trialPoints = 3 } }
			}
		}
	}
	# Best option
	option = {
		name = castanortrials.306.b
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 3 } }
				1 = { change_variable = { trialPoints = 4 } }
			}
		}
	}
	# Bad option
	option = {
		name = castanortrials.306.c
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 0 } }
				1 = { change_variable = { trialPoints = 1 } }
			}
		}
	}
	after = {
		country_event = {
			id = castanortrials.307
		}
	}
}
# 
country_event = {
	id = castanortrials.307
	title = castanortrials.307.t
	desc = castanortrials.307.desc
	picture = ACCUSATION_eventPicture

	is_triggered_only = yes

	# Meh option
	option = {
		name = castanortrials.307.a
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 1 } }
				1 = { change_variable = { trialPoints = 2 } }
				1 = { change_variable = { trialPoints = 3 } }
			}
		}
	}
	# Bad option
	option = {
		name = castanortrials.307.b
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 0 } }
				1 = { change_variable = { trialPoints = 1 } }
			}
		}
	}
	# Best option
	option = {
		name = castanortrials.307.c
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 3 } }
				1 = { change_variable = { trialPoints = 4 } }
			}
		}
	}
	after = {
		if = {
			limit = { check_variable = { trialPoints = 6 } }
			country_event = {
				id = castanortrials.308 # Success
			}
		}
		else = {
			country_event = {
				id = castanortrials.309 # Fail
			}
		}
	}
}
# - Success
country_event = {
	id = castanortrials.308
	title = castanortrials.308.t
	desc = castanortrials.308.desc
	picture = GOOD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Nice
	option = {
		name = castanortrials.308.a
		country_event = {
			id = castanortrials.103
		}
	}
}
#  - Fail (you die lol)
country_event = {
	id = castanortrials.309
	title = castanortrials.309.t
	desc = castanortrials.309.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Dang
	option = {
		name = castanortrials.309.a
		castanor_trials_die_effect = yes
	}
}

# Trial of Castan XXXVI Dragonfriend - Befriend a young, silver wyvern
# You're walking along a cliff when a curious wyvern approaches you - what do?
country_event = {
	id = castanortrials.310
	title = castanortrials.310.t
	desc = castanortrials.310.desc
	picture = ACCUSATION_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = { set_variable = { trialPoints = 0 } }
	}

	# Best option - Clear out a comfortable spot for it to land
	option = {
		name = castanortrials.310.a
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 3 } }
				1 = { change_variable = { trialPoints = 4 } }
			}
		}
	}
	# Bad option - shoo!
	option = {
		name = castanortrials.310.b
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 0 } }
				1 = { change_variable = { trialPoints = 1 } }
			}
		}
	}
	# Meh option - appear as non-threatening as possible and let it approach you
	option = {
		name = castanortrials.310.c
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 1 } }
				1 = { change_variable = { trialPoints = 2 } }
				1 = { change_variable = { trialPoints = 3 } }
			}
		}
	}
	after = {
		country_event = {
			id = castanortrials.311
		}
	}
}
# Share some food from your pack
country_event = {
	id = castanortrials.311
	title = castanortrials.311.t
	desc = castanortrials.311.desc
	picture = ACCUSATION_eventPicture

	is_triggered_only = yes

	# Bad option - No! You can't have anything!
	option = {
		name = castanortrials.311.a
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 0 } }
				1 = { change_variable = { trialPoints = 1 } }
			}
		}
		random = {
			chance = 50
			if = {
				limit = { NOT = { has_reform = original_castanor_trials_reform } }
				add_ruler_personality = bold_fighter_personality
			}
			else = {
				add_prestige = 5
			}
		}
	}
	# Meh option - you want my lunch?
	option = {
		name = castanortrials.311.b
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 1 } }
				1 = { change_variable = { trialPoints = 2 } }
				1 = { change_variable = { trialPoints = 3 } }
			}
		}
	}
	# Best option - I happened to bring some foreign treats...
	option = {
		name = castanortrials.311.c
		trigger = {
			if = {
				limit = { has_reform = original_castanor_trials_reform }
				OR = {
					has_country_flag = castanor_trials_candidate_merchant_chosen
					has_country_flag = castanor_trials_candidate_dignitary_chosen	
				}
			}
			else = {
				always = yes
			}
		}
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 3 } }
				1 = { change_variable = { trialPoints = 4 } }
			}
		}
		if = {
			limit = { NOT = { has_reform = original_castanor_trials_reform } }
			add_treasury = -100
		}
	}
	
	after = {
		country_event = {
			id = castanortrials.312
		}
	}
}
# Communicate with the wyvern
country_event = {
	id = castanortrials.312
	title = castanortrials.312.t
	desc = castanortrials.312.desc
	picture = ACCUSATION_eventPicture

	is_triggered_only = yes

	# Bold option
	option = {
		name = castanortrials.312.a
		hidden_effect = {
			if = {
				limit = {
					has_reform = original_castanor_trials_reform
					OR = {
						has_country_flag = castanor_trials_candidate_adventurer_chosen
						# Maybe the wyvern senses the patrician has original Castanite blood or something
						has_country_flag = castanor_trials_candidate_patrician_chosen
					}
				}
				random_list = {
					1 = { change_variable = { trialPoints = 3 } }
					1 = { change_variable = { trialPoints = 4 } }
				}
			}
			else_if = {
				limit = {
					OR = {
						ruler_has_personality = bold_fighter_personality
						mil = 5
					}
				}
				random_list = {
					1 = { change_variable = { trialPoints = 2 } }
					1 = { change_variable = { trialPoints = 3 } }
				}
			}
			else = {
				random_list = {
					1 = { change_variable = { trialPoints = 0 } }
					1 = { change_variable = { trialPoints = 1 } }
				}
			}
		}
	}
	# Hand motion option
	option = {
		name = castanortrials.312.b
		hidden_effect = {
			if = {
				limit = { dip = 5 }
				random_list = {
					1 = { change_variable = { trialPoints = 2 } }
					1 = { change_variable = { trialPoints = 3 } }
				}
			}
			else_if = {
				limit = { dip = 4 }
				random_list = {
					1 = { change_variable = { trialPoints = 1 } }
					1 = { change_variable = { trialPoints = 2 } }
					1 = { change_variable = { trialPoints = 3 } }
				}
			}
			else = {
				random_list = {
					1 = { change_variable = { trialPoints = 0 } }
					1 = { change_variable = { trialPoints = 1 } }
				}
			}
		}
	}
	# Magic option
	option = {
		name = castanortrials.312.c
		trigger = {
			if = {
				limit = { has_reform = original_castanor_trials_reform }
				OR = {
					has_country_flag = castanor_trials_candidate_mage_chosen
					has_country_flag = castanor_trials_candidate_priest_chosen
					has_country_flag = castanor_trials_candidate_patrician
				}
			}
			else = {
				OR = {
					ruler_has_mage_personality = yes
					has_reform = magocracy_reform
				}
			}
		}
		hidden_effect = {
			random_list = {
				1 = { change_variable = { trialPoints = 3 } }
				1 = { change_variable = { trialPoints = 4 } }
			}
		}
	}
	after = {
		if = {
			limit = {
				OR = {
					has_country_flag = first_time_trying_trials
					check_variable = { trialPoints = 6 }
				}
			}
			country_event = {
				id = castanortrials.313 # Success
			}
		}
		else = {
			set_country_flag = dragonfriend_trial_died
			castanor_trials_die_effect = yes
		}
	}
}
# Dragonfriend trial - Success
country_event = {
	id = castanortrials.313
	title = castanortrials.313.t
	desc = castanortrials.313.desc
	picture = GOOD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Nice
	option = {
		name = castanortrials.313.a
		country_event = {
			id = castanortrials.103
		}
	}
}

# Jump around a rock 10 times
country_event = {
	id = castanortrials.315
	title = castanortrials.315.t
	desc = castanortrials.315.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	immediate = {
		if = {
			limit = { NOT = { has_country_flag = jump_trial_in_progress } }
			set_country_flag = jump_trial_in_progress
			set_variable = {
				which = jumpsMade
				value = 0
			}
		}
	}

	# Jump
	option = {
		name = castanortrials.315.a
		hidden_effect = {
			if = {
				limit = { check_variable = { which = jumpsMade value = 8 } }
				country_event = {
					id = castanortrials.316
				}
			}
			else = {
				random_list = {
					8 = {
						country_event = {
							id = castanortrials.319
						}
					}
					1 = {
						country_event = {
							id = castanortrials.316
						}
					}
				}
			}
			change_variable = {
				which = jumpsMade
				value = 1
			}
		}
	}

	# Don't jump
	option = {
		name = castanortrials.315.b
		hidden_effect = {
			set_country_flag = jump_trial_failed
			castanor_trials_fail_effect = yes
		}
	}
}
# Curveball
country_event = {
	id = castanortrials.316
	title = castanortrials.315.t
	desc = castanortrials.315.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Don't Jump
	option = {
		name = castanortrials.316.b
		hidden_effect = {
			set_country_flag = jump_trial_failed
			castanor_trials_fail_effect = yes
		}
	}

	# Jump
	option = {
		name = castanortrials.315.a
		hidden_effect = {
			if = {
				limit = { check_variable = { which = jumpsMade value = 8 } }
				hidden_effect = {
					country_event = {
						id = castanortrials.317
					}
				}
			}
			else = {
				random_list = {
					8 = {
						country_event = {
							id = castanortrials.315
						}
					}
					1 = {
						country_event = {
							id = castanortrials.320
						}
					}
				}
			}
			change_variable = {
				which = jumpsMade
				value = 1
			}
		}
	}
}
country_event = {
	id = castanortrials.319
	title = castanortrials.315.t
	desc = castanortrials.315.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	immediate = {
		if = {
			limit = { NOT = { has_country_flag = jump_trial_in_progress } }
			set_country_flag = jump_trial_in_progress
			set_variable = {
				which = jumpsMade
				value = 0
			}
		}
	}

	# Jump
	option = {
		name = castanortrials.315.a
		hidden_effect = {
			if = {
				limit = { check_variable = { which = jumpsMade value = 8 } }
				country_event = {
					id = castanortrials.316
				}
			}
			else = {
				random_list = {
					8 = {
						country_event = {
							id = castanortrials.315
						}
					}
					1 = {
						country_event = {
							id = castanortrials.316
						}
					}
				}
			}
			change_variable = {
				which = jumpsMade
				value = 1
			}
		}
	}

	# Don't jump
	option = {
		name = castanortrials.315.b
		hidden_effect = {
			set_country_flag = jump_trial_failed
			castanor_trials_fail_effect = yes
		}
	}
}
# Curveball
country_event = {
	id = castanortrials.320
	title = castanortrials.315.t
	desc = castanortrials.315.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Don't Jump
	option = {
		name = castanortrials.316.b
		hidden_effect = {
			set_country_flag = jump_trial_failed
			castanor_trials_fail_effect = yes
		}
	}

	# Jump
	option = {
		name = castanortrials.315.a
		hidden_effect = {
			if = {
				limit = { check_variable = { which = jumpsMade value = 8 } }
				hidden_effect = {
					country_event = {
						id = castanortrials.317
					}
				}
			}
			else = {
				random_list = {
					8 = {
						country_event = {
							id = castanortrials.315
						}
					}
					1 = {
						country_event = {
							id = castanortrials.316
						}
					}
				}
			}
			change_variable = {
				which = jumpsMade
				value = 1
			}
		}
	}
}

# Jump success
country_event = {
	id = castanortrials.317
	title = castanortrials.317.t
	desc = castanortrials.317.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	option = {
		name = castanortrials.317.a
		country_event = {
			id = castanortrials.103
		}
	}
}

# Long af Trials #
# Giantsbane trial
country_event = {
	id = castanortrials.400
	title = castanortrials.400.t
	desc = castanortrials.400.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			# Randomizes how strong the golem is this time 'round
			random_list = {
				1 = {
					set_variable = {
						which = golemPower
						value = 10
					}
				}
				1 = {
					set_variable = {
						which = golemPower
						value = 9
					}
				}
				1 = {
					set_variable = {
						which = golemPower
						value = 8
					}
				}
				1 = {
					set_variable = {
						which = golemPower
						value = 7
					}
				}
				1 = {
					set_variable = {
						which = golemPower
						value = 6
					}
				}
				1 = {
					set_variable = {
						which = golemPower
						value = 5
					}
				}
			}
			set_variable = {
				which = aspirantPower
				value = 0
			}
			if = {
				limit = { has_country_flag = first_time_trying_trials }
				set_variable = {
					which = aspirantPower
					value = 100
				}
			}
			if = {
				limit = { NOT = { has_reform = original_castanor_trials_reform } }
				if = {
					limit = { mil = 6 }
					change_variable = {
						which = aspirantPower
						value = 10
					}
				}
				else_if = {
					limit = { mil = 5 }
					change_variable = {
						which = aspirantPower
						value = 8
					}
				}
				else_if = {
					limit = { mil = 4 }
					change_variable = {
						which = aspirantPower
						value = 6
					}
				}
				else_if = {
					limit = { mil = 2 }
					subtract_variable = {
						which = aspirantPower
						value = 2
					}
				}
				else_if = {
					limit = { mil = 1 }
					subtract_variable = {
						which = aspirantPower
						value = 3
					}
				}
				else_if = {
					limit = { mil = 0 }
					subtract_variable = {
						which = aspirantPower
						value = 4
					}
				}
				if = {
					limit = { ruler_has_personality = bold_fighter_personality }
					change_variable = {
						which = aspirantPower
						value = 4
					}
				}
				if = {
					limit = { ruler_has_mage_personality = yes }
					change_variable = {
						which = aspirantPower
						value = 4
					}
				}
				if = {
					limit = { has_reform = magocracy_reform }
					change_variable = {
						which = aspirantPower
						value = 3
					}
				}
				if = {
					limit = { ruler_age = 60 }
					subtract_variable = {
						which = aspirantPower
						value = 3
					}
				}
				else_if = {
					limit = { ruler_age = 50 }
					subtract_variable = {
						which = aspirantPower
						value = 2
					}
				}
				else_if = {
					limit = { ruler_age = 40 }
					subtract_variable = {
						which = aspirantPower
						value = 1
					}
				}
			}
			if = {
				limit = { has_reform = original_castanor_trials_reform }
				if = {
					limit = { has_country_flag = castanor_trials_candidate_adventurer_chosen }
					change_variable = {
						which = aspirantPower
						value = 10
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_noble_chosen }
					change_variable = {
						which = aspirantPower
						value = 6
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_general_chosen }
					change_variable = {
						which = aspirantPower
						value = 8
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_academic_chosen }
					subtract_variable = {
						which = aspirantPower
						value = 4
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_peasant_chosen }
					subtract_variable = {
						which = aspirantPower
						value = 2
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_priest }
					subtract_variable = {
						which = aspirantPower
						value = 3
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_mage_chosen }
					change_variable = {
						which = aspirantPower
						value = 4
					}
				}
			}
		}
	}

	# Scout out the area first
	option	= {
		name = castanortrials.400.a
		country_event = {
			id = castanortrials.401
		}
	}
	# Just attack him head on yo
	option	= {
		name = castanortrials.400.b
		country_event = {
			id = castanortrials.406
		}
	}
}
# Giantsbane trial - Scout out the area
country_event = {
	id = castanortrials.401
	title = castanortrials.401.t
	desc = castanortrials.401.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Look around for resources
	option	= {
		name = castanortrials.401.a
		country_event = {
			id = castanortrials.402
		}
	}
	# Sneak attack!
	option	= {
		name = castanortrials.401.b
		hidden_effect = {
			# Innate - golem is slow + old so sneak attacks are easy to pull off
			change_variable = {
				which = aspirantPower
				value = 1
			}
			if = {
				limit = { NOT = { has_reform = original_castanor_trials_reform } }
				if = {
					limit = { ruler_has_personality = secretive_personality }
					change_variable = {
						which = aspirantPower
						value = 6
					}
				}
				if = {
					limit = { ruler_has_personality = intricate_web_weaver_personality }
					change_variable = {
						which = aspirantPower
						value = 5
					}
				}
				if = {
					limit = { ruler_has_personality = calm_personality }
					change_variable = {
						which = aspirantPower
						value = 4
					}
				}
			}
			else_if = {
				limit = { has_reform = original_castanor_trials_reform }
				if = {
					limit = { has_country_flag = castanor_trials_candidate_adventurer_chosen }
					change_variable = {
						which = aspirantPower
						value = 4
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_merchant_chosen }
					change_variable = {
						which = aspirantPower
						value = 3
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_patrician_chosen }
					change_variable = {
						which = aspirantPower
						value = 2
					}
				}
			}
		}
		country_event = { id = castanortrials.405 }
	}
}
# Giantsbane trial - Look around
country_event = {
	id = castanortrials.402
	title = castanortrials.402.t
	desc = castanortrials.402.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Fashion a makeshift weapon
	option	= {
		name = castanortrials.402.a
		country_event = {
			id = castanortrials.403
		}
		hidden_effect = {
			if = {
				limit = { NOT = { has_reform = original_castanor_trials_reform } }
				if = {
					limit = { ruler_has_personality = martial_educator_personality }
					change_variable = {
						which = aspirantPower
						value = 4
					}
				}
				if = {
					limit = { ruler_has_personality = entrepreneur_personality }
					change_variable = {
						which = aspirantPower
						value = 3
					}
				}
				if = {
					limit = { ruler_has_personality = free_thinker_personality }
					change_variable = {
						which = aspirantPower
						value = 2
					}
				}
			}
			else_if = {
				limit = { has_reform = original_castanor_trials_reform }
				if = {
					limit = { has_country_flag = castanor_trials_candidate_noble_chosen }
					change_variable = {
						which = aspirantPower
						value = 4
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_peasant_chosen }
					change_variable = {
						which = aspirantPower
						value = 3
					}
				}
			}
		}
	}
	# Set up some traps
	option	= {
		name = castanortrials.402.b
		country_event = {
			id = castanortrials.404
		}
		hidden_effect = {
			# Innate - golem is slow + old so traps are easy to lead him into
			change_variable = {
				which = aspirantPower
				value = 1
			}
			if = {
				limit = { NOT = { has_reform = original_castanor_trials_reform } }
				if = {
					limit = { ruler_has_personality = careful_personality }
					change_variable = {
						which = aspirantPower
						value = 6
					}
				}
				if = {
					limit = { ruler_has_personality = intricate_web_weaver_personality }
					change_variable = {
						which = aspirantPower
						value = 5
					}
				}
				if = {
					limit = { ruler_has_personality = entrepreneur_personality }
					change_variable = {
						which = aspirantPower
						value = 4
					}
				}
			}
			else_if = {
				limit = { has_reform = original_castanor_trials_reform }
				if = {
					limit = { has_country_flag = castanor_trials_candidate_academic_chosen }
					change_variable = {
						which = aspirantPower
						value = 4
					}
				}
			}
		}
	}
}
# Giantsbane trial - Makeshift weapon
country_event = {
	id = castanortrials.403
	title = castanortrials.403.t
	desc = castanortrials.403.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Proceed
	option	= {
		name = castanortrials.403.a
		country_event = {
			id = castanortrials.406
		}
	}
}
# Giantsbane trial - Traps
country_event = {
	id = castanortrials.404
	title = castanortrials.404.t
	desc = castanortrials.404.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Proceed
	option	= {
		name = castanortrials.404.a
		country_event = {
			id = castanortrials.406
		}
	}
}
# Giantsbane trial - Sneak attack
country_event = {
	id = castanortrials.405
	title = castanortrials.405.t
	desc = castanortrials.405.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Proceed
	option	= {
		name = castanortrials.405.a
		country_event = {
			id = castanortrials.406
		}
	}
}
# Giantsbane trial - Combat
country_event = {
	id = castanortrials.406
	title = castanortrials.406.t
	desc = castanortrials.406.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Magical attack
	option	= {
		name = castanortrials.406.a
		hidden_effect = {
			if = {
				limit = {
					NOT = { has_reform = original_castanor_trials_reform }
					OR = {
						ruler_has_mage_personality = yes
						has_reform = magocracy_reform
					}
				}
				change_variable = {
					which = aspirantPower
					value = 3
				}
			}
			else_if = {
				limit = { NOT = { has_reform = original_castanor_trials_reform } }
				random_list = {
					5 = {
						change_variable = {
							which = aspirantPower
							value = 3
						}
					}
					10 = {
						change_variable = {
							which = aspirantPower
							value = 2
						}
					}
					20 = {
						change_variable = {
							which = aspirantPower
							value = 1
						}
					}
					65 = {
	
					}
				}
			}
			if = {
				limit = { has_reform = original_castanor_trials_reform }
				if = {
					limit = { has_country_flag = castanor_trials_candidate_mage_chosen }
					change_variable = {
						which = aspirantPower
						value = 5
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_priest_chosen }
					change_variable = {
						which = aspirantPower
						value = 3
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_patrician_chosen }
					change_variable = {
						which = aspirantPower
						value = 1
					}
				}
			}
		}
	}
	# Feint
	option	= {
		name = castanortrials.406.b
		hidden_effect = {
			if = {
				limit = { NOT = { has_reform = original_castanor_trials_reform } }
				trigger_switch = {
					on_trigger = mil
					6 = {
						change_variable = {
							which = aspirantPower
							value = 3
						}
					}
					5 = {
						change_variable = {
							which = aspirantPower
							value = 2
						}
					}
					4 = {
						change_variable = {
							which = aspirantPower
							value = 1
						}
					}
				}
				trigger_switch = {
					on_trigger = dip # Representing how convincing the dude is at performing the act
					6 = {
						change_variable = {
							which = aspirantPower
							value = 2
						}
					}
					5 = {
						change_variable = {
							which = aspirantPower
							value = 1
						}
					}
				}
				# Innate - golem is slow + old so feints are easy to pull off
				change_variable = {
					which = aspirantPower
					value = 1
				}
				if = { 
					limit = { ruler_has_personality = tactical_genius_personality }
					change_variable = {
						which = aspirantPower
						value = 2
					}
				}
			}
			else_if = {
				limit = { has_reform = original_castanor_trials_reform }
				if = {
					limit = { has_country_flag = castanor_trials_candidate_merchant_chosen }
					change_variable = {
						which = aspirantPower
						value = 1
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_adventurer_chosen }
					change_variable = {
						which = aspirantPower
						value = 2
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_general_chosen }
					change_variable = {
						which = aspirantPower
						value = 2
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_noble_chosen }
					change_variable = {
						which = aspirantPower
						value = 2
					}
				}
			}
		}
	}
	# Overpower with strength
	option	= {
		name = castanortrials.406.c
		hidden_effect = {
			if = {
				limit = { NOT = { has_reform = original_castanor_trials_reform } }
				trigger_switch = {
					on_trigger = mil
					6 = {
						change_variable = {
							which = aspirantPower
							value = 4
						}
					}
					5 = {
						change_variable = {
							which = aspirantPower
							value = 3
						}
					}
					4 = {
						change_variable = {
							which = aspirantPower
							value = 2
						}
					}
				}
				if = { 
					limit = { ruler_has_personality = bold_fighter_personality }
					change_variable = {
						which = aspirantPower
						value = 2
					}
				}
				if = { 
					limit = { ruler_has_personality = conqueror_personality }
					change_variable = {
						which = aspirantPower
						value = 2
					}
				}
			}
			else_if = {
				limit = { has_reform = original_castanor_trials_reform }
				if = {
					limit = { has_country_flag = castanor_trials_candidate_adventurer_chosen }
					change_variable = {
						which = aspirantPower
						value = 5
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_general_chosen }
					change_variable = {
						which = aspirantPower
						value = 4
					}
				}
				else_if = {
					limit = { has_country_flag = castanor_trials_candidate_noble_chosen }
					change_variable = {
						which = aspirantPower
						value = 3
					}
				}
			}
		}
	}
	# Run away
	option	= {
		name = castanortrials.406.d
		set_country_flag = golem_trial_ran
		castanor_trials_fail_effect = yes
	}
	
	after = {
		if = {
			limit = { NOT = { has_country_flag = golem_trial_ran } }
			subtract_variable = {
				which = aspirantPower
				which = golemPower
			}
			log = "Current aspirant power is [Root.aspirantPower.GetValue]"
			hidden_effect = {
				if = {
					limit = { check_variable = { which = aspirantPower value = 5 } }
					country_event = {
						id = castanortrials.407 # Succcess
					}
				}
				else_if = {
					limit = { check_variable = { which = aspirantPower value = 4 } }
					random_list = {
						9 = {
							country_event = {
								id = castanortrials.407 # Succcess
							}
						}
						1 = {
							set_country_flag = golem_trial_died
							castanor_trials_die_effect = yes
						}
					}
				}
				else_if = {
					limit = { check_variable = { which = aspirantPower value = 3 } }
					random_list = {
						85 = {
							country_event = {
								id = castanortrials.407 # Succcess
							}
						}
						15 = {
							set_country_flag = golem_trial_died
							castanor_trials_die_effect = yes
						}
					}
				}
				else_if = {
					limit = { check_variable = { which = aspirantPower value = 2 } }
					random_list = {
						80 = {
							country_event = {
								id = castanortrials.407 # Succcess
							}
						}
						20 = {
							set_country_flag = golem_trial_died
							castanor_trials_die_effect = yes
						}
					}
				}
				else_if = {
					limit = { check_variable = { which = aspirantPower value = 1 } }
					random_list = {
						75 = {
							country_event = {
								id = castanortrials.407 # Succcess
							}
						}
						25 = {
							set_country_flag = golem_trial_died
							castanor_trials_die_effect = yes
						}
					}
				}
				else_if = {
					limit = { check_variable = { which = aspirantPower value = 0 } }
					random_list = {
						70 = {
							country_event = {
								id = castanortrials.407 # Succcess
							}
						}
						30 = {
							set_country_flag = golem_trial_died
							castanor_trials_die_effect = yes
						}
					}
				}
				else_if = {
					limit = { check_variable = { which = aspirantPower value = -1 } }
					random_list = {
						65 = {
							country_event = {
								id = castanortrials.407 # Succcess
							}
						}
						35 = {
							set_country_flag = golem_trial_died
							castanor_trials_die_effect = yes
						}
					}
				}
				else_if = {
					limit = { check_variable = { which = aspirantPower value = -2 } }
					random_list = {
						60 = {
							country_event = {
								id = castanortrials.407 # Succcess
							}
						}
						40 = {
							set_country_flag = golem_trial_died
							castanor_trials_die_effect = yes
						}
					}
				}
				else_if = {
					limit = { check_variable = { which = aspirantPower value = -3 } }
					random_list = {
						50 = {
							country_event = {
								id = castanortrials.407 # Succcess
							}
						}
						50 = {
							set_country_flag = golem_trial_died
							castanor_trials_die_effect = yes
						}
					}
				}
				else_if = {
					limit = { check_variable = { which = aspirantPower value = -4 } }
					random_list = {
						40 = {
							country_event = {
								id = castanortrials.407 # Succcess
							}
						}
						60 = {
							set_country_flag = golem_trial_died
							castanor_trials_die_effect = yes
						}
					}
				}
				else = {
					random_list = {
						30 = {
							country_event = {
								id = castanortrials.407 # Succcess
							}
						}
						70 = {
							set_country_flag = golem_trial_died
							castanor_trials_die_effect = yes
						}
					}
				}
			}
		}
	}
}
# Giantsbane trial - Golem success
country_event = {
	id = castanortrials.407
	title = castanortrials.407.t
	desc = castanortrials.407.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# 
	option	= {
		name = castanortrials.407.a
		country_event = {
			id = castanortrials.104
		}
	}
}

# Beastbane trial
country_event = {
	id = castanortrials.410
	title = castanortrials.410.t
	desc = castanortrials.410.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Rely on tracking skills
	option	= {
		name = castanortrials.410.a
		hidden_effect = {
			random_list = {
				# Tracking success
				50 = {
					modifier = {
						factor = 3
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_adventurer_chosen
					}
					modifier = {
						factor = 1.5
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_peasant_chosen
					}
					modifier = {
						factor = 1.5
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_noble_chosen
					}
					modifier = {
						factor = 1.5
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_general_chosen
					}
					modifier = {
						factor = 2.5
						NOT = { has_reform = original_castanor_trials_reform }
						adm = 6
					}
					modifier = {
						factor = 2
						NOT = { has_reform = original_castanor_trials_reform }
						adm = 5
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						adm = 4
					}
					modifier = {
						factor = 2
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = free_thinker_personality
					}
					modifier = {
						factor = 2
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = careful_personality
					}
					set_country_flag = beastbane_trial_tracking_success
				}
				# Tracking failure
				50 = {
					modifier = {
						factor = 1.5
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_academic_chosen
					}
					modifier = {
						factor = 1.5
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_patrician_chosen
					}
					set_country_flag = beastbane_trial_tracking_failure
				}
			}
			country_event = {
				id = castanortrials.411
			}
		}
	}
	# Ask the forest spirits/fey
	option	= {
		name = castanortrials.410.b
		hidden_effect = {
			random_list = {
				# Fey success
				50 = {
					modifier = {
						factor = 3
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_dignitary_chosen
					}
					modifier = {
						factor = 2
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_merchant_chosen
					}
					modifier = {
						factor = 1.5
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_priest_chosen
					}
					modifier = {
						factor = 2.5
						NOT = { has_reform = original_castanor_trials_reform }
						dip = 6
					}
					modifier = {
						factor = 2
						NOT = { has_reform = original_castanor_trials_reform }
						dip = 5
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						dip = 4
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = fierce_negotiator_personality
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = charismatic_negotiator_personality
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = silver_tongue_personality
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = intricate_web_weaver_personality
					}
					set_country_flag = beastbane_trial_fey_success
				}
				# Fey failure
				50 = {
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = babbling_buffoon_personality
					}
					modifier = {
						factor = 1.5
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_peasant_chosen
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						NOT = { dip = 3 }
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						NOT = { dip = 2 }
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						NOT = { dip = 1 }
					}
					set_country_flag = beastbane_trial_fey_failure
				}
			}
			country_event = {
				id = castanortrials.412
			}
		}
	}
}
# Tracking result
country_event = {
	id = castanortrials.411
	title = castanortrials.411.t
	desc = {
		trigger = {
			has_country_flag = beastbane_trial_tracking_success
		}
		desc = castanortrials.411.desc1
	}
	desc = {
		trigger = {
			has_country_flag = beastbane_trial_tracking_failure
		}
		desc = castanortrials.411.desc2
	}
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Go to the fey
	option	= {
		name = castanortrials.411.a
		trigger = {
			has_country_flag = beastbane_trial_tracking_failure
		}
		hidden_effect = {
			random_list = {
				# Fey success
				50 = {
					modifier = {
						factor = 3
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_dignitary_chosen
					}
					modifier = {
						factor = 2
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_merchant_chosen
					}
					modifier = {
						factor = 1.5
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_priest_chosen
					}
					modifier = {
						factor = 2.5
						NOT = { has_reform = original_castanor_trials_reform }
						dip = 6
					}
					modifier = {
						factor = 2
						NOT = { has_reform = original_castanor_trials_reform }
						dip = 5
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						dip = 4
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						NOT = { dip = 3 }
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						NOT = { dip = 2 }
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						NOT = { dip = 1 }
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = fierce_negotiator_personality
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = charismatic_negotiator_personality
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = silver_tongue_personality
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = intricate_web_weaver_personality
					}
					set_country_flag = beastbane_trial_fey_success
				}
				# Fey failure
				50 = {
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = babbling_buffoon_personality
					}
					modifier = {
						factor = 1.5
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_peasant_chosen
					}
					set_country_flag = beastbane_trial_fey_failure
				}
			}
			country_event = {
				id = castanortrials.412
			}
		}
	}
	# Run away
	option	= {
		name = castanortrials.411.b
		trigger = {
			has_country_flag = beastbane_trial_tracking_failure
		}
		set_country_flag = beastbane_trial_ran
		castanor_trials_fail_effect = yes
	}
	# Noice
	option = {
		name = castanortrials.411.c
		trigger = {
			has_country_flag = beastbane_trial_tracking_success
		}
		set_country_flag = beastbane_trial_beast_asleep
		country_event = {
			id = castanortrials.414
		}
	}
}
# Fey result
country_event = {
	id = castanortrials.412
	title = castanortrials.412.t
	desc = {
		trigger = {
			has_country_flag = beastbane_trial_fey_success
		}
		desc = castanortrials.412.desc1
	}
	desc = {
		trigger = {
			has_country_flag = beastbane_trial_fey_failure
		}
		desc = castanortrials.412.desc2
	}
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# We've been misled - uh oh
	option	= {
		name = castanortrials.412.a
		trigger = {
			has_country_flag = beastbane_trial_fey_failure
		}
		hidden_effect = {
			random_list = {
				# Fight success
				50 = {
					modifier = {
						factor = 3
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_adventurer_chosen
					}
					modifier = {
						factor = 1.5
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_noble_chosen
					}
					modifier = {
						factor = 2
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_mage_chosen
					}
					modifier = {
						factor = 2.5
						NOT = { has_reform = original_castanor_trials_reform }
						mil = 6
					}
					modifier = {
						factor = 2
						NOT = { has_reform = original_castanor_trials_reform }
						mil = 5
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						mil = 4
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = strict_personality
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = bold_fighter_personality
					}
					modifier = {
						factor = 2
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_mage_personality = yes
					}
					set_country_flag = beastbane_trial_fey_fight_success
				}
				# Fight failure
				50 = {
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = craven_personality
					}
					modifier = {
						factor = 1.5
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_academic_chosen
					}
					modifier = {
						factor = 1.5
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_dignitary_chosen
					}
					modifier = {
						factor = 1.5
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_priest_chosen
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						NOT = { mil = 3 }
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						NOT = { mil = 2 }
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						NOT = { mil = 1 }
					}
					set_country_flag = beastbane_trial_fey_fight_failure
				}
			}
			country_event = {
				id = castanortrials.413
			}
		}
	}
	# Ya almost got away with it too
	option	= {
		name = castanortrials.412.b
		trigger = {
			has_country_flag = beastbane_trial_fey_success
		}
		if = {
			limit = { has_country_flag = beastbane_trial_tracking_failure }
			set_country_flag = beastbane_trial_beast_hunting
		}
		else = {
			set_country_flag = beastbane_trial_beast_asleep
		}
		country_event = {
			id = castanortrials.414
		}
	}
}
# Mislead by fey battle result
country_event = {
	id = castanortrials.413
	title = castanortrials.413.t
	desc = {
		trigger = {
			has_country_flag = beastbane_trial_fey_fight_success
		}
		desc = castanortrials.413.desc1
	}
	desc = {
		trigger = {
			has_country_flag = beastbane_trial_fey_fight_failure
		}
		desc = castanortrials.413.desc2
	}
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Continue on
	option = {
		name = castanortrials.413.a
		trigger = {
			has_country_flag = beastbane_trial_fey_fight_success
		}
		set_country_flag = beastbane_trial_beast_hunting
	}
	# First aid yourself first
	option = {
		name = castanortrials.413.b
		trigger = {
			has_country_flag = beastbane_trial_fey_fight_failure
		}
		if = {
			limit = { has_country_flag = beastbane_trial_tracking_failure }
			set_country_flag = beastbane_trial_being_hunted
		}
		else = {
			set_country_flag = beastbane_trial_beast_hunting
		}
	}
	# Push on without dressing your wounds first
	option = {
		name = castanortrials.413.c
		trigger = {
			has_country_flag = beastbane_trial_fey_fight_failure
		}
		set_country_flag = undressed_wounds
		set_country_flag = beastbane_trial_beast_hunting
	}
	# Take the skin of the minor beast, abandon your quarry (worse enchant chance basically)
	option = {
		name = castanortrials.413.d
		set_country_flag = beastbane_trial_minor_beast_skin
	}
	after = {
		if = {
			limit = { has_country_flag = beastbane_trial_minor_beast_skin }
			country_event = {
				id = castanortrials.416
			}
		}
		else = {
			country_event = {
				id = castanortrials.414
			}
		}
	}
}
# The beast is found
country_event = {
	id = castanortrials.414
	title = castanortrials.414.t
	desc = {
		trigger = {
			has_country_flag = beastbane_trial_beast_asleep
		}
		desc = castanortrials.414.desc1 # it be sleeping
	}
	desc = {
		trigger = {
			has_country_flag = beastbane_trial_beast_hunting
		}
		desc = castanortrials.414.desc2 # it be hunting for food
	}
	desc = {
		trigger = {
			has_country_flag = beastbane_trial_being_hunted
		}
		desc = castanortrials.414.desc3 # it be hunting YOU
	}
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Grab its molted skin
	option = {
		name = castanortrials.414.a
		trigger = {
			has_country_flag = beastbane_trial_beast_asleep
		}
		set_country_flag = beastbane_trial_molt_grabbed
		country_event = {
			id = castanortrials.416
		}
	}
	# Riddle it with arrows
	option = {
		name = castanortrials.414.b
		trigger = {
			OR = {
				has_country_flag = beastbane_trial_beast_hunting
				has_country_flag = beastbane_trial_beast_asleep
			}
		}
		if = { 
			limit = { has_country_flag = beastbane_trial_beast_asleep }
			set_country_flag = beastbane_trial_sleeping_arrow_ambush
		}
		else = {
			set_country_flag = beastbane_trial_hunting_arrow_ambush
		}
		country_event = {
			id = castanortrials.415
		}
	}
	# Wait for it to finish its hunt, then attack while it's occupied
	option = {
		name = castanortrials.414.c
		trigger = {
			has_country_flag = beastbane_trial_beast_hunting
		}
		set_country_flag = beastbane_trial_occupied_ambush
		country_event = {
			id = castanortrials.415
		}
	}
	# Run away
	option = {
		name = castanortrials.414.d
		trigger = {
			has_country_flag = beastbane_trial_being_hunted
		}
		set_country_flag = beastbane_trial_ran
		castanor_trials_fail_effect = yes
	}
	# Right into combat
	option = {
		name = castanortrials.414.e
		trigger = {
			has_country_flag = beastbane_trial_being_hunted
		}
		country_event = {
			id = castanortrials.415
		}
	}
}
# Combat time
country_event = {
	id = castanortrials.415
	title = castanortrials.415.t
	desc = castanortrials.415.desc
	picture = TRAILS_BASILISK_eventPicture

	is_triggered_only = yes

	immediate = {
		# Calcs
		hidden_effect = {
			random_list = {
				# Win
				33 = {
					modifier = {
						factor = 5
						has_country_flag = beastbane_trial_sleeping_arrow_ambush
					}
					modifier = {
						factor = 2
						has_country_flag = beastbane_trial_hunting_arrow_ambush
					}
					modifier = {
						factor = 3
						has_country_flag = beastbane_trial_occupied_ambush
					}
					modifier = {
						factor = 3
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_adventurer_chosen
					}
					modifier = {
						factor = 1.5
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_noble_chosen
					}
					modifier = {
						factor = 2
						has_reform = original_castanor_trials_reform
						has_country_flag = castanor_trials_candidate_mage_chosen
					}
					modifier = {
						factor = 2.5
						NOT = { has_reform = original_castanor_trials_reform }
						mil = 6
					}
					modifier = {
						factor = 2
						NOT = { has_reform = original_castanor_trials_reform }
						mil = 5
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						mil = 4
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = strict_personality
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = bold_fighter_personality
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_mage_personality = yes
					}
					set_country_flag = beastbane_trial_beast_killed
				}
				# Lose
				66 = {
					modifier = {
						factor = 1.2
						NOT = { has_reform = original_castanor_trials_reform }
						ruler_has_personality = craven_personality
					}
					modifier = {
						factor = 1.2
						NOT = { has_reform = original_castanor_trials_reform }
						has_country_flag = castanor_trials_candidate_academic_chosen
					}
					modifier = {
						factor = 1.2
						NOT = { has_reform = original_castanor_trials_reform }
						has_country_flag = castanor_trials_candidate_dignitary_chosen
					}
					modifier = {
						factor = 1.2
						NOT = { has_reform = original_castanor_trials_reform }
						has_country_flag = castanor_trials_candidate_priest_chosen
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						NOT = { mil = 3 }
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						NOT = { mil = 2 }
					}
					modifier = {
						factor = 1.5
						NOT = { has_reform = original_castanor_trials_reform }
						NOT = { mil = 1 }
					}
					modifier = {
						factor = 1.5
						has_country_flag = undressed_wounds
					}
					modifier = {
						factor = 0
						has_country_flag = first_time_trying_trials
					}
					set_country_flag = beastbane_trial_aspirant_killed
				}
			}
		}
	}

	# Continue on
	option = {
		name = castanortrials.415.a
		trigger = {
			has_country_flag = beastbane_trial_beast_killed
		}
		country_event = {
			id = castanortrials.416
		}
		add_prestige = 10
	}
	# We died rip
	option = {
		name = castanortrials.415.b
		trigger = {
			has_country_flag = beastbane_trial_aspirant_killed
		}
		castanor_trials_die_effect = yes
	}
	
}
# Time to process the carcass
country_event = {
	id = castanortrials.416
	title = castanortrials.416.t
	desc = {
		trigger = { has_country_flag = beastbane_trial_molt_grabbed }
		desc = castanortrials.416.desc1
	}
	desc = castanortrials.416.desc2
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Admin option
	option = {
		name = castanortrials.416.a
		custom_tooltip = beastbane_trial_reward_adm
		hidden_effect = {
			random_list = {
				# Success
				2 = {
					modifier = {
						factor = 0.5
						has_country_flag = beastbane_trial_molt_grabbed
					}
					modifier = {
						factor = 0.25
						has_country_flag = beastbane_trial_minor_beast_skin
						NOT = { has_country_flag = beastbane_trial_molt_grabbed }
					}
					set_country_flag = beastbane_trial_enchantment_adm_success
				}
				# Fail
				1 = { }
			}
		}
	}
	# Dip option
	option = {
		name = castanortrials.416.b
		custom_tooltip = beastbane_trial_reward_dip
		hidden_effect = {
			random_list = {
				# Success
				1 = {
					modifier = {
						factor = 0.5
						has_country_flag = beastbane_trial_molt_grabbed
					}
					modifier = {
						factor = 0.25
						has_country_flag = beastbane_trial_minor_beast_skin
					}
					set_country_flag = beastbane_trial_enchantment_dip_success
				}
				# Fail
				1 = { }
			}
		}
	}
	# Mil option
	option = {
		name = castanortrials.416.c
		custom_tooltip = beastbane_trial_reward_mil
		hidden_effect = {
			random_list = {
				# Success
				1 = {
					modifier = {
						factor = 0.5
						has_country_flag = beastbane_trial_molt_grabbed
					}
					modifier = {
						factor = 0.25
						has_country_flag = beastbane_trial_minor_beast_skin
					}
					set_country_flag = beastbane_trial_enchantment_mil_success
				}
				# Fail
				1 = { }
			}
		}
	}
	after = {
		country_event = {
			id = castanortrials.417
		}
	}
}
# Processing success/fail - onto the coronation
country_event = {
	id = castanortrials.417
	title = castanortrials.417.t
	desc = {
		desc = castanortrails.417.descMinorBeastSuccess
		trigger = {
			has_country_flag = beastbane_trial_minor_beast_skin
			OR = {
				has_country_flag = beastbane_trial_enchantment_mil_success
				has_country_flag = beastbane_trial_enchantment_dip_success
				has_country_flag = beastbane_trial_enchantment_adm_success
			}
		}
	}
	desc = {
		desc = castanortrails.417.descMinorBeastFail
		trigger = { has_country_flag = beastbane_trial_minor_beast_skin }
	}
	desc = {
		trigger = { has_country_flag = beastbane_trial_enchantment_adm_success }
		desc = castanortrials.417.desc1
	}
	desc = {
		trigger = { has_country_flag = beastbane_trial_enchantment_dip_success }
		desc = castanortrials.417.desc2
	}
	desc = {
		trigger = { has_country_flag = beastbane_trial_enchantment_mil_success }
		desc = castanortrials.417.desc3
	}
	desc = {
		trigger = {
			NOT = { has_country_flag = beastbane_trial_enchantment_mil_success }
			NOT = { has_country_flag = beastbane_trial_enchantment_dip_success }
			NOT = { has_country_flag = beastbane_trial_enchantment_adm_success }				
		}
		desc = castanortrials.417.desc4
	}
	
	
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Proceed
	option = {
		name = castanortrials.417.a
		country_event = {
			id = castanortrials.104
		}
	}
	
}
# You die lol - deprecated
country_event = {
	id = castanortrials.418
	title = castanortrials.415.t
	desc = castanortrials.415.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Continue on
	option = {
		
	}
	
}
# You run away like a fucking coward
country_event = {
	id = castanortrials.419
	title = castanortrials.419.t
	desc = castanortrials.419.desc
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	# Continue on
	option = {
		name = castanortrials.419.a
		castanor_trials_fail_effect = yes
	}
}