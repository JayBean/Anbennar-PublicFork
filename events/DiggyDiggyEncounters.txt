
namespace = diggy_encounter

# Adding encounter are not a hard feat, as long as you use the effects customized for them. Feel free to take notice of them:
# encounter_effect
# change_party_supplies
# change_party_rewards
# change_party_effectiveness
# change_party_morale
# change_party_manpower
# change_party_loot
# Look into anb_digging_effects to see how they work or get some more information on them, or take inspiration of the other encounters already coded



#Encounters Menu
province_event = {
	id = diggy_encounter.0
	title = diggy_encounter.0.t
	desc = diggy_encounter.0.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	hidden = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
	}
	
	# Peaceful campfire
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			always = yes
		}
		province_event = { id = diggy_encounter.1 }
	}
	
	# Deserters
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			always = yes
		}
		province_event = { id = diggy_encounter.2 }
	}
	
	# Edible Fungi
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			always = yes
		}
		province_event = { id = diggy_encounter.3 }
	}
	
	# Lost Malfunctionning Golem
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			expedition_danger_level = { min = 1 max = 5 }
		}
		province_event = { id = diggy_encounter.10 }
	}
	
	# Spider Nest
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			expedition_danger_level = { min = 1 max = 3 }
		}
		province_event = { id = diggy_encounter.20 }
	}
	
	# Pack of Rothé
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			expedition_danger_level = { min = 1 max = 4 }
		}
		province_event = { id = diggy_encounter.30 }
	}
	
	# Grue
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			expedition_danger_level = { min = 3 max = 5 }
		}
		province_event = { id = diggy_encounter.40 }
	}
	
	# Cloakers
	option = {
        name = diggy_encounter.0.a
        ai_chance = {
			factor = 10
			modifier = { factor = 10 has_terrain = cavern }
		}
		trigger = {
			expedition_danger_level = { min = 3 max = 5 }
		}
		province_event = { id = diggy_encounter.50 }
	}
	
	# Cave Troll
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			expedition_danger_level = { min = 3 max = 5 }
		}
		province_event = { id = diggy_encounter.60 }
	}
	
	# Roof collapse
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			always = yes
		}
		province_event = { id = diggy_encounter.70 }
	}
	
	# Unusual Mushroom
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			always = yes
		}
		province_event = { id = diggy_encounter.80 }
	}
	
	# Hobgoblin Expedition
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			expedition_danger_level = { min = 3 max = 5 }
			region = tree_of_stone_region
		}
		province_event = { id = diggy_encounter.90 }
	}
	
	#Piercers on the Ceiling
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			expedition_danger_level = { min = 1 max = 5 }
			has_terrain = cavern
		}
		province_event = { id = diggy_encounter.100 }
	}
	
	#Poison carrier
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			always = yes
		}
		province_event = { id = diggy_encounter.110 }
	}
	
	#Purple Worm
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			expedition_danger_level = { min = 4 max = 5 }
		}
		province_event = { id = diggy_encounter.120 }
	}
	
	#Drunks oldiers
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			owner = { has_country_modifier = dwarven_administration }
			NOT = { has_province_flag = encounter_drunk_dwarf }
		}
		province_event = { id = diggy_encounter.130 }
	}
	
	#Dwarves Party Ahead Of us
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			expedition_danger_level = { min = 1 max = 5 }
			NOT = { check_variable = { nbFloor = 5 } }
			OR = {
				region = west_dwarovar_region
				region = serpentreach_region
			}
		}
		province_event = { id = diggy_encounter.140 }
	}
	
	# Restless Dwarves Spirit
	option = {
        name = diggy_encounter.0.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			expedition_danger_level = { min = 1 max = 3 }
		}
		province_event = { id = diggy_encounter.150 }
	}
}

# Peaceful night next to the campfire
province_event = {
	id = diggy_encounter.1
	title = diggy_encounter.1.t
	desc = diggy_encounter.1.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	hidden = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.1.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			always = yes
		}
		change_party_morale = { add_tooltip = yes add = 0.5 }
	}
}

# Deserters
province_event = {
	id = diggy_encounter.2
	title = diggy_encounter.2.t
	desc = diggy_encounter.2.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	hidden = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.2.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			always = yes
		}
		change_party_manpower = { remove_tooltip = yes loss = 250 }
	}
}

# Edible Fungi
province_event = {
	id = diggy_encounter.3
	title = diggy_encounter.3.t
	desc = diggy_encounter.3.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	hidden = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.3.a
        ai_chance = { 
			factor = 100
		}
		trigger = {
			always = yes
		}
		change_party_supplies = { add_tooltip = yes add = 3 }
	}
}

# Lost Malfunctionning Golem
province_event = {
	id = diggy_encounter.10
	title = diggy_encounter.10.t
	desc = diggy_encounter.10.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
	}
	
	#He Attack
	option = {
        name = diggy_encounter.10.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 80
			success_id = 11
			
			base_failure = 20
			failure_id = 12
		}
	}
	
	#Go Around
	option = {
        name = diggy_encounter.10.b
        ai_chance = { factor = 100 }
		trigger = {
			#Smoll races
			OR = {
				owner = { has_country_modifier = goblin_military }
				owner = { has_country_modifier = kobold_military }
			}
		}
		continue_expedition = yes
	}
}

#Beat it
province_event = {
	id = diggy_encounter.11
	title = diggy_encounter.11.t
	desc = diggy_encounter.11.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	#yay
	option = {
        name = diggy_encounter.11.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_loot = { add_tooltip = yes  add = 75 }
		change_party_morale = { add_tooltip = yes add = 0.5 }
		change_party_manpower = { remove_tooltip = yes loss = 150 }
	}
}

#We got rekt
province_event = {
	id = diggy_encounter.12
	title = diggy_encounter.12.t
	desc = diggy_encounter.12.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	#yay
	option = {
        name = diggy_encounter.12.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { remove_tooltip = yes loss = 0.5 }
		change_party_manpower = { remove_tooltip = yes loss = 250 }
	}
}

# Spider Nest
province_event = {
	id = diggy_encounter.20
	title = diggy_encounter.20.t
	desc = diggy_encounter.20.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		expedition_danger_level = { min = 1 max = 3 }
	}
	
	immediate = {
	}
	
	after = {
	}
	
	# Send a regiment to see if there's any loot
	option = {
        name = diggy_encounter.20.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 70
			success_id = 21
			
			base_failure = 30
			failure_id = 22
		}
	}
	
	#Go Around
	option = {
        name = diggy_encounter.20.b
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		
		encounter_effect = {
			base_success = 85
			success_id = 0
			
			base_failure = 15
			failure_id = 23
		}
	}
}

# Found some loot
province_event = {
	id = diggy_encounter.21
	title = diggy_encounter.21.t
	desc = diggy_encounter.21.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	#yay
	option = {
        name = diggy_encounter.21.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { add_tooltip = yes add = 0.5 }
		change_party_loot = { add_tooltip = yes add = 50 }
	}
}

#Regiment is dead
province_event = {
	id = diggy_encounter.22
	title = diggy_encounter.22.t
	desc = diggy_encounter.22.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	#yay
	option = {
        name = diggy_encounter.22.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { remove_tooltip = yes loss = 0.5 }
		change_party_manpower = { remove_tooltip = yes loss = 200 }
	}
}

# Humonguous spider ambush us, we killed them but lost some supplies
province_event = {
	id = diggy_encounter.23
	title = diggy_encounter.23.t
	desc = diggy_encounter.23.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	#yay
	option = {
        name = diggy_encounter.23.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_loot = { add_tooltip = yes add = 25 }
		change_party_supplies = { remove_tooltip = yes loss = 3 }
	}
}

# Deep Rothé
province_event = {
	id = diggy_encounter.30
	title = diggy_encounter.30.t
	desc = diggy_encounter.30.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		expedition_danger_level = { min = 1 max = 4 }
	}
	
	immediate = {
	}
	
	after = {
	}
	
	# Kill them for supplies
	option = {
        name = diggy_encounter.30.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 90
			success_id = 31
			
			base_failure = 10
			failure_id = 32
		}
	}
	
	#Let's ignore them
	option = {
        name = diggy_encounter.30.b
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		
		continue_expedition = yes
	}
}

# Kill them without problem
province_event = {
	id = diggy_encounter.31
	title = diggy_encounter.31.t
	desc = diggy_encounter.31.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	#yay
	option = {
        name = diggy_encounter.31.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_supplies = { add_tooltip = yes add = 10 }
	}
}

# We lost some mens
province_event = {
	id = diggy_encounter.32
	title = diggy_encounter.32.t
	desc = diggy_encounter.32.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	#yay
	option = {
        name = diggy_encounter.32.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_supplies = { add_tooltip = yes add = 10 }
		change_party_manpower = { remove_tooltip = yes loss = 200 }
	}
}

# Grue monster attack
province_event = {
	id = diggy_encounter.40
	title = diggy_encounter.40.t
	desc = diggy_encounter.40.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		expedition_danger_level = { min = 3 max = 5 }
	}
	
	immediate = {
	}
	
	after = {
	}
	
	# Kill them for supplies
	option = {
        name = diggy_encounter.40.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 60
			success_id = 41
			
			base_failure = 40
			failure_id = 42
		}
	}
}

# Victory but some men died
province_event = {
	id = diggy_encounter.41
	title = diggy_encounter.41.t
	desc = diggy_encounter.41.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.41.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_manpower = { remove_tooltip = yes loss = 150 }
		change_party_loot = { add_tooltip = yes add = 50 }
		change_party_morale = { add_tooltip = yes add = 1 }
	}
}

# Crushing defeat, had to flee, because he was using the darkness
province_event = {
	id = diggy_encounter.42
	title = diggy_encounter.42.t
	desc = diggy_encounter.42.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.42.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { remove_tooltip = yes loss = 1 }
		change_party_manpower = { remove_tooltip = yes loss = 350 }
	}
}

# Flock of Cloakers
province_event = {
	id = diggy_encounter.50
	title = diggy_encounter.50.t
	desc = diggy_encounter.50.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		expedition_danger_level = { min = 3 max = 5 }
	}
	
	immediate = {
	}
	
	after = {
	}
	
	# Fend them off
	option = {
        name = diggy_encounter.50.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 70
			success_id = 51
			
			base_failure = 30
			failure_id = 52
			
			special_option = 200
			special_trigger = " trigger = { check_variable = { partyEffectiveness = 150 } } "
			special_event = " province_event = { id = diggy_encounter.53 } "
			
			special_option_2 = 200
			special_trigger_2 = " trigger = { NOT = { check_variable = { partyEffectiveness = 100 } } } "
			special_event_2 = " province_event = { id = diggy_encounter.54 } "
			
		}
	}
}

# Managed to make them flee
province_event = {
	id = diggy_encounter.51
	title = diggy_encounter.51.t
	desc = diggy_encounter.51.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.51.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { add_tooltip = yes add = 1 }
		change_party_manpower = { remove_tooltip = yes loss = 75 }
	}
}

# They pillaged our supplies and killed our man, but finally flee
province_event = {
	id = diggy_encounter.52
	title = diggy_encounter.52.t
	desc = diggy_encounter.52.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.52.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { remove_tooltip = yes loss = 1 }
		change_party_manpower = { remove_tooltip = yes loss = 300 }
		change_party_supplies = { remove_tooltip = yes loss = 10 }
	}
}

# We fought them off and tracked them to their nest, finding treasure
province_event = {
	id = diggy_encounter.53
	title = diggy_encounter.53.t
	desc = diggy_encounter.53.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.53.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { add_tooltip = yes loss = 1.5 }
		change_party_loot = { add_tooltip = yes add = 150 }
		change_party_manpower = { remove_tooltip = yes loss = 150 }
	}
}

# They fucked us, HARD, and destroyed part of our supplies
province_event = {
	id = diggy_encounter.54
	title = diggy_encounter.54.t
	desc = diggy_encounter.54.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.54.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { remove_tooltip = yes loss = 2 }
		change_party_manpower = { remove_tooltip = yes loss = 500 }
		change_party_supplies = { remove_tooltip = yes loss = 20 }
	}
}

# Cave trolls
province_event = {
	id = diggy_encounter.60
	title = diggy_encounter.60.t
	desc = diggy_encounter.60.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		expedition_danger_level = { min = 3 max = 5 }
	}
	
	immediate = {
	}
	
	after = {
	}
	
	# Fend them off
	option = {
        name = diggy_encounter.60.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 80
			success_id = 61
			
			base_failure = 20
			failure_id = 62
			
			special_option = 20
			special_trigger = " trigger = { check_variable = { partyEffectiveness = 120 } } "
			special_modifier = " modifier = { factor = 2 has_terrain = cavern } "
			special_event = " province_event = { id = diggy_encounter.63 } "
		}
	}
}

# Kill them with minimal casualties
province_event = {
	id = diggy_encounter.61
	title = diggy_encounter.61.t
	desc = diggy_encounter.61.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.61.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { add_tooltip = yes add = 0.5 }
		change_party_manpower = { remove_tooltip = yes loss = 100 }
	}
}

# We lost to many men
province_event = {
	id = diggy_encounter.62
	title = diggy_encounter.62.t
	desc = diggy_encounter.62.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.62.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { remove_tooltip = yes loss = 0.5 }
		change_party_manpower = { remove_tooltip = yes loss = 350 }
	}
}

# We found the treasure they were guarding
province_event = {
	id = diggy_encounter.63
	title = diggy_encounter.63.t
	desc = diggy_encounter.63.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.63.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { add_tooltip = yes add = 0.5 }
		change_party_manpower = { remove_tooltip = yes loss = 75 }
		change_party_loot = { add_tooltip = yes add = 100 }
	}
}

# Roof collapse
province_event = {
	id = diggy_encounter.70
	title = diggy_encounter.70.t
	desc = diggy_encounter.70.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	# Fend them off
	option = {
        name = diggy_encounter.70.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_manpower = { remove_tooltip = yes loss = 500 }
	}
}

# Unusual Mushroom
province_event = {
	id = diggy_encounter.80
	title = diggy_encounter.80.t
	desc = diggy_encounter.80.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		expedition_danger_level = { min = 1 max = 5 }
	}
	
	immediate = {
	}
	
	after = {
	}
	
	# Try to gather supplies
	option = {
        name = diggy_encounter.80.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 65
			success_id = 81
			
			base_failure = 35
			failure_id = 82
		}
	}
	
	# Go around
	option = {
        name = diggy_encounter.80.b
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 95
			success_id = 0
			
			base_failure = 5
			failure_id = 83
		}
	}
}

# Pick edible mushroom
province_event = {
	id = diggy_encounter.81
	title = diggy_encounter.81.t
	desc = diggy_encounter.81.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.81.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_supplies = { add_tooltip = yes add = 10 }
	}
}

# Poisonous field
province_event = {
	id = diggy_encounter.82
	title = diggy_encounter.82.t
	desc = diggy_encounter.82.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.82.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { remove_tooltip = yes loss = 0.5 }
		change_party_manpower = { remove_tooltip = yes loss = 325 }
	}
}

# Cavern filled with toxic spore
province_event = {
	id = diggy_encounter.83
	title = diggy_encounter.83.t
	desc = diggy_encounter.83.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.83.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { remove_tooltip = yes loss = 0.5 }
		change_party_manpower = { remove_tooltip = yes loss = 500 }
	}
}

# Hobgoblin Expedition
province_event = {
	id = diggy_encounter.90
	title = diggy_encounter.90.t
	desc = diggy_encounter.90.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		expedition_danger_level = { min = 3 max = 5 }
		region = tree_of_stone_region
	}
	
	immediate = {
	}
	
	after = {
	}
	
	# Fight them!
	option = {
        name = diggy_encounter.90.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 60 #Costly Victory
			success_id = 91
			
			base_failure = 40 #Costly Defeat
			failure_id = 92
			
			special_option = 150 #Total Victory
			special_trigger = " trigger = { check_variable = { partyEffectiveness = 125 } } "
			special_modifier = "
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 130 } }
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 135 } }
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 135 } }
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 140 } }
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 145 } }
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 150 } }
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 155 } }
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 160 } }
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 165 } }
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 170 } }
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 175 } }
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 180 } }
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 185 } }
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 190 } }
				modifier = { factor = 1.2 check_variable = { partyEffectiveness = 195 } }
			"
			special_event = " province_event = { id = diggy_encounter.93 } "
			
			special_option_2 = 100 #Crushing Defeat
			special_trigger_2 = " trigger = { NOT = { check_variable = { partyEffectiveness = 100 } } } "
			special_modifier_2 = "
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 95 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 90 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 85 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 80 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 75 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 70 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 65 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 60 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 55 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 50 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 45 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 40 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 35 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 30 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 25 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 20 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 15 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 10 } } }
				modifier = { factor = 1.2 NOT = { check_variable = { partyEffectiveness = 5 } } }
				modifier = { factor = 100 NOT = { check_variable = { partyEffectiveness = 1 } } }
			"
			special_event_2 = " province_event = { id = diggy_encounter.94 } "
		}
	}
	
	# Let them join our group
	option = {
        name = diggy_encounter.90.b
        ai_chance = { factor = 100 }
		trigger = {
			OR = {
				owner = { has_country_modifier = hobgoblin_administration }
				owner = { overlord = { has_country_modifier = hobgoblin_administration } }
			}
		}
		highlight = yes
		change_party_manpower = { add_tooltip = yes add = 1000 }
		continue_expedition = yes
	}
}

# Costly Victory
province_event = {
	id = diggy_encounter.91
	title = diggy_encounter.91.t
	desc = diggy_encounter.91.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.91.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_loot = { add_tooltip = yes add = 150 }
		change_party_morale = { add_tooltip = yes add = 1 }
		change_party_manpower = { remove_tooltip = yes loss = 250 }
	}
}

# Costly Defeat
province_event = {
	id = diggy_encounter.92
	title = diggy_encounter.92.t
	desc = diggy_encounter.92.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.92.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_supplies = { remove_tooltip = yes loss = 15 }
		change_party_loot = { remove_tooltip = yes loss = 150 }
		change_party_morale = { remove_tooltip = yes loss = 1 }
		change_party_manpower = { remove_tooltip = yes loss = 650 }
	}
}

# Total Victory
province_event = {
	id = diggy_encounter.93
	title = diggy_encounter.93.t
	desc = diggy_encounter.93.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.93.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_loot = { add_tooltip = yes add = 150 }
		change_party_morale = { add_tooltip = yes add = 2 }
		change_party_manpower = { remove_tooltip = yes loss = 200 }
	}
}

# Crushing Defeat
province_event = {
	id = diggy_encounter.94
	title = diggy_encounter.94.t
	desc = diggy_encounter.94.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.94.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_supplies = { remove_tooltip = yes loss = 25 }
		change_party_loot = { remove_tooltip = yes loss = 250 }
		change_party_morale = { remove_tooltip = yes loss = 2 }
		change_party_manpower = { remove_tooltip = yes loss = 1250 }
	}
}

# Piercers on the Ceiling
province_event = {
	id = diggy_encounter.100
	title = diggy_encounter.100.t
	desc = diggy_encounter.100.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		expedition_danger_level = { min = 1 max = 5 }
		has_terrain = cavern
	}
	
	immediate = {
	}
	
	after = {
	}
	
	# Try to gather supplies
	option = {
        name = diggy_encounter.100.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 85 #Kill most of them
			success_id = 101
			
			base_failure = 15 #Kill most of them but lose too many men in the process
			failure_id = 102
		}
	}
}

# Kill most of them
province_event = {
	id = diggy_encounter.101
	title = diggy_encounter.101.t
	desc = diggy_encounter.101.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.101.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { add_tooltip = yes add = 0.5 }
		change_party_manpower = { remove_tooltip = yes loss = 100 }
	}
}

# Kill most of them but lose too many men in the process
province_event = {
	id = diggy_encounter.102
	title = diggy_encounter.102.t
	desc = diggy_encounter.102.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.102.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { remove_tooltip = yes loss = 0.5 }
		change_party_manpower = { remove_tooltip = yes loss = 250 }
	}
}

# Poison Carrier
province_event = {
	id = diggy_encounter.110
	title = diggy_encounter.110.t
	desc = diggy_encounter.110.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		expedition_danger_level = { min = 1 max = 5 }
	}
	
	immediate = {
	}
	
	after = {
	}
	
	# Fuck
	option = {
        name = diggy_encounter.110.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 80 #Explode, killing some men
			success_id = 111
			
			base_failure = 20 #Explode, killing men and supplies
			failure_id = 112
		}
	}
	
	#Carefully handle the carrier, and use this poison for yourself
	option = {
        name = diggy_encounter.110.b
        ai_chance = { factor = 100 }	
		trigger = {
			owner = { OR = { has_idea = innovativeness_ideas innovativeness = 33 } }
		}
		highlight = yes
		change_party_effectiveness = { add_tooltip = yes add = 5 }
		change_party_morale = { add_tooltip = yes add = 0.5 }
		continue_expedition = yes
	}
}


#Explode, killing some men
province_event = {
	id = diggy_encounter.111
	title = diggy_encounter.111.t
	desc = diggy_encounter.111.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.111.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		
		change_party_manpower = { remove_tooltip = yes loss = 150 }
	}
}

#Explode, killing some men and contaminated some supplies
province_event = {
	id = diggy_encounter.112
	title = diggy_encounter.112.t
	desc = diggy_encounter.112.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.112.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_supplies = { remove_tooltip = yes loss = 5 }
		change_party_manpower = { remove_tooltip = yes loss = 275 }
	}
}

# Purple Worm
province_event = {
	id = diggy_encounter.120
	title = diggy_encounter.120.t
	desc = diggy_encounter.120.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		expedition_danger_level = { min = 4 max = 5 }
	}
	
	immediate = {
	}
	
	after = {
	}
	
	# Fuck
	option = {
        name = diggy_encounter.120.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 60 #Kill it
			success_id = 121
			
			base_failure = 40 #Sack our expedition
			failure_id = 122
		}
	}
}

#Kill it
province_event = {
	id = diggy_encounter.121
	title = diggy_encounter.121.t
	desc = diggy_encounter.121.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	#Celebrate
	option = {
        name = diggy_encounter.121.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { add_tooltip = yes add = 1 }
		change_party_manpower = { remove_tooltip = yes loss = 200 }
	}
	
	#Meat is back on the menu boy
	option = {
        name = diggy_encounter.121.b
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_supplies = { add_tooltip = yes add = 15 }
		change_party_morale = { remove_tooltip = yes loss = 0.5 }
		change_party_manpower = { remove_tooltip = yes loss = 200 }
	}
}

# Sack our expedition
province_event = {
	id = diggy_encounter.122
	title = diggy_encounter.122.t
	desc = diggy_encounter.122.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.122.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { remove_tooltip = yes loss = 1.5 }
		change_party_manpower = { remove_tooltip = yes loss = 650 }
	}
}

# Drunk soldiers
province_event = {
	id = diggy_encounter.130
	title = diggy_encounter.130.t
	desc = diggy_encounter.130.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		expedition_danger_level = { min = 1 max = 5 }
		owner = { has_country_modifier = dwarven_administration }
		NOT = { has_province_flag = encounter_drunk_dwarf }
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
		hidden_effect = { set_province_flag = encounter_drunk_dwarf }
	}
	
	# Make an example of them and execute them
	option = {
        name = diggy_encounter.130.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { remove_tooltip = yes loss = 0.5 }
		change_party_effectiveness = { add_tooltip = yes add = 5 }
	}
	
	# No more alcool for everyone
	option = {
        name = diggy_encounter.130.b
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { remove_tooltip = yes loss = 1 }
		change_party_supplies = { remove_tooltip = yes loss = 1 }
		change_party_effectiveness = { add_tooltip = yes add = 10 }
	}
}

# Dwarves party exploring ahead of us
province_event = {
	id = diggy_encounter.140
	title = diggy_encounter.140.t
	desc = diggy_encounter.140.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		expedition_danger_level = { min = 1 max = 5 }
		NOT = { check_variable = { nbFloor = 5 } }
		OR = {
			region = west_dwarovar_region
			region = serpentreach_region
		}
	}
	
	immediate = {
	}
	
	after = {
	}
	
	# Fight them
	option = {
        name = diggy_encounter.140.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 60 #Kill them
			success_id = 141
			
			base_failure = 40 #Sack our expedition
			failure_id = 142
		}
	}
	
	# Let them join our group
	option = {
        name = diggy_encounter.140.b
        ai_chance = { factor = 100 }
		trigger = {
			owner = { has_country_modifier = dwarven_administration }
		}
		highlight = yes
		change_party_supplies = { add_tooltip = yes add = 5 }
		change_party_manpower = { add_tooltip = yes add = 1000 }
		continue_expedition = yes
	}
}

#Kill them
province_event = {
	id = diggy_encounter.141
	title = diggy_encounter.141.t
	desc = diggy_encounter.141.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	#Celebrate
	option = {
        name = diggy_encounter.141.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_loot = { add_tooltip = yes add = 125 }
		change_party_morale = { add_tooltip = yes add = 1 }
		change_party_manpower = { remove_tooltip = yes loss = 300 }
	}
}

# Sack our expedition
province_event = {
	id = diggy_encounter.142
	title = diggy_encounter.142.t
	desc = diggy_encounter.142.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.142.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_supplies = { remove_tooltip = yes loss = 10 }
		change_party_loot = { remove_tooltip = yes loss = 175 }
		change_party_morale = { remove_tooltip = yes loss = 1 }
		change_party_manpower = { remove_tooltip = yes loss = 750 }
	}
}

# Restlesss Dwarves spirit
province_event = {
	id = diggy_encounter.150
	title = diggy_encounter.150.t
	desc = diggy_encounter.150.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		expedition_danger_level = { min = 1 max = 3 }
	}
	
	immediate = {
	}
	
	after = {
	}
	
	# Fight them
	option = {
        name = diggy_encounter.150.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 60 # They stare in silence, uneasing feeling
			success_id = 151
			
			base_failure = 40 # They spook our party
			failure_id = 152
		}
	}
	
	# They sheer us up and lead us to a gold cache
	option = {
        name = diggy_encounter.150.b
        ai_chance = { factor = 100 }
		trigger = {
			owner = { has_country_modifier = dwarven_administration }
		}
		highlight = yes
		change_party_loot = { add_tooltip = yes add = 100 }
		change_party_morale = { add_tooltip = yes add = 0.5 }
		continue_expedition = yes
	}
}

# They stare in silence, uneasing feeling
province_event = {
	id = diggy_encounter.151
	title = diggy_encounter.151.t
	desc = diggy_encounter.151.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.151.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { remove_tooltip = yes loss = 0.5 }
	}
}

# They spook our party
province_event = {
	id = diggy_encounter.152
	title = diggy_encounter.152.t
	desc = diggy_encounter.152.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		always = yes
	}
	
	immediate = {
	}
	
	after = {
		continue_expedition = yes
	}
	
	option = {
        name = diggy_encounter.152.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		change_party_morale = { remove_tooltip = yes loss = 1 }
	}
}

# Otyugh herd
province_event = {
	id = diggy_encounter.160
	title = diggy_encounter.160.t
	desc = diggy_encounter.160.d
	picture = MULTI_RACIAL_MERC_eventPicture

	is_triggered_only = yes
	
	trigger = {
		expedition_danger_level = { min = 2 max = 5 }
		OR = {
			has_terrain = dwarven_road
			has_terrain = dwarven_hold
			has_terrain = dwarven_hold_surface
		}
	}
	
	immediate = {
	}
	
	after = {
	}
	
	# Fight them heads on
	option = {
        name = diggy_encounter.160.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 65 # costly victory
			success_id = 161
			
			base_failure = 35 # decimated
			failure_id = 162
		}
	}
	
	# Try to ambush them
	option = {
        name = diggy_encounter.160.a
        ai_chance = { factor = 100 }
		trigger = {
			always = yes
		}
		encounter_effect = {
			base_success = 5 # Surprisingly it work
			success_id = 163
			
			base_failure = 95 # They have night vision and fuck us
			failure_id = 164
		}
	}
}
