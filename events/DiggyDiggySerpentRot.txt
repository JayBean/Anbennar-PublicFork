
namespace = serpent_rot

#Starting Event
country_event = {
	id = serpent_rot.1
	title = serpent_rot.1.t
	desc = serpent_rot.1.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	major = yes
	trigger = {
		always = yes
	}
	
	immediate = {
		hidden_effect = {
			REB = {
				set_variable = {
					which = serpentCureGlobal
					value = 0
				}
				set_variable = {
					which = countryInfectedVariable
					value = 1
				}
			}
			set_variable = {
				which = serpentCureNational
				value = 0
			}
		}
	}
	
	option = {
        name = serpent_rot.1.a
        ai_chance = { factor = 100 }
		random_owned_province = {
			limit = { has_province_flag = caurak_collapse }
			add_permanent_province_modifier = {
				name = serpent_rot_1
				duration = -1
			}
		}
		hidden_effect = { 
			set_global_flag = serpent_rot_happening
			country_event = { id = serpent_rot.6 days = 50 }
		}
	}
}
##The disease spread
province_event = {
	id = serpent_rot.2
	title = serpent_rot.2.t
	desc = serpent_rot.2.d
	picture = ARTWORK_eventPicture
	hidden = yes
	
	mean_time_to_happen = {
		months = 6
		
		modifier = {
			factor = 0.9
			any_neighbor_province = {
				has_province_modifier = serpent_rot_2
			}
		}
		
		modifier = {
			factor = 1.1
			NOT = { development = 10 }
		}
		
		modifier = {
			factor = 0.9
			development = 15
		}
		
		modifier = {
			factor = 0.9
			development = 20
		}
		
		modifier = {
			factor = 0.9
			development = 30
		}
		
		modifier = {
			factor = 0.9
			development = 40
		}
		
		modifier = {
			factor = 0.9
			development = 50
		}
		
		modifier = {
			factor = 1.1
			
			owner = { has_country_flag = burn_the_corpse }
		}
		
		modifier = {
			factor = 1.1
			
			owner = { has_country_flag = burn_the_village }
		}
		
		modifier = {
			factor = 2
			
			has_province_modifier = using_fire
		}
		
		modifier = {
			factor = 5
			
			trade_goods = fungi
		}
		
		modifier = {
			factor = 5
			
			has_global_flag = serpent_rot_happened
		}
	}
	
	trigger = {
		has_global_flag = serpent_rot_happening
		continent = serpentspine
		is_city = yes
		NOT = { has_province_modifier = serpent_rot_1 }
		NOT = { has_province_modifier = serpent_rot_2 }
		NOT = { has_province_modifier = serpent_cure }
		any_neighbor_province = {
			OR = {
				has_province_modifier = serpent_rot_1
				has_province_modifier = serpent_rot_2
			}
		}
	}
	
	immediate = {
		hidden_effect = {
			add_permanent_province_modifier = {
				name = serpent_rot_1
				duration = -1
			}
		}
	}
	
	option = {
        name = serpent_rot.2.a
        ai_chance = { factor = 100 }
		tooltip = {
			add_permanent_province_modifier = {
				name = serpent_rot_1
				duration = -1
			}
		}
	}
}

#The disease become extremely present in the province
province_event = {
	id = serpent_rot.3
	title = serpent_rot.3.t
	desc = serpent_rot.3.d
	picture = ARTWORK_eventPicture
	hidden = yes
	mean_time_to_happen = {
		years = 4
		
		modifier = {
			factor = 0.8
			any_neighbor_province = {
				has_province_modifier = serpent_rot_2
			}
		}
	}
	
	trigger = {
		has_global_flag = serpent_rot_happening
		has_province_modifier = serpent_rot_1
		NOT = { has_province_modifier = serpent_rot_2 }
		NOT = { has_province_modifier = serpent_cure }
	}
	
	immediate = {
		hidden_effect = {
			add_permanent_province_modifier = {
				name = serpent_rot_2
				duration = -1
			}
			remove_province_modifier = serpent_rot_1
		}
	}
	
	option = {
        name = serpent_rot.3.a
        ai_chance = { factor = 100 }
		tooltip = {
			add_permanent_province_modifier = {
				name = serpent_rot_2
				duration = -1
			}
			remove_province_modifier = serpent_rot_1
		}
	}
}

#The disease has spread to a new country
country_event = {
	id = serpent_rot.4
	title = serpent_rot.4.t
	desc = serpent_rot.4.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		months = 3
	}
	
	immediate = {
		hidden_effect = {
			REB = {
				change_variable = {
					which = countryInfectedVariable
					value = 1
				}
			}
			set_variable = {
				which = serpentCureNational
				value = 0
			}
		}
		hidden_effect = { save_yearly_income = yes }
	}
	
	trigger = {
		has_global_flag = serpent_rot_happening
		NOT = { has_global_flag = serpent_rot_happened }
		any_owned_province = {
			continent = serpentspine
			OR = {
				has_province_modifier = serpent_rot_1
				has_province_modifier = serpent_rot_2
			}
			NOT = { has_province_modifier = serpent_cure }
		}
		NOT = { has_disaster = serpent_rot }
		NOT = { has_country_modifier = serpent_rot_outbreak }
		NOT = { has_country_modifier = ignoring_serpent_rot }
	}
	
	
	option = {
        name = serpent_rot.4.a
        ai_chance = { factor = 1 }
		add_country_modifier = {
			name = serpent_rot_outbreak
			duration = 5475
		}
		country_event = { id = serpent_rot.6 days = 15 }
	}
	
	option = {
		name = serpent_rot.4.b
		highlight = yes
		trigger = { 
			NOT = {
				OR = { 
					capital_scope = { continent = serpentspine }
					AND = {
						OR = {
							any_owned_province = { has_terrain = dwarven_hold }
							any_owned_province = { has_terrain = dwarven_hold_surface }
						}
						OR = {
							has_country_modifier = dwarven_administration
							has_country_modifier = goblin_administration
							has_country_modifier = orcish_administration
						}
					}
				}
			} 
		}
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		custom_tooltip = serpent_rot.4.tt
		hidden_effect = {
			every_owned_province = {
				limit = { continent = serpentspine }
				add_unrest = 20
			}
			add_country_modifier = {
				name = ignoring_serpent_rot
				duration  = 3650 #5 years
				hidden = yes
			}
			REB = {
				subtract_variable = {
					which = countryInfectedVariable
					value = 1
				}
			}
		}
	}
}

#Lose dev
province_event = {
	id = serpent_rot.5
	title = serpent_rot.5.t
	desc = serpent_rot.5.d
	picture = ARTWORK_eventPicture
	hidden = yes
	mean_time_to_happen = {
		years = 3
		
		modifier = {
			factor = 0.5
			
			has_province_modifier = serpent_rot_2
		}
		
		modifier = {
			factor = 1.3
			
			owner = { has_country_flag = quarantine_zone }
		}
	}
	
	trigger = {
		has_global_flag = serpent_rot_happening
		OR = {
			has_province_modifier = serpent_rot_1
			has_province_modifier = serpent_rot_2
		}
	}
	
	
	option = {
        name = serpent_rot.5.a
        ai_chance = { factor = 100 }
		random_list = {
			33 = { add_base_production = -1 }
			33 = { add_base_tax = -1 }
			33 = { add_base_manpower = -1 }
		}
	}
}

########################
### Event chain to find a cure
########################

### We need to find a remedy
country_event = {
	id = serpent_rot.6
	title = serpent_rot.6.t
	desc = serpent_rot.6.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	## It must be an old forgotten dark spell
	option = {
        name = serpent_rot.6.a
        ai_chance = { factor = 100 }
		hidden_effect = { country_event = { id = serpent_rot.24 days = 50 } } #Start magic path
	}
	## We should focus on the sick
	option = {
        name = serpent_rot.6.b
        ai_chance = { factor = 100 }
		hidden_effect = { country_event = { id = serpent_rot.7 days = 50 } } #Start science path
	}
	
	## Don't have to make a cure for one province
	option = {
		highlight = yes
		trigger = { 
			NOT = {
				OR = { 
					capital_scope = { continent = serpentspine }
					any_owned_province = { has_terrain = dwarven_hold }
					any_owned_province = { has_terrain = dwarven_hold_surface }
				}
			} 
		}
        name = serpent_rot.6.c
        ai_chance = { factor = 0 }
		every_owned_province = {
			limit = { continent = serpentspine }
			add_unrest = 20
		}
	}
}

###Science path start
country_event = {
	id = serpent_rot.7
	title = serpent_rot.7.t
	desc = serpent_rot.7.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	## Study Origin
	option = {
        name = serpent_rot.7.a
        ai_chance = { factor = 100 }
		trigger = {
			any_owned_province = { has_province_flag = caurak_collapse }
		}
		hidden_effect = {
			country_event = { id = serpent_rot.8 days = 365 random = 100 } ##It's from the cave, all the team die
			country_event = { id = serpent_rot.10 days = 600 random = 100 } ##What to do next
		}
	}
	## Study sick corpse
	option = {
        name = serpent_rot.7.b
        ai_chance = { factor = 100 }
		hidden_effect = {
			country_event = { id = serpent_rot.9 days = 365 random = 100 } ##It's from their blood
			country_event = { id = serpent_rot.10 days = 600 random = 100 } ##What to do next
		}
	}
	#Fight it with fire
	option = {
        name = serpent_rot.7.c
        ai_chance = { factor = 100 }
		hidden_effect = { country_event = { id = serpent_rot.17 days = 650 random = 100 } } ##Fight with fire path
	}
}

#We learn it's a disease coming from the cave
country_event = {
	id = serpent_rot.8
	title = serpent_rot.8.t
	desc = serpent_rot.8.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	option = {
        name = serpent_rot.8.a
        ai_chance = { factor = 100 }
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 3
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 3
			}
		}
	}
}

#We learn it's a disease rooted in the blood of it's victim
country_event = {
	id = serpent_rot.9
	title = serpent_rot.9.t
	desc = serpent_rot.9.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	option = {
        name = serpent_rot.9.a
        ai_chance = { factor = 100 }
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 5
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 5
			}
		}
	}
}

#What to do next
country_event = {
	id = serpent_rot.10
	title = serpent_rot.10.t
	desc = serpent_rot.10.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	immediate = {
		hidden_effect = { save_yearly_income = yes }
	}
	
	#We should run experiment on alive dude
	option = {
        name = serpent_rot.10.a
        ai_chance = { factor = 100 }
		reduce_stability_or_adm_power = yes
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.11 days = 365 random = 100 } ##A blood disease
		}
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 5
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 5
			}
		}
	}
	#create quarantine zone
	option = {
        name = serpent_rot.10.b
        ai_chance = { factor = 100 }
		#add_years_of_income = -1
		custom_tooltip = pay_year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=YearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.11 days = 465 random = 50 } #A blood disease
			set_country_flag = quarantine_zone
		}
	}
}

##A blood disease
country_event = {
	id = serpent_rot.11
	title = serpent_rot.11.t
	desc = serpent_rot.11.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	immediate = {
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 5
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 5
			}
		}
		hidden_effect = { save_yearly_income = yes }
	}
	
	#We should run experiment on alive dude
	option = {
        name = serpent_rot.11.a
        ai_chance = { factor = 100 }
		reduce_stability_or_adm_power = yes
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.12 days = 365 random = 100 } ##Spread through air, sensible to fire
			hidden_effect = {
				REB = {
					change_variable = {
						which = serpentCureGlobal
						value = 5
					}
				}
				change_variable = {
					which = serpentCureNational
					value = 5
				}
			}
		}
	}
	#Study blood sample
	option = {
        name = serpent_rot.11.b
        ai_chance = { factor = 100 }
		#add_years_of_income = -1
		custom_tooltip = pay_year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=YearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.12 days = 465 random = 50 } #Spread through air, sensible to fire
			hidden_effect = {
				REB = {
					change_variable = {
						which = serpentCureGlobal
						value = 5
					}
				}
				change_variable = {
					which = serpentCureNational
					value = 5
				}
			}
		}
	}
}

#We learn that it spread through air and is sensible to fire
country_event = {
	id = serpent_rot.12
	title = serpent_rot.12.t
	desc = serpent_rot.12.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	immediate = {
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 5
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 5
			}
		}
		hidden_effect = { save_yearly_income = yes }
	}
	
	#Look in ancient book
	option = {
        name = serpent_rot.12.a
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.13 days = 150 random = 100 } ##Discover that you need the Pristine Fungi to cure it
			country_event = { id = serpent_rot.14 days = 465 random = 100 } ##Cure soon done, last ingredient
		}
	}
	#Study blood sample
	option = {
        name = serpent_rot.12.b
        ai_chance = { factor = 100 }
		#add_years_of_income = -1
		custom_tooltip = pay_year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=YearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.14 days = 365 random = 50 } #Cure soon done, last ingredient
		}
	}
	#Fight it with fire
	option = {
        name = serpent_rot.12.c
        ai_chance = { factor = 100 }
		hidden_effect = {
			country_event = { id = serpent_rot.17 days = 465 random = 50 } #fight it with fire
		}
	}
}
#We learn about the Pristine Fungi to cure it
country_event = {
	id = serpent_rot.13
	title = serpent_rot.13.t
	desc = serpent_rot.13.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	#Ok
	option = {
        name = serpent_rot.13.a
        ai_chance = { factor = 100 }
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 5
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 5
			}
		}
	}
}
###Cure soon done, need to search for the last ingredient
country_event = {
	id = serpent_rot.14
	title = serpent_rot.14.t
	desc = serpent_rot.14.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}

	immediate = {
		hidden_effect = { save_yearly_income = yes }
	}
	
	#Dragon's Tongue
	option = {
        name = serpent_rot.14.a
        ai_chance = { factor = 100 }
		#add_years_of_income = -1
		custom_tooltip = pay_year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=YearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.15 days = 650 }
		}
	}
	#Pristine Fungi
	option = {
        name = serpent_rot.14.b
        ai_chance = { factor = 100 }
		#add_years_of_income = -1
		custom_tooltip = pay_year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=YearOfIncome }
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 10
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 10
			}
		}
	}
	#Purple Grass
	option = {
        name = serpent_rot.14.c
        ai_chance = { factor = 100 }
		#add_years_of_income = -1
		custom_tooltip = pay_year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=YearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.15 days = 365 }
		}
	}
}
##We find the cure, hidden event
country_event = {
	id = serpent_rot.15
	title = serpent_rot.15.t
	desc = serpent_rot.15.d
	picture = ARTWORK_eventPicture
	fire_only_once = yes
	hidden = yes
	mean_time_to_happen = {
		months = 9
		
		modifier = {
			factor = 0.5
			check_variable = {
				which = serpentCureNational
				value = 105
			}
		}
		
		modifier = {
			factor = 0.5
			check_variable = {
				which = serpentCureNational
				value = 110
			}
		}
		modifier = {
			factor = 0.5
			check_variable = {
				which = serpentCureNational
				value = 115
			}
		}
		modifier = {
			factor = 0.5
			check_variable = {
				which = serpentCureNational
				value = 120
			}
		}
		modifier = {
			factor = 2
			ai = yes
		}
	}
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
		OR = {
			check_variable = {
				which = serpentCureNational
				value = 100
			}
			if = {
				limit = { 
					REB = {
						check_variable = {
							which = countryInfectedVariable
							value = 3
						}
					}
				}
				REB = {
					check_variable = {
						which = serpentCureGlobal
						value = 275
					}
				}
			}
			else_if = {
				limit = { 
					REB = {
						check_variable = {
							which = countryInfectedVariable
							value = 2
						}
					}
				}
				REB = {
					check_variable = {
						which = serpentCureGlobal
						value = 200
					}
				}
			}
			else_if = {
				limit = { 
					REB = {
						check_variable = {
							which = countryInfectedVariable
							value = 1
						}
					}
				}
				REB = {
					check_variable = {
						which = serpentCureGlobal
						value = 115
					}
				}
			}
		}
	}
	
	option = {
        name = serpent_rot.15.a
        ai_chance = { factor = 100 }
		set_country_flag = serpent_rot_cure
		set_global_flag = serpent_rot_happened
		country_event = { id = serpent_rot.16 }
	}
}
##Ending event, we've find the cure
country_event = {
	id = serpent_rot.16
	title = serpent_rot.16.t
	desc = serpent_rot.16.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	major = yes
	trigger = {
		always = yes
	}
	
	option = {
        name = serpent_rot.16.a
        ai_chance = { factor = 1 }
		add_prestige = 50
		add_stability = 3
		custom_tooltip = serpent_cure_tooltip
		if = {
			limit = { capital_scope = { continent = serpentspine OR = { has_province_modifier = serpent_rot_1 has_province_modifier = serpent_rot_2} } }
			capital_scope = {
				add_permanent_province_modifier = {
					name = serpent_cure
					duration = 3650
				}
			}
		} 
		else = {
			random_owned_province = {
				limit = { continent = serpentspine OR = { has_province_modifier = serpent_rot_1 has_province_modifier = serpent_rot_2} } 
				add_permanent_province_modifier = {
					name = serpent_cure
					duration = 3650
				}
			}
		}
		hidden_effect = {
			clr_country_flag = burn_the_corpse
			clr_country_flag = quarantine_zone
			clr_country_flag = fight_it_with_fire
		}
	}
	
	option = {
        name = serpent_rot.16.b
        ai_chance = { 
			factor = 100
			
			modifier = {
				factor = 0
				OR = {
					ruler_has_personality = malevolent_personality
					ruler_has_personality = cruel_personality
				}
			}
		}
		trigger = { 
			any_owned_province = { OR = { has_terrain = dwarven_hold has_terrain = dwarven_hold_surface } }
		}
		add_prestige = 50
		add_stability = 3
		custom_tooltip = serpent_cure_ventilation_tooltip
		add_country_modifier = {
			name = cure_bringer
			duration = 36500
		}
		serpentspine = {
			limit = {
				OR = {
					has_terrain = dwarven_hold
					has_terrain = dwarven_hold_surface
					has_terrain = dwarven_road
				}
			}
			add_permanent_province_modifier = {
				name = serpent_cure
				duration = 3650
			}
		}
		hidden_effect = {
			clr_country_flag = burn_the_corpse
			clr_country_flag = quarantine_zone
			clr_country_flag = fight_it_with_fire
		}
	}
}
###Figth it with fire
country_event = {
	id = serpent_rot.17
	title = serpent_rot.17.t
	desc = serpent_rot.17.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	immediate = {
		hidden_effect = { set_country_flag = fight_it_with_fire }
		hidden_effect = { save_yearly_income = yes }
	}
	
	## Inspect every house
	option = {
        name = serpent_rot.17.a
        ai_chance = { factor = 100 }
		#add_years_of_income = -1
		custom_tooltip = pay_year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=YearOfIncome }
		hidden_effect = { 
			country_event = { id = serpent_rot.18 days = 300 }
			country_event = { id = serpent_rot.19 days = 465 random = 100 }
		}
	}
	## burn the corpse
	option = {
        name = serpent_rot.17.b
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		reduce_stability_or_adm_power = yes
		hidden_effect = { 
			country_event = { id = serpent_rot.19 days = 465 random = 100 }
			set_country_flag = burn_the_corpse
		}
	}
}
## The house eating pristine fungi are less sick
country_event = {
	id = serpent_rot.18
	title = serpent_rot.18.t
	desc = serpent_rot.18.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	#Ok
	option = {
        name = serpent_rot.18.a
        ai_chance = { factor = 100 }
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 5
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 5
			}
		}
	}
}
#Spread seem to slowdown
country_event = {
	id = serpent_rot.19
	title = serpent_rot.19.t
	desc = serpent_rot.19.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	immediate = {
		hidden_effect = {
			save_yearly_income = yes
		}
	}
	
	#Try to spread incandescent powder through the ventilation system
	option = {
        name = serpent_rot.19.a
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		hidden_effect = { 
			country_event = { id = serpent_rot.20 days = 265 random = 50 } #Big Explosion
			country_event = { id = serpent_rot.21 days = 465 random = 100 } #Healthy carrier
		}
	}
	#Burn some village if necessary
	option = {
        name = serpent_rot.19.b
		ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		add_stability = -2
		hidden_effect = { 
			country_event = { id = serpent_rot.21 days = 465 random = 100 } #Healthy carrier
			set_country_flag = burn_the_village
		}
	}
}
#The [Root.Capital.GetName] Incandescant disaster of [GetYears] 
country_event = {
	id = serpent_rot.20
	title = serpent_rot.20.t
	desc = serpent_rot.20.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	#Big explosion
	option = {
        name = serpent_rot.20.a
        ai_chance = { factor = 100 }
		capital_scope = {
			if = {
				limit = { has_province_modifier = dig_6 }
				remove_province_modifier = dig_6
				add_permanent_province_modifier = {
					name = dig_5
					duration = -1
				}
			}
			else_if = {
				limit = { has_province_modifier = dig_7 }
				remove_province_modifier = dig_7
				add_permanent_province_modifier = {
					name = dig_6
					duration = -1
				}
			}
			else_if = {
				limit = { has_province_modifier = dig_8 }
				remove_province_modifier = dig_8
				add_permanent_province_modifier = {
					name = dig_7
					duration = -1
				}
			}
			else_if = {
				limit = { has_province_modifier = dig_9 }
				remove_province_modifier = dig_9
				add_permanent_province_modifier = {
					name = dig_8
					duration = -1
				}
			}
			else_if = {
				limit = { has_province_modifier = dig_10 }
				remove_province_modifier = dig_10
				add_permanent_province_modifier = {
					name = dig_9
					duration = -1
				}
			}
			else_if = {
				limit = { has_province_modifier = dig_11 }
				remove_province_modifier = dig_11
				add_permanent_province_modifier = {
					name = dig_10
					duration = -1
				}
			}
			add_base_manpower = -1
			add_base_tax = -1
			add_base_production = -1
		}
		capital_scope = {
			area = {
				add_base_manpower = -2
				add_base_tax = -2
				add_base_production = -2
			}
		}
		add_stability = -2
	}
}
##Healthy carrier
country_event = {
	id = serpent_rot.21
	title = serpent_rot.21.t
	desc = serpent_rot.21.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	immediate = {
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 5
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 5
			}
			save_yearly_income = yes
		}
	}
	
	#Run experiment on him
	option = {
        name = serpent_rot.21.a
        ai_chance = { factor = 100 }
		#add_years_of_income = -1
		custom_tooltip = pay_year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=YearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.23 days = 365 }
			hidden_effect = {
				REB = {
					change_variable = {
						which = serpentCureGlobal
						value = 5
					}
				}
				change_variable = {
					which = serpentCureNational
					value = 5
				}
			}
		}
	}
	#Drown Mycos Caurak under fire
	option = {
		trigger = { any_owned_province = { has_province_flag = caurak_collapse } }
        name = serpent_rot.21.b
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.22 days = 100 }
			country_event = { id = serpent_rot.23 days = 465 }
		}
	}
}
##Big explosion of Mycos Caurak
country_event = {
	id = serpent_rot.22
	title = serpent_rot.22.t
	desc = serpent_rot.22.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	option = {
        name = serpent_rot.22.a
        ai_chance = { factor = 100 }
		reduce_stability_or_adm_power = yes
		random_owned_province = {
			limit = { has_province_flag = caurak_collapse }
			add_base_manpower = -1
			add_base_tax = -1
			add_base_production = -1
		}
	}
}
##The Healthy Carrier admit eating lot of Pristine Fungi
country_event = {
	id = serpent_rot.23
	title = serpent_rot.23.t
	desc = serpent_rot.23.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	immediate = {
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 5
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 5
			}
			save_yearly_income = yes
		}
	}
	
	#Run experiment on him
	option = {
        name = serpent_rot.23.a
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.14 days = 365 }
		}
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 5
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 5
			}
		}
	}
	#Collect sample
	option = {
        name = serpent_rot.23.b
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.75
		custom_tooltip = pay_year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=YearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.14 days = 465 }
		}
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 3
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 3
			}
		}
	}
	#Burn all the Pristine Fungi
	option = {
        name = serpent_rot.23.c
        ai_chance = { factor = 100 }
		#add_years_of_income = -3
		custom_tooltip = pay_3year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=3YearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.14 days = 750 }
		}
	}
}

###Magic path
#What kind of spell can this be ?
country_event = {
	id = serpent_rot.24
	title = serpent_rot.24.t
	desc = serpent_rot.24.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	immediate = {
		hidden_effect = {
			save_yearly_income = yes
		}
	}
	
	##Enchantment
	option = {
        name = serpent_rot.24.a
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.25 days = 565 random = 100 }
		}
	}
	#Necromancy
	option = {
        name = serpent_rot.24.b
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.25 days = 465 random = 100 }
		}
	}
	#Evocation
	option = {
        name = serpent_rot.24.c
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.25 days = 750 random = 100 }
		}
	}
}

#Look like Necromancy
country_event = {
	id = serpent_rot.25
	title = serpent_rot.25.t
	desc = serpent_rot.25.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	immediate = {
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 3
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 3
			}
			save_yearly_income = yes
		}
	}
	
	##Search for the caster
	option = {
        name = serpent_rot.25.a
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.27 days = 650 random = 100 }
		}
	}
	#Study the spell
	option = {
        name = serpent_rot.25.b
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.27 days = 550 random = 100 }
		}
	}
	#Search for clue in Mycos Caurak
	option = {
        name = serpent_rot.25.c
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		hidden_effect = {
			country_event = { id = serpent_rot.26 days = 250 random = 100 }
			country_event = { id = serpent_rot.27 days = 750 random = 100 }
		}
	}
}

#All magician team die
country_event = {
	id = serpent_rot.26
	title = serpent_rot.26.t
	desc = serpent_rot.26.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	#Damn it
	option = {
        name = serpent_rot.26.a
        ai_chance = { factor = 100 }
		reduce_stability_or_adm_power = yes
	}
}

##Natural disease rather than a spell, we were wrong
country_event = {
	id = serpent_rot.27
	title = serpent_rot.27.t
	desc = serpent_rot.27.d
	picture = ARTWORK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	immediate = {
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 6
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 6
			}
		}
		hidden_effect = { save_yearly_income = yes }
	}
	
	#Run experiment
	option = {
        name = serpent_rot.27.a
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		add_prestige = -25
		add_stability = -2
		hidden_effect = {
			country_event = { id = serpent_rot.7 days = 50 random = 20 }
		}
	}
	#Fight it with fire
	option = {
        name = serpent_rot.27.b
        ai_chance = { factor = 100 }
		#add_years_of_income = -0.5
		custom_tooltip = pay_0.5year_of_income
		currency_effect = { currency=treasury takeFrom=ROOT which=HalfYearOfIncome }
		add_prestige = -25
		reduce_stability_or_adm_power = yes
		hidden_effect = {
			country_event = { id = serpent_rot.17 days = 50 random = 20 }
		}
	}
}

##No more serpent rot in our country
country_event = {
	id = serpent_rot.28
	title = serpent_rot.28.t
	desc = serpent_rot.28.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		months = 6
	}
	
	immediate = {
		hidden_effect = {
			REB = {
				subtract_variable = {
					which = countryInfectedVariable
					value = 1
				}
			}
		}
	}
	
	trigger = {
		has_country_modifier = serpent_rot_outbreak
		all_owned_province = {
			NOT = { has_province_modifier = serpent_rot_1 }
			NOT = { has_province_modifier = serpent_rot_2 }
		}
	}
	
	option = {
        name = serpent_rot.28.a
        ai_chance = { factor = 100 }
		remove_country_modifier = serpent_rot_outbreak
	}
}

###Random event during disaster
#Establish hospital in the province
province_event = {
	id = serpent_rot.29
	title = serpent_rot.29.t
	desc = serpent_rot.29.d
	picture = ARTWORK_eventPicture
	goto = root
	
	is_mtth_scaled_to_size = 1
	mean_time_to_happen = {
		years = 1
	}
	
	trigger = {
		owner = {
			OR = {
				has_disaster = serpent_rot
				has_country_modifier = serpent_rot_outbreak
			}
			NOT = { has_global_flag = serpent_rot_happened }
		}
		OR = {
			has_province_modifier = serpent_rot_1
			has_province_modifier = serpent_rot_2
		}
		NOT = { has_province_modifier = local_emergency_hospital }
	}
	
	option = {
        name = serpent_rot.29.a
        ai_chance = { factor = 100 }
		owner = {
		add_prestige = 5
		add_treasury = -100
		}
		add_province_modifier = {
			name = local_emergency_hospital
			duration = 1825
		}
		custom_tooltip = serpent_rot_hospital_tooltip
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 2
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 2
			}
		}
	}
	option = {
        name = serpent_rot.29.b
        ai_chance = { factor = 100 }
		owner = { add_prestige = -5 }
	}
}
##A breakthrought in our research
country_event = {
	id = serpent_rot.30
	title = serpent_rot.30.t
	desc = serpent_rot.30.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 3
	}
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
		has_country_flag = finance_research
	}
	
	option = {
        name = serpent_rot.30.a
        ai_chance = { factor = 100 }
		add_prestige = 15
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 10
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 10
			}
		}
	}
}

#A genius researcher make our research go up by a mile
country_event = {
	id = serpent_rot.31
	title = serpent_rot.31.t
	desc = serpent_rot.31.d
	picture = ARTWORK_eventPicture
	
	fire_only_once = yes
	major = yes
	mean_time_to_happen = {
		years = 10
	}
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
		has_country_flag = finance_research
	}
	
	option = {
        name = serpent_rot.31.a
        ai_chance = { factor = 100 }
		add_prestige = 15
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 30
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 15
			}
		}
	}
}

##Population ask for more effort put into research
country_event = {
	id = serpent_rot.32
	title = serpent_rot.32.t
	desc = serpent_rot.32.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 2
	}
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
		has_country_flag = finance_research
	}
	#We will, let's invest more.
	option = {
        name = serpent_rot.32.a
        ai_chance = { factor = 100 }
		add_treasury = -350
		add_adm_power = -150
		add_dip_power = -50
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 1
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 2
			}
		}
	}
	#Use them as test subject
	option = {
        name = serpent_rot.32.b
        ai_chance = { factor = 100 }
		random = {
			chance = 50
			reduce_stability_or_adm_power = yes
		}
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 1
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 3
			}
		}
	}
	#Screw them
	option = {
        name = serpent_rot.32.c
        ai_chance = { factor = 100 }
		random_owned_province = {
			create_revolt = 2
		}
	}
}

##Finance research
country_event = {
	id = serpent_rot.33
	title = serpent_rot.33.t
	desc = serpent_rot.33.d
	picture = ARTWORK_eventPicture
	
	mean_time_to_happen = {
		years = 2
	}
	
	trigger = {
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
		has_country_flag = finance_research
	}
	#Big investment
	option = {
        name = serpent_rot.33.a
        ai_chance = { factor = 100 }
		add_treasury = -500
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 2
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 3
			}
		}
	}
	
	#Middle investment
	option = {
        name = serpent_rot.33.b
        ai_chance = { factor = 100 }
		add_treasury = -350
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 1
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 2
			}
		}
	}
	#Low investment
	option = {
        name = serpent_rot.33.c
        ai_chance = { factor = 100 }
		add_treasury = -150
		hidden_effect = {
			REB = {
				change_variable = {
					which = serpentCureGlobal
					value = 0
				}
			}
			change_variable = {
				which = serpentCureNational
				value = 1
			}
		}
	}
	#Nothing
	option = {
        name = serpent_rot.33.e
        ai_chance = { factor = 100 }
		add_prestige = -5
	}
}

#####################
###cure Event
####################
##Curing province
province_event = {
	id = serpent_rot.100
	title = serpent_rot.100.t
	desc = serpent_rot.100.d
	picture = ARTWORK_eventPicture
	hidden = yes
	
	mean_time_to_happen = {
		months = 6
	}
	
	trigger = {
		has_global_flag = serpent_rot_happened
		OR = {
			has_province_modifier = serpent_rot_1
			has_province_modifier = serpent_rot_2
		}
		has_province_modifier = serpent_cure
	}
	
	#Province slowing curing
	option = {
        name = serpent_rot.100.a
        ai_chance = { factor = 100 }
		if = {
			limit = { has_province_modifier = serpent_rot_2 }
			remove_province_modifier = serpent_rot_2
			add_permanent_province_modifier = {
				name = serpent_rot_1
				duration = -1
			}
		}
		else_if = {
			limit = { has_province_modifier = serpent_rot_1 }
			remove_province_modifier = serpent_rot_1
		}
	}
}
#Cure spread
province_event = {
	id = serpent_rot.101
	title = serpent_rot.101.t
	desc = serpent_rot.101.d
	picture = ARTWORK_eventPicture
	hidden = yes
	
	mean_time_to_happen = {
		months = 6
	}
	
	trigger = {
		has_global_flag = serpent_rot_happened
		OR = {
			has_province_modifier = serpent_rot_1
			has_province_modifier = serpent_rot_2
		}
		NOT = { has_province_modifier = serpent_cure }
		any_neighbor_province = {
			has_province_modifier = serpent_cure
		}
	}
	
	#Province slowing curing
	option = {
        name = serpent_rot.101.a
        ai_chance = { factor = 100 }
		add_permanent_province_modifier = {
			name = serpent_cure
			duration = 3650
		}
	}
}

##Stacking research every years
country_event = {
	id = serpent_rot.102
	title = serpent_rot.102.t
	desc = serpent_rot.102.d
	picture = ARTWORK_eventPicture
	hidden = yes
	
	mean_time_to_happen = {
		years = 1
	}
	
	trigger = {
		has_global_flag = serpent_rot_happening
		OR = {
			has_disaster = serpent_rot
			has_country_modifier = serpent_rot_outbreak
		}
		NOT = { has_global_flag = serpent_rot_happened }
	}
	
	#Province slowing curing
	option = {
        name = serpent_rot.102.a
        ai_chance = { factor = 100 }
		random_list = {
			50 = {
				change_variable = {
					which = serpentCureNational
					value = 1
				}
			}
			50 = {
				change_variable = {
					which = serpentCureNational
					value = 2
				}
			}
		}
		random_list = {
			50 = {
				REB = {
					change_variable = {
						which = serpentCureGlobal
						value = 1
					}
				}
			}
			50 = {
				REB = {
					change_variable = {
						which = serpentCureGlobal
						value = 2
					}
				}
			}
		}
	}
}