
namespace = magic_siege

#Magic Menu
country_event = {
	id = magic_siege.1
	title = magic_siege.1.t	#Have this title mention the target
	desc = magic_siege.1.d
	picture = SPELL_MENU_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		random_province = {
			limit = {
				fort_level = 1
				sieged_by = ROOT
				unit_has_leader = yes
				num_of_units_in_province = {
					who = ROOT
					amount = 1
				}
			}
			hidden_effect = {
				save_event_target_as = spell_target_province	#this works yo
			}
		}
	}
	
	#Close
	option = {	
		name = magic_siege.1.z
		ai_chance = {
			factor = 50
		}
		highlight = yes
		#some sort of tooltip
		
		close_single_menu = yes
		clr_ruler_flag = magic_just_casted_spell
		clr_ruler_flag = magic_siege_menu
	}
	
	#1 - Summon Siege Elemental
	option = {
		name = magic_ruler.2.c	#available
		trigger = {
			has_ruler_flag = conjuration_1
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				OR = {
					NOT = { adm_power = 20 }
					NOT = { dip_power = 20 }
					NOT = { mil_power = 20 }
				}
			}
		}
		
		country_event = { id = magic_siege.2 }
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			add_province_modifier = {
				name = siege_magic_elemental_besieger
				duration = 84
			}
		}
		custom_tooltip = magic_elemental_desc_tt
	}
	option = {
		name = magic_ruler.2.cm	#unavailable - low mastery
		trigger = {
			ai = no
			NOT = { has_ruler_flag = conjuration_1 }
		}
		set_country_flag = siege_magic_menu
		hidden_effect = { country_event = { id = magic_ruler.9 } }
		
		custom_tooltip = school_mastery_not_talented_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			add_province_modifier = {
				name = siege_magic_elemental_besieger
				duration = 84
			}
		}
		custom_tooltip = magic_elemental_desc_tt
	}
	
	#1 - #Fireball
	option = {
		name = magic_ruler.5.c	#available
		trigger = {
			has_ruler_flag = evocation_1
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { mil_power = 10 }
			}
		}
		
		country_event = { id = magic_siege.8 }
		if = {
			limit = { 
				OR = {
					has_ruler_flag = rakshasa_patron
					has_ruler_flag = manifestation_of_surael_patron
				} 
			}
			custom_tooltip = magic_booster_by_patron_tt
		}
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 1
		}
		custom_tooltip = magic_fireball_desc_tt
	}
	option = {
		name = magic_ruler.5.cm	#unavailable - low mastery
		trigger = {
			ai = no
			NOT = { has_ruler_flag = evocation_1 }
		}
		set_country_flag = siege_magic_menu
		hidden_effect = { country_event = { id = magic_ruler.9 } }
		
		custom_tooltip = school_mastery_not_talented_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 1
		}
		custom_tooltip = magic_fireball_desc_tt
	}
	
	#2 - Thunderstorm
	option = {
		name = magic_ruler.2.e	#available
		trigger = {
			has_ruler_flag = conjuration_2
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				OR = {
					NOT = { adm_power = 20 }
					NOT = { dip_power = 20 }
					NOT = { mil_power = 20 }
				}
			}
		}
		
		country_event = { id = magic_siege.17 }
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 5
			add_devastation = 5
			add_province_modifier = {
				name = siege_magic_thunderstorm
				duration = 182
			}
		}
		custom_tooltip = magic_thunderstorm_desc_tt
	}
	option = {
		name = magic_ruler.2.em	#unavailable - low mastery
		trigger = {
			ai = no
			NOT = { has_ruler_flag = conjuration_2 }
		}
		set_country_flag = siege_magic_menu
		hidden_effect = { country_event = { id = magic_ruler.9 } }
		
		custom_tooltip = school_mastery_not_renowned_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 5
			add_devastation = 5
			add_province_modifier = {
				name = siege_magic_thunderstorm
				duration = 182
			}
		}
		custom_tooltip = magic_thunderstorm_desc_tt
	}
	
	#2 - #Earthquake
	option = {
		name = magic_ruler.5.e	#available
		trigger = {
			has_ruler_flag = evocation_2
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { adm_power = 20 }
				NOT = { mil_power = 5 }
			}
		}
		
		country_event = { id = magic_siege.11 }
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 3
			add_province_modifier = {
				name = siege_magic_earthquake
				duration = 365
			}
			add_devastation = 10
		}
		custom_tooltip = magic_earthquake_desc_tt
	}
	option = {
		name = magic_ruler.5.em	#unavailable - low mastery
		trigger = {
			ai = no
			NOT = { has_ruler_flag = evocation_2 }
		}
		set_country_flag = siege_magic_menu
		hidden_effect = { country_event = { id = magic_ruler.9 } }
		
		custom_tooltip = school_mastery_not_renowned_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 3
			add_province_modifier = {
				name = siege_magic_earthquake
				duration = 365
			}
			add_devastation = 10
		}
		custom_tooltip = magic_earthquake_desc_tt
	}

	#2 - Shapechange into a Giant
	option = {
		name = magic_ruler.8.f	#available
		trigger = {
			has_ruler_flag = transmutation_2
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				current_age = age_of_revolutions
			}
		}

		country_event = { id = magic_siege.20 }
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		random_list = {
			30 = {
				tooltip = {
					add_province_modifier = {
						name = siege_magic_instant_siege
						duration = 3
					}
					add_devastation = 5
				}
			}
			70 = {
				tooltip = {
					add_province_modifier = {
						name = siege_magic_giant_besieger
						duration = 14
					}
				}
			}
		}
		custom_tooltip = magic_giant_desc_tt
	}
	option = {
		name = magic_ruler.8.fm	#unavailable - low mastery
		trigger = {
			ai = no
			NOT = { has_ruler_flag = transmutation_2 }
		}
		set_country_flag = siege_magic_menu
		hidden_effect = { country_event = { id = magic_ruler.9 } }

		custom_tooltip = school_mastery_not_renowned_tt

		custom_tooltip = magic_effect_separator_tt

		custom_tooltip = magic_if_siege_magic_succeeds_tt
		random_list = {
			30 = {
				tooltip = {
					add_province_modifier = {
						name = siege_magic_instant_siege
						duration = 3
					}
					add_devastation = 5
				}
			}
			70 = {
				tooltip = {
					add_province_modifier = {
						name = siege_magic_giant_besieger
						duration = 14
					}
				}
			}
		}
		custom_tooltip = magic_giant_desc_tt
	}

	#3 - Dominate to Surrender
	option = {
		name = magic_ruler.4.m	#available
		trigger = {
			has_ruler_flag = enchantment_3
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				OR = {
					NOT = { adm_power = 20 }
					NOT = { dip_power = 20 }
				}
			}
		}

		country_event = { id = magic_siege.5 }
		if = {
			limit = { has_ruler_flag = baku_patron }
			custom_tooltip = magic_booster_by_patron_tt
		}
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			add_province_modifier = {
				name = siege_magic_instant_siege
				duration = 3
			}
		}
		custom_tooltip = magic_dominate_desc_tt
	}
	option = {
		name = magic_ruler.4.mm	#unavailable - low mastery
		trigger = {
			ai = no
			NOT = { has_ruler_flag = enchantment_3 }
		}
		set_country_flag = siege_magic_menu
		hidden_effect = { country_event = { id = magic_ruler.9 } }

		custom_tooltip = school_mastery_not_legendary_tt

		custom_tooltip = magic_effect_separator_tt

		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			add_province_modifier = {
				name = siege_magic_instant_siege
				duration = 3
			}
		}
		custom_tooltip = magic_dominate_desc_tt
	}

	#3 - #Meteor Strike
	option = {
		name = magic_ruler.5.g	#available
		trigger = {
			OR = {
				has_ruler_flag = evocation_3
				AND = {
					has_ruler_flag = evocation_2
					has_ruler_flag = rakshasa_patron
				}
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { mil_power = 50 }
			}
		}
		
		country_event = { id = magic_siege.14 }
		if = {
			limit = {
				has_ruler_flag = rakshasa_patron
				NOT = { has_ruler_flag = evocation_3 }
			}
			custom_tooltip = magic_spell_available_by_patron_tt
		}
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 10
			add_devastation = 50
		}
		custom_tooltip = magic_meteor_desc_tt
	}
	option = {
		name = magic_ruler.5.gm	#unavailable - low mastery
		trigger = {
			ai = no
			NOT = { has_ruler_flag = evocation_3 }
			NOT = {
				AND = {
					has_ruler_flag = evocation_2
					has_ruler_flag = rakshasa_patron
				}
			}
		}
		set_country_flag = siege_magic_menu
		hidden_effect = { country_event = { id = magic_ruler.9 } }

		custom_tooltip = school_mastery_not_legendary_tt

		custom_tooltip = magic_effect_separator_tt

		custom_tooltip = magic_if_siege_magic_succeeds_tt
		tooltip = {
			change_siege = 10
			add_devastation = 50
		}
		custom_tooltip = magic_meteor_desc_tt
	}

	#3 - Shapechange into a Dragon
	option = {
		name = magic_ruler.8.j	#available
		trigger = {
			has_ruler_flag = transmutation_3
		}
		ai_chance = {
			factor = 50
		}

		country_event = { id = magic_siege.23 }
		custom_tooltip = magic_if_siege_magic_succeeds_tt
		random_list = {
			30 = {
				tooltip = {
					add_province_modifier = {
						name = siege_magic_instant_siege
						duration = 3
					}
					add_devastation = 10
				}
			}
			70 = {
				tooltip = {
					add_province_modifier = {
						name = siege_magic_dragon_besieger
						duration = 14
					}
				}
			}
		}
		custom_tooltip = magic_dragon_desc_tt
	}
	option = {
		name = magic_ruler.8.jm	#unavailable - low mastery
		trigger = {
			ai = no
			NOT = { has_ruler_flag = transmutation_3 }
		}
		set_country_flag = siege_magic_menu
		hidden_effect = { country_event = { id = magic_ruler.9 } }

		custom_tooltip = school_mastery_not_legendary_tt

		custom_tooltip = magic_effect_separator_tt

		custom_tooltip = magic_if_siege_magic_succeeds_tt
		random_list = {
			30 = {
				tooltip = {
					add_province_modifier = {
						name = siege_magic_instant_siege
						duration = 3
					}
					add_devastation = 10
				}
			}
			70 = {
				tooltip = {
					add_province_modifier = {
						name = siege_magic_dragon_besieger
						duration = 14
					}
				}
			}
		}
		custom_tooltip = magic_dragon_desc_tt
	}
}

############################################# CONJURATION #############################################

#Summon Siege Elemental
country_event = {
	id = magic_siege.2
	title = magic_siege.2.t
	desc = magic_siege.2.d
	picture = HUIZTILOPOCHTLI_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	# Come forth!
	option = {
		name = magic_siege.2.a
		ai_chance = {
			factor = 90
		}
		
		#Costs
		add_adm_power = -10	#Adm is concentration spells
		
		magic_casted_spell = yes
		add_ruler_modifier = { name = magic_siege_cooldown duration = 30 hidden = yes }
		
		#Success/Fail
		if = {
			limit = {
				#Conjuration 3
				event_target:spell_target_province = {
					fort_level = 1
					NOT = { fort_level = 4 }
				}
				has_ruler_flag = conjuration_3
			}
			set_country_flag = spell_1
			tooltip = {
				random_list = {
					90 = {
						country_event = { id = magic_siege.3 }
					}
					10 = {
						country_event = { id = magic_siege.4 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					#Conjuration 3
					AND = {
						event_target:spell_target_province = {
							fort_level = 4
							NOT = { fort_level = 6 }
						}
						has_ruler_flag = conjuration_3
					}
					#Conjuration 2
					AND = {
						event_target:spell_target_province = {
							fort_level = 1
							NOT = { fort_level = 4 }
						}
						has_ruler_flag = conjuration_2
					}
				}
			}
			set_country_flag = spell_2
			tooltip = {
				random_list = {
					80 = {
						country_event = { id = magic_siege.3 }
					}
					20 = {
						country_event = { id = magic_siege.4 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					#Conjuration 3
					AND = {
						event_target:spell_target_province = {
							fort_level = 6
							NOT = { fort_level = 8 }
						}
						has_ruler_flag = conjuration_3
					}
					#Conjuration 2
					AND = {
						event_target:spell_target_province = {
							fort_level = 4
							NOT = { fort_level = 6 }
						}
						has_ruler_flag = conjuration_2
					}
					#Conjuration 1
					AND = {
						event_target:spell_target_province = {
							fort_level = 1
							NOT = { fort_level = 4 }
						}
						has_ruler_flag = conjuration_1
					}
				}
			}
			set_country_flag = spell_3
			tooltip = {
				random_list = {
					70 = {
						country_event = { id = magic_siege.3 }
					}
					30 = {
						country_event = { id = magic_siege.4 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					#Conjuration 3
					AND = {
						event_target:spell_target_province = {
							fort_level = 8
						}
						has_ruler_flag = conjuration_3
					}
					#Conjuration 2
					AND = {
						event_target:spell_target_province = {
							fort_level = 6
							NOT = { fort_level = 8 }
						}
						has_ruler_flag = conjuration_2
					}
					#Conjuration 1
					AND = {
						event_target:spell_target_province = {
							fort_level = 4
							NOT = { fort_level = 6 }
						}
						has_ruler_flag = conjuration_1
					}
				}
			}
			set_country_flag = spell_4
			tooltip = {
				random_list = {
					60 = {
						country_event = { id = magic_siege.3 }
					}
					40 = {
						country_event = { id = magic_siege.4 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					#Conjuration 2
					AND = {
						event_target:spell_target_province = {
							fort_level = 8
						}
						has_ruler_flag = conjuration_2
					}
					#Conjuration 1
					AND = {
						event_target:spell_target_province = {
							fort_level = 6
							NOT = { fort_level = 8 }
						}
						has_ruler_flag = conjuration_1
					}
				}
			}
			set_country_flag = spell_5
			tooltip = {
				random_list = {
					50 = {
						country_event = { id = magic_siege.3 }
					}
					50 = {
						country_event = { id = magic_siege.4 }
					}
				}
			}
		}
		else_if = {
			limit = {
				#Conjuration 1
				event_target:spell_target_province = {
					fort_level = 8
				}
				has_ruler_flag = conjuration_1
			}
			set_country_flag = spell_6
			tooltip = {
				random_list = {
					40 = {
						country_event = { id = magic_siege.3 }
					}
					60 = {
						country_event = { id = magic_siege.4 }
					}
				}
			}
		}
		hidden_effect = { country_event = { id = magic_siege.100 } }
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 10
			modifier = {
				factor = 100
				NOT = { adm_power = 10 }
			}
		}
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				country_event = { id = magic_siege.1 }
			}
			else = {
				country_event = { id = magic_ruler.2 }
			}
		}
	}
	
}

#Summon Siege Elemental - Success
country_event = {
	id = magic_siege.3
	title = magic_siege.3.t
	desc = magic_siege.3.d
	picture = HUIZTILOPOCHTLI_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	
	option = {
		name = magic_siege.3.a
		ai_chance = {
			factor = 100
		}
		event_target:spell_target_province = { 
			#change_siege = 1	#if possible
			add_province_modifier = {
				name = siege_magic_elemental_besieger
				duration = 84
			}
		}
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.2 }
			}
		}
	}
}

#Summon Siege Elemental - Fail
country_event = {
	id = magic_siege.4
	title = magic_siege.4.t
	desc = magic_siege.4.d
	picture = HUIZTILOPOCHTLI_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	#Force Success
	option = {
		name = magic_siege.4.a
		ai_chance = {
			factor = 70
		}
		
		#Cost
		add_adm_power = -10
		
		#Spell
		event_target:spell_target_province = { 
			add_province_modifier = {
				name = siege_magic_elemental_besieger
				duration = 28
			}
		}
	}
	
	#Fail
	option = {
		name = magic_siege.4.b
		ai_chance = {
			factor = 30
			modifier = {
				factor = 100
				NOT = { adm_power = 20 } #if they dont have double it 
			}
		}
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.2 }
			}
		}
	}
	
}

# Conjuration 2: Thunderstorm
country_event = {
	id = magic_siege.17
	title = magic_siege.17.t
	desc = magic_siege.17.d
	picture = RAMADAN_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	# Cast Thunderstorm
	option = {
		name = magic_siege.17.a
		ai_chance = {
			factor = 90
		}
		
		#Costs
		add_mil_power = -10
		add_adm_power = -15
		
		magic_casted_spell = yes
		add_ruler_modifier = { name = magic_siege_cooldown duration = 30 hidden = yes }
		
		increase_witch_king_points_small = yes
		
		add_ruler_modifier = {	#For Witch King mtth
			name = magic_witch_king_thunderstorm
			duration = 1825
			hidden = yes
		}
		
		#Success/Fail
		if = {
			limit = {
				event_target:spell_target_province = {
					#Conjuration 3
					OR = {
						has_climate = tropical
						has_province_modifier = mild_winter
					}
					ROOT = { has_ruler_flag = conjuration_3 }
				}
			}
			set_country_flag = spell_1
			tooltip = {
				random_list = {
					90 = {
						country_event = { id = magic_siege.18 }
					}
					10 = {
						country_event = { id = magic_siege.19 }
					}
				}
			}
		}
		else_if = {
			limit = {
				event_target:spell_target_province = {
					OR = {
						#Conjuration 3
						AND = {
							has_province_modifier = normal_winter
							ROOT = { has_ruler_flag = conjuration_3 }
						}
						#Conjuration 2
						AND = {
							OR = {
								has_climate = tropical
								has_province_modifier = mild_winter
							}
							ROOT = { has_ruler_flag = conjuration_2 }
						}
					}
				}
			}
			set_country_flag = spell_2
			tooltip = {
				random_list = {
					80 = {
						country_event = { id = magic_siege.18 }
					}
					20 = {
						country_event = { id = magic_siege.19 }
					}
				}
			}
		}
		else_if = {
			limit = {
				event_target:spell_target_province = {
					OR = {
						#Conjuration 3
						AND = {
							has_province_modifier = severe_winter
							ROOT = { has_ruler_flag = conjuration_3 }
						}
						#Conjuration 2
						AND = {
							has_province_modifier = normal_winter
							ROOT = { has_ruler_flag = conjuration_2 }
						}
					}
				}
			}
			set_country_flag = spell_3
			tooltip = {
				random_list = {
					70 = {
						country_event = { id = magic_siege.18 }
					}
					30 = {
						country_event = { id = magic_siege.19 }
					}
				}
			}
		}
		else_if = {
			limit = {
				event_target:spell_target_province = {
					OR = {
						#Conjuration 3
						AND = {
							OR = {
								has_climate = arid
								has_climate = arctic
							}
							ROOT = { has_ruler_flag = conjuration_3 }
						}
						#Conjuration 2
						AND = {
							has_province_modifier = severe_winter
							ROOT = { has_ruler_flag = conjuration_2 }
						}
					}
				}
			}
			set_country_flag = spell_4
			tooltip = {
				random_list = {
					60 = {
						country_event = { id = magic_siege.18 }
					}
					40 = {
						country_event = { id = magic_siege.19 }
					}
				}
			}
		}
		else_if = {
			limit = {
				event_target:spell_target_province = {
					OR = {
						#Conjuration 2
						has_climate = arid
						has_climate = arctic
						ROOT = { has_ruler_flag = conjuration_2 }
					}
				}
			}
			set_country_flag = spell_5
			tooltip = {
				random_list = {
					50 = {
						country_event = { id = magic_siege.18 }
					}
					50 = {
						country_event = { id = magic_siege.19 }
					}
				}
			}
		}
		else = {	#Debug just in case
			set_country_flag = spell_6
			tooltip = {
				random_list = {
					40 = {
						country_event = { id = magic_siege.18 }
					}
					60 = {
						country_event = { id = magic_siege.19 }
					}
				}
			}
		}
		hidden_effect = { country_event = { id = magic_siege.101 } }
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 10
			modifier = {
				factor = 100
				NOT = { mil_power = 20 }
				NOT = { adm_power = 30 }
			}
		}
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				country_event = { id = magic_siege.1 }
			}
			else = {
				country_event = { id = magic_ruler.2 }
			}
		}
	}
}

# Conjuration 2: Thunderstorm - Success
country_event = {
	id = magic_siege.18
	title = magic_siege.18.t
	desc = magic_siege.18.d
	picture = RAMADAN_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	option = {
		name = magic_siege.18.a
		ai_chance = {
			factor = 100
		}
		
		#Spell
		event_target:spell_target_province = { 
			change_siege = 5
			add_devastation = 5
			add_province_modifier = {
				name = siege_magic_thunderstorm
				duration = 182
			}
		}
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.2 }
			}
		}
	}
}

# Conjuration 2: Thunderstorm - Fail
country_event = {
	id = magic_siege.19
	title = magic_siege.19.t
	desc = magic_siege.19.d
	picture = RAMADAN_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	#Force Success
	option = {
		name = magic_siege.19.a
		ai_chance = {
			factor = 90
		}
		
		add_mil_power = -5
		add_adm_power = -20	#Concentration spells
		
		#Spell
		event_target:spell_target_province = { 
			change_siege = 5
			add_devastation = 5
			add_province_modifier = {
				name = siege_magic_thunderstorm
				duration = 182
			}
		}
	}
	
	option = {
		name = magic_siege.19.b
		ai_chance = {
			factor = 10
			modifier = {
				factor = 100
				NOT = { mil_power = 10 }
				NOT = { adm_power = 40 }
			}
		}
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.2 }
			}
		}
	}
}


############################################# ENCHANTMENT #############################################

#Enchantment 2: Dominate Surrender - Base			- goddamn this is hard to make work, just test with a normal garrison one jeez, maybe just make it level 3 then, but i guess theres no lvl 2 stuff!
country_event = {
	id = magic_siege.5
	title = magic_siege.5.t
	desc = magic_siege.5.d
	picture = WESTERNISATION_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	option = {
		name = magic_siege.5.a
		ai_chance = {
			factor = 90
		}
		
		magic_casted_spell = yes
		add_ruler_modifier = { name = magic_siege_cooldown duration = 30 hidden = yes }
		
		increase_witch_king_points_large = yes
		
		add_ruler_modifier = {	#For Witch King mtth & echantment malus events
			name = magic_witch_king_dominate_surrender
			duration = 1825
			hidden = yes
		}

		
		#Costs + Success/Fail
		if = {
			limit = {
				NOT = { has_ruler_flag = baku_patron }
				event_target:spell_target_province = {
					garrison = 15000
				}
			}
			add_adm_power = -100
			add_dip_power = -100

			set_country_flag = spell_1
			tooltip = {
				random_list = {
					25 = {
						country_event = { id = magic_siege.6 }
					}
					75 = {
						country_event = { id = magic_siege.7 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					event_target:spell_target_province = {
						garrison = 13000
					}
					AND = {
						has_ruler_flag = baku_patron
						event_target:spell_target_province = {
							garrison = 15000
						}
					}
				}
			}
			add_adm_power = -80
			add_dip_power = -80

			set_country_flag = spell_2
			tooltip = {
				random_list = {
					30 = {
						country_event = { id = magic_siege.6 }
					}
					70 = {
						country_event = { id = magic_siege.7 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					event_target:spell_target_province = {
						garrison = 10000
					}
					AND = {
						has_ruler_flag = baku_patron
						event_target:spell_target_province = {
							garrison = 13000
						}
					}
				}
			}
			add_adm_power = -70
			add_dip_power = -60

			set_country_flag = spell_3
			tooltip = {
				random_list = {
					35 = {
						country_event = { id = magic_siege.6 }
					}
					65 = {
						country_event = { id = magic_siege.7 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					event_target:spell_target_province = {
						garrison = 9000
					}
					AND = {
						has_ruler_flag = baku_patron
						event_target:spell_target_province = {
							garrison = 10000
						}
					}
				}
			}
			add_adm_power = -60
			add_dip_power = -60

			set_country_flag = spell_4
			tooltip = {
				random_list = {
					40 = {
						country_event = { id = magic_siege.6 }
					}
					60 = {
						country_event = { id = magic_siege.7 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					event_target:spell_target_province = {
						garrison = 8000
					}
					AND = {
						has_ruler_flag = baku_patron
						event_target:spell_target_province = {
							garrison = 9000
						}
					}
				}
			}
			add_adm_power = -60
			add_dip_power = -50

			set_country_flag = spell_5
			tooltip = {
				random_list = {
					50 = {
						country_event = { id = magic_siege.6 }
					}
					50 = {
						country_event = { id = magic_siege.7 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					event_target:spell_target_province = {
						garrison = 7000
					}
					AND = {
						has_ruler_flag = baku_patron
						event_target:spell_target_province = {
							garrison = 8000
						}
					}
				}
			}
			add_adm_power = -50
			add_dip_power = -50

			set_country_flag = spell_6
			tooltip = {
				random_list = {
					55 = {
						country_event = { id = magic_siege.6 }
					}
					45 = {
						country_event = { id = magic_siege.7 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					event_target:spell_target_province = {
						garrison = 6000
					}
					AND = {
						has_ruler_flag = baku_patron
						event_target:spell_target_province = {
							garrison = 7000
						}
					}
				}
			}
			add_adm_power = -40
			add_dip_power = -40

			set_country_flag = spell_7
			tooltip = {
				random_list = {
					60 = {
						country_event = { id = magic_siege.6 }
					}
					40 = {
						country_event = { id = magic_siege.7 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					event_target:spell_target_province = {
						garrison = 5000
					}
					AND = {
						has_ruler_flag = baku_patron
						event_target:spell_target_province = {
							garrison = 6000
						}
					}
				}
			}
			add_adm_power = -40
			add_dip_power = -30

			set_country_flag = spell_8
			tooltip = {
				random_list = {
					65 = {
						country_event = { id = magic_siege.6 }
					}
					35 = {
						country_event = { id = magic_siege.7 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					event_target:spell_target_province = {
						garrison = 4000
					}
					AND = {
						has_ruler_flag = baku_patron
						event_target:spell_target_province = {
							garrison = 5000
						}
					}
				}
			}
			add_adm_power = -30
			add_dip_power = -30

			set_country_flag = spell_9
			tooltip = {
				random_list = {
					70 = {
						country_event = { id = magic_siege.6 }
					}
					30 = {
						country_event = { id = magic_siege.7 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					event_target:spell_target_province = {
						garrison = 3000
					}
					AND = {
						has_ruler_flag = baku_patron
						event_target:spell_target_province = {
							garrison = 4000
						}
					}
				}
			}
			add_adm_power = -30
			add_dip_power = -20

			set_country_flag = spell_10
			tooltip = {
				random_list = {
					75 = {
						country_event = { id = magic_siege.6 }
					}
					25 = {
						country_event = { id = magic_siege.7 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					event_target:spell_target_province = {
						garrison = 2000
					}
					AND = {
						has_ruler_flag = baku_patron
						event_target:spell_target_province = {
							garrison = 3000
						}
					}
				}
			}
			add_adm_power = -20
			add_dip_power = -20

			set_country_flag = spell_10
			tooltip = {
				random_list = {
					75 = {
						country_event = { id = magic_siege.6 }
					}
					25 = {
						country_event = { id = magic_siege.7 }
					}
				}
			}
		}
		else = {
			add_adm_power = -20
			add_dip_power = -10

			set_country_flag = spell_10
			tooltip = {
				random_list = {
					75 = {
						country_event = { id = magic_siege.6 }
					}
					25 = {
						country_event = { id = magic_siege.7 }
					}
				}
			}
		}
		hidden_effect = { country_event = { id = magic_siege.102 } }
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 10
			modifier = {
				factor = 100
				NOT = { mil_power = 10 }
			}
		}
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				country_event = { id = magic_siege.1 }
			}
			else = {
				country_event = { id = magic_ruler.4 }
			}
		}
	}
}

#Dominate Surrender - Success
country_event = {
	id = magic_siege.6
	title = magic_siege.6.t
	desc = magic_siege.6.d
	picture = PIRATES_CAPTURED_eventPicture
	goto = spell_target_province

	is_triggered_only = yes

	option = {
		name = magic_siege.6.a
		ai_chance = {
			factor = 100
		}

		#Spell
		event_target:spell_target_province = {
			add_province_modifier = {
				name = siege_magic_instant_siege
				duration = 3
			}
			hidden_effect = {
				owner = { country_event = { id = magic_siege.120 } }
				if = {
					limit = {
						OR = {
							has_terrain = dwarven_hold
							has_terrain = dwarven_hold_surface
						}
					}
					add_province_modifier = {
						name = siege_no_hold_damage
						duration = 7
						hidden = yes
					}
				}
			}
		}
	}

	after = {
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.4 }
			}
		}
	}
}

#Dominate Surrender - Fail
country_event = {
	id = magic_siege.7
	title = magic_siege.7.t
	desc = magic_siege.7.d
	picture = ACCUSATION_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	#Force Success
	option = {
		name = magic_siege.7.a
		ai_chance = {
			factor = 70
		}
		
		#Cost
		add_mil_power = -20
		
		event_target:spell_target_province = { 
			change_siege = 1	#if possible
		}
		
	}
	
	#Fail
	option = {
		name = magic_siege.7.b
		ai_chance = {
			factor = 30
			modifier = {
				factor = 100
				NOT = { mil_power = 100 }
			}
		}
		
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.4 }
			}
		}
	}
}

############################################# EVOCATION #############################################

# Evocation 1: Greater Fireball
country_event = {
	id = magic_siege.8
	title = magic_siege.8.t
	desc = magic_siege.8.d
	picture = COMET_SIGHTED_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	# Come forth!
	option = {
		name = magic_siege.8.a
		ai_chance = {
			factor = 90
		}
		
		#Costs
		add_mil_power = -10
		
		magic_casted_spell = yes
		add_ruler_modifier = { name = magic_siege_cooldown duration = 30 hidden = yes }
		
		#Success/Fail
		if = {
			limit = {
				#Evocation 3
				event_target:spell_target_province = {
					fort_level = 1
					NOT = { fort_level = 4 }
				}
				OR = {
					has_ruler_flag = evocation_3
					AND = {
						has_ruler_flag = evocation_2
						OR = {
							has_ruler_flag = rakshasa_patron
							has_ruler_flag = manifestation_of_surael_patron
						}
					}
				}
				has_ruler_flag = evocation_3
			}
			set_country_flag = spell_1
			tooltip = {
				random_list = {
					90 = {
						country_event = { id = magic_siege.9 }
					}
					10 = {
						country_event = { id = magic_siege.10 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					#Evocation 3
					AND = {
						event_target:spell_target_province = {
							fort_level = 4
							NOT = { fort_level = 6 }
						}
						OR = {
							has_ruler_flag = evocation_3
							AND = {
								has_ruler_flag = evocation_2
								OR = {
									has_ruler_flag = rakshasa_patron
									has_ruler_flag = manifestation_of_surael_patron
								}
							}
						}
					}
					#Evocation 2
					AND = {
						event_target:spell_target_province = {
							fort_level = 1
							NOT = { fort_level = 4 }
						}
						OR = {
							has_ruler_flag = evocation_2
							AND = {
								has_ruler_flag = evocation_1
								OR = {
									has_ruler_flag = rakshasa_patron
									has_ruler_flag = manifestation_of_surael_patron
								}
							}
						}
					}
				}
			}
			set_country_flag = spell_2
			tooltip = {
				random_list = {
					80 = {
						country_event = { id = magic_siege.9 }
					}
					20 = {
						country_event = { id = magic_siege.10 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					#Evocation 3
					AND = {
						event_target:spell_target_province = {
							fort_level = 6
							NOT = { fort_level = 8 }
						}
						OR = {
							has_ruler_flag = evocation_3
							AND = {
								has_ruler_flag = evocation_2
								OR = {
									has_ruler_flag = rakshasa_patron
									has_ruler_flag = manifestation_of_surael_patron
								}
							}
						}
					}
					#Evocation 2
					AND = {
						event_target:spell_target_province = {
							fort_level = 4
							NOT = { fort_level = 6 }
						}
						OR = {
							has_ruler_flag = evocation_2
							AND = {
								has_ruler_flag = evocation_1
								OR = {
									has_ruler_flag = rakshasa_patron
									has_ruler_flag = manifestation_of_surael_patron
								}
							}
						}
					}
					#Evocation 1
					AND = {
						event_target:spell_target_province = {
							fort_level = 1
							NOT = { fort_level = 4 }
						}
						has_ruler_flag = evocation_1
					}
				}
			}
			set_country_flag = spell_3
			tooltip = {
				random_list = {
					70 = {
						country_event = { id = magic_siege.9 }
					}
					30 = {
						country_event = { id = magic_siege.10 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					#Evocation 3
					AND = {
						event_target:spell_target_province = {
							fort_level = 8
						}
						OR = {
							has_ruler_flag = evocation_3
							AND = {
								has_ruler_flag = evocation_2
								OR = {
									has_ruler_flag = rakshasa_patron
									has_ruler_flag = manifestation_of_surael_patron
								}
							}
						}
					}
					#Evocation 2
					AND = {
						event_target:spell_target_province = {
							fort_level = 6
							NOT = { fort_level = 8 }
						}
						OR = {
							has_ruler_flag = evocation_2
							AND = {
								has_ruler_flag = evocation_1
								OR = {
									has_ruler_flag = rakshasa_patron
									has_ruler_flag = manifestation_of_surael_patron
								}
							}
						}
					}
					#Evocation 1
					AND = {
						event_target:spell_target_province = {
							fort_level = 4
							NOT = { fort_level = 6 }
						}
						has_ruler_flag = evocation_1
					}
				}
			}
			set_country_flag = spell_4
			tooltip = {
				random_list = {
					60 = {
						country_event = { id = magic_siege.9 }
					}
					40 = {
						country_event = { id = magic_siege.10 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					#Evocation 2
					AND = {
						event_target:spell_target_province = {
							fort_level = 8
						}
						OR = {
							has_ruler_flag = evocation_2
							AND = {
								has_ruler_flag = evocation_1
								OR = {
									has_ruler_flag = rakshasa_patron
									has_ruler_flag = manifestation_of_surael_patron
								}
							}
						}
					}
					#Evocation 1
					AND = {
						event_target:spell_target_province = {
							fort_level = 6
							NOT = { fort_level = 8 }
						}
						has_ruler_flag = evocation_1
					}
				}
			}
			set_country_flag = spell_5
			tooltip = {
				random_list = {
					50 = {
						country_event = { id = magic_siege.9 }
					}
					50 = {
						country_event = { id = magic_siege.10 }
					}
				}
			}
		}
		else_if = {
			limit = {
				#Evocation 1
				event_target:spell_target_province = {
					fort_level = 8
				}
				has_ruler_flag = evocation_1
			}
			set_country_flag = spell_6
			tooltip = {
				random_list = {
					40 = {
						country_event = { id = magic_siege.9 }
					}
					60 = {
						country_event = { id = magic_siege.10 }
					}
				}
			}
		}
		hidden_effect = { country_event = { id = magic_siege.103 } }
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 10
			modifier = {
				factor = 100
				NOT = { mil_power = 10 }
			}
		}
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				country_event = { id = magic_siege.1 }
			}
			else = {
				country_event = { id = magic_ruler.5 }
			}
		}
	}
	
}

# Evocation 1: Greater Fireball - Success
country_event = {
	id = magic_siege.9
	title = magic_siege.9.t
	desc = magic_siege.9.d
	picture = SIEGE_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	option = {
		name = magic_siege.9.a
		ai_chance = {
			factor = 100
		}
		
		#Spell
		event_target:spell_target_province = { 
			change_siege = 1
		}
		
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.5 }
			}
		}
	}
}

# Evocation 1: Greater Fireball - Fail (Misses)
country_event = {
	id = magic_siege.10
	title = magic_siege.10.t
	desc = magic_siege.10.d
	picture = SIEGE_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	#Force Fail
	option = {
		name = magic_siege.10.a
		ai_chance = {
			factor = 100
		}
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.5 }
			}
		}
	}
}



# Evocation 2: Earthquake
country_event = {
	id = magic_siege.11
	title = magic_siege.11.t
	desc = magic_siege.11.d
	picture = COUNTRY_COLLAPSE_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	# Cast Earthquake
	option = {
		name = magic_siege.11.a
		ai_chance = {
			factor = 90
		}
		
		#Costs
		add_mil_power = -20
		add_adm_power = -5
		
		magic_casted_spell = yes
		add_ruler_modifier = { name = magic_siege_cooldown duration = 30 hidden = yes }
		
		increase_witch_king_points_medium = yes
		
		add_ruler_modifier = {	#For Witch King mtth
			name = magic_witch_king_earthquake
			duration = 1825
			hidden = yes
		}
		
		#Success/Fail
		if = {
			limit = {
				#Evocation 3
				event_target:spell_target_province = {
					has_terrain = mountain
					#maybe need to make a new terrain called underground
				}
				has_ruler_flag = evocation_3
			}
			set_country_flag = spell_1
			tooltip = {
				random_list = {
					80 = {
						country_event = { id = magic_siege.12 }
					}
					20 = {
						country_event = { id = magic_siege.13 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					#Evocation 3
					AND = {
						event_target:spell_target_province = {
							OR = {
								has_terrain = hills
								has_terrain = highlands
							}
						}
						has_ruler_flag = evocation_3
					}
					#Evocation 2
					AND = {
						event_target:spell_target_province = {
							has_terrain = mountain
							#maybe need to make a new terrain called underground
						}
						has_ruler_flag = evocation_2
					}
				}
			}
			set_country_flag = spell_2
			tooltip = {
				random_list = {
					70 = {
						country_event = { id = magic_siege.12 }
					}
					30 = {
						country_event = { id = magic_siege.13 }
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					#Evocation 3
					AND = {
						event_target:spell_target_province = {
							OR = {
								has_terrain = coastline
								has_terrain = coastal_desert
							}
						}
						has_ruler_flag = evocation_3
					}
					#Evocation 2
					AND = {
						event_target:spell_target_province = {
							OR = {
								has_terrain = hills
								has_terrain = highlands
							}
						}
						has_ruler_flag = evocation_2
					}
				}
			}
			set_country_flag = spell_3
			tooltip = {
				random_list = {
					60 = {
						country_event = { id = magic_siege.12 }
					}
					40 = {
						country_event = { id = magic_siege.13 }
					}
				}
			}
		}
		else_if = {
			limit = {
				#Evocation 2
				event_target:spell_target_province = {
					OR = {
						has_terrain = coastline
						has_terrain = coastal_desert
					}
				}
				has_ruler_flag = evocation_2
			}
			set_country_flag = spell_4
			tooltip = {
				random_list = {
					50 = {
						country_event = { id = magic_siege.12 }
					}
					50 = {
						country_event = { id = magic_siege.13 }
					}
				}
			}
		}
		else = {
			set_country_flag = spell_5
			tooltip = {
				random_list = {
					40 = {
						country_event = { id = magic_siege.12 }
					}
					60 = {
						country_event = { id = magic_siege.13 }
					}
				}
			}
		}
		hidden_effect = { country_event = { id = magic_siege.104 } }
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 10
			modifier = {
				factor = 100
				NOT = { mil_power = 10 }
			}
		}
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				country_event = { id = magic_siege.1 }
			}
			else = {
				country_event = { id = magic_ruler.5 }
			}
		}
	}
	
}

# Evocation 2: Earthquake - Success
country_event = {
	id = magic_siege.12
	title = magic_siege.12.t
	desc = magic_siege.12.d
	picture = COUNTRY_COLLAPSE_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	option = {
		name = magic_siege.12.a
		ai_chance = {
			factor = 100
		}
		
		#Spell
		event_target:spell_target_province = { 
			change_siege = 3
			add_province_modifier = {
				name = siege_magic_earthquake
				duration = 365
			}
			add_devastation = 10
		}
		
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.5 }
			}
		}
	}
}

# Evocation 2: Earthquake - Fail
country_event = {
	id = magic_siege.13
	title = magic_siege.13.t
	desc = magic_siege.13.d
	picture = COUNTRY_COLLAPSE_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	#Force Success
	option = {
		name = magic_siege.13.a
		ai_chance = {
			factor = 90
		}
		
		add_mil_power = -20
		
		#Spell
		event_target:spell_target_province = { 
			change_siege = 3
			add_province_modifier = {
				name = siege_magic_earthquake
				duration = 365
			}
			add_devastation = 10
		}
		
	}
	
	option = {
		name = magic_siege.13.b
		ai_chance = {
			factor = 10
			modifier = {
				factor = 100
				NOT = { mil_power = 40 }
			}
		}
		
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.5 }
			}
		}
	}
}

# Evocation 3: Meteor Strike
country_event = {
	id = magic_siege.14
	title = magic_siege.14.t
	desc = magic_siege.14.d
	picture = COMET_SIGHTED_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	# Cast Meteor Strike
	option = {
		name = magic_siege.14.a
		ai_chance = {
			factor = 90
		}
		
		#Costs
		add_mil_power = -50
		
		increase_witch_king_points_large = yes
		
		add_ruler_modifier = {	#For Witch King mtth
			name = magic_witch_king_meteor_strike
			duration = 1825
			hidden = yes
		}
		
		magic_casted_spell = yes
		add_ruler_modifier = { name = magic_siege_cooldown duration = 30 hidden = yes }
		
		#Success/Fail
		if = {
			limit = {
				event_target:spell_target_province = {
					fort_level = 1
					NOT = { fort_level = 4 }
				}
			}
			set_country_flag = spell_1
			tooltip = {
				random_list = {
					90 = {
						country_event = { id = magic_siege.15 }
					}
					10 = {
						country_event = { id = magic_siege.16 }
					}
				}
			}
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					fort_level = 4
					NOT = { fort_level = 6 }
				}
			}
			set_country_flag = spell_2
			tooltip = {
				random_list = {
					80 = {
						country_event = { id = magic_siege.15 }
					}
					20 = {
						country_event = { id = magic_siege.16 }
					}
				}
			}
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					fort_level = 6
					NOT = { fort_level = 8 }
				}
			}
			set_country_flag = spell_3
			tooltip = {
				random_list = {
					70 = {
						country_event = { id = magic_siege.15 }
					}
					30 = {
						country_event = { id = magic_siege.16 }
					}
				}
			}
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					fort_level = 8
				}
			}
			set_country_flag = spell_4
			tooltip = {
				random_list = {
					60 = {
						country_event = { id = magic_siege.15 }
					}
					40 = {
						country_event = { id = magic_siege.16 }
					}
				}
			}
		}
		hidden_effect = { country_event = { id = magic_siege.105 } }
	}
	
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 10
			modifier = {
				factor = 100
				NOT = { mil_power = 10 }
			}
		}
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				country_event = { id = magic_siege.1 }
			}
			else = {
				country_event = { id = magic_ruler.5 }
			}
		}
	}
}

# Evocation 3: Meteor Strike - Success
country_event = {
	id = magic_siege.15
	title = magic_siege.15.t
	desc = magic_siege.15.d
	picture = COMET_SIGHTED_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	option = {
		name = magic_siege.15.a
		ai_chance = {
			factor = 100
		}
		
		#Spell
		event_target:spell_target_province = { 
			change_siege = 10
			add_devastation = 50
		}
		
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.5 }
			}
		}
	}
}

# Evocation 3: Meteor Strike - Fail
country_event = {
	id = magic_siege.16
	title = magic_siege.16.t
	desc = magic_siege.16.d
	picture = COMET_SIGHTED_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	#Force Success
	option = {
		name = magic_siege.16.a
		ai_chance = {
			factor = 90
		}
		
		add_mil_power = -30
		
		#Spell
		event_target:spell_target_province = { 
			change_siege = 5
			add_devastation = 25
		}
		
	}
	
	option = {
		name = magic_siege.16.b
		ai_chance = {
			factor = 10
			modifier = {
				factor = 100
				NOT = { mil_power = 60 }
			}
		}
		
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.5 }
			}
		}
	}
}

############################################# TRANSMUTATION #############################################

# Transmutation 2: Shapechange into a Giant
country_event = {
	id = magic_siege.20
	title = magic_siege.20.t
	desc = magic_siege.20.d
	picture = TEMPORAL_RIFT_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	# Shapechange
	option = {
		name = magic_siege.20.a
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0 
				current_age = age_of_revolutions
			}
		}
		
		#Costs
		add_adm_power = -30
		add_dip_power = -10
		add_mil_power = -10
		
		magic_casted_spell = yes
		add_ruler_modifier = { name = magic_siege_cooldown duration = 30 hidden = yes }
		
		#Success/Fail
		if = {
			limit = {
				event_target:spell_target_province = {
					owner = {
						NOT = { mil_tech = 7}
					
						# mil_tech = 7 #cannons
						# mil_tech = 11 #matchlock
						# mil_tech = 13 #trunnions
						# mil_tech = 17 #flintlock
						# mil_tech = 22 #cartridge
						# mil_tech = 26 #light infantry
						# mil_tech = 29 #defense in depth
						# mil_tech = 31 # rifle
					}
				}
			}
			set_country_flag = spell_1
			tooltip = {
				random_list = {
					95 = {
						country_event = { id = magic_siege.21 }
					}
					5 = {
						country_event = { id = magic_siege.22 }
					}
				}
			}
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					owner = {
						mil_tech = 7
						NOT = { mil_tech = 13}
					
						# mil_tech = 7 #cannons
						# mil_tech = 11 #matchlock
						# mil_tech = 13 #trunnions
						# mil_tech = 17 #flintlock
						# mil_tech = 22 #cartridge
						# mil_tech = 26 #light infantry
						# mil_tech = 29 #defense in depth
						# mil_tech = 31 # rifle
					}
				}
			}
			set_country_flag = spell_2
			tooltip = {
				random_list = {
					90 = {
						country_event = { id = magic_siege.21 }
					}
					10 = {
						country_event = { id = magic_siege.22 }
					}
				}
			}
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					owner = {
						mil_tech = 13
						NOT = { mil_tech = 18}	#carbines
					
						# mil_tech = 7 #cannons
						# mil_tech = 11 #matchlock
						# mil_tech = 13 #trunnions
						# mil_tech = 17 #flintlock
						# mil_tech = 22 #cartridge
						# mil_tech = 26 #light infantry
						# mil_tech = 29 #defense in depth
						# mil_tech = 31 # rifle
					}
				}
			}
			set_country_flag = spell_3
			tooltip = {
				random_list = {
					80 = {
						country_event = { id = magic_siege.21 }
					}
					20 = {
						country_event = { id = magic_siege.22 }
					}
				}
			}
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					owner = {
						mil_tech = 18
						NOT = { mil_tech = 22}
					
						# mil_tech = 7 #cannons
						# mil_tech = 11 #matchlock
						# mil_tech = 13 #trunnions
						# mil_tech = 17 #flintlock
						# mil_tech = 22 #cartridge
						# mil_tech = 26 #light infantry
						# mil_tech = 29 #defense in depth
						# mil_tech = 31 # rifle
					}
				}
			}
			set_country_flag = spell_4
			tooltip = {
				random_list = {
					70 = {
						country_event = { id = magic_siege.21 }
					}
					30 = {
						country_event = { id = magic_siege.22 }
					}
				}
			}
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					owner = {
						mil_tech = 22
						NOT = { mil_tech = 29}
					
						# mil_tech = 7 #cannons
						# mil_tech = 11 #matchlock
						# mil_tech = 13 #trunnions
						# mil_tech = 17 #flintlock
						# mil_tech = 22 #cartridge
						# mil_tech = 26 #light infantry
						# mil_tech = 29 #defense in depth
						# mil_tech = 31 # rifle
					}
				}
			}
			set_country_flag = spell_5
			tooltip = {
				random_list = {
					60 = {
						country_event = { id = magic_siege.21 }
					}
					40 = {
						country_event = { id = magic_siege.22 }
					}
				}
			}
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					owner = {
						mil_tech = 29
					
						# mil_tech = 7 #cannons
						# mil_tech = 11 #matchlock
						# mil_tech = 13 #trunnions
						# mil_tech = 17 #flintlock
						# mil_tech = 22 #cartridge
						# mil_tech = 26 #light infantry
						# mil_tech = 29 #defense in depth
						# mil_tech = 31 # rifle
					}
				}
			}
			set_country_flag = spell_6
			tooltip = {
				random_list = {
					50 = {
						country_event = { id = magic_siege.21 }
					}
					50 = {
						country_event = { id = magic_siege.22 }
					}
				}
			}
		}
		hidden_effect = { country_event = { id = magic_siege.106 } }
	}
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 10
			modifier = {
				factor = 100
				NOT = { mil_power = 10 }
			}
		}
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				country_event = { id = magic_siege.1 }
			}
			else = {
				country_event = { id = magic_ruler.8 }
			}
		}
	}
	
}

# Transmutation 2: Shapechange into Giant - Success
country_event = {
	id = magic_siege.21
	title = magic_siege.21.t
	desc = magic_siege.21.d
	picture = TEMPORAL_RIFT_eventPicture
	goto = spell_target_province

	is_triggered_only = yes

	option = {	#Try and bring victory
		name = magic_siege.21.a
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = { mil_power = 60 }
			}
		}

		add_mil_power = -30

		tooltip = {
			random_list = {
				30 = {
					event_target:spell_target_province = {
						add_province_modifier = {
							name = siege_magic_instant_siege
							duration = 3
						}
					}
				}
				70 = {
					event_target:spell_target_province = {
						add_province_modifier = {
							name = siege_magic_giant_besieger
							duration = 14
						}
					}
				}
			}
		}

		hidden_effect = { country_event = { id = magic_siege.108 } }
	}

	option = {
		name = magic_siege.21.b
		ai_chance = {
			factor = 100
		}

		#Spell
		event_target:spell_target_province = {
			add_province_modifier = {
				name = siege_magic_giant_besieger
				duration = 42
			}
		}
		
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.8 }
			}
		}
	}
}

# Transmutation 2: Shapechange into Giant - Fail
country_event = {
	id = magic_siege.22
	title = magic_siege.22.t
	desc = magic_siege.22.d
	picture = TEMPORAL_RIFT_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	option = {	#...the harder they fall
		name = magic_siege.22.a
		ai_chance = {
			factor = 1
		}
		
		kill_ruler = yes
		event_target:spell_target_province = { 
			add_devastation = 5
		}
		
	}
	
	option = {	#Thankfully I had a protective ward
		name = magic_siege.22.b
		highlight = yes
		trigger = {
			has_ruler_flag = abjuration_1
		}
		ai_chance = {
			factor = 100
		}
		
		add_mil_power = -100
		
		custom_tooltip = tooltip_option_abjuration_1
		
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.8 }
			}
		}
	}
	
}


# Transmutation 3: Shapechange into Dragon
country_event = {
	id = magic_siege.23
	title = magic_siege.23.t
	desc = magic_siege.23.d
	picture = TEMPORAL_RIFT_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	# Shapechange
	option = {
		name = magic_siege.23.a
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0 
				current_age = age_of_revolutions
			}
		}
		
		#Costs
		add_adm_power = -40
		add_dip_power = -20
		add_mil_power = -10
		
		magic_casted_spell = yes
		add_ruler_modifier = { name = magic_siege_cooldown duration = 30 hidden = yes }
		
		#Success/Fail
		if = {
			limit = {
				event_target:spell_target_province = {
					owner = {
						NOT = { mil_tech = 11 }
					
						# mil_tech = 7 #cannons
						# mil_tech = 11 #matchlock
						# mil_tech = 13 #trunnions
						# mil_tech = 17 #flintlock
						# mil_tech = 22 #cartridge
						# mil_tech = 26 #light infantry
						# mil_tech = 29 #defense in depth
						# mil_tech = 31 # rifle
					}
				}
			}
			set_country_flag = spell_1
			tooltip = {
				random_list = {
					99 = {
						country_event = { id = magic_siege.24 }
					}
					1 = {
						country_event = { id = magic_siege.25 }
					}
				}
			}
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					owner = {
						mil_tech = 11
						NOT = { mil_tech = 17 }
					
						# mil_tech = 7 #cannons
						# mil_tech = 11 #matchlock
						# mil_tech = 13 #trunnions
						# mil_tech = 17 #flintlock
						# mil_tech = 22 #cartridge
						# mil_tech = 26 #light infantry
						# mil_tech = 29 #defense in depth
						# mil_tech = 31 # rifle
					}
				}
			}
			set_country_flag = spell_2
			tooltip = {
				random_list = {
					95 = {
						country_event = { id = magic_siege.24 }
					}
					5 = {
						country_event = { id = magic_siege.25 }
					}
				}
			}
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					owner = {
						mil_tech = 17
						NOT = { mil_tech = 22 }	#carbines
					
						# mil_tech = 7 #cannons
						# mil_tech = 11 #matchlock
						# mil_tech = 13 #trunnions
						# mil_tech = 17 #flintlock
						# mil_tech = 22 #cartridge
						# mil_tech = 26 #light infantry
						# mil_tech = 29 #defense in depth
						# mil_tech = 31 # rifle
					}
				}
			}
			set_country_flag = spell_3
			tooltip = {
				random_list = {
					90 = {
						country_event = { id = magic_siege.24 }
					}
					10 = {
						country_event = { id = magic_siege.25 }
					}
				}
			}
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					owner = {
						mil_tech = 22
						NOT = { mil_tech = 26 }
					
						# mil_tech = 7 #cannons
						# mil_tech = 11 #matchlock
						# mil_tech = 13 #trunnions
						# mil_tech = 17 #flintlock
						# mil_tech = 22 #cartridge
						# mil_tech = 26 #light infantry
						# mil_tech = 29 #defense in depth
						# mil_tech = 31 # rifle
					}
				}
			}
			set_country_flag = spell_4
			tooltip = {
				random_list = {
					85 = {
						country_event = { id = magic_siege.24 }
					}
					15 = {
						country_event = { id = magic_siege.25 }
					}
				}
			}
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					owner = {
						mil_tech = 26
						NOT = { mil_tech = 31 }
					
						# mil_tech = 7 #cannons
						# mil_tech = 11 #matchlock
						# mil_tech = 13 #trunnions
						# mil_tech = 17 #flintlock
						# mil_tech = 22 #cartridge
						# mil_tech = 26 #light infantry
						# mil_tech = 29 #defense in depth
						# mil_tech = 31 # rifle
					}
				}
			}
			set_country_flag = spell_5
			tooltip = {
				random_list = {
					80 = {
						country_event = { id = magic_siege.24 }
					}
					20 = {
						country_event = { id = magic_siege.25 }
					}
				}
			}
		}
		if = {
			limit = {
				event_target:spell_target_province = {
					owner = {
						mil_tech = 31
					
						# mil_tech = 7 #cannons
						# mil_tech = 11 #matchlock
						# mil_tech = 13 #trunnions
						# mil_tech = 17 #flintlock
						# mil_tech = 22 #cartridge
						# mil_tech = 26 #light infantry
						# mil_tech = 29 #defense in depth
						# mil_tech = 31 # rifle
					}
				}
			}
			set_country_flag = spell_6
			tooltip = {
				random_list = {
					70 = {
						country_event = { id = magic_siege.24 }
					}
					30 = {
						country_event = { id = magic_siege.25 }
					}
				}
			}
		}
		hidden_effect = { country_event = { id = magic_siege.107 } }
	}
	option = {	#Option B: Go back
		name = magic_siege.goback
		ai_chance = {
			factor = 10
			modifier = {
				factor = 100
				NOT = { mil_power = 10 }
			}
		}
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				country_event = { id = magic_siege.1 }
			}
			else = {
				country_event = { id = magic_ruler.8 }
			}
		}
	}
	
}

# Transmutation 3: Shapechange into Dragon - Success
country_event = {
	id = magic_siege.24
	title = magic_siege.24.t
	desc = magic_siege.24.d
	picture = TEMPORAL_RIFT_eventPicture
	goto = spell_target_province

	is_triggered_only = yes

	option = {	#Burn them all!
		name = magic_siege.24.a
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = { mil_power = 120 }
			}
		}

		add_mil_power = -60

		tooltip = {
			random_list = {
				60 = {
					event_target:spell_target_province = {
						add_province_modifier = {
							name = siege_magic_instant_siege
							duration = 3
						}
						add_devastation = 10
					}
				}
				40 = {
					event_target:spell_target_province = {
						add_province_modifier = {
							name = siege_magic_dragon_besieger
							duration = 14
						}
					}
				}
			}
		}

		hidden_effect = { country_event = { id = magic_siege.109 } }
	}

	option = {
		name = magic_siege.24.b
		ai_chance = {
			factor = 100
		}
		
		#Spell
		event_target:spell_target_province = { 
			add_province_modifier = {
				name = siege_magic_dragon_besieger
				duration = 42
			}
		}
		
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.8 }
			}
		}
	}
}

# Transmutation 3: Shapechange into Dragon - Fail
country_event = {
	id = magic_siege.25
	title = magic_siege.25.t
	desc = magic_siege.25.d
	picture = TEMPORAL_RIFT_eventPicture
	goto = spell_target_province
	
	is_triggered_only = yes
	
	option = {	#It all comes crashing down
		name = magic_siege.25.a
		ai_chance = {
			factor = 1
		}
		
		kill_ruler = yes
		event_target:spell_target_province = { 
			add_devastation = 5
		}
		
	}
	
	option = {	#Wake up - Cast a spell to survive the fall!
		name = magic_siege.25.b
		highlight = yes
		trigger = {
			ROOT = { has_ruler_flag = abjuration_2 }
		}
		ai_chance = {
			factor = 100
		}
		
		add_mil_power = -100
		
		tooltip = {
			random_list = {
				60 = {
					kill_ruler = yes
				}
				40 = {
				
				}
			}
		}
		
		hidden_effect = { country_event = { id = magic_siege.110 } }
		
		custom_tooltip = tooltip_option_abjuration_2
		
	}
	
	after = {		
		hidden_effect = {
			if = { limit = { has_ruler_flag = magic_siege_menu }
				close_single_menu = yes
				clr_ruler_flag = magic_siege_menu
			}
			else = {
				country_event = { id = magic_ruler.8 }
			}
		}
	}
	
}

#Result Selection for Siege Elemental
country_event = {
	id = magic_siege.100
	title = magic_siege.100.t
	desc = magic_siege.100.d
	picture = TEMPORAL_RIFT_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	after = {
		clear_spell_flags = yes
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 90
		}
		
		country_event = { id = magic_siege.3 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 10
		}
		
		country_event = { id = magic_siege.4 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 80
		}
		
		country_event = { id = magic_siege.3 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 20
		}
		
		country_event = { id = magic_siege.4 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 70
		}
		
		country_event = { id = magic_siege.3 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 30
		}
		
		country_event = { id = magic_siege.4 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 60
		}
		
		country_event = { id = magic_siege.3 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 40
		}
		
		country_event = { id = magic_siege.4 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_5
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_siege.3 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_5
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_siege.4 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_6
		}
		ai_chance = {
			factor = 40
		}
		
		country_event = { id = magic_siege.3 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_6
		}
		ai_chance = {
			factor = 60
		}
		
		country_event = { id = magic_siege.4 }
	}
}

#Result Selection for Thunderstorm
country_event = {
	id = magic_siege.101
	title = magic_siege.100.t
	desc = magic_siege.100.d
	picture = TEMPORAL_RIFT_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	after = {
		clear_spell_flags = yes
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 90
		}
		
		country_event = { id = magic_siege.18 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 10
		}
		
		country_event = { id = magic_siege.19 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 80
		}
		
		country_event = { id = magic_siege.18 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 20
		}
		
		country_event = { id = magic_siege.19 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 70
		}
		
		country_event = { id = magic_siege.18 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 30
		}
		
		country_event = { id = magic_siege.19 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 60
		}
		
		country_event = { id = magic_siege.18 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 40
		}
		
		country_event = { id = magic_siege.19 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_5
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_siege.18 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_5
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_siege.19 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_6
		}
		ai_chance = {
			factor = 40
		}
		
		country_event = { id = magic_siege.18 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_6
		}
		ai_chance = {
			factor = 60
		}
		
		country_event = { id = magic_siege.19 }
	}
}

#Result Selection for Dominate Surrender
country_event = {
	id = magic_siege.102
	title = magic_siege.100.t
	desc = magic_siege.100.d
	picture = TEMPORAL_RIFT_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	after = {
		clear_spell_flags = yes
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 25
		}
		
		country_event = { id = magic_siege.6 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 75
		}
		
		country_event = { id = magic_siege.7 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 30
		}
		
		country_event = { id = magic_siege.6 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 70
		}
		
		country_event = { id = magic_siege.7 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 35
		}
		
		country_event = { id = magic_siege.6 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 65
		}
		
		country_event = { id = magic_siege.7 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 40
		}
		
		country_event = { id = magic_siege.6 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 60
		}
		
		country_event = { id = magic_siege.7 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_5
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_siege.6 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_5
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_siege.7 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_6
		}
		ai_chance = {
			factor = 55
		}
		
		country_event = { id = magic_siege.6 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_6
		}
		ai_chance = {
			factor = 45
		}
		
		country_event = { id = magic_siege.7 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_7
		}
		ai_chance = {
			factor = 60
		}
		
		country_event = { id = magic_siege.6 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_7
		}
		ai_chance = {
			factor = 40
		}
		
		country_event = { id = magic_siege.7 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_8
		}
		ai_chance = {
			factor = 65
		}
		
		country_event = { id = magic_siege.6 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_8
		}
		ai_chance = {
			factor = 35
		}
		
		country_event = { id = magic_siege.7 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_9
		}
		ai_chance = {
			factor = 70
		}
		
		country_event = { id = magic_siege.6 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_9
		}
		ai_chance = {
			factor = 30
		}
		
		country_event = { id = magic_siege.7 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_10
		}
		ai_chance = {
			factor = 75
		}
		
		country_event = { id = magic_siege.6 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_10
		}
		ai_chance = {
			factor = 25
		}
		
		country_event = { id = magic_siege.7 }
	}
}

#Result Selection for Greater Fireball
country_event = {
	id = magic_siege.103
	title = magic_siege.100.t
	desc = magic_siege.100.d
	picture = TEMPORAL_RIFT_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	after = {
		clear_spell_flags = yes
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 90
		}
		
		country_event = { id = magic_siege.9 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 10
		}
		
		country_event = { id = magic_siege.10 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 80
		}
		
		country_event = { id = magic_siege.9 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 20
		}
		
		country_event = { id = magic_siege.10 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 70
		}
		
		country_event = { id = magic_siege.9 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 30
		}
		
		country_event = { id = magic_siege.10 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 60
		}
		
		country_event = { id = magic_siege.9 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 40
		}
		
		country_event = { id = magic_siege.10 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_5
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_siege.9 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_5
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_siege.10 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_6
		}
		ai_chance = {
			factor = 40
		}
		
		country_event = { id = magic_siege.9 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_6
		}
		ai_chance = {
			factor = 60
		}
		
		country_event = { id = magic_siege.10 }
	}
}

#Result Selection for Earthquake
country_event = {
	id = magic_siege.104
	title = magic_siege.100.t
	desc = magic_siege.100.d
	picture = TEMPORAL_RIFT_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	after = {
		clear_spell_flags = yes
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 80
		}
		
		country_event = { id = magic_siege.12 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 20
		}
		
		country_event = { id = magic_siege.13 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 70
		}
		
		country_event = { id = magic_siege.12 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 30
		}
		
		country_event = { id = magic_siege.13 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 60
		}
		
		country_event = { id = magic_siege.12 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 40
		}
		
		country_event = { id = magic_siege.13 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_siege.12 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_siege.13 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_5
		}
		ai_chance = {
			factor = 40
		}
		
		country_event = { id = magic_siege.12 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_5
		}
		ai_chance = {
			factor = 60
		}
		
		country_event = { id = magic_siege.13 }
	}
}

#Result Selection for Meteor Strike
country_event = {
	id = magic_siege.105
	title = magic_siege.100.t
	desc = magic_siege.100.d
	picture = TEMPORAL_RIFT_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	after = {
		clear_spell_flags = yes
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 90
		}
		
		country_event = { id = magic_siege.15 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 10
		}
		
		country_event = { id = magic_siege.16 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 80
		}
		
		country_event = { id = magic_siege.15 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 20
		}
		
		country_event = { id = magic_siege.16 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 70
		}
		
		country_event = { id = magic_siege.15 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 30
		}
		
		country_event = { id = magic_siege.16 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 60
		}
		
		country_event = { id = magic_siege.15 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 40
		}
		
		country_event = { id = magic_siege.16 }
	}
}

#Result Selection for Shapechange into a Giant
country_event = {
	id = magic_siege.106
	title = magic_siege.100.t
	desc = magic_siege.100.d
	picture = TEMPORAL_RIFT_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	after = {
		clear_spell_flags = yes
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 95
		}
		
		country_event = { id = magic_siege.21 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 5
		}
		
		country_event = { id = magic_siege.22 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 90
		}
		
		country_event = { id = magic_siege.21 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 10
		}
		
		country_event = { id = magic_siege.22 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 80
		}
		
		country_event = { id = magic_siege.21 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 20
		}
		
		country_event = { id = magic_siege.22 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 70
		}
		
		country_event = { id = magic_siege.21 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 30
		}
		
		country_event = { id = magic_siege.22 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_5
		}
		ai_chance = {
			factor = 60
		}
		
		country_event = { id = magic_siege.21 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_5
		}
		ai_chance = {
			factor = 40
		}
		
		country_event = { id = magic_siege.22 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_6
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_siege.21 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_6
		}
		ai_chance = {
			factor = 50
		}
		
		country_event = { id = magic_siege.22 }
	}
}

#Result Selection for Shapechange into a Dragon
country_event = {
	id = magic_siege.107
	title = magic_siege.100.t
	desc = magic_siege.100.d
	picture = TEMPORAL_RIFT_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	after = {
		clear_spell_flags = yes
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 99
		}
		
		country_event = { id = magic_siege.24 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_1
		}
		ai_chance = {
			factor = 1
		}
		
		country_event = { id = magic_siege.25 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 95
		}
		
		country_event = { id = magic_siege.24 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_2
		}
		ai_chance = {
			factor = 5
		}
		
		country_event = { id = magic_siege.25 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 90
		}
		
		country_event = { id = magic_siege.24 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_3
		}
		ai_chance = {
			factor = 10
		}
		
		country_event = { id = magic_siege.25 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 85
		}
		
		country_event = { id = magic_siege.24 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_4
		}
		ai_chance = {
			factor = 15
		}
		
		country_event = { id = magic_siege.25 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_5
		}
		ai_chance = {
			factor = 80
		}
		
		country_event = { id = magic_siege.24 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_5
		}
		ai_chance = {
			factor = 20
		}
		
		country_event = { id = magic_siege.25 }
	}
	
	option = { #Success
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_6
		}
		ai_chance = {
			factor = 70
		}
		
		country_event = { id = magic_siege.24 }
	}
	
	option = { #Fail
		name = magic_siege.100.a
		trigger = {
			has_country_flag = spell_6
		}
		ai_chance = {
			factor = 30
		}

		country_event = { id = magic_siege.25 }
	}
}

#Result Selection for Shapechange into a Giant Success
country_event = {
	id = magic_siege.108
	title = magic_siege.100.t
	desc = magic_siege.100.d
	picture = TEMPORAL_RIFT_eventPicture

	hidden = yes
	is_triggered_only = yes

	after = {
		clear_spell_flags = yes
	}

	option = { #Success
		name = magic_siege.100.a
		ai_chance = {
			factor = 30
		}

		event_target:spell_target_province = {
			add_province_modifier = {
				name = siege_magic_instant_siege
				duration = 3
			}
			add_devastation = 5
		}
	}

	option = { #Fail
		name = magic_siege.100.a
		ai_chance = {
			factor = 70
		}

		event_target:spell_target_province = {
			add_province_modifier = {
				name = siege_magic_giant_besieger
				duration = 14
			}
		}
	}
}

#Result Selection for Shapechange into a Dragon Success
country_event = {
	id = magic_siege.109
	title = magic_siege.100.t
	desc = magic_siege.100.d
	picture = TEMPORAL_RIFT_eventPicture

	hidden = yes
	is_triggered_only = yes

	after = {
		clear_spell_flags = yes
	}

	option = { #Success
		name = magic_siege.100.a
		ai_chance = {
			factor = 60
		}

		event_target:spell_target_province = {
			add_province_modifier = {
				name = siege_magic_instant_siege
				duration = 3
			}
			add_devastation = 10
		}
	}

	option = { #Fail
		name = magic_siege.100.a
		ai_chance = {
			factor = 40
		}

		event_target:spell_target_province = {
			add_province_modifier = {
				name = siege_magic_dragon_besieger
				duration = 14
			}
		}
	}
}

#Result Selection for Shapechange into a Dragon Fail
country_event = {
	id = magic_siege.110
	title = magic_siege.100.t
	desc = magic_siege.100.d
	picture = TEMPORAL_RIFT_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	after = {
		clear_spell_flags = yes
	}
	
	option = { #Die
		name = magic_siege.100.a
		ai_chance = {
			factor = 60
		}
		
		kill_ruler = yes
	}
	
	option = { #Live
		name = magic_siege.100.a
		ai_chance = {
			factor = 40
		}
		
	}
} 

# Dominate to Surrender notification
country_event = {
	id = magic_siege.120
	title = magic_siege.120.t
	desc = magic_siege.120.d
	picture = PIRATES_CAPTURED_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		ai = no
		FROM = { NOT = { tag = ROOT } }
	}
	
	option = {
		name = magic_siege.120.a
		add_prestige = -1
	}
}
