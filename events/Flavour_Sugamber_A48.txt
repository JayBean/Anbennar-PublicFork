
######################################
#  Sugamber Succession War Disaster  #
######################################

namespace = flavor_sugamber

#Legitamacy of Lisolette called into question
country_event = {
	id = flavor_sugamber.999
	title = flavor_sugamber.999.t
	desc = flavor_sugamber.999.d
	picture = KING_SICK_IN_BED_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
		tag = A48
		NOT = { has_country_flag = had_sugamber_succession_war }
		government = monarchy
		is_free_or_tributary_trigger = yes
		has_ruler = "Lisolette"
	}
	option = {
		name = flavor_sugamber.999.a
		ai_chance = { factor = 100 }
		add_legitimacy = -20
	}
}

#Helper events for disaster to trigger correct start
country_event = {
	id = flavor_sugamber.1000
	title = flavor_sugamber.1000.t
	desc = flavor_sugamber.1000.d
	picture = KING_SICK_IN_BED_eventPicture
	
	major = yes
	major_trigger = {
		capital_scope = {
			OR = {
				superregion = western_cannor_superregion
				AND = {
					superregion = escann_superregion
					owner = { technology_group = tech_cannorian }
				}
			}
		}
	}

	fire_only_once = yes
	hidden = yes
	is_triggered_only = yes

	option = {
		ai_chance = { factor = 100 }
		hidden_effect = { country_event = { id = flavor_sugamber.1001 } }
	}
}

country_event = {
	id = flavor_sugamber.1001
	title = flavor_sugamber.1001.t
	desc = flavor_sugamber.1001.d
	picture = KING_SICK_IN_BED_eventPicture

	fire_only_once = yes
	hidden = yes
	is_triggered_only = yes

	option = {
		ai_chance = { factor = 100 }
		trigger = {
			has_ruler = "Lisolette"
		}
		country_event = { id = flavor_sugamber.0 }
	}

	option = {
		ai_chance = { factor = 100 }
		trigger = {
			has_ruler = "Ewald II"
		}
		country_event = { id = flavor_sugamber.4 }
	}
}


# Start of the Sugambrian succession crisis
country_event = {
	id = flavor_sugamber.0
	title = flavor_sugamber.0.t
	desc = flavor_sugamber.0.d
	picture = KING_SICK_IN_BED_eventPicture
	
	fire_only_once = yes

	is_triggered_only = yes

	immediate = {
		set_country_flag = sugamber_succession_war_start
	}

	option = {
		name = flavor_sugamber.0.a
		country_event = { id = flavor_sugamber.1 days = 7 random = 7 }
		hidden_effect = {
			random_list = { 
				35 = { 
				set_country_flag = A48_stabbed
				}
				35 = { 
				set_country_flag = A48_poisoned
				}
				30 = {
				set_country_flag = A48_drunken_reveal
				}
			}
		}
	}

	option = {
		name = flavor_sugamber.0.b
		country_event = { id = flavor_sugamber.1 days = 7 random = 7 }
		hidden_effect = {
			random_list = { 
				35 = { 
				set_country_flag = A48_cold_feet
				}
				35 = { 
				set_country_flag = A48_generic
				}
				30 = {
				set_country_flag = A48_crossbow
				}
			}
		}
	}
}


country_event = {
	id = flavor_sugamber.1
	title = flavor_sugamber.1.t
	desc = {
		trigger = { has_country_flag = A48_stabbed }
		desc = flavor_sugamber.1.d1
	}
	desc = {
		trigger = { has_country_flag = A48_poisoned }
		desc = flavor_sugamber.1.d2
	}
	desc = {
		trigger = { has_country_flag = A48_drunken_reveal }
		desc = flavor_sugamber.1.d3
	}
	desc = {
		trigger = { has_country_flag = A48_cold_feet }
		desc = flavor_sugamber.1.d4
	}
	desc = {
		trigger = { has_country_flag = A48_generic }
		desc = flavor_sugamber.1.d5
	}
	desc = {
		trigger = { has_country_flag = A48_crossbow }
		desc = flavor_sugamber.1.d6
	}
	picture = ASSASSINATION_eventPicture
	
	fire_only_once = yes

	is_triggered_only = yes
	
	option = {
		name = flavor_sugamber.1.a
		trigger = { 
			OR = {
				has_country_flag = A48_stabbed
				has_country_flag = A48_poisoned
				has_country_flag = A48_crossbow
			}
		}
		country_event = { id = flavor_sugamber.2 days = 7 random = 7 }
		define_ruler = {
			name = "Ethelbert"
			dynasty = "of Rupellion"
			adm = 4
			dip = 4
			mil = 5
			age = 40 
		}
		if = {
			limit = {
				OR = {
					has_country_flag = A48_stabbed
					has_country_flag = A48_crossbow
				}
			}
			reduce_stability_or_adm_power = yes
		}
	}

	option = {
		name = flavor_sugamber.1.b
		trigger = { 
			OR = {
				has_country_flag = A48_drunken_reveal
				has_country_flag = A48_cold_feet
				has_country_flag = A48_generic
			}
		}
		country_event = { id = flavor_sugamber.3 days = 7 random = 7 }
		if = {
			limit = {
				has_country_flag = A48_generic
			}
			reduce_stability_or_adm_power = yes
		}
	}
}

#Lisolette supporters rise up
country_event = {
	id = flavor_sugamber.2
	title = flavor_sugamber.2.t
	desc = flavor_sugamber.2.d
	picture = CIVIL_WAR_eventPicture
	
	fire_only_once = yes

	is_triggered_only = yes

	immediate = {
	}

	option = {
		name = flavor_sugamber.2.a
		if = {
			limit = {
				owns = 415		#Lockcastle
				415 = {
					NOT = { units_in_province = 1 }
				}
			}
			415 = {
				set_province_flag = sugamber_local_support_for_rebels 
				spawn_rebels = {
					type = pretender_rebels
					size = 1.8
					leader = "Baldwin of Lockcastle"
					win = yes
				}
			}
		}
		else = {
			random_owned_province = {
				limit = {
					NOT = { units_in_province = 1 }
					NOT = { has_province_modifier = gnollish_minority_coexisting_large}
					NOT = { culture = hill_gnoll }
				}
				set_province_flag = sugamber_local_support_for_rebels
				spawn_rebels = {
					type = pretender_rebels
					size = 1.8
					leader = "Baldwin of Lockcastle"
					win = yes
				}
			}
		}
		random_owned_province = {
			limit = {
				NOT = { units_in_province = 1 }
				NOT = { has_province_modifier = gnollish_minority_coexisting_large}
				NOT = { culture = hill_gnoll }
			}
			set_province_flag = sugamber_local_support_for_rebels
			spawn_rebels = {
				type = pretender_rebels
				size = 1.2
				leader = "Baldwin of Lockcastle"
				win = yes
			}
		}
		add_yearly_manpower = -2
		set_country_flag = sugamber_baldwin_rebellion
	}

	after = {
		clr_country_flag = sugamber_succession_war_start
	}
}

# Ethelbert rises up
country_event = {
	id = flavor_sugamber.3
	title = flavor_sugamber.3.t
	desc = flavor_sugamber.3.d
	picture = CIVIL_WAR_eventPicture
	
	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = flavor_sugamber.3.a
		if = {
			limit = {
				owns = 317		#Rupellion
				317 = {
					NOT = { units_in_province = 1 }
				}
			}
			317 = {
				set_province_flag = sugamber_local_support_for_rebels 
				spawn_rebels = {
					type = pretender_rebels
					size = 1.8
					leader = "Ethelbert of Rupellion"
					win = yes
				}
			}
		}
		else = {
			random_owned_province = {
				limit = {
					NOT = { units_in_province = 1 }
					NOT = { has_province_modifier = gnollish_minority_coexisting_large}
					NOT = { culture = hill_gnoll }
				}
				set_province_flag = sugamber_local_support_for_rebels
				spawn_rebels = {
					type = pretender_rebels
					size = 1.8
					leader = "Ethelbert of Rupellion"
					win = yes
				}
			}
		}
		random_owned_province = {
			limit = {
				NOT = { units_in_province = 1 }
				NOT = { has_province_modifier = gnollish_minority_coexisting_large}
				NOT = { culture = hill_gnoll }
			}
			set_province_flag = sugamber_local_support_for_rebels
			spawn_rebels = {
				type = pretender_rebels
				size = 1.2
				leader = "Ethelbert of Rupellion"
				win = yes
			}
		}
		add_yearly_manpower = -2
		set_country_flag = sugamber_ethelbert_rebellion
	}

	after = {
		clr_country_flag = sugamber_succession_war_start
	}
}

# Alternative start of the Sugambrian succession crisis
country_event = {
	id = flavor_sugamber.4
	title = flavor_sugamber.4.t
	desc = flavor_sugamber.4.d
	picture = DEATH_OF_HEIR_eventPicture
	
	fire_only_once = yes

	is_triggered_only = yes

	trigger = {
		tag = A48
		NOT = { has_country_flag = sugamber_baldwin_rebellion }
		NOT = { has_country_flag = sugamber_ethelbert_rebellion }
		NOT = { has_country_flag = had_sugamber_succession_war }
	}

	immediate = {
	}

	option = {
		name = flavor_sugamber.4.a
			reduce_stability_or_adm_power = yes
			define_heir = {
				name = "Baldwin"
				dynasty = "Lockcastle"
				#fixed = yes
				change_adm = 4
				change_dip = 3
				change_mil = 4
				age = 39
			}
			random_owned_province = {
				limit = {
					NOT = { units_in_province = 1 }
					NOT = { has_province_modifier = gnollish_minority_coexisting_large}
					NOT = { culture = hill_gnoll }
				}
				set_province_flag = sugamber_local_support_for_rebels
				spawn_rebels = {
					type = pretender_rebels
					size = 1.8
					leader = "Ethelbert of Rupellion"
					win = yes
				}
			}
			random_owned_province = {
				limit = {
					NOT = { units_in_province = 1 }
					NOT = { has_province_modifier = gnollish_minority_coexisting_large}
					NOT = { culture = hill_gnoll }
				}
				set_province_flag = sugamber_local_support_for_rebels
				spawn_rebels = {
					type = pretender_rebels
					size = 1.2
					leader = "Ethelbert of Rupellion"
					win = yes
				}
			}
			add_yearly_manpower = -2
			set_country_flag = sugamber_ethelbert_rebellion
	}
	after = {
		clr_country_flag = sugamber_succession_war_start
	}
}

# Gnolls might start making trouble
country_event = {
	id = flavor_sugamber.5
	title = flavor_sugamber.5.t
	desc = flavor_sugamber.5.d
	picture = REVOLUTION_eventPicture
	
	fire_only_once = yes
	mean_time_to_happen = {
		months = 6
	}
	
	trigger = {
		tag = A48
		OR	= {	has_country_flag = sugamber_baldwin_rebellion
				has_country_flag = sugamber_ethelbert_rebellion
		}
		owns = 913
		controls = 913
	}
	
	option = {	#Just ignore them.
		name = flavor_sugamber.5.a
		random = { 
			chance = 50 
			913 = {
			spawn_rebels = {
				type = nationalist_rebels
				size = 1
				friend = A49
				}
			}
		}
	}
	
	option = {	# Preempt rebellion by giving them someone else to fight.
		name = flavor_sugamber.5.b
			913 = {
				add_unit_construction = {
					type = infantry
					amount = 1
					speed = 0.25
					cost = 1
			}
		}
		set_country_flag = gnollish_officer
	}
	
	option = {	# Keep them quiet by lowering their taxes.
		name = flavor_sugamber.5.c
			913 = {
				add_local_autonomy = 30
		}	
	}
}

# The civil war hurts our agriculture.
country_event = {
	id =  flavor_sugamber.6
	title = flavor_sugamber.6.t
	desc = flavor_sugamber.6.d
	picture = FAMINE_eventPicture
	
	trigger = {
		tag = A48
		OR	= {	has_country_flag = sugamber_baldwin_rebellion
				has_country_flag = sugamber_ethelbert_rebellion
		}
	}
	
	fire_only_once = yes
	is_triggered_only = yes
	
	option = {		# Why can't the peasants eat cake?
		name = flavor_sugamber.6.a
		ai_chance = { factor = 25 }
		reduce_stability_or_adm_power = yes
		reduce_legitimacy_small_effect = yes
		add_war_exhaustion = 2
	}
	option = {		# Just import food from abroad.
		name = flavor_sugamber.6.b
		ai_chance = { factor = 50 }
		add_country_modifier = {
			name = importing_food
			duration = 1825
		}
	}
	option = {		# Someone must be hoarding food, we must seize it.
		name = flavor_sugamber.6.c
		ai_chance = { factor = 25 }
		reduce_estate_nobles_loyalty_effect = yes
		reduce_estate_burghers_loyalty_effect = yes
	}
}

#Elven fortress betrayed by local noble
province_event = {
	id = flavor_sugamber.7
	title = flavor_sugamber.7.t
	desc = flavor_sugamber.7.d
	picture = LILAC_WARS_eventPicture
	goto = root

	fire_only_once = yes

	trigger = {
		owner = {
			has_disaster = sugamber_succession_war
		}
		province_id = 316
		fort_level = 2
		has_siege = yes
		sieged_by = REB
		NOT = { nationalism = 1 }
	}

	mean_time_to_happen = {
		months = 6
	}

	option = {
		name = flavor_sugamber.7.a
		change_siege = 5
	}
}

#Deserters
country_event = {
	id = flavor_sugamber.8
	title = flavor_sugamber.8.t
	desc = flavor_sugamber.8.d
	picture = LILAC_WARS_eventPicture
	goto = root

	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		war_exhaustion = 5
		manpower_percentage = 0.2
	}

	#Welp
	option = {
		name = flavor_sugamber.8.a
		ai_chance = { factor = 10 }
		add_yearly_manpower = -2
		add_prestige = -5
	}
	#Pay them off
	option = {
		name = flavor_sugamber.8.b
		ai_chance = { factor = 10 }
		add_years_of_income = -0.5
	}
	#Scorch and burn
	option = {
		name = flavor_sugamber.8.c
		ai_chance = { factor = 10 }
		random_owned_province = {
			limit = {
				num_of_units_in_province = {
					who = A48
					amount = 5
				}
			}
			add_devastation = 10
			add_local_autonomy = 10
		}
	}
}

#Rebel army defeated and leader captured
country_event = {
	id = flavor_sugamber.9
	title = flavor_sugamber.9.t
	desc = flavor_sugamber.9.d
	picture = LILAC_WARS_eventPicture

	is_triggered_only = yes
	fire_only_once = yes
	
	trigger = { 
		has_disaster = sugamber_succession_war
		tag = A48
	}
	
	#Pardon them
	option = {
		name =  flavor_sugamber.9.a
		ai_chance = { factor = 50 }
		ROOT = {
			add_legitimacy = -10
			add_country_modifier = {
				name = benign_ruler
				duration = 1825
			}
		}
	}
	#Execute and seize their holdings
	option = {
		name =  flavor_sugamber.9.b
		ai_chance = { factor = 50 }
		ROOT = {
			add_years_of_income = 0.5
			add_legitimacy = 10
			add_country_modifier = {
				name = rebel_leaders_executed
				duration = 1095
			}
		}
	}
}

#Neighbors supporting rebels
country_event = {
	id = flavor_sugamber.10
	title = flavor_sugamber.10.t
	desc = {
		trigger = { has_country_flag = sugamber_baldwin_rebellion }
		desc = flavor_sugamber.10.d1
	}
	desc = {
		trigger = { has_country_flag = sugamber_ethelbert_rebellion}
		desc = flavor_sugamber.10.d2
	}
	
	picture = SPY_eventPicture
	
	mean_time_to_happen = {
		months = 18
	}

	trigger = {
		is_neighbor_of = A48
		
		NOT = { has_country_flag = support_rebels }
		NOT = { has_country_flag = no_support_for_rebels }
		A48 = {
			has_disaster = sugamber_succession_war
			any_owned_province = {
				OR = {
					any_neighbor_province = {
						owned_by = ROOT
					}
					has_port = yes
				}
				unit_in_siege = no
				NOT = { has_province_flag = sugamber_local_support_for_rebels }
				NOT = { has_province_modifier = gnollish_minority_coexisting_large}
				NOT = { culture = hill_gnoll }
			}
		}
	}
		
	option = {		# Send some unruly subjects to the rebels as 'volunteers'.
		name = flavor_sugamber.10.a
		ai_chance = { factor = 30 }
		set_country_flag = support_rebels
		add_manpower = -2
		hidden_effect = {
			A48 = {
				country_event = { id = flavor_sugamber.12 days = 1 }
			}
		}
		reverse_add_opinion = {
				who = A48
				modifier = A48_supported_rebels
		}
	}
	option = {		# Give the rebels some monetary aid.
		name = flavor_sugamber.10.b
		ai_chance = { factor = 20 }
		set_country_flag = support_rebels
		add_years_of_income = -0.4
		hidden_effect = {
			A48 = {
				country_event = { id = flavor_sugamber.12 days = 1 }
			}
		}
		reverse_add_opinion = {
				who = A48
				modifier = A48_supported_rebels
		}
	}
	option = {		# We don't help rebel scum.
		name = flavor_sugamber.10.c
		ai_chance = { 
			factor = 50
			modifier = {
				factor = 3
				has_opinion = {
					who = A48
					value = 30 }
			}
			modifier = {
				factor = 2
				NOT = { tag = A56 } #Celliande
				NOT = { tag = A34 } #Bisan
			}
			modifier = {
				factor = 0.3
				NOT = {
					has_opinion = {
						who = A48
						value = -30 }
				}
			}
		}
		set_country_flag = no_support_for_rebels
		add_prestige = 5
		reverse_add_opinion = {
				who = A48
				modifier = A48_didnt_support_rebels
		}
	}
}

# Country Intervenes!
country_event = {
	id = flavor_sugamber.12
	title = flavor_sugamber.12.t
	desc = flavor_sugamber.12.d
	picture = SPY_eventPicture
	
	is_triggered_only = yes
	
	option = {		# We will not forget this.
		name = flavor_sugamber.12.a
		if = { #Celliande supports nationalist rebels
			limit = {
				FROM = {
					tag = A56
				}
				410 = {
					owned_by = ROOT
					unit_in_siege = no
					NOT = { has_province_flag = sugamber_local_support_for_rebels }
				}
				411 = {
					owned_by = ROOT
					unit_in_siege = no
					NOT = { has_province_flag = sugamber_local_support_for_rebels }
				}
			}
			410 = {
				spawn_rebels = {
					type = nationalist_rebels
					size = 0.5
					friend = FROM
				}
				set_province_flag = sugamber_local_support_for_rebels
			}
			411 = {
				spawn_rebels = {
					type = nationalist_rebels
					size = 0.5
					friend = FROM
				}
				set_province_flag = sugamber_local_support_for_rebels
			}
		}
		else_if = { #Bisan supports nationalist rebels
			limit = {
				FROM = {
					tag = A34
				}
				315 = {
					owned_by = ROOT
					unit_in_siege = no
					NOT = { has_province_flag = sugamber_local_support_for_rebels }
				}
			}
			315 = {
				spawn_rebels = {
					type = nationalist_rebels
					size = 0.75
					friend = FROM
				}
				set_province_flag = sugamber_local_support_for_rebels
			}
		}
		else_if = { #Neighboring country supports rebels
			limit = {
				any_owned_province = {
					any_neighbor_province = {
						owned_by = FROM
					}
					unit_in_siege = no
				}
			}
			random_owned_province = {
				limit = {
					OR = {
						any_neighbor_province = {
							owned_by = ROOT
						}
					has_port = yes
					}
					unit_in_siege = no
					NOT = { has_province_flag = sugamber_local_support_for_rebels }
					NOT = { has_province_modifier = gnollish_minority_coexisting_large}
					NOT = { culture = hill_gnoll }
				}
				spawn_rebels = {
					type = pretender_rebels
					size = 0.8
					friend = FROM
				}
				set_province_flag = sugamber_local_support_for_rebels
			}
		}
	}
}

#Succession War Ends
country_event = {
	id = flavor_sugamber.13
	title = flavor_sugamber.13.t
	desc = flavor_sugamber.13.d
	picture = LILAC_WARS_eventPicture
	
	major = yes
	major_trigger = {
		capital_scope = {
			OR = {
				superregion = western_cannor_superregion
				AND = {
					superregion = escann_superregion
					owner = { technology_group = tech_cannorian }
				}
			}
		}
	}

	hidden = yes
	fire_only_once = yes
	mean_time_to_happen = {
		days = 1
	}

	trigger = {
		tag = A48
		OR = {
			#Normal trigger (all rebels are dead)
			AND = {
				has_disaster = sugamber_succession_war
				NOT = { num_of_rebel_controlled_provinces = 1 }
				NOT = { num_of_rebel_armies = 1 }
				NOT = { has_country_flag = sugamber_succession_war_start }
			}
			#If ruler dies in battle or goes kaput from old age - Lisolette loyalists rebel route
			AND = {
				has_country_flag = sugamber_baldwin_rebellion
				NOT = { has_ruler = "Ethelbert" }
			}
			#If ruler dies in battle or goes kaput from old age - Ethelbert rebels route
			AND = {
				has_country_flag = sugamber_ethelbert_rebellion
				NOT = {
					calc_true_if = {
						has_ruler = "Ewald II"
						has_ruler = "Lisolette"
						has_ruler = "Baldwin"
						amount = 1
					}
				}
			}
		}
	}

	option = {
		name = flavor_sugamber.13.a
		ai_chance = { factor = 100 }
		if = {
			limit = { 
				has_country_flag = sugamber_baldwin_rebellion
				NOT = { has_ruler = "Ethelbert" }
			}
			define_ruler = {
				name = "Baldwin"
				dynasty = "Lockcastle"
				adm = 4
				dip = 3
				mil = 4
				age = 39
			}
			set_country_flag = sugamber_lisolette_avenged
		}
		else_if = {
			limit = { 
				has_country_flag = sugamber_ethelbert_rebellion
				NOT = {
					calc_true_if = {
						has_ruler = "Ewald II"
						has_ruler = "Lisolette"
						has_ruler = "Baldwin"
						amount = 1
					}
				}
			}
			define_ruler = {
				name = "Ethelbert"
				dynasty = "of Rupellion"
				adm = 4
				dip = 4
				mil = 5
				age = 40 
			}
			set_country_flag = sugamber_ethelbert_restored
		}
		else = {
			set_country_flag = rebels_lost
		}
		set_country_flag = had_sugamber_succession_war
		disband_rebels = pretender_rebels
	}
}

country_event = {
	id = flavor_sugamber.14
	title = flavor_sugamber.14.t
	desc = {
		trigger = { 
			OR = {
				has_country_flag = sugamber_ethelbert_restored
				has_country_flag = sugamber_lisolette_avenged
			}
		}
		desc = flavor_sugamber.14.d1
	}
	desc = {
		trigger = {
			has_country_flag = rebels_lost
		}
		desc = flavor_sugamber.14.d2
	}
	
	picture = LILAC_WARS_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

    immediate = {
		set_country_flag = had_sugamber_succession_war
	}

	option = {
		ai_chance = { factor = 100 }
		name = flavor_sugamber.12.a
		add_stability_or_adm_power = yes
		add_war_exhaustion = -3

		#What happens if rebels win
		if = {
			limit = {
				NOT = { has_country_flag = rebels_lost}
			}
			country_event = { id = flavor_sugamber.19 } #Giving nobles recompense for supporting rebellion
			
			#Add unrest to all provinces that didn't support rebels
			every_owned_province = {
				limit = {
					NOT = { has_province_flag = sugamber_local_support_for_rebels }
				}
				add_province_modifier = {
					name = add_unrest_5_modifier
					duration = 3650
				}
			}

			#Returning territory to Bisan?
			if = { 
				limit = { 
					NOT = { war_with = A34 } 
					A34 = { has_country_flag = support_rebels }
				}
				country_event = { id = flavor_sugamber.20 days = 30 }
			}

			#Returning territory to Celliande?
			if = { 
				limit = { 
					NOT = { war_with = A56 } 
					A56 = { has_country_flag = support_rebels } 
				}
				country_event = { id = flavor_sugamber.21 days = 30 }
			}

			#Deal with relations and such
			every_country = {
				limit = {
					has_country_flag = support_rebels
				}
				country_event = { id = flavor_sugamber.16 days = 1 } # Improved Relations with Sugamber
			}
			every_country = {
				limit = {
					has_country_flag = no_support_for_rebels
				}
				remove_opinion = {
					who = ROOT
					modifier = A48_didnt_support_rebels
				}
				clr_country_flag = no_support_for_rebels
			}
		}

		#What happens if rebels lose
		else = {
			every_owned_province = {
				limit = {
					has_province_flag = sugamber_local_support_for_rebels
				}
				add_province_modifier = {
					name = add_unrest_5_modifier
					duration = 3650
				}
			}
			every_country = {
				limit = {
					OR = {
						has_country_flag = no_support_for_rebels
						has_country_flag = support_rebels
					}
				}
				country_event = { id = flavor_sugamber.17 days = 1 } #Relations deteriorate with Sugamber
			}
		}
		hidden_effect = {
			clr_country_flag = A48_cold_feet
			clr_country_flag = A48_crossbow
			clr_country_flag = A48_drunken_reveal
			clr_country_flag = A48_generic
			clr_country_flag = A48_poisoned
			clr_country_flag = A48_stabbed
			clr_country_flag = sugamber_baldwin_rebellion
			clr_country_flag = sugamber_ethelbert_rebellion
			clr_country_flag = sugamber_lisolette_avenged
			clr_country_flag = sugamber_ethelbert_restored
			clr_country_flag = rebels_lost
			if = { limit = { has_country_flag = gnollish_officer }
				country_event = { id = flavor_sugamber.18 days = 60 }
			}
			every_owned_province = {
				clr_province_flag = sugamber_local_support_for_rebels
			}
		}
	}
}

#Improved Relations with Sugamber
country_event = {
	id = flavor_sugamber.16
	title = flavor_sugamber.16.t
	desc = flavor_sugamber.16.d
	picture = LILAC_WARS_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		clr_country_flag = support_rebels
	}
	
	option = {		# Hopefully he'll one day pays us back.
		name = flavor_sugamber.16.a
		FROM = {
			add_opinion = {
				who = ROOT
				modifier = A48_support_during_succession_war
			}
			remove_opinion = {
				who = ROOT
				modifier = A48_supported_rebels
			}
		}
	}
}

# Relations Deteriorate with Sugamber
country_event = {
	id = flavor_sugamber.17
	title = flavor_sugamber.17.t
	desc = flavor_sugamber.17.d
	picture = LILAC_WARS_eventPicture
	
	is_triggered_only = yes
	
	option = {		#Not mentioning any names? that's how you recognize anyone who's bluffing.
		trigger = { has_country_flag = support_rebels }
		name = flavor_sugamber.17.a
		FROM = {
			add_opinion = {
				who = ROOT
				modifier = A48_supported_rebels
			}
		}
		clr_country_flag = support_rebels
	}
	
	option = {		#Oh, good thing we didn't.
		trigger = { has_country_flag = no_support_for_rebels }
		name = flavor_sugamber.17.b
		FROM = {
			add_opinion = {
				who = ROOT
				modifier = A48_didnt_support_rebels
			}
		}
		clr_country_flag = no_support_for_rebels
	}
}

# Gnollish officers?
country_event = {
	id = flavor_sugamber.18
	title = flavor_sugamber.18.t
	desc = flavor_sugamber.18.d
	picture = LILAC_WARS_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			clr_country_flag = gnollish_officer
		}
	}

	option = {	# Give him a high function.
		name = flavor_sugamber.18.a
		ai_chance = { factor = 10 }
		define_advisor = {
			type = commandant
			skill = 1
			culture = hill_gnoll
			location = 913
			discount = yes
		}
		reduce_legitimacy_medium_effect = yes
		add_prestige = -10
		add_army_tradition = 5
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -5
		}
		add_estate_loyalty = {
			estate = estate_church
			loyalty = -5
		}
		small_increase_of_gnollish_tolerance_effect = yes
	}

	option = {	# Make him an officer.
		name = flavor_sugamber.18.b
		ai_chance = { factor = 50 }
		add_army_tradition = 5
	}

	option = {	# Gnolls already cause enough havoc without recieving high positions.
		name = flavor_sugamber.18.c
		ai_chance = { factor = 40 }
		increase_legitimacy_small_effect = yes
		add_prestige = 5
		add_army_tradition = -5
		small_decrease_of_gnollish_tolerance_effect = yes
	}
}

# To the victor's supporters go the spoils
country_event = {
	id = flavor_sugamber.19
	title = flavor_sugamber.19.t
	desc = flavor_sugamber.19.d
	picture = GOOD_WITH_MONARCH_eventPicture
	
	fire_only_once = yes

	is_triggered_only = yes
	
	trigger = {
		tag = A48
	}

	option = { # Divide the crown lands under our supporters.
		name = flavor_sugamber.19.a
		ai_chance = { factor = 20 }
		give_estate_land_share_medium = { estate = estate_nobles }
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = 5
		}
	}

	option = { # Arrange for public offices to be given to their surplus children, even if those traditionaly went to priest or burghers.
		name = flavor_sugamber.19.b
		ai_chance = { factor = 20 }
		add_estate_loyalty = {
			estate = estate_burghers
			loyalty = -5
		}
		add_estate_loyalty = {
			estate = estate_church
			loyalty = -5
		}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = 5
		}
		add_corruption = 5
	}

	option = { # Give them a donation out of the treasury.
		name = flavor_sugamber.19.c
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.1
				num_of_loans = 2
			}
		}
		add_years_of_income = -0.75
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = 5
		}
	}

	option = { # They only did their duty, I don't reward basic decency.
		name = flavor_sugamber.19.e
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.1
				NOT = {
					estate_loyalty = {
						estate = estate_nobles
						loyalty = 40
					}
				}
			}
		}
		reduce_estate_nobles_loyalty_effect = yes
	}
}

# Returning territory to Bisan?
country_event = {
	id = flavor_sugamber.20
	title = flavor_sugamber.20.t
	desc = flavor_sugamber.20.d
	picture = MERCHANTS_TALKING_eventPicture

	is_triggered_only = yes

	option = { # They can have Gnollesgate, the gnolles only makes trouble anyway.
		name = flavor_sugamber.20.a
		trigger = { owns = 913 }
		ai_chance = { factor = 50 }
		913 = {
			cede_province = A34
			remove_core = A48
		}
	}

	option = { # Give them Countsbridge.
		name = flavor_sugamber.20.b
		trigger = { owns = 315 }
		ai_chance = { factor = 20 }
		315 = {
			cede_province = A34
			remove_core = A48
		}
		A34 = {
			add_opinion = {
				who = ROOT
				modifier = A48_gave_important_province
			}
		}
	}

	option = { # Fullfill all their claims.
		name = flavor_sugamber.20.c
		trigger = { 
			owns = 913
			owns = 315
		}
		ai_chance = { factor = 10 }
		913 = {
			cede_province = A34
			remove_core = A48
		}
		315 = {
			cede_province = A34
			remove_core = A48
		}
		A34 = {
			add_historical_friend = A48
			add_opinion = {
				who = ROOT
				modifier = A48_gave_important_province
			}
		}
	}

	option = { # Pay them in cash.
		name = flavor_sugamber.20.e
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0.1
				num_of_loans = 2
			}
			modifier = {
				factor = 3
				NOT = { owns = 913 }
			}
			modifier = {
				factor = 3
				NOT = { owns = 315 }
			}
		}
		add_years_of_income = -1
		A34 = {
			country_event = { id = flavor_sugamber.22 days = 1 } # We recieved tribute from Sugamber
		}
	}

	option = { # Haha! did they really thought we'd pay them back.
		name = flavor_sugamber.20.f
		ai_chance = { factor = 20 }
		A34 = {
			add_historical_rival = A48
			add_opinion = {
				who = ROOT
				modifier = A48_didnt_paid_us_back
			}
		}
	}
}

# Returning territory to Celliande?
country_event = {
	id = flavor_sugamber.21
	title = flavor_sugamber.21.t
	desc = flavor_sugamber.21.d
	picture = MERCHANTS_TALKING_eventPicture

	is_triggered_only = yes

	option = { # They can have Hawkshot, we still have a coastline without it.
		name = flavor_sugamber.21.a
		trigger = { owns = 410 }
		ai_chance = { factor = 50 }
		410 = {
			cede_province = A56
			remove_core = A48
		}
	}

	option = { # Give them Irmathmas, if we haven't got any port we can't get raided by pirates.
		name = flavor_sugamber.21.b
		trigger = { owns = 411 }
		ai_chance = { factor = 21 }
		411 = {
			cede_province = A56
			remove_core = A48
		}
		A56 = {
			add_opinion = {
				who = ROOT
				modifier = A48_gave_important_province
			}
		}
	}

	option = { # Fullfill all their claims.
		name = flavor_sugamber.21.c
		trigger = { 
			owns = 410
			owns = 411
		}
		ai_chance = { factor = 10 }
		410 = {
			cede_province = A56
			remove_core = A48
		}
		411 = {
			cede_province = A56
			remove_core = A48
		}
		A56 = {
			add_historical_friend = A48
			add_opinion = {
				who = ROOT
				modifier = A48_gave_important_province
			}
		}
	}

	option = { # Pay them in cash.
		name = flavor_sugamber.21.e
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0.1
				num_of_loans = 2
			}
			modifier = {
				factor = 3
				NOT = { owns = 410 }
			}
			modifier = {
				factor = 3
				NOT = { owns = 411 }
			}
		}
		add_years_of_income = -1
		A56 = {
			country_event = { id = flavor_sugamber.22 days = 1 } # We recieved tribute from Sugamber
		}
	}

	option = { # Haha, did they really thought we'd pay them back
		name = flavor_sugamber.21.f
		ai_chance = { factor = 21 }
		A56 = {
			add_historical_rival = A48
			add_opinion = {
				who = ROOT
				modifier = A48_didnt_paid_us_back
			}
		}
	}
}

# We recieved tribute from Sugamber
country_event = {
	id = flavor_sugamber.22
	title = flavor_sugamber.22.t
	desc = flavor_sugamber.22.d
	picture = MERCHANTS_TALKING_eventPicture
	is_triggered_only = yes

	option = { # They are lucky that it now would appear unthankful to attack them
		name = flavor_sugamber.22.a
		add_years_of_income = 1.5
	}
}


#################################
#    Sugamber Mission Events    #
#################################

#Rhinmond Carnival Troupe
country_event = {
	id = flavor_sugamber.2000
	title = flavor_sugamber.2000.t
	desc = flavor_sugamber.2000.d
	picture = CULTURE_eventPicture
	is_triggered_only = yes
	goto = sugamber_carnival_provinces

	immediate = {
		hidden_effect = {
			random_owned_area = {
				limit = { 
					is_state_core = ROOT
					area_for_scope_province = { type = all owned_by = ROOT }
				}
				save_event_target_as = sugamber_carnival_provinces
			}
		}
	}

	option = {
		name = flavor_sugamber.2000.a
		ai_chance = { 
			factor = 20 
		}
		event_target:sugamber_carnival_provinces = {
			area = {
				add_province_modifier = {
					name = sugamber_rhinmond_troupe_entertain_peasants_focus
					duration = 1825
				}
			}
		}
	}
	option = {
		name = flavor_sugamber.2000.b
		ai_chance = { 
			factor = 20 
		}
		event_target:sugamber_carnival_provinces = {
			area = {
				add_province_modifier = {
					name = sugamber_rhinmond_troupe_culture_focus
					duration = 1825
				}
			}
		}
	}
	option = {
		name = flavor_sugamber.2000.c
		ai_chance = { 
			factor = 20 
		}
		event_target:sugamber_carnival_provinces = {
			area = {
				add_province_modifier = {
					name = sugamber_rhinmond_troupe_ducats_focus
					duration = 1825
				}
			}
		}
	}
	option = {
		name = flavor_sugamber.2000.e
		ai_chance = { 
			factor = 20 
		}
		event_target:sugamber_carnival_provinces = {
			area = {
				add_province_modifier = {
					name = sugamber_rhinmond_troupe_garrison_focus
					duration = 1825
				}
			}
		}
	}
	option = {
		name = flavor_sugamber.2000.f
		ai_chance = { 
			factor = 20 
		}
		event_target:sugamber_carnival_provinces = {
			area = {
				add_province_modifier = {
					name = sugamber_rhinmond_troupe_entertain_workers_focus
					duration = 1825
				}
			}
		}
	}

	after = {
		country_event = {
			id = flavor_sugamber.2000
			days = 1825
		}
		set_country_flag = sugamber_rhinmond_troupe_fired
	}
}

#The Bisan Partition - start
country_event = {
	id = flavor_sugamber.2001
	title = flavor_sugamber.2001.t
	desc = flavor_sugamber.2001.d
	picture = DIPLOMACY_eventPicture
	is_triggered_only = yes
	hidden = yes

	#Send the ultimatum!
	option = {
		name = flavor_sugamber.2001.a
		A34 = {
			country_event = {
				id = flavor_sugamber.2002
				days = 7
			}
		}
	}
}

#Bisan gets the ultimatum
country_event = {
	id = flavor_sugamber.2002
	title = flavor_sugamber.2002.t
	desc = flavor_sugamber.2002.d
	picture = DIPLOMACY_eventPicture
	is_triggered_only = yes

	#Get partitioned
	option = {
		name = flavor_sugamber.2002.a
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				total_development = 55
			}
		}
		FROM = {
			country_event = {
				id = flavor_sugamber.2003
				days = 7
			}
		}
	}

	#Refuse to get partitioned
	option = {
		name = flavor_sugamber.2002.b
		ai_chance = {
			factor = 90
		}		
		FROM = {
			country_event = {
				id = flavor_sugamber.2004
				days = 7
			}
		}
	}
}

#Bisan accepts - nice
country_event = {
	id = flavor_sugamber.2003
	title = flavor_sugamber.2003.t
	desc = flavor_sugamber.2003.d
	picture = DIPLOMACY_eventPicture
	is_triggered_only = yes

	option = {
		name = flavor_sugamber.2003.a
		if = {
			limit = {
				A34 = {
					owns = 300
				}
			}
			300 = {
				cede_province = A30
				add_core = A30
			}
		}
		if = {
			limit = {
				A34 = {
					owns = 332
				}
			}
			332 = {
				cede_province = A30
				add_core = A30
			}
		}
		if = {
			limit = {
				A34 = {
					owns = 903
				}
			}
			903 = {
				cede_province = A30
				add_core = A30
			}
		}
		if = {
			limit = {
				A34 = {
					owns = 579
				}
			}
			579 = {
				cede_province = A48
				add_core = A48
			}
		}
		if = {
			limit = {
				A34 = {
					owns = 923
				}
			}
			923 = {
				cede_province = A48
				add_core = A48
			}
		}
		if = {
			limit = {
				A34 = {
					owns = 294
				}
			}
			294 = {
				cede_province = A48
				add_core = A48
			}
		}
	}
}

#Bisan refuses - to war!
country_event = {
	id = flavor_sugamber.2004
	title = flavor_sugamber.2004.t
	desc = flavor_sugamber.2004.d
	picture = BATTLE_eventPicture
	is_triggered_only = yes

	option = {
		name = flavor_sugamber.2004.a
		declare_war_with_cb = {
			casus_belli = cb_annex
			who = A34
		}
		A30 = {
			join_all_offensive_wars_of = ROOT
		}
		if = {
			limit = {
				A34 = {
					owns = 300
				}
			}
			300 = {
				add_claim = A30
			}
		}
		if = {
			limit = {
				A34 = {
					owns = 332
				}
			}
			332 = {
				add_claim = A30
			}
		}
		if = {
			limit = {
				A34 = {
					owns = 903
				}
			}
			903 = {
				add_claim = A30
			}
		}
		if = {
			limit = {
				A34 = {
					owns = 579
				}
			}
			579 = {
				add_claim = A48
			}
		}
		if = {
			limit = {
				A34 = {
					owns = 923
				}
			}
			923 = {
				add_claim = A48
			}
		}
		if = {
			limit = {
				A34 = {
					owns = 294
				}
			}
			294 = {
				add_claim = A48
			}
		}
	}
}


#Make Orda Aldresia a march?
country_event = {
	id = flavor_sugamber.2005
	title = flavor_sugamber.2005.t
	desc = flavor_sugamber.2005.d
	picture = DIPLOMACY_eventPicture
	is_triggered_only = yes

	#Accepts
	option = {
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				FROM = {
					is_emperor = no
				}
				total_development = 50
			}
			modifier = {
				factor = 0
				FROM = {
					is_emperor = no
					NOT = {
						has_matching_religion = THIS
					}
				}
			}
		}
		name = flavor_sugamber.2005.a
		FROM = {
			country_event = {
				id = flavor_sugamber.2006
				days = 7
			}
		}
	}

	#Declines
	option = {
		ai_chance = {
			factor = 3
			modifier = {
				factor = 0.1
				FROM = {
					is_emperor = yes
				}
			}
		}
		name = flavor_sugamber.2005.b
		FROM = {
			country_event = {
				id = flavor_sugamber.2007
				days = 7
			}
		}
	}
}

#Orda Aldresia accepts
country_event = {
	id = flavor_sugamber.2006
	title = flavor_sugamber.2006.t
	desc = flavor_sugamber.2006.d
	picture = DIPLOMACY_eventPicture
	is_triggered_only = yes

	option = {
		name = flavor_sugamber.2006.a
		add_trust = {
			who = FROM
			value = 20
			mutual = yes
		}
		create_subject = {
			subject_type = march
			subject = A77
		}
	}
}

#Orda Aldresia declines
country_event = {
	id = flavor_sugamber.2007
	title = flavor_sugamber.2007.t
	desc = flavor_sugamber.2007.d
	picture = DIPLOMACY_eventPicture
	is_triggered_only = yes

	option = {
		name = flavor_sugamber.2007.a
		rotwall_area = {
			add_claim = ROOT
		}
		ROOT = {
			add_prestige = -10
		}
	}
}

#The Alpha Pack - start
country_event = {
 	id = flavor_sugamber.2008
	title = flavor_sugamber.2008.t
	desc = flavor_sugamber.2008.d
	picture = BORDER_TENSION_eventPicture
	is_triggered_only = yes

	#Give some... support to the Flamemarked Gnolls
	option = {
		name = flavor_sugamber.2008.a
		ai_chance = {
			factor = 50
		}
		set_country_flag = sugamber_flamemaked_gnolls_dominant
		add_years_of_income = -0.5
		add_prestige = -10
	}

	#Give some... support to the Hill Gnolls
	option = {
		name = flavor_sugamber.2008.b
		ai_chance = {
			factor = 50
		}
		set_country_flag = sugamber_hill_gnolls_dominant
		add_years_of_income = -0.5
		add_prestige = -10
	}

	#Their fights don't concern us
	option = {
		name = flavor_sugamber.2008.c
		ai_chance = {
			factor = 50
		}
		hidden_effect = {
			random_list = {
				50 = {
					set_country_flag = sugamber_flamemaked_gnolls_dominant
				}
				50 = {
					set_country_flag = sugamber_hill_gnolls_dominant
				}
			}
		}
		add_prestige = 10
	}

	after = {
		hidden_effect = {
			country_event = {
				id = flavor_sugamber.2009
				days = 30
			}
		}
	}
}

#Alpha pack winner
country_event = {
	id = flavor_sugamber.2009
	title = flavor_sugamber.2009.t
	desc = flavor_sugamber.2009.d
	picture = BORDER_TENSION_eventPicture
	is_triggered_only = yes

	option = {
		name = flavor_sugamber.2009.a
		if = {
			limit = { has_country_flag = sugamber_flamemaked_gnolls_dominant }
			add_country_modifier = {
				name = sugamber_alpha_flamemarked_win
				duration = -1
			}
		}
		else_if = {
			limit = { has_country_flag = sugamber_hill_gnolls_dominant }
			add_country_modifier = {
				name = sugamber_alpha_pack_hill_win
				duration = -1
			}
		}
	}
	after = {
		hidden_effect = {
			country_event = {
				id = flavor_sugamber.2010
				days = 30
			}
		}
	}
}

#Winner causes looting and devastation
country_event = {
	id = flavor_sugamber.2010
	title = flavor_sugamber.2010.t
	desc = flavor_sugamber.2010.d
	picture = VILLAGE_BURNING_eventPicture
	is_triggered_only = yes

	#What can ya do
	option = {
		name = flavor_sugamber.2010.a
		ai_chance = {
			factor = 50
		}
		if = {
			limit = { has_country_flag = sugamber_flamemaked_gnolls_dominant }
			gnollsgate_area = {
				add_devastation = 50
				add_local_autonomy = 25
			}
		}
		else_if = {
			limit = { has_country_flag = sugamber_hill_gnolls_dominant }
			central_dreadmire_area = {
				add_devastation = 50
				add_local_autonomy = 25
			}
		}
	}

	#Damn these unruly Gnolls
	option = {
		name = flavor_sugamber.2010.b
		ai_chance = {
			factor = 50
		}
		if = {
			limit = { has_country_flag = sugamber_flamemaked_gnolls_dominant }
			central_dreadmire_area = {
				spawn_rebels = {
					type = xhazobkult_rebels
					size = 1
				}
			}
			add_country_modifier = {
				name = sugamber_gnoll_unrest
				duration = 1850
			}
		}
		else_if = {
			limit = { has_country_flag = sugamber_hill_gnolls_dominant }
			gnollsgate_area = {
				spawn_rebels = {
					type = xhazobkult_rebels
					size = 1
				}
			}
			add_country_modifier = {
				name = sugamber_gnoll_unrest
				duration = 1850
			}
		}
	}
	after = {
		clr_country_flag = sugamber_hill_gnolls_dominant
		clr_country_flag = sugamber_flamemarked_gnolls_dominant
	}
}