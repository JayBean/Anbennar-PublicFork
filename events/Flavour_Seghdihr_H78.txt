
namespace = flavor_seghdihr
#1-49 missions
#50-99 goblin incursions
#100+ SGC

#Missions
#
#goblin initial attack
country_event = {
	id = flavor_seghdihr.1
	title = flavor_seghdihr.1.t
	desc = flavor_seghdihr.1.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.1.a
		4090 = { 
			add_devastation = 25
			spawn_rebels = {
				type = cave_goblin_rebel
				size = 1
			}
		}
		4218 = {
			add_devastation = 30
			spawn_rebels = {
				type = cave_goblin_rebel
				size = 2
			}
		}
		custom_tooltip = flavor_seghdihr.1.tooltip
		hidden_effect = { 
			#####set up incursions
			set_country_flag = seghdihr_incursions_active
			set_variable = { which = incursion_gathering_strength value = 0 }
			set_variable = { which = incursion_mission_bonus value = 0 }
			seghdihr_calculate_incursion_strength = yes
		}
		ai_chance = { factor = 5 }
	}
}

#VG event
country_event = {
	id = flavor_seghdihr.2
	title = flavor_seghdihr.2.t
	desc = flavor_seghdihr.2.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.2.a
		reverse_add_opinion = { who = H78 modifier = opinion_disappointed }
		add_prestige = 15
		H78 = { country_event = { id = flavor_seghdihr.3 } }
		ai_chance = { factor = 5 }
	}
}

#Seghdihr gets reply
country_event = {
	id = flavor_seghdihr.3
	title = flavor_seghdihr.3.t
	desc = flavor_seghdihr.3.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.3.a
		add_casus_belli = { type = cb_vassalize_mission target = F47 }
		ai_chance = { factor = 5 }
	}
}

#kings dilemma
country_event = {
	id = flavor_seghdihr.4
	title = flavor_seghdihr.4.t
	desc = flavor_seghdihr.4.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.4.a
		if = {
			limit = { has_country_modifier = seghdihr_seg_band_contract }
			remove_country_modifier = seghdihr_seg_band_contract
		}
		if = {
			limit = { NOT = { has_estate_privilege = estate_adventurers_organization_licensed_adventurers } }
			set_estate_privilege = estate_adventurers_organization_licensed_adventurers
		}
		else_if = {
			limit = { has_estate_privilege = estate_adventurers_ennoblement_of_adventurers }
			remove_estate_privilege = estate_adventurers_ennoblement_of_adventurers
		}
		else_if = {
			limit = { has_estate_privilege = estate_adventurers_free_company_rosters }
			remove_estate_privilege = estate_adventurers_free_company_rosters
		}
		else_if = {
			limit = { has_estate_privilege = estate_adventurers_heroes_in_the_army }
			remove_estate_privilege = estate_adventurers_heroes_in_the_army
		}
		else_if = {
			limit = { has_estate_privilege = estate_adventurers_advisors }
			remove_estate_privilege = estate_adventurers_advisors
		}
		add_estate_loyalty = { estate = estate_adventurers loyalty = -10 }
		ai_chance = { factor = 5 }
	}
}

#true unity
country_event = {
	id = flavor_seghdihr.5
	title = flavor_seghdihr.5.t
	desc = flavor_seghdihr.5.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = flavor_seghdihr.5.a
		#take diplo if vassal fed
		custom_tooltip = flavor_seghdihr.5.tooltip
		hidden_effect = {
			F47 = {
				every_owned_province = {
					limit = {
						NOT = { area = verkal_gulan_area }
						NOT = { province_id = 2915 }
					}
					ROOT = { add_dip_power = -5 }
				}
			}
			I15 = {
				every_owned_province = {
					limit = { NOT = { area = hehos_legacy_area  } }
					ROOT = { add_dip_power = -5 }
				}
			}
			I14 = {
				every_owned_province = {
					limit = { NOT = { area = vazumbrog_area } }
					ROOT = { add_dip_power = -5 }
				}
			}
			I17 = {
				every_owned_province = {
					limit = { NOT = { area = ozumbrog_area } }
					ROOT = { add_dip_power = -5 }
				}
			}
		}

		#change to historical cultures and inherit
		verkal_gulan_area = { change_culture = gold_dwarf }
		2915 = { change_culture = gold_dwarf }
		inherit = F47
		hehos_legacy_area = { change_culture = pyrite_dwarf }
		inherit = I15
		vazumbrog_area = { change_culture = titanium_dwarf }
		inherit = I14
		ozumbrog_area = { change_culture = topaz_dwarf }
		inherit = I17

		#colonization buff if needed
		if = {
			limit = {
				middle_dwarovar_region = {
					calc_true_if = {
						amount = 10
						NOT = { is_city = yes }
					}
				}
			}
			add_country_modifier = { name = seghdihr_colonization_buff duration = 7300 }
		}

		#gov reform, name, and missions
		add_government_reform = seghdihr_segbandal_reform
		override_country_name = THE_SEGBANDAL
		set_country_flag = seghdihr_part2
		swap_non_generic_missions = yes
		ai_chance = { factor = 5 }
	}
}

#way of force-gulan
country_event = {
	id = flavor_seghdihr.6
	title = flavor_seghdihr.6.t
	desc = flavor_seghdihr.6.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.6.a
		add_country_modifier = { name = seghdihr_force_cannons duration = -1 }
		ai_chance = { factor = 5 }
	}
	option = {
		name = flavor_seghdihr.6.b
		add_country_modifier = { name = seghdihr_force_generals duration = -1 }
		ai_chance = { factor = 5 }
	}
	option = {
		name = flavor_seghdihr.6.c
		add_country_modifier = { name = seghdihr_force_sieges duration = -1 }
		ai_chance = { factor = 5 }
	}
}

#way of vigilance-ozumbrog
country_event = {
	id = flavor_seghdihr.7
	title = flavor_seghdihr.7.t
	desc = flavor_seghdihr.7.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.7.a
		add_country_modifier = { name = seghdihr_vigilance_speed duration = -1 }
		ai_chance = { factor = 5 }
	}
	option = {
		name = flavor_seghdihr.7.b
		add_country_modifier = { name = seghdihr_vigilance_garrison duration = -1 }
		ai_chance = { factor = 5 }
	}
	option = {
		name = flavor_seghdihr.7.c
		add_country_modifier = { name = seghdihr_vigilance_tactics duration = -1 }
		ai_chance = { factor = 5 }
	}
}

#integrating seg band
country_event = {
	id = flavor_seghdihr.8
	title = flavor_seghdihr.8.t
	desc = flavor_seghdihr.8.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	immediate = {
		hidden_effect = { add_country_modifier = { name = seghdihr_integrate_band duration = 1825 } }
	}

	option = {
		name = flavor_seghdihr.8.a
		tooltip = { add_country_modifier = { name = seghdihr_integrate_band duration = 1825 } }
		ai_chance = { factor = 5 }
	}
}

#enacting segbandal military
country_event = {
	id = flavor_seghdihr.9
	title = flavor_seghdihr.9.t
	desc = flavor_seghdihr.9.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.9.a
		add_government_reform = seghdihr_segbandalic_military
		ai_chance = { factor = 5 }
	}
}

#way of defiance-seghdihr
country_event = {
	id = flavor_seghdihr.10
	title = flavor_seghdihr.10.t
	desc = flavor_seghdihr.10.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.10.a
		add_country_modifier = { name = seghdihr_defiance_morale duration = -1 }
		ai_chance = { factor = 5 }
	}
	option = {
		name = flavor_seghdihr.10.b
		add_country_modifier = { name = seghdihr_defiance_generals duration = -1 }
		ai_chance = { factor = 5 }
	}
	option = {
		name = flavor_seghdihr.10.c
		add_country_modifier = { name = seghdihr_defiance_defence duration = -1 }
		ai_chance = { factor = 5 }
	}
}

#syndicates
country_event = {
	id = flavor_seghdihr.11
	title = flavor_seghdihr.11.t
	desc = flavor_seghdihr.11.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.11.a
		#hold trade goods
		if = {
			limit = {
				4247 = {
					OR = {
						trade_goods = wine
						trade_goods = serpentbloom
						trade_goods = livestock
						trade_goods = fungi
						trade_goods = salt
					}
				}
			}
			4247 = {
				random_list = {
					20 = { change_trade_goods = copper }
					20 = { change_trade_goods = cloth }
					20 = { change_trade_goods = iron }
					20 = { change_trade_goods = glass }
					20 = { change_trade_goods = paper }
				}
			}
		}
		if = {
			limit = {
				4265 = {
					OR = {
						trade_goods = wine
						trade_goods = serpentbloom
						trade_goods = livestock
						trade_goods = fungi
						trade_goods = salt
					}
				}
			}
			4265 = {
				random_list = {
					20 = { change_trade_goods = copper }
					20 = { change_trade_goods = cloth }
					20 = { change_trade_goods = iron }
					20 = { change_trade_goods = glass }
					20 = { change_trade_goods = paper }
				}
			}
		}
		#syndicate vassals
		create_subject = {
			subject_type = seghdihr_syndicate
			subject = H79 
		}
		create_subject = {
			subject_type = seghdihr_syndicate
			subject = I18 
		}
		#split the land
		custom_tooltip = flavor_seghdihr.11_tooltip
		hidden_effect = {
			tree_of_stone_region = {
				#kanzad
				if = {
					limit = { 
						NOT = { owned_by = H79 }
						OR = {
							area = dwarovrod_45_48_area
							area = kanzad_area
							area = anduz_area
							province_id = 4267 #mit
							province_id = 4282 #cannonpass
							province_id = 4249 #dwarovrod50
						}
					}
					remove_core = owner
					add_core = H79
					cede_province = H79
				}
				#grozumdihr
				else_if = {
					limit = {
						NOT = { owned_by = I18 }
						OR = {
							area = earthseed_area
							area = grozumdihr_area
							province_id = 4271 #ambermine
							province_id = 4270 #hordesbreach
							province_id = 4251 #grozumrod1
						}
					}
					remove_core = owner
					add_core = I18
					cede_province = I18
				}
			}
			##change cultures
			H79 = {
				change_primary_culture = amber_dwarf
				set_ruler_culture = amber_dwarf
				change_religion = ancestor_worship
				set_ruler_religion = ancestor_worship
				every_owned_province = {
					limit = { culture_group = dwarven }
					change_culture = amber_dwarf
				}
			}
			I18 = {
				change_primary_culture = peridot_dwarf
				set_ruler_culture = peridot_dwarf
				change_religion = ancestor_worship
				set_ruler_religion = ancestor_worship
				every_owned_province = {
					limit = { culture_group = dwarven }
					change_culture = peridot_dwarf
				}
			}
		}
		#upgrade modifier
		if = {
			limit = { has_country_modifier = seghdihr_limit_flow_2a }
			remove_country_modifier = seghdihr_limit_flow_2a
			add_country_modifier = { name = seghdihr_limit_flow_3a duration = -1 }
		}
		else_if = {
			limit = { has_country_modifier = seghdihr_limit_flow_2b }
			remove_country_modifier = seghdihr_limit_flow_2b
			add_country_modifier = { name = seghdihr_limit_flow_3b duration = -1 }
		}
		else = {
			remove_country_modifier = seghdihr_limit_flow_2c
			add_country_modifier = { name = seghdihr_limit_flow_3c duration = -1 }
		}
		#give claims
		ovdal_az_an_area = { add_permanent_claim = ROOT }
		the_kariats_area = { add_permanent_claim = ROOT }
		ibran_pass_area = { add_permanent_claim = ROOT }
		#missions
		set_country_flag = seghdihr_part3
		swap_non_generic_missions = yes
		ai_chance = { factor = 5 }
	}
}

#integrating soldiers
country_event = {
	id = flavor_seghdihr.12
	title = flavor_seghdihr.12.t
	desc = flavor_seghdihr.12.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	immediate = {
		hidden_effect = { add_country_modifier = { name = seghdihr_integrate_soldiers duration = 1825 } }
	}

	option = {
		name = flavor_seghdihr.12.a
		tooltip = { add_country_modifier = { name = seghdihr_integrate_soldiers duration = 1825 } }
		ai_chance = { factor = 5 }
	}
}

#kings of all
country_event = {
	id = flavor_seghdihr.13
	title = flavor_seghdihr.13.t
	desc = flavor_seghdihr.13.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	
	option = {
		name = flavor_seghdihr.13.a
		set_dynasty = "az-hargûn"
		add_government_reform = seghdihr_segamlavad
		2914 = { set_seat_in_parliament = yes }
		4078 = { set_seat_in_parliament = yes }
		4218 = { set_seat_in_parliament = yes }
		4217 = { set_seat_in_parliament = yes }
		ai_chance = { factor = 5 }
	}
}

#way of preparation-vazumbrog
country_event = {
	id = flavor_seghdihr.14
	title = flavor_seghdihr.14.t
	desc = flavor_seghdihr.14.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.14.a
		add_country_modifier = { name = seghdihr_preparation_decay duration = -1 }
		ai_chance = { factor = 5 }
	}
	option = {
		name = flavor_seghdihr.14.b
		add_country_modifier = { name = seghdihr_preparation_speed duration = -1 }
		ai_chance = { factor = 5 }
	}
	option = {
		name = flavor_seghdihr.14.c
		add_country_modifier = { name = seghdihr_preparation_reinforce duration = -1 }
		ai_chance = { factor = 5 }
	}
}

#way of tenacity-hehodovar
country_event = {
	id = flavor_seghdihr.15
	title = flavor_seghdihr.15.t
	desc = flavor_seghdihr.15.d
	picture = FORT_eventPicture
	
	is_triggered_only = yes
	trigger = { always = yes }

	option = {
		name = flavor_seghdihr.15.a
		add_country_modifier = { name = seghdihr_tenacity_attrition duration = -1 }
		ai_chance = { factor = 5 }
	}
	option = {
		name = flavor_seghdihr.15.b
		add_country_modifier = { name = seghdihr_tenacity_fire duration = -1 }
		ai_chance = { factor = 5 }
	}
	option = {
		name = flavor_seghdihr.15.c
		add_country_modifier = { name = seghdihr_tenacity_shock duration = -1 }
		ai_chance = { factor = 5 }
	}
}














######Goblin Incursions######
country_event = {
	id = flavor_seghdihr.50
	title = flavor_seghdihr.50.t
	desc = flavor_seghdihr.50.d
	picture = FORT_eventPicture
	
	#hidden = yes
	is_triggered_only = yes
	
	trigger = {
		tag = H78
		has_country_flag = seghdihr_incursions_active
	}


	immediate = {
		seghdihr_calculate_incursion_strength = yes
		#incursion_base_strength
	}



	option = {
		name = flavor_seghdihr.4.a
		
		ai_chance = { factor = 5 }
	}
}