namespace = flavor_azjakuma

#Event Guide
#4 Elections
#15-19 105-109 Command Truce Events
#21-104 first part non on_action events
#1001-1002 Debug
#1101 cedes uncolonized province 70 years after start
#1250 Shirgrii Magic Menu and Events
#2500 on_province_owner_change
#2600 Kongren Event Chain (second part of mission tree)
#2650 All vassal/rethagi events, mostly from missions. Mostly events to release subjects or not
#2700 Xianjie disaster events
#2800 misc (1 event currently)

country_event = {
	id = flavor_azjakuma.4
	title =  flavor_azjakuma.4.t
	desc =  flavor_azjakuma.4.d
	picture = ONI_FORTRESS_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_reform = tagharoghi_reform
		NOT = { has_country_flag = in_oni_heir_selection }
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = in_oni_heir_selection
		}
	}
	
	option = {
		name = flavor_azjakuma.4.a
		ai_chance = { factor = 100 }
		trigger = {
			has_estate = estate_shinukhorchi
		}
		add_adm_power = 75
		define_heir = {
			dynasty = "Aromo"
			age = 40
			claim = 90
			culture = horned_ogre
			max_random_adm = 5
			max_random_dip = 5
			max_random_mil = 5
		}
		set_country_flag = oni_heir_shinukhorchi
		clr_country_flag = in_oni_heir_selection
		custom_tooltip = shinukhorchi_heir_event_tooltip
	}
	
	option = {
		name = flavor_azjakuma.4.b
		ai_chance = { factor = 100 }
		trigger = {
			has_estate = estate_chumijemoya
		}
		add_dip_power = 75
		define_heir = {
			dynasty = "Talshimok"
			age = 30
			claim = 90
			culture = horned_ogre
			max_random_adm = 4
			max_random_dip = 6
			max_random_mil = 4
		}
		set_country_flag = oni_heir_chumijemoya
		clr_country_flag = in_oni_heir_selection
		custom_tooltip = chumijemoya_heir_event_tooltip
	}
	
	option = {
		name = flavor_azjakuma.4.c
		ai_chance = { factor = 100 }
		trigger = {
			has_estate = estate_ajgriijarul
		}
		add_mil_power = 75
		define_heir = {
			dynasty = "Surgoshi"
			age = 20
			claim = 90
			culture = horned_ogre
			max_random_adm = 4
			max_random_dip = 4
			max_random_mil = 6
		}
		set_country_flag = oni_heir_ajgriijarul
		clr_country_flag = in_oni_heir_selection
		custom_tooltip = ajgriijarul_heir_event_tooltip
	}
	
	option = {
		name = flavor_azjakuma.4.e
		ai_chance = { factor = 100 }
		trigger = {
			has_estate = estate_kabiurgarko
		}
		add_years_of_income = 1.25
		define_heir = {
			dynasty = "Moguruld"
			age = 30
			claim = 90
			culture = horned_ogre
			max_random_adm = 6
			max_random_dip = 4
			max_random_mil = 4
		}
		set_country_flag = oni_heir_kabiurgarko
		clr_country_flag = in_oni_heir_selection
		custom_tooltip = kabiurgarko_heir_event_tooltip
	}
	
	option = {
		name = flavor_azjakuma.4.f
		ai_chance = { factor = 100 }
		trigger = {
			has_estate = estate_khelorvalshi
		}
		add_adm_power = 25
		add_dip_power = 25
		add_mil_power = 25
		define_heir = {
			dynasty = "Jishuro"
			age = 30
			claim = 90
			culture = horned_ogre
			max_random_adm = 6
			max_random_dip = 6
			max_random_mil = 6
		}
		set_country_flag = oni_heir_khelorvalshi
		clr_country_flag = in_oni_heir_selection
		custom_tooltip = khelorvalshi_heir_event_tooltip
	}
}

#Command Azjakuma truce start
country_event = {
	#send offer or do not
	id = flavor_azjakuma.15
	title = flavor_azjakuma.15.t
	desc = flavor_azjakuma.15.d
	picture = ONI_THINK_HOBGOBLIN_eventPicture
	is_triggered_only = yes
	fire_only_once = yes
	trigger = {
		tag = Y01
	}

	immediate = {
		hidden_effect = {
			4833 = {
				province_event = {
					id = flavor_azjakuma.1102
					days = 18250 #50 years after game start
				}
			}
		}
	}

	option = {
		name = flavor_azjakuma.15.a #make truce offer
		ai_chance = { factor = 100 }
		add_prestige = -10
		R62 = { #command
			country_event = {
				id = flavor_azjakuma.18
			}
		}
		hidden_effect = { clr_country_flag = oni_truce_happened }
	}
	option = {
		name = flavor_azjakuma.15.b #do not make truce offer
		ai_chance = { factor = 0 }
		add_prestige = 15

		R62 = {
			country_event = {
				id = flavor_azjakuma.19
				days = 365
			}
		}
		hidden_effect = { clr_country_flag = oni_truce_happened }
	}
}

country_event = { #command accepts
	#command accepts
	id = flavor_azjakuma.16
	title = flavor_azjakuma.16.t
	desc = flavor_azjakuma.16.d
	picture = DIPLOMACY_SIGNING_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavor_azjakuma.16.a
		ai_chance = { factor = 1 }

		tooltip = {
			R62 = { #command
				add_truce_with = Y01
				add_truce_with = Y89 #yuantsai
				command_change_korashi_supply = { increase = yes }
			}
		}
		5430 = { #shinukhorchi
			add_province_modifier = {
				name = azjakuma_korashi_diverted #-75% local prod eff
				duration = 1825
			}
		}
	}
}

country_event = {#command rejects
	id = flavor_azjakuma.17
	title = flavor_azjakuma.17.t
	desc = flavor_azjakuma.17.d
	picture = CONSPIRACY_eventpicture

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavor_azjakuma.17.a
		ai_chance = { factor = 30 }
		add_stability = -1
	}
}

country_event = { #Azjakuma Deal initial offer recieved
	id = flavor_azjakuma.18
	title = flavor_azjakuma.18.t
	desc = flavor_azjakuma.18.d
	picture = WESTERNISATION_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	option = { #accept offer
		name = flavor_azjakuma.18.a
		ai_chance = {
			factor = 100
		}
		highlight = yes
		
		add_truce_with = Y01
		add_truce_with = Y89 #yuantsai
		command_change_korashi_supply = { increase = yes }
		Y01 = {
			country_event = {
				id = flavor_azjakuma.16
			}
		}
		if = {
			limit = {
				NOT = {
					is_year = 1480
				}
			}
			hidden_effect = {
				Y01 = {
					country_event = {
						id = flavor_azjakuma.105
						days = 1825
					}
				}
				country_event = {
					id = flavor_azjakuma.110
					days = 1825
				}
			}
		}
	}
	option = { #reject offer
		name = flavor_azjakuma.18.b
		ai_chance = {
			factor = 0
		}
		
		custom_tooltip = command_will_no_longer_import_korashi_tt
		Y01 = {
			country_event = {
				id = flavor_azjakuma.17
			}
		}
	}
}

country_event = { #Azjakuma didn't extend offer
	id = flavor_azjakuma.19
	title = flavor_azjakuma.19.t
	desc = flavor_azjakuma.19.d
	picture = IMPERIAL_SEAL_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	option = { 
		name = flavor_azjakuma.19.a
		ai_chance = {
			factor = 1
		}
	}
}
#goto 105, truce renewal events
##Command Azjakuma truce end

# country_event = {
# 	#Cautious acceptance
# 	id = flavor_azjakuma.21
# 	title = flavor_azjakuma.21.t
# 	desc = flavor_azjakuma.21.d
# 	picture = COMET_SIGHTED_eventPicture

# 	trigger = {
# 		tag = Y01
# 	}

# 	fire_only_once = yes
# 	is_triggered_only = yes

# 	option = {
# 		name = flavor_azjakuma.21.a
# 		ai_chance = { factor = 1 }

# 		custom_tooltip = azjakuma_birb_rejection_to_caution_tooltip
# 		hidden_effect = {
# 			every_owned_province = {
# 				limit = {
# 					has_province_modifier = azjakuma_birb_rejection #-3 mis strength
# 				}
# 				remove_province_modifier = azjakuma_birb_rejection
# 				add_permanent_province_modifier = {
# 					name = azjakuma_birb_caution
# 					duration = -1
# 				}
# 			}
# 		}
# 	}
# }

country_event = {
	#Oni Immigration
	id = flavor_azjakuma.22
	title = flavor_azjakuma.22.t
	desc = flavor_azjakuma.22.d
	picture = CARAVAN_EVENT_Picture
	goto = oni_immigration_target

	trigger = {
		tag = Y01
		has_country_flag = oni_birb_immigration_allowed
		any_owned_province = {
			is_core = ROOT
			culture = shuvuush
			trade_goods = grain
			NOT = {
				has_province_modifier = ogre_minority_integrated_large
				has_province_modifier = ogre_minority_integrated_small
			}
		}
	}

	immediate = {
		hidden_effect = {
			random_core_province = {
				limit = {
					culture = shuvuush
					trade_goods = grain
					NOT = {
						has_province_modifier = ogre_minority_integrated_large
						has_province_modifier = ogre_minority_integrated_small
						culture = horned_ogre
					}
				}
				save_event_target_as = oni_immigration_target
			}
		}
	}

	mean_time_to_happen = {
		months = 20
	}

	option = {
		name = flavor_azjakuma.22.a
		ai_chance = { factor = 1 }
		
		event_target:oni_immigration_target = {
			add_ogre_minority_size_effect = yes
		}		
	}
}

country_event = {
	#Full integration of the Shuvuush
	id = flavor_azjakuma.23
	title = flavor_azjakuma.23.t
	desc = flavor_azjakuma.23.d
	picture = ONI_HUMANS_eventPicture

	trigger = {
		tag = Y01
	}
	fire_only_once = yes
	is_triggered_only = yes
	

	option = {
		name = flavor_azjakuma.23.a
		ai_chance = { factor = 1 }

		custom_tooltip = azjakuma_birb_full_integration_tooltip
		hidden_effect = {
			clr_country_flag = oni_birb_caution_setup
			set_country_flag = oni_birb_accepted
			every_owned_province = {
				limit = {
					OR = {
						has_province_modifier = azjakuma_birb_rejection
						has_province_modifier = azjakuma_birb_caution
					}
				}
				remove_province_modifier = azjakuma_birb_rejection
				remove_province_modifier = azjakuma_birb_caution
			}
		}
	}
}

# province_event = {
# 	id = flavor_azjakuma.24
# 	title = flavor_azjakuma.20.t
# 	desc = flavor_azjakuma.24.d
# 	picture = COMET_SIGHTED_eventPicture

# 	is_triggered_only = yes

# 	trigger = {
# 		owner = {
# 			tag = Y01
# 			has_country_flag = oni_birb_caution_setup
# 		}
# 		culture = shuvuush
# 		NOT = {
# 			has_province_modifier = azjakuma_birb_caution #-3 mis strength
# 		}
# 	}

# 	option = {
# 		name = flavor_azjakuma.24.a
# 		ai_chance = { factor = 1 }

# 		custom_tooltip = azjakuma_birb_caution_tooltip
# 		hidden_effect = {
# 			owner = {
# 				every_owned_province = {
# 					limit = {
# 						culture = shuvuush
# 						NOT = {
# 							has_province_modifier = azjakuma_birb_caution
# 						}
# 					}
# 					add_permanent_province_modifier = {
# 						name = azjakuma_birb_caution
# 						duration = -1
# 					}
# 				}
# 			}
# 		}
# 	}
# }

country_event = {
	#informing nation that get defensiveness debuff they have been infiltrated
	id = flavor_azjakuma.25
	title = flavor_azjakuma.25.t
	desc = flavor_azjakuma.25.d
	picture = SPY_eventPicture

	is_triggered_only = yes
	
	option = {
		name = flavor_azjakuma.25.a
		ai_chance = { factor = 1 }

		add_country_modifier = {
			name = azjakuma_infiltrated_khelorvalshi #-25% defensivness
			duration = 3650 #10 years
		}
	}
}

country_event = {
	#The Khelorvalshi
	id = flavor_azjakuma.30
	title = flavor_azjakuma.30.t
	desc = flavor_azjakuma.30.d
	picture = ONI_FORTRESS_eventPicture

	is_triggered_only = yes
	fire_only_once = yes
	
	immediate = {
		hidden_effect = {
			set_country_flag = khelorvalshi_restored
		}
	}

	# after = {
	# 	hidden_effect = {
	# 		if = {
	# 			limit = {
	# 				has_country_flag = accepted_khelorvalshi
	# 			}
	# 			add_estate_loyalty_modifier = {
	# 				estate = estate_khelorvalshi
	# 				desc = accepted_cursed_desc
	# 				loyalty = 15
	# 				duration = -1
	# 			}
	# 			add_estate_influence_modifier = {
	# 				estate = estate_khelorvalshi
	# 				desc = accepted_cursed_desc
	# 				influence = 10
	# 				duration = -1
	# 			}
	# 		}
	# 		else_if = {
	# 			limit = {
	# 				has_country_flag = restricted_khelorvalshi
	# 			}
	# 			add_estate_loyalty_modifier = {
	# 				estate = estate_khelorvalshi
	# 				desc = accepted_cursed_desc
	# 				loyalty = 15
	# 				duration = -1
	# 			}
	# 			add_estate_influence_modifier = {
	# 				estate = estate_khelorvalshi
	# 				desc = accepted_cursed_desc
	# 				influence = 10
	# 				duration = -1
	# 			}
	# 		}
	# 	}
	# }

	option = {
		name = flavor_azjakuma.30.a
		ai_chance = { factor = 20 }
		# add_country_modifier = {
		# 	name = azjakuma_accepted_cursed
		# 	duration = -1
		# }
		add_devotion = 10
		custom_tooltip = accepted_cursed_tooltip
		tooltip = {
			set_estate_privilege = estate_khelorvalshi_restrictive_regulations
		}
		hidden_effect = {
			set_country_flag = accepted_khelorvalshi
			country_event = {
				id = flavor_azjakuma.37
				days = 2
			}
		}
	}
	option = {
		name = flavor_azjakuma.30.b
		ai_chance = { factor = 80 }

		# add_country_modifier = {
		# 	name = azjakuma_restrictive_regulations
		# 	duration = -1
		# }
		custom_tooltip = restricive_regulations_tooltip
		tooltip = {
			set_estate_privilege = estate_khelorvalshi_accepted_the_cursed
		}
		add_stability_or_adm_power = yes
		add_devotion = 10
		hidden_effect = {
			set_country_flag = restricted_khelorvalshi
			country_event = {
				id = flavor_azjakuma.37
				days = 2
			}
		}
	}
}

country_event = {
	#The Knowledge of Khelorvalshi
	id = flavor_azjakuma.31
	title = flavor_azjakuma.31.t
	desc = flavor_azjakuma.31.d
	picture = BIG_BOOK_eventPicture

	is_triggered_only = yes

	option = {
		name = flavor_azjakuma.31.a
		ai_chance = { factor = 20 }

		add_country_modifier = {
			name = azjakuma_khelorvalshi_libraries
			duration = 7300
		}
		hidden_effect = {
			set_country_flag = khelorvalshi_studying
		}
	}

	option = {
		name = flavor_azjakuma.31.b
		ai_chance = { factor = 80 }

		add_stability_or_adm_power = yes
		add_adm_power = 50
		add_dip_power = 50
		add_mil_power = 50
		hidden_effect = {
			set_country_flag = khelorvalshi_not_studying
		}
	}
}

country_event = {
	#Meeting of the High Council | END OF PART 1
	id = flavor_azjakuma.32
	title = flavor_azjakuma.32.t
	desc = flavor_azjakuma.32.d
	picture = COURT_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	#the cost (stab/rebels) is affected by the flags set in events 30 and 31
	option = { #demon empire, this will expand into yanshen, xianjie, shuvuushudi, odheongu, and up to the yanhe in shamakhad
		name = flavor_azjakuma.32.b #how to tell paths were cut, the only option is labeled 'b'
		ai_chance = { factor = 25 }

		#hidden_effect = {
		#	lose_reforms = 10 # Reset reform progress
		#}

		custom_tooltip = azjakuma_two_magics_unlock_tooltip
		set_country_flag = oni_demon_empire_mission_unlock #enables second part
		swap_non_generic_missions = yes #adds the obtains new missions tooltip
		override_country_name = CHOMORA
		change_government = monarchy
		add_government_reform = demon_empire_reform
		custom_tooltip = azjakuma_way_forward_demon_empire_tooltip
		if = { #denied cursed both times, does not have cursed on throne
			limit = {
				has_country_flag = restricted_khelorvalshi
				has_country_flag = khelorvalshi_not_studying
				NOT = {
					dynasty = "Jishuro" #unless something strange happens, azjakuma will always have a ruler from one of 5 dynasties, each corresponding to a shirgrii
				}
			}
			add_stability = -3
			hidden_effect = {
				4848 = {
					spawn_rebels = {
						type = pretender_rebels
						size = 2
						win = yes
						leader_dynasty = "Jishuro"
					}
				}
				random_owned_province = {
					limit = {
						culture = horned_ogre
					}
					spawn_rebels = {
						type = noble_rebels
						size = 2
					}
				}
			}
		}
		else_if = {
			limit = {
				has_country_flag = restricted_khelorvalshi
				has_country_flag = khelorvalshi_studying
				NOT = {
					dynasty = "Jishuro"
				}
			}
			add_stability = -3
			hidden_effect = {
				4848 = {
					add_province_modifier = {
						name = azjakuma_khelorvalshi_displeased
						duration = 1825
					}
				}
				random_owned_province = {
					limit = {
						culture = horned_ogre
					}
					spawn_rebels = {
						type = noble_rebels
						size = 1
					}
				}
			}
		}
		else_if = {
			limit = {
				has_country_flag = accepted_khelorvalshi
				has_country_flag = khelorvalshi_not_studying
				NOT = {
					dynasty = "Jishuro"
				}
			}
			add_stability = -3
			hidden_effect = {
				4848 = {
					add_province_modifier = {
						name = azjakuma_khelorvalshi_displeased
						duration = 1825
					}
				}
			}
		}
		else = {
			add_stability = -2
		}
		#end of effects caused by choices in 30 and 31
		#start of rebels from all shirgrii that are not the one the ruler is from
		#if the leading faction is not the one the rashenbirs dynasty is from, they will have extra rebels
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						dynasty = "Aromo"
					}
				}
				if = {
					limit = {
						estate_influence = {
							estate = estate_shinukhorchi
							influence = 70
						}
					}
					5430 = {
						spawn_rebels = {
							type = pretender_rebels
							size = 4
							leader_dynasty = "Aromo"
						}
					}
				}
				else = {
					5430 = {
						spawn_rebels = {
							type = pretender_rebels
							size = 3
							leader_dynasty = "Aromo"
						}
					}
				}
			}
			else_if = {
				limit = {
					dynasty = "Aromo"
				}
				5430 = {
					add_province_modifier = {
						name = azjakuma_highest_fire_traditions_broken
						duration = 1825
					}
				}
			}
			if = {
				limit = {
					NOT = {
						dynasty = "Moguruld"
					}
				}
				if = {
					limit = {
						estate_influence = {
							estate = estate_kabiurgarko
							influence = 70
						}
					}
					4828 = {
						spawn_rebels = {
							type = pretender_rebels
							size = 3
							win = yes
							leader_dynasty = "Moguruld"
						}
					}
				}
				else = {
					4828 = {
						spawn_rebels = {
							type = pretender_rebels
							size = 2
							win = yes
							leader_dynasty = "Moguruld"
						}
					}
				}
			}
			if = {
				limit = {
					not = {
						dynasty = "Surgoshi"
					}
				}
				if = {
					limit = {
						estate_influence = {
							estate = estate_ajgriijarul
							influence = 70
						}
					}
					4829 = {
						spawn_rebels = {
							type = pretender_rebels
							size = 3
							win = yes
							leader_dynasty = "Surgoshi"
						}
					}
				}
				else = {
					4829 = {
						spawn_rebels = {
							type = pretender_rebels
							size = 2
							win = yes
							leader_dynasty = "Surgoshi"
						}
					}
				}
			}
			if = {
				limit = {
					not = {
						dynasty = "Talshimok"
					}
				}
				if = {
					limit = {
						estate_influence = {
							estate = estate_chumijemoya
							influence = 70
						}
					}
					4831 = {
						spawn_rebels = {
							type = pretender_rebels
							size = 3
							win = yes
							leader_dynasty = "Talshimok"
						}
					}
				}
				else = {
					4831 = {
						spawn_rebels = {
							type = pretender_rebels
							size = 2
							win = yes
							leader_dynasty = "Talshimok"
						}
					}
				}
			}
			#switch capital to Rashenbirs shirgrii
		}
		if = {
			limit = {
				dynasty = "Aromo"
			}
			set_country_flag = shinukhorchi_empire_flag
			set_capital = 5430
		}
		else_if = {
			limit = {
				dynasty = "Moguruld"
			}
			set_country_flag = chumijemoya_empire_flag
			set_capital = 4828
		}
		else_if = {
			limit = {
				dynasty = "Surgoshi"
			}
			set_country_flag = ajgriijarul_empire_flag
			set_capital = 4829
		}
		else_if = {
			limit = {
				dynasty = "Talshimok"
			}
			set_country_flag = kabiurgarko_empire_flag
			set_capital = 4831
		}
		else_if = {
			limit = {
				dynasty = "Jishuro"
			}
			set_country_flag = khelorvalshi_empire_flag
			set_capital = 4848
		}
		# trigger_switch = {
			# 	on_trigger = dynasty
			# 	"" = { move_great_project = { type = $type$  province = 4125 instant = $instant$ } }
			# 	"" = { move_great_project = { type = $type$  province = 4129 instant = $instant$ } }
			# 	"" = { move_great_project = { type = $type$  province = 4125 instant = $instant$ } }
			# 	"" = { move_great_project = { type = $type$  province = 4129 instant = $instant$ } }
		# }
		set_country_flag = azjakuma_two_magics_allowed
	}
}

country_event = { #removes ruler modifier for magic study
	id = flavor_azjakuma.34
	title = flavor_azjakuma.1.t
	desc = flavor_azjakuma.1.d
	picture = CITY_VIEW_eventPicture
	
	is_triggered_only = yes
	hidden = yes

	trigger = {
		tag = Y01
		has_country_flag = ruler_magic_study_increase_azjakuma
	}

	option = {
		name = flavor_azjakuma.1.a
		if = {
			limit = {
				has_country_flag = ruler_magic_study_increase_azjakuma
			}
			update_magic_study_experience_modifier = { value = -20 }
			clr_country_flag = ruler_magic_study_increase_azjakuma
		}
	}
}

country_event = { #adds claims to temples in yanshen, xianjie, and the command
	id = flavor_azjakuma.35
	title = flavor_azjakuma.35.t
	desc = flavor_azjakuma.35.d
	picture = SPY_eventPicture
	
	is_triggered_only = yes

	option = {
		name = flavor_azjakuma.35.a
		asia = {
			limit = {
				OR = {
					AND = {
						superregion = yanshen_superregion
						OR = {
							has_province_modifier = temple_complex
							has_province_modifier = damaged_temple_complex
							has_province_modifier = derelict_temple_complex
							has_province_modifier = ruined_temple_complex
							has_province_modifier = corrupted_temple_complex
						}
					}
					AND = {
						region = xianjie_region
						OR = {
							has_province_modifier = temple_complex
							has_province_modifier = damaged_temple_complex
							has_province_modifier = derelict_temple_complex
							has_province_modifier = ruined_temple_complex
							has_province_modifier = corrupted_temple_complex
						}
					}
					province_id = 4630
					province_id = 4546
					province_id = 4633
				}
			}
			add_permanent_claim = ROOT
		}
	}
}

country_event = { #applies khelorvalshi loyalty/influence changes before they are unlocked
	id = flavor_azjakuma.37
	title = flavor_azjakuma.1.t
	desc = flavor_azjakuma.1.d
	picture = DHIMMI_ESTATE_eventPicture

	hidden = yes
	is_triggered_only = yes
	immediate = {
		if = {
			limit = {
				has_country_flag = accepted_khelorvalshi
			}
			# add_estate_loyalty_modifier = {
			# 	estate = estate_khelorvalshi
			# 	desc = accepted_cursed_desc
			# 	loyalty = 15
			# 	duration = -1
			# }
			# add_estate_influence_modifier = {
			# 	estate = estate_khelorvalshi
			# 	desc = accepted_cursed_desc
			# 	influence = 10
			# 	duration = -1
			# }
			set_estate_privilege = estate_khelorvalshi_accepted_the_cursed
		}
		if = {
			limit = {
				has_country_flag = restricted_khelorvalshi
			}
			# add_estate_loyalty_modifier = {
			# 	estate = estate_khelorvalshi
			# 	desc = restricive_regulations_desc
			# 	loyalty = -10
			# 	duration = -1
			# }
			# add_estate_influence_modifier = {
			# 	estate = estate_khelorvalshi
			# 	desc = restricive_regulations_desc
			# 	influence = -20
			# 	duration = -1
			# }
			set_estate_privilege = estate_khelorvalshi_restrictive_regulations
		}
	}

	option = {
		name = flavor_azjakuma.1.a
	}
}

# country_event = { #this is a dumb evennt
# 	id = flavor_azjakuma.40
# 	title = flavor_azjakuma.40.t
# 	desc = flavor_azjakuma.40.d
# 	picture = CITY_VIEW_eventPicture

# 	fire_only_once = yes

# 	mean_time_to_happen = {
# 		months = 600
# 	}

# 	trigger = {
# 		# always = no
# 		tag = Y01
# 		ai = no
# 		is_year = 1584
# 		4411 = { owned_by = Root }
# 	}

# 	option = {
# 		name = flavor_azjakuma.40.a
# 		ai_chance = { factor = 1 }
# 		4411 = { add_unrest = -10 }
# 	}
# }

country_event = { #allows Y01_winning_over_birb to be completed
	id = flavor_azjakuma.103
	title = flavor_azjakuma.1.t
	desc = flavor_azjakuma.1.d
	picture = CITY_VIEW_eventPicture
	
	is_triggered_only = yes
	hidden = yes
	
	option = {		
		name = flavor_azjakuma.1.a
		ai_chance = { factor = 30 }	

		set_country_flag = birb_conquered_decade
	}
}

country_event = { #removes name change broke flag
	#not currently used, more testing needed on name change to chomora causing game to think you restored some shirgrii
	id = flavor_azjakuma.104
	title = flavor_azjakuma.1.t
	desc = flavor_azjakuma.1.d
	picture = CITY_VIEW_eventPicture
	
	is_triggered_only = yes
	hidden = yes
	
	option = {		
		name = flavor_azjakuma.1.a
		ai_chance = { factor = 30 }	

		clr_country_flag = oni_name_change_broke
	}
}

country_event = { #azjakuma renew truce with command
	id = flavor_azjakuma.105
	title = flavor_azjakuma.105.t
	desc = flavor_azjakuma.105.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes

	trigger = {
		NOT = { is_year = 1486 }
		NOT = { war_with = R62 }
		is_subject = no
	}
	
	option = { #renew truce
		name = flavor_azjakuma.105.a
		ai_chance = { factor = 1 }	

		add_prestige = -5
		R62 = {
			country_event = {
				id = flavor_azjakuma.106
			}
		}

		if = {
			limit = { is_year = 1481 }
			custom_tooltip = azjakuma_cannot_renew_tooltip
		}
	}

	option = { #do not renew truce
		name = flavor_azjakuma.105.b
		ai_chance = { factor = 0 }	

		add_prestige = 10
		R62 = {
			country_event = {
				id = flavor_azjakuma.107
				days = 60
			}
		}
	}
}

country_event = { #command recieves renewal
	id = flavor_azjakuma.106
	title = flavor_azjakuma.106.t
	desc = flavor_azjakuma.106.d
	picture = DIPLOMACY_SIGNING_eventPicture
	
	is_triggered_only = yes

	
	option = { #renew truce
		name = flavor_azjakuma.106.a
		ai_chance = { factor = 100 }

		add_truce_with = Y01
		
		if = {
			limit = {
				Y89 = {
					is_subject_of = Y01
				}
			}
			add_truce_with = Y89
		}
		command_change_korashi_supply = { increase = yes }
		Y01 = {
			country_event = {
				id = flavor_azjakuma.108
			}
		}
		hidden_effect = {
			Y01 = {
				country_event = {
					id = flavor_azjakuma.105
					days = 1825
				}
			}
			country_event = {
				id = flavor_azjakuma.110
				days = 1825
			}
		}
		if = {
			limit = { 
				has_country_flag = command_azjakuma_campaign_unlocked_flag 
				Y01 = { owns = 5430 } #Shinukhorchi
			}
			custom_tooltip = azjakuma_backstab_tooltip
		}
	}
	option = { #do not renew truce
		name = flavor_azjakuma.106.b
		ai_chance = { factor = 0 }	
		
		custom_tooltip = command_will_no_longer_import_korashi_tt
		Y01 = {
			country_event = {
				id = flavor_azjakuma.109
			}
		}
	}
}

country_event = { #command doesn't recieve renewal
	id = flavor_azjakuma.107
	title = flavor_azjakuma.107.t
	desc = flavor_azjakuma.107.d
	picture = IMPERIAL_SEAL_eventPicture
	
	is_triggered_only = yes

	
	option = { 
		name = flavor_azjakuma.107.a
		ai_chance = { factor = 90 }	
	}
}

country_event = { #command accepts renewal
	id = flavor_azjakuma.108
	title = flavor_azjakuma.108.t
	desc = flavor_azjakuma.108.d
	picture = DIPLOMACY_SIGNING_eventPicture
	
	is_triggered_only = yes

	
	option = { 
		name = flavor_azjakuma.108.a
		ai_chance = { factor = 90 }	

		tooltip = {
			R62 = {
				add_truce_with = Y01
				add_truce_with = Y89
				command_change_korashi_supply = { increase = yes }
			}
		}
		5430 = {
			add_province_modifier = {
				name = azjakuma_korashi_diverted
				duration = 1825
			}
		}
	}
}

country_event = { #command rejects renewal
	id = flavor_azjakuma.109
	title = flavor_azjakuma.109.t
	desc = flavor_azjakuma.109.d
	picture = CONSPIRACY_eventpicture
	
	is_triggered_only = yes

	
	option = { 
		name = flavor_azjakuma.109.a
		ai_chance = { factor = 90 }	

		add_stability = -1
	}
}

country_event = { #reset command korashi imports
	id = flavor_azjakuma.110
	title = flavor_azjakuma.110.t
	desc = flavor_azjakuma.110.d
	picture = CONSPIRACY_eventpicture
	
	is_triggered_only = yes
	hidden = yes
	
	option = { 
		name = flavor_azjakuma.110.a
		ai_chance = { factor = 90 }	
		
		command_change_korashi_supply = { decrease = yes }
	}
}

#debug
country_event = {
	id = flavor_azjakuma.1001
	title = flavor_azjakuma.1.t
	desc = flavor_azjakuma.1.d
	picture = ONI_FORTRESS_eventPicture

	is_triggered_only = yes

	option = {
		name = flavor_azjakuma.1.a
		ai_chance = { factor = 1 }

		set_country_flag = khelorvalshi_restored
	}
}

country_event = {
	id = flavor_azjakuma.1002
	title = flavor_azjakuma.1.t
	desc = flavor_azjakuma.1.d
	picture = ONI_FORTRESS_eventPicture

	is_triggered_only = yes

	option = {
		name = flavor_azjakuma.1.a
		ai_chance = { factor = 1 }

		clr_country_flag = khelorvalshi_restored
	}
}
province_event = { #give aikogeoke to neighbor
	id = flavor_azjakuma.1101
	title = flavor_azjakuma.1101.t
	desc = flavor_azjakuma.1101.d
	picture = COLONIZATION_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavor_azjakuma.1101.a
		ai_chance = {
			factor = 50
		}
		owner = {
			5409 = {
				add_core = PREV
				cede_province = PREV
			}
		}
	}
}

province_event = { #give aikogeoke to neighbor
	id = flavor_azjakuma.1102
	title = flavor_azjakuma.1101.t
	desc = flavor_azjakuma.1101.d
	picture = COLONIZATION_eventPicture

	is_triggered_only = yes
	fire_only_once = yes
	hidden = yes

	trigger = {
		5409 = {
			NOT = {
				is_colony = yes
				is_city = yes
			}
		}
	}

	option = {
		name = flavor_azjakuma.1101.a
		ai_chance = {
			factor = 50
		}
		if = {
			limit = {
				5409 = {
					NOT = { is_colony = yes }
					NOT = { is_city = yes }
				}
			}
			province_event = {
				id = flavor_azjakuma.1101
			}
		}
	}
}

country_event = { #Shingrii magic menu
	id = flavor_azjakuma.1250
	title = flavor_azjakuma.1250.t
	desc = flavor_azjakuma.1250.desc #using desc for these because I need .d
	picture = COLONIZATION_eventPicture #need to find an actual picture at some point, don't have the time now

	is_triggered_only = yes
	
	#Shinukhorchi Menu
	option = {	
		name = flavor_azjakuma.1250.a
		trigger = {
			has_estate = estate_shinukhorchi
			NOT = { has_estate_privilege = estate_shinukhorchi_cast_magic }
		}
		ai_chance = { factor = 1 }
		hidden_effect = { country_event = { id = flavor_azjakuma.1251 } }
	}
	
	#Chumijemoya Menu
	option = {	
		name = flavor_azjakuma.1250.b
		trigger = {
			has_estate = estate_chumijemoya
			NOT = { has_estate_privilege = estate_chumijemoya_cast_magic }
		}
		ai_chance = { factor = 1 }
		hidden_effect = { country_event = { id = flavor_azjakuma.1252 } }
	}
	
	#Ajgriijarul Menu
	option = {	
		name = flavor_azjakuma.1250.c
		trigger = {
			has_estate = estate_ajgriijarul
			NOT = { has_estate_privilege = estate_ajgriijarul_cast_magic }
		}
		ai_chance = { factor = 1 }
		hidden_effect = { country_event = { id = flavor_azjakuma.1253 } }
	}
	
	#Kabiurgarko Menu
	option = {	
		name = flavor_azjakuma.1250.d
		ai_chance = { factor = 1 }
		trigger = {
			has_estate = estate_kabiurgarko
			NOT = { has_estate_privilege = estate_kabiurgarko_cast_magic }
		}
		hidden_effect = { country_event = { id = flavor_azjakuma.1254 } }
	}
	
	#Khelorvalshi Menu
	option = {	
		name = flavor_azjakuma.1250.e
		trigger = {
			has_estate = estate_khelorvalshi
			NOT = { has_estate_privilege = estate_khelorvalshi_cast_magic }
		}
		ai_chance = { factor = 1 }
		hidden_effect = { country_event = { id = flavor_azjakuma.1255 } }
	}
	
	#Go back
	option = {	
		name = flavor_azjakuma.1250.f
		ai_chance = { factor = 0 }
		clr_country_flag = azjakuma_magic_menu_opened
	}
}

#estate magic
country_event = { #Shinukhorchi Menu
	id = flavor_azjakuma.1251
	title = flavor_azjakuma.1251.t
	desc = flavor_azjakuma.1251.desc #using desc for these because I need .d
	picture = SPELL_MENU_eventPicture

	is_triggered_only = yes
	
	option = { #close menu
		name = flavor_azjakuma.1251.a
		highlight = yes
		ai_chance = { factor = 50 }

		if = { # Causes crashes on Linux
			limit = { ai = yes }
			set_country_flag = remove_azjakuma_casting_spells
		}
		country_event = { id = flavor_azjakuma.1250 }
	}
	
	#Korashi Talismans
	option = {
		name = flavor_azjakuma.1251.b
		ai_chance = {
			factor = 50
			modifier = {
				factor = 20
				is_at_war = yes
			}
		}
		trigger = {
			has_country_flag = korashi_talismans_unlocked
		}

		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_adm_power = -20
			add_dip_power = -20
			add_mil_power = -20
		}
		else = {
			add_adm_power = -15
			add_dip_power = -15
			add_mil_power = -15
		}

		add_country_modifier = {
			name = estate_shinukhorchi_korashi_talisman_mod #-15% shock damage recieved
			duration = 3650 #10 years
		}
		
		5430 = {
			add_province_modifier = {
				name = estate_shinukhorchi_magic_korashi_talismans_prod_mod #-25% local prod eff
				duration = 3650 #10 years
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_korashi_talisman_desc_tt
		set_estate_privilege = estate_shinukhorchi_cast_magic
	}
	
	#Rite of Fertility
	option = {	#Available
		name = flavor_azjakuma.1251.c
		trigger = {
			has_consort = yes
			has_government_attribute = heir
			is_lesser_in_union = no
			NOT = { ruler_is_immortal = yes } # No lich babies
			has_reform = demon_empire_reform
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				ruler_has_mage_personality = yes 
			}
			modifier = {
				factor = 0.5
				has_heir = yes
			}
			modifier = {
				factor = 0.8
				OR = {
					adm = 6
					dip = 6
					mil = 6
				}
			}
			modifier = {
				factor = 0.25
				years_of_income = 1.5
			}
		}
		add_years_of_income = -1
		if = { limit = { has_heir = yes }
			add_legitimacy = -10
		}
		custom_tooltip = shinukhorchi_estate_rite_of_conception_tooltip
		hidden_effect = { country_event = { id = flavor_azjakuma.1257 } }
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_fertility_desc_tt
		set_estate_privilege = estate_shinukhorchi_cast_magic
	}
	option = {	#Unavailable
		name = flavor_azjakuma.1251.cx
		trigger = {
			ai = no
			OR = {
				has_consort = no
				NOT = { has_government_attribute = heir }
				is_lesser_in_union = yes
				ruler_is_immortal = yes # No lich babies
				NOT = { has_reform = demon_empire_reform }
			}
		}
		if = { limit = { NOT = { has_reform = demon_empire_reform } }
			custom_tooltip = magic_need_demon_empire_reform_tt
		}
		if = { limit = { has_consort = no }
			custom_tooltip = magic_need_consort_tt
		}
		if = { limit = { NOT = { has_government_attribute = heir } }
			custom_tooltip = magic_government_allow_heirs_tt
		}
		if = { limit = { is_lesser_in_union = yes }
			custom_tooltip = magic_is_not_in_lesser_union_tt
		}
		if = { limit = { ruler_is_immortal = yes }
			custom_tooltip = magic_ruler_is_mortal_tt
		}
		set_country_flag = shinukhorchi_menu
		hidden_effect = { country_event = { id = flavor_azjakuma.1256 } }
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			add_years_of_income = -1
			if = { limit = { has_heir = yes }
				add_legitimacy = -10
			}
		}
		custom_tooltip = shinukhorchi_estate_rite_of_conception_tooltip
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_fertility_desc_tt
	}
	
	
	#Vassal domination
	option = { 
		name = flavor_azjakuma.1251.d

		trigger = {
			has_country_flag = vassal_acceptance_magic_unlocked
		}
		
		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_years_of_income = -0.75
			add_dip_power = -30
		}
		else = {
			add_years_of_income = -0.5
			add_dip_power = -20
		}

		if = { limit = { estate_influence = { estate = estate_shinukhorchi influence = 66 } }
			add_country_modifier = {
				name = estate_shinukhorchi_vassal_acceptance_lvl3_mod
				duration = 3650
			}
		}
		else_if = { limit = { estate_influence = { estate = estate_shinukhorchi influence = 33 } }
			add_country_modifier = {
				name = estate_shinukhorchi_vassal_acceptance_lvl2_mod
				duration = 3650
			}
		}
		else = {
			add_country_modifier = {
				name = estate_shinukhorchi_vassal_acceptance_lvl1_mod
				duration = 3650
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_vassal_domination_desc_tt
		set_estate_privilege = estate_shinukhorchi_cast_magic
	}
	
	#Field of Blazing Souls
	option = {	
		name = flavor_azjakuma.1251.e
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				average_unrest = 0
			}
			modifier = {
				factor = 2
				personality = ai_capitalist
			}
		}
		add_adm_power = -25
		add_mil_power = -25
		
		if = { limit = { estate_influence = { estate = estate_shinukhorchi influence = 66 } }
			add_country_modifier = { name = estate_shinukhorchi_blazing_souls_3_mod duration = 3650 }
		}
		else_if = { limit = { estate_influence = { estate = estate_shinukhorchi influence = 33 } }
			add_country_modifier = { name = estate_shinukhorchi_blazing_souls_2_mod duration = 3650 }
		}
		else = {
			add_country_modifier = { name = estate_shinukhorchi_blazing_souls_1_mod duration = 3650 }
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_blazing_field_desc_tt
		set_estate_privilege = estate_shinukhorchi_cast_magic
	}
}

country_event = { #Chumijemoya Menu
	id = flavor_azjakuma.1252
	title = flavor_azjakuma.1252.t
	desc = flavor_azjakuma.1252.desc #using desc for these because I need .d
	picture = SPELL_MENU_eventPicture

	is_triggered_only = yes

	option = { #close menu
		name = magic_siege.1.z
		highlight = yes
		ai_chance = { factor = 50 }

		if = { # Causes crashes on Linux
			limit = { ai = yes }
			set_country_flag = remove_azjakuma_casting_spells
		}
		country_event = { id = flavor_azjakuma.1250 }
	}
	
	#Mist
	option = {
		name = flavor_azjakuma.1252.b
		ai_chance = {
			factor = 50
		}

		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_adm_power = -15
			add_dip_power = -15
			add_mil_power = -15
		}
		else = {
			add_adm_power = -10
			add_dip_power = -10
			add_mil_power = -10
		}

		if = { limit = { estate_influence = { estate = estate_chumijemoya influence = 66 } }
			custom_tooltip = azjakuma_lost_in_mist_3_tooltip
			hidden_effect = {
				every_owned_province = {
					limit = { region = demon_hills_region }
					add_province_modifier = {
						name = estate_chumijemoya_magic_lost_in_mist_lvl3_mod
						duration = 3650
					}
				}
			}
		}
		else_if = { limit = { estate_influence = { estate = estate_chumijemoya influence = 33 } }
			custom_tooltip = azjakuma_lost_in_mist_2_tooltip
			hidden_effect = {
				every_owned_province = {
					limit = { region = demon_hills_region }
					add_province_modifier = {
						name = estate_chumijemoya_magic_lost_in_mist_lvl2_mod
						duration = 3650
					}
				}
			}
		}
		else = {
			custom_tooltip = azjakuma_lost_in_mist_1_tooltip
			hidden_effect = {
				every_owned_province = {
					limit = { region = demon_hills_region }
					add_province_modifier = {
						name = estate_chumijemoya_magic_lost_in_mist_lvl1_mod
						duration = 3650
					}
				}
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_mist_desc_tt
		set_estate_privilege = estate_chumijemoya_cast_magic
	}
	
	#Mind Control
	option = {
		name = flavor_azjakuma.1252.c
		ai_chance = {
			factor = 50
		}

		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_years_of_income = -1.5
			add_dip_power = -15
		}
		else = {
			add_years_of_income = -1
			add_dip_power = -10
		}

		if = { limit = { estate_influence = { estate = estate_chumijemoya influence = 66 } }
			add_country_modifier = {
				name = estate_chumijemoya_mind_control_lvl3_mod
				duration = 3650
			}
		}
		else_if = { limit = { estate_influence = { estate = estate_chumijemoya influence = 33 }	}
			add_country_modifier = {
				name = estate_chumijemoya_mind_control_lvl2_mod
				duration = 3650
			}
		}
		else = {
			add_country_modifier = {
				name = estate_chumijemoya_mind_control_lvl1_mod
				duration = 3650
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_mind_control_desc_tt
		set_estate_privilege = estate_chumijemoya_cast_magic
	}
	
	#spynetworks
	option = { #available
		name = flavor_azjakuma.1252.d
		ai_chance = {
			factor = 50
		}
		trigger = {
			has_country_flag = oni_silent_mist_privilege
		}

		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_years_of_income = -0.75
			add_dip_power = -15
		}
		else = {
			add_years_of_income = -0.5
			add_dip_power = -10
		}

		if = { limit = { estate_influence = { estate = estate_chumijemoya influence = 66 } }
			add_country_modifier = {
				name = estate_chumijemoya_spymasters_lvl3_mod
				duration = 3650
			}
		}
		else_if = { limit = { estate_influence = { estate = estate_chumijemoya influence = 33 } }
			add_country_modifier = {
				name = estate_chumijemoya_spymasters_lvl2_mod
				duration = 3650
			}
		}
		else = {
			add_country_modifier = {
				name = estate_chumijemoya_spymasters_lvl1_mod
				duration = 3650
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_spynetworks_desc_tt
		set_estate_privilege = estate_chumijemoya_cast_magic
	}
	option = { #unavailable
		name = flavor_azjakuma.1252.dx
		trigger = {
			ai = no
			NOT = { has_country_flag = oni_silent_mist_privilege }
		}
		
		set_country_flag = chumijemoya_menu
		hidden_effect = { country_event = { id = flavor_azjakuma.1256 } }
		
		custom_tooltip = azjakuma_has_silent_mist_privilege_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			if = {
				limit = {
					has_country_flag = azjakuma_two_magics_allowed
					calc_true_if = {
						has_estate_privilege = estate_shinukhorchi_cast_magic
						has_estate_privilege = estate_chumijemoya_cast_magic
						has_estate_privilege = estate_ajgriijarul_cast_magic
						has_estate_privilege =  estate_kabiurgarko_cast_magic
						has_estate_privilege =  estate_khelorvalshi_cast_magic
						amount = 2
					}
				}
				custom_tooltip = azjakuma_more_expensive_magic_tooltip
				add_years_of_income = -0.75
				add_dip_power = -15
			}
			else = {
				add_years_of_income = -0.5
				add_dip_power = -10
			}

			if = { limit = { estate_influence = { estate = estate_chumijemoya influence = 66 } }
				add_country_modifier = {
					name = estate_chumijemoya_spymasters_lvl3_mod
					duration = 3650
				}
			}
			else_if = { limit = { estate_influence = { estate = estate_chumijemoya influence = 33 } }
				add_country_modifier = {
					name = estate_chumijemoya_spymasters_lvl2_mod
					duration = 3650
				}
			}
			else = {
				add_country_modifier = {
					name = estate_chumijemoya_spymasters_lvl1_mod
					duration = 3650
				}
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_spynetworks_desc_tt
	}
	
	#Dispel the mist
	option = { #available
		name = flavor_azjakuma.1252.e
		ai_chance = {
			factor = 50
		}
		trigger = {
			is_at_war = yes
		}

		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_adm_power = -20
			add_dip_power = -20
			add_mil_power = -20
		}
		else = {
			add_adm_power = -15
			add_dip_power = -15
			add_mil_power = -15
		}

		every_country = {
			limit = { war_with = ROOT }
			remove_fow = 120
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_fow_desc_tt
		set_estate_privilege = estate_chumijemoya_cast_magic
	}
	option = { #unavailable
		name = flavor_azjakuma.1252.ex
		trigger = {
			ai = no
			is_at_war = no
		}
		set_country_flag = chumijemoya_menu
		hidden_effect = { country_event = { id = flavor_azjakuma.1256 } }
		
		custom_tooltip = magic_is_at_war_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			if = {
				limit = {
					has_country_flag = azjakuma_two_magics_allowed
					calc_true_if = {
						has_estate_privilege = estate_shinukhorchi_cast_magic
						has_estate_privilege = estate_chumijemoya_cast_magic
						has_estate_privilege = estate_ajgriijarul_cast_magic
						has_estate_privilege =  estate_kabiurgarko_cast_magic
						has_estate_privilege =  estate_khelorvalshi_cast_magic
						amount = 2
					}
				}
				custom_tooltip = azjakuma_more_expensive_magic_tooltip
				add_adm_power = -20
				add_dip_power = -20
				add_mil_power = -20
			}
			else = {
				add_adm_power = -15
				add_dip_power = -15
				add_mil_power = -15
			}
		}
		
		custom_tooltip = azjakuma_remove_fow_tt
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_fow_desc_tt
	}
}

country_event = { #Ajgriijarul Menu
	id = flavor_azjakuma.1253
	title = flavor_azjakuma.1253.t
	desc = flavor_azjakuma.1253.desc #using desc for these because I need .d
	picture = SPELL_MENU_eventPicture

	is_triggered_only = yes

	option = { #close menu
		name = magic_siege.1.z
		highlight = yes
		ai_chance = { factor = 50 }

		if = { # Causes crashes on Linux
			limit = { ai = yes }
			set_country_flag = remove_azjakuma_casting_spells
		}
		country_event = { id = flavor_azjakuma.1250 }
	}
	
	#Defend the Demon Hills
	option = { #available
		name = flavor_azjakuma.1253.b
		ai_chance = {
			factor = 50
		}
		trigger = {
			any_known_country = {
				war_with = ROOT
				ROOT = {
					NOT = {
						army_strength = {
							who = PREV
							value = 0.90
						}
					}
				}
			}
		}
		
		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_mil_power = -45
		}
		else = {
			add_mil_power = -30
		}

		if = { limit = { estate_influence = { estate = estate_ajgriijarul influence = 66 } }
			custom_tooltip = estate_ajgriijarul_defend_demon_hills_mod_lvl3_tooltp
			hidden_effect = {
				every_owned_province = {
					limit = {
						region = demon_hills_region
						OR = {
							has_terrain = hills
							has_terrain = mountain
						}
					}
					add_province_modifier = {
						name = estate_ajgriijarul_defend_demon_hills_lvl3_mod #+66% defensiveness
						duration = 3650 #10 years
					}
				}
			}
		}
		else_if = { limit = { estate_influence = { estate = estate_ajgriijarul influence = 33 } }
			custom_tooltip = estate_ajgriijarul_defend_demon_hills_mod_lvl2_tooltp
			hidden_effect = {
				every_owned_province = {
					limit = {
						region = demon_hills_region
						OR = {
							has_terrain = hills
							has_terrain = mountain
						}
					}
					add_province_modifier = {
						name = estate_ajgriijarul_defend_demon_hills_lvl2_mod #+44% defensiveness
						duration = 3650 #10 years
					}
				}
			}
		}
		else = {
			custom_tooltip = estate_ajgriijarul_defend_demon_hills_mod_lvl1_tooltp
			hidden_effect = {
				every_owned_province = {
					limit = {
						region = demon_hills_region
						OR = {
							has_terrain = hills
							has_terrain = mountain
						}
					}
					add_province_modifier = {
						name = estate_ajgriijarul_defend_demon_hills_lvl1_mod #+22% defensiveness
						duration = 3650 #10 years
					}
				}
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_demon_hills_desc_tt
		set_estate_privilege = estate_ajgriijarul_cast_magic
	}
	option = { #unavailable
		name = flavor_azjakuma.1253.bx
		trigger = {
			ai = no
			NOT = {
				any_known_country = {
					war_with = ROOT
					ROOT = {
						NOT = {
							army_strength = {
								who = PREV
								value = 0.90
							}
						}
					}
				}
			}
		}
		set_country_flag = ajgriijarul_menu
		hidden_effect = { country_event = { id = flavor_azjakuma.1256 } }
		
		custom_tooltip = magic_is_at_war_with_powerful_enemy_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			if = { limit = { has_country_flag = azjakuma_two_magics_allowed
					calc_true_if = {
						has_estate_privilege = estate_shinukhorchi_cast_magic
						has_estate_privilege = estate_chumijemoya_cast_magic
						has_estate_privilege = estate_ajgriijarul_cast_magic
						has_estate_privilege =  estate_kabiurgarko_cast_magic
						has_estate_privilege =  estate_khelorvalshi_cast_magic
						amount = 2
					}
				}
				custom_tooltip = azjakuma_more_expensive_magic_tooltip
				add_mil_power = -45
			}
			else = {
				add_mil_power = -30
			}

			if = { limit = { estate_influence = { estate = estate_ajgriijarul influence = 66 } }
				custom_tooltip = estate_ajgriijarul_defend_demon_hills_mod_lvl3_tooltp
				hidden_effect = {
					every_owned_province = {
						limit = {
							region = demon_hills_region
							OR = {
								has_terrain = hills
								has_terrain = mountain
							}
						}
						add_province_modifier = {
							name = estate_ajgriijarul_defend_demon_hills_lvl3_mod #+66% defensiveness
							duration = 3650 #10 years
						}
					}
				}
			}
			else_if = { limit = { estate_influence = { estate = estate_ajgriijarul influence = 33 } }
				custom_tooltip = estate_ajgriijarul_defend_demon_hills_mod_lvl2_tooltp
				hidden_effect = {
					every_owned_province = {
						limit = {
							region = demon_hills_region
							OR = {
								has_terrain = hills
								has_terrain = mountain
							}
						}
						add_province_modifier = {
							name = estate_ajgriijarul_defend_demon_hills_lvl2_mod #+44% defensiveness
							duration = 3650 #10 years
						}
					}
				}
			}
			else = {
				custom_tooltip = estate_ajgriijarul_defend_demon_hills_mod_lvl1_tooltp
				hidden_effect = {
					every_owned_province = {
						limit = {
							region = demon_hills_region
							OR = {
								has_terrain = hills
								has_terrain = mountain
							}
						}
						add_province_modifier = {
							name = estate_ajgriijarul_defend_demon_hills_lvl1_mod #+22% defensiveness
							duration = 3650 #10 years
						}
					}
				}
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_demon_hills_desc_tt
	}
	
	#Dominate the Unruly
	option = {
		name = flavor_azjakuma.1253.c
		ai_chance = {
			factor = 50
		}
		trigger = {
			has_country_flag = unlock_ajgriijarul_rebel_supression
		}

		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_dip_power = -15
			add_mil_power = -45
		}
		else = {
			add_dip_power = -10
			add_mil_power = -30
		}
		
		custom_tooltip = azjakuma_clear_rebels_tt
		hidden_effect = {
			every_owned_province = {
				clear_rebels = yes
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_dominate_unruly_desc_tt
		set_estate_privilege = estate_ajgriijarul_cast_magic
	}
	
	#Trance Induced Rage
	option = {
		name = flavor_azjakuma.1253.d
		ai_chance = {
			factor = 50
		}
		
		if = { limit = { has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_mil_power = -60
		}
		else = {
			add_mil_power = -30
		}
		
		if = { limit = { estate_influence = { estate = estate_ajgriijarul influence = 66 } }
			add_country_modifier = {
				name = estate_ajgriijarul_trance_induced_rage_lvl3_mod #+25% shock damage +10% shock damage received
				duration = 3650 #10 years
			}
		}
		else_if = { limit = { estate_influence = { estate = estate_ajgriijarul influence = 33 } }
			add_country_modifier = {
				name = estate_ajgriijarul_trance_induced_rage_lvl2_mod #+20% shock damage +7.5% shock damage received
				duration = 3650 #10 years
			}
		}
		else = {
			add_country_modifier = {
				name = estate_ajgriijarul_trance_induced_rage_lvl1_mod #+15% shock damage +5% shock damage received
				duration = 3650 #10 years
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_trance_rage_desc_tt
		set_estate_privilege = estate_ajgriijarul_cast_magic
	}
	
	#Soul Ignition
	option = {
		name = flavor_azjakuma.1253.e
		ai_chance = {
			factor = 50
		}
		
		if = { limit = { has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_manpower = -5
			add_mil_power = -30
		}
		else = {
			add_manpower = -3
			add_mil_power = -15
		}
		
		if = { limit = { estate_influence = { estate = estate_ajgriijarul influence = 66 } }
			add_country_modifier = {
				name = estate_ajgriijarul_soul_ignition_lvl3_mod #+30% siege ability -10% manpower recovery speed
				duration = 3650 #10 years
			}
		}
		else_if = { limit = { estate_influence = { estate = estate_ajgriijarul influence = 33 } }
			add_country_modifier = {
				name = estate_ajgriijarul_soul_ignition_lvl2_mod #+20% shock damage -7.5% manpower recovery speed
				duration = 3650 #10 years
			}
		}
		else = {
			add_country_modifier = {
				name = estate_ajgriijarul_soul_ignition_lvl1_mod #+15% siege ability -5% manpower recovery speed
				duration = 3650 #10 years
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_soul_ignition_desc_tt
		set_estate_privilege = estate_ajgriijarul_cast_magic
	}
}

country_event = { #Kabiurgarko Menu
	id = flavor_azjakuma.1254
	title = flavor_azjakuma.1254.t
	desc = flavor_azjakuma.1254.desc #using desc for these because I need .d
	picture = SPELL_MENU_eventPicture

	is_triggered_only = yes

	option = { #close menu
		name = magic_siege.1.z
		highlight = yes
		ai_chance = { factor = 50 }

		if = { # Causes crashes on Linux
			limit = { ai = yes }
			set_country_flag = remove_azjakuma_casting_spells
		}
		country_event = { id = flavor_azjakuma.1250 }
	}
	
	# Earth Bending
	option = {
		name = flavor_azjakuma.1254.b
		ai_chance = { factor = 50 }
		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_years_of_income = -0.75
		}
		else = {
			add_years_of_income = -0.5
		}
		if = { limit = { estate_influence = { estate = estate_kabiurgarko influence = 66 } }
			custom_tooltip = estate_kabiurgarko_production_lvl3_mod_tooltip
			hidden_effect = {
				every_owned_province = {
					limit = {
						region = demon_hills_region
						OR = {
							has_terrain = hills
							has_terrain = mountain
						}
					}
					add_province_modifier = {
						name = estate_kabiurgarko_production_lvl3_mod
						duration = 3650
					}
				}
			}
		}
		else_if = { limit = { estate_influence = { estate = estate_kabiurgarko influence = 33 } }
			custom_tooltip = estate_kabiurgarko_production_lvl2_mod_tooltip
			hidden_effect = {
				every_owned_province = {
					limit = {
						region = demon_hills_region
						OR = {
							has_terrain = hills
							has_terrain = mountain
						}
					}
					add_province_modifier = {
						name = estate_kabiurgarko_production_lvl2_mod
						duration = 3650
					}
				}
			}
		}
		else = {
			custom_tooltip = estate_kabiurgarko_production_lvl1_mod_tooltip
			hidden_effect = {
				every_owned_province = {
					limit = {
						region = demon_hills_region
						OR = {
							has_terrain = hills
							has_terrain = mountain
						}
					}
					add_province_modifier = {
						name = estate_kabiurgarko_production_lvl1_mod
						duration = 3650
					}
				}
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_production_desc_tt
		set_estate_privilege = estate_kabiurgarko_cast_magic
	}
	
	# Wood Bending
	option = {
		name = flavor_azjakuma.1254.c
		ai_chance = { factor = 50 }

		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_years_of_income = -0.75
			add_adm_power = -30
		}
		else = {
			add_years_of_income = -0.5
			add_adm_power = -20
		}
		if = { limit = { estate_influence = { estate = estate_kabiurgarko influence = 66 } }
			add_country_modifier = {
				name = estate_kabiurgarko_construction_lvl3_mod
				duration = 3650
			}
		}
		else_if = { limit = { estate_influence = { estate = estate_kabiurgarko influence = 33 } }
			add_country_modifier = {
				name = estate_kabiurgarko_construction_lvl2_mod
				duration = 3650
			}
		}
		else = {
			add_country_modifier = {
				name = estate_kabiurgarko_construction_lvl1_mod
				duration = 3650
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_contruction_desc_tt
		set_estate_privilege = estate_kabiurgarko_cast_magic
	}
	
	# Energy Bending
	option = {
		name = flavor_azjakuma.1254.d
		ai_chance = { factor = 50 }

		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_years_of_income = -4.5
			add_adm_power = -45
			add_dip_power = -45
			add_mil_power = -45
		}
		else = {
			add_years_of_income = -3
			add_adm_power = -30
			add_dip_power = -30
			add_mil_power = -30
		}
		if = { limit = { estate_influence = { estate = estate_kabiurgarko influence = 66 } }
			add_country_modifier = {
				name = estate_kabiurgarko_energy_bending_lvl3_mod
				duration = 3650
			}
		}
		else_if = { limit = { estate_influence = { estate = estate_kabiurgarko influence = 33 } }
			add_country_modifier = {
				name = estate_kabiurgarko_energy_bending_lvl2_mod
				duration = 3650
			}
		}
		else = {
			add_country_modifier = {
				name = estate_kabiurgarko_energy_bending_lvl1_mod
				duration = 3650
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_energy_bending_desc_tt
		set_estate_privilege = estate_kabiurgarko_cast_magic
	}
	
	# Metal Bending
	option = {
		name = flavor_azjakuma.1254.e
		ai_chance = { factor = 50 }

		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_years_of_income = -0.5
			add_adm_power = -45
			add_dip_power = -45
			add_mil_power = -45
		}
		else = {
			add_years_of_income = -0.5
			add_adm_power = -30
			add_dip_power = -30
			add_mil_power = -30
		}
		if = { limit = { estate_influence = { estate = estate_kabiurgarko influence = 66 } }
			add_country_modifier = {
				name = estate_kabiurgarko_metal_bending_lvl3_mod
				duration = 3650
			}
		}
		else_if = { limit = { estate_influence = { estate = estate_kabiurgarko influence = 33 } }
			add_country_modifier = {
				name = estate_kabiurgarko_metal_bending_lvl2_mod
				duration = 3650
			}
		}
		else = {
			add_country_modifier = {
				name = estate_kabiurgarko_metal_bending_lvl1_mod
				duration = 3650
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_metal_bending_desc_tt
		set_estate_privilege = estate_kabiurgarko_cast_magic
	}
}

country_event = { #Khelorvalshi Menu
	id = flavor_azjakuma.1255
	title = flavor_azjakuma.1255.t
	desc = flavor_azjakuma.1255.desc #using desc for these because I need .d
	picture = SPELL_MENU_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_province = {
				limit = {
					fort_level = 1
					sieged_by = ROOT
					num_of_units_in_province = {
						who = ROOT
						amount = 1
					}
				}
				save_event_target_as = spell_target_province
			}

			if = {
				limit = {
					has_country_flag = azjakuma_two_magics_allowed
					calc_true_if = {
						has_estate_privilege = estate_shinukhorchi_cast_magic
						has_estate_privilege = estate_chumijemoya_cast_magic
						has_estate_privilege = estate_ajgriijarul_cast_magic
						has_estate_privilege = estate_kabiurgarko_cast_magic
						has_estate_privilege = estate_khelorvalshi_cast_magic
						amount = 2
					}
				}
				random_owned_province = {
					limit = {
						base_tax = 3
						base_production = 2
						base_manpower = 3
						NOT = { has_province_modifier = azjakuma_shirgrii }
						NOT = { culture = horned_ogre }
					}
					save_event_target_as = khelorvalshi_drain_target_1
					set_province_flag = khelorvalshi_drain_dont_pick
				}
				random_owned_province = {
					limit = {
						base_tax = 3
						base_production = 2
						base_manpower = 3
						NOT = { has_province_modifier = azjakuma_shirgrii }
						NOT = { culture = horned_ogre }
						NOT = { has_province_flag = khelorvalshi_drain_dont_pick }
					}
					save_event_target_as = khelorvalshi_drain_target_2
				}
				event_target:khelorvalshi_drain_target_1 = {
					clr_province_flag = khelorvalshi_drain_dont_pick
				}
			}
			else = {
				random_owned_province = {
					limit = {
						base_tax = 2
						base_production = 2
						base_manpower = 2
						NOT = { has_province_modifier = azjakuma_shirgrii }
						NOT = { culture = horned_ogre }
					}
					save_event_target_as = khelorvalshi_drain_target_1
					set_province_flag = khelorvalshi_drain_dont_pick
				}
				random_owned_province = {
					limit = {
						base_tax = 2
						base_production = 2
						base_manpower = 2
						NOT = { has_province_modifier = azjakuma_shirgrii }
						NOT = { culture = horned_ogre }
						NOT = { has_province_flag = khelorvalshi_drain_dont_pick }
					}
					save_event_target_as = khelorvalshi_drain_target_2
				}
				event_target:khelorvalshi_drain_target_1 = {
					clr_province_flag = khelorvalshi_drain_dont_pick
				}
			}
		}
	}

	option = { #close menu
		name = magic_siege.1.z
		highlight = yes
		ai_chance = { factor = 50 }

		if = { # Causes crashes on Linux
			limit = { ai = yes }
			set_country_flag = remove_azjakuma_casting_spells
		}
		country_event = { id = flavor_azjakuma.1250 }
	}
	
	#Drain Defenders
	option = {	#Available
		name = flavor_azjakuma.1255.b
		ai_chance = {
			factor = 50
		}
		trigger = {
			is_at_war = yes
			any_army = {
				location = {
					fort_level = 1
					sieged_by = ROOT
				}
			}
		}

		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege = estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_years_of_income = -0.375
			add_adm_power = -20
			add_dip_power = -20
			add_mil_power = -20
		}
		else = {
			add_years_of_income = -0.25
			add_adm_power = -15
			add_dip_power = -15
			add_mil_power = -15
		}

		event_target:spell_target_province = { 
			add_devastation = 70
			add_province_modifier = {
				name = estate_khelorvalshi_siege_magic_mod
				duration = 14
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_drain_defenders_desc_tt
		set_estate_privilege = estate_khelorvalshi_cast_magic
	}
	option = {	#Unavailable
		name = flavor_azjakuma.1255.bx
		trigger = {
			ai = no
			OR = {
				is_at_war = no
				NOT = {
					any_army = {
						location = {
							fort_level = 1
							sieged_by = ROOT
						}
					}
				}
			}
		}
		set_country_flag = khelorvalshi_menu
		hidden_effect = { country_event = { id = flavor_azjakuma.1256 } }
		
		custom_tooltip = magic_army_sieging_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			if = {
				limit = {
					has_country_flag = azjakuma_two_magics_allowed
					calc_true_if = {
						has_estate_privilege = estate_shinukhorchi_cast_magic
						has_estate_privilege = estate_chumijemoya_cast_magic
						has_estate_privilege = estate_ajgriijarul_cast_magic
						has_estate_privilege =  estate_kabiurgarko_cast_magic
						has_estate_privilege =  estate_khelorvalshi_cast_magic
						amount = 2
					}
				}
				custom_tooltip = azjakuma_more_expensive_magic_tooltip
				add_years_of_income = -0.375
				add_adm_power = -20
				add_dip_power = -20
				add_mil_power = -20
			}
			else = {
				add_years_of_income = -0.25
				add_adm_power = -15
				add_dip_power = -15
				add_mil_power = -15
			}
			
			custom_tooltip = magic_if_siege_magic_succeeds_tt
			add_province_modifier = {
				name = estate_khelorvalshi_siege_magic_mod
				duration = 14
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_drain_defenders_desc_tt
	}
	
	#Drain Populace
	option = {	#Available
		name = flavor_azjakuma.1255.c
		ai_chance = {
			factor = 50
		}
		trigger = {
			if = {
				limit = {
					has_country_flag = azjakuma_two_magics_allowed
					calc_true_if = {
						has_estate_privilege = estate_shinukhorchi_cast_magic
						has_estate_privilege = estate_chumijemoya_cast_magic
						has_estate_privilege = estate_ajgriijarul_cast_magic
						has_estate_privilege = estate_kabiurgarko_cast_magic
						has_estate_privilege = estate_khelorvalshi_cast_magic
						amount = 2
					}
				}
				calc_true_if = {
					all_owned_province = {
						base_tax = 3
						base_production = 2
						base_manpower = 3
						NOT = { devastation = 50 }
						NOT = { has_province_modifier = azjakuma_shirgrii }
						NOT = { culture = horned_ogre }
					}
					amount = 2
				}
			}
			else = {
				calc_true_if = {
					all_owned_province = {
						base_tax = 2
						base_production = 2
						base_manpower = 2
						NOT = { devastation = 50 }
						NOT = { has_province_modifier = azjakuma_shirgrii }
						NOT = { culture = horned_ogre }
					}
					amount = 2
				}
			}
		}

		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			event_target:khelorvalshi_drain_target_1 = {
				add_devastation = 85
				add_base_tax = -2
				add_base_production = -1
				add_base_manpower = -2
				#add in if statement
			}
			event_target:khelorvalshi_drain_target_2 = {
				add_devastation = 85
				add_base_tax = -2
				add_base_production = -1
				add_base_manpower = -2
			}
		}
		else = {
			event_target:khelorvalshi_drain_target_1 = {
				add_devastation = 70
				add_base_tax = -1
				add_base_production = -1
				add_base_manpower = -1
				#add in if statement
			}
			event_target:khelorvalshi_drain_target_2 = {
				add_devastation = 70
				add_base_tax = -1
				add_base_production = -1
				add_base_manpower = -1
			}
		}

		if = { limit = { estate_influence = { estate = estate_khelorvalshi influence = 66 } }
			add_adm_power = 150
			add_dip_power = 150
			add_mil_power = 150
		}
		else_if = { limit = { estate_influence = { estate = estate_khelorvalshi influence = 33 } }
			add_adm_power = 100
			add_dip_power = 100
			add_mil_power = 100
		}
		else = {
			add_adm_power = 50
			add_dip_power = 50
			add_mil_power = 50
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_drain_populace_desc_tt
		set_estate_privilege = estate_khelorvalshi_cast_magic
	}
	option = {	#Unavailable
		name = flavor_azjakuma.1255.cx
		trigger = {
			ai = no
			NOT = {
				calc_true_if = {
					amount = 2
					all_owned_province = {
						base_tax = 2
						base_production = 2
						base_manpower = 2
						NOT = { devastation = 50 }
					}
				}
			}
		}
		set_country_flag = khelorvalshi_menu
		hidden_effect = { country_event = { id = flavor_azjakuma.1256 } }
		
		custom_tooltip = magic_two_drainable_provinces_tt
		
		custom_tooltip = magic_effect_separator_tt
		
		tooltip = {
			if = {
				limit = {
					has_country_flag = azjakuma_two_magics_allowed
						calc_true_if = {
							has_estate_privilege = estate_shinukhorchi_cast_magic
							has_estate_privilege = estate_chumijemoya_cast_magic
							has_estate_privilege = estate_ajgriijarul_cast_magic
							has_estate_privilege =  estate_kabiurgarko_cast_magic
							has_estate_privilege =  estate_khelorvalshi_cast_magic
							amount = 2
						}
				}
				custom_tooltip = azjakuma_more_expensive_magic_tooltip
				event_target:khelorvalshi_drain_target_1 = {
					add_devastation = 85
					add_base_tax = -2
					add_base_production = -1
					add_base_manpower = -2
					#add in if statement
				}
				event_target:khelorvalshi_drain_target_2 = {
					add_devastation = 85
					add_base_tax = -2
					add_base_production = -1
					add_base_manpower = -2
				}
			}
			else = {
				event_target:khelorvalshi_drain_target_1 = {
					add_devastation = 70
					add_base_tax = -1
					add_base_production = -1
					add_base_manpower = -1
					#add in if statement
				}
				event_target:khelorvalshi_drain_target_2 = {
					add_devastation = 70
					add_base_tax = -1
					add_base_production = -1
					add_base_manpower = -1
				}
			}
			
			add_adm_power = 150
			add_dip_power = 150
			add_mil_power = 150
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_drain_populace_desc_tt
	}
	
	#Blood Ritual
	option = {	#Available
		name = flavor_azjakuma.1255.d
		ai_chance = {
			factor = 50
		}
		trigger = {
			OR = {
				employed_advisor = { category = ADM }
				employed_advisor = { category = DIP }
				employed_advisor = { category = MIL }
			}
		}
		
		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_dip_power = -25
		}
		
		kill_advisor = random
		
		tooltip = {
			if = { limit = { estate_influence = { estate = estate_khelorvalshi influence = 66 } }
				add_war_exhaustion = -12
			}
			else_if = { limit = { estate_influence = { estate = estate_khelorvalshi influence = 33 } }
				add_war_exhaustion = -10
			}
			else = {
				add_war_exhaustion = -8
			}
		}
		
		hidden_effect = {
			if = {	#anti cheat
				limit = {
					OR = {
						employed_advisor = { category = ADM }
						employed_advisor = { category = DIP }
						employed_advisor = { category = MIL }
					}
				}
				if = { limit = { estate_influence = { estate = estate_khelorvalshi influence = 66 } }
					add_war_exhaustion = -12
				}
				else_if = { limit = { estate_influence = { estate = estate_khelorvalshi influence = 33 } }
					add_war_exhaustion = -10
				}
				else = {
					add_war_exhaustion = -8
				}
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_blood_ritual_desc_tt
		set_estate_privilege = estate_khelorvalshi_cast_magic
	}
	option = {	#Unavailable
		name = flavor_azjakuma.1255.dx
		trigger = {
			ai = no
			NOT = { employed_advisor = { category = ADM } }
			NOT = { employed_advisor = { category = DIP } }
			NOT = { employed_advisor = { category = MIL } }
		}
		set_country_flag = khelorvalshi_menu
		hidden_effect = { country_event = { id = flavor_azjakuma.1256 } }
		
		custom_tooltip = magic_has_employed_advisor_tt
		
		custom_tooltip = magic_effect_separator_tt

		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege =  estate_kabiurgarko_cast_magic
					has_estate_privilege =  estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_dip_power = -25
		}
		
		tooltip = {
			kill_advisor = random
			if = { limit = { estate_influence = { estate = estate_khelorvalshi influence = 66 } }
				add_war_exhaustion = -12
			}
			else_if = { limit = { estate_influence = { estate = estate_khelorvalshi influence = 33 } }
				add_war_exhaustion = -10
			}
			else = {
				add_war_exhaustion = -8
			}
		}
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_blood_ritual_desc_tt
	}
	
	#Spirit Consumption
	option = {	#Available
		name = flavor_azjakuma.1255.e
		ai_chance = {
			factor = 50
		}

		if = {
			limit = {
				has_country_flag = azjakuma_two_magics_allowed
				calc_true_if = {
					has_estate_privilege = estate_shinukhorchi_cast_magic
					has_estate_privilege = estate_chumijemoya_cast_magic
					has_estate_privilege = estate_ajgriijarul_cast_magic
					has_estate_privilege = estate_kabiurgarko_cast_magic
					has_estate_privilege = estate_khelorvalshi_cast_magic
					amount = 2
				}
			}
			custom_tooltip = azjakuma_more_expensive_magic_tooltip
			add_dip_power = -20
			add_prestige = -20
		}
		else = {
			add_dip_power = -10
			add_prestige = -10
		}
		
		if = { limit = { estate_influence = { estate = estate_khelorvalshi influence = 66 } }
			set_country_flag = spell_1
			random_list = {
				80 = { custom_tooltip = azjakuma_add_random_skill_tt }
				20 = { }
			}
		}
		else_if = { limit = { estate_influence = { estate = estate_khelorvalshi influence = 33 } }
			set_country_flag = spell_2
			random_list = {
				70 = { custom_tooltip = azjakuma_add_random_skill_tt }
				25 = { }
				5 = { custom_tooltip = azjakuma_lose_random_skill_tt }
			}
		}
		else = {
			set_country_flag = spell_3
			random_list = {
				60 = { custom_tooltip = azjakuma_add_random_skill_tt }
				30 = { }
				10 = { custom_tooltip = azjakuma_lose_random_skill_tt }
			}
		}
		hidden_effect = { country_event = { id = flavor_azjakuma.1262 } }
		clr_country_flag = azjakuma_magic_menu_opened
		custom_tooltip = magic_spirit_consumption_desc_tt
		set_estate_privilege = estate_khelorvalshi_cast_magic
	}
}

#
country_event = {
	id = flavor_azjakuma.1256
	title = flavor_azjakuma.1256.t
	desc = flavor_azjakuma.1256.desc
	picture = CITY_VIEW_eventPicture

	is_triggered_only = yes
	
	hidden = yes
	
	#Go back
	option = {	
		name = flavor_azjakuma.1256.z	
		trigger_switch = {
			on_trigger = has_country_flag
			shinukhorchi_menu = { country_event = { id = flavor_azjakuma.1251 } clr_country_flag = shinukhorchi_menu }
			chumijemoya_menu = { country_event = { id = flavor_azjakuma.1252 } clr_country_flag = chumijemoya_menu }
			ajgriijarul_menu = { country_event = { id = flavor_azjakuma.1253 } clr_country_flag = ajgriijarul_menu }
			kabiurgarko_menu = { country_event = { id = flavor_azjakuma.1254 } clr_country_flag = kabiurgarko_menu }
			khelorvalshi_menu = { country_event = { id = flavor_azjakuma.1255 } clr_country_flag = khelorvalshi_menu }
		}
	}
}

#Rite of Fertility
country_event = {
	id = flavor_azjakuma.1257
	title = flavor_azjakuma.1257.t
	desc = flavor_azjakuma.1257.d
	picture = NEW_HEIR_eventPicture
	
	hidden = yes
	
	is_triggered_only = yes
	
	option = {
		# Success, get good heir
		name = flavor_azjakuma.1257.a
		ai_chance = {
			factor = 60
			modifier = {
				factor = 1.33
				estate_influence = {
					estate = estate_shinukhorchi
					influence = 33
				}
			}
			modifier = {
				factor = 1.33
				estate_influence = {
					estate = estate_shinukhorchi
					influence = 66
				}
			}
			modifier = {
				factor = 1.2
				OR = {
					ruler_has_personality = fertile_personality
					consort_has_personality = fertile_personality
				}
			}
			modifier = {
				factor = 0.8
				OR = {
					ruler_has_personality = infertile_personality
					consort_has_personality = infertile_personality
				}
			}
		}
		country_event = { id = flavor_azjakuma.1258 days = 240 random = 60 }
	}
	option = {
		# Failure, mother + child dies in childbirth
		name = flavor_azjakuma.1257.b
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0.75
				estate_influence = {
					estate = estate_shinukhorchi
					influence = 33
				}
			}
			modifier = {
				factor = 0.75
				estate_influence = {
					estate = estate_shinukhorchi
					influence = 66
				}
			}
			modifier = {
				factor = 0.8
				OR = {
					ruler_has_personality = fertile_personality
					consort_has_personality = fertile_personality
				}
			}
			modifier = {
				factor = 1.2
				OR = {
					ruler_has_personality = infertile_personality
					consort_has_personality = infertile_personality
				}
			}
		}
		country_event = { id = flavor_azjakuma.1259 days = 240 random = 60 }
	}
	option = {
		# Semi-success, mother dies in childbirth
		name = flavor_azjakuma.1257.d
		ai_chance = {
			factor = 10
			modifier = {
				factor = 1.2
				OR = {
					ruler_has_personality = fertile_personality
					consort_has_personality = fertile_personality
				}
			}
			modifier = {
				factor = 0.8
				OR = {
					ruler_has_personality = infertile_personality
					consort_has_personality = infertile_personality
				}
			}
		}
		country_event = { id = flavor_azjakuma.1261 days = 240 random = 60 }
	}
	option = {
		# Nothing happens. Flavor event for miscarriage/stillborn
		name = flavor_azjakuma.1257.e
		ai_chance = {
			factor = 20
			modifier = {
				factor = 0.75
				estate_influence = {
					estate = estate_shinukhorchi
					influence = 33
				}
			}
			modifier = {
				factor = 0.75
				estate_influence = {
					estate = estate_shinukhorchi
					influence = 66
				}
			}
			modifier = {
				factor = 0.8
				OR = {
					ruler_has_personality = fertile_personality
					consort_has_personality = fertile_personality
				}
			}
			modifier = {
				factor = 1.2
				OR = {
					ruler_has_personality = infertile_personality
					consort_has_personality = infertile_personality
				}
			}
		}
		country_event = { id = flavor_azjakuma.1260 days = 240 random = 60 }
	}
}

# Success event
country_event = {
	id = flavor_azjakuma.1258
	title = flavor_azjakuma.1258.t
	desc = flavor_azjakuma.1258.d
	picture = NEW_HEIR_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			random_list = {
				50 = { set_ruler_flag = boy_child }
				50 = { set_ruler_flag = girl_child }
			}
		}
	}
	after = {
		clr_ruler_flag = girl_child
		clr_ruler_flag = boy_child
	}
	option = {
		name = flavor_azjakuma.1258.a
		if = { limit = { has_heir = yes }
			add_prestige = -20
		}
		if = { limit = { has_ruler_flag = boy_child  }
			define_heir = {
				dynasty = ROOT
				claim = 100
				adm = 4
				dip = 4
				mil = 4
				max_random_adm = 4
				max_random_dip = 4
				max_random_mil = 4
			}
		}
		if = { limit = { has_ruler_flag = girl_child }
			define_heir = {
				dynasty = ROOT
				claim = 100
				female = yes
				adm = 4
				dip = 4
				mil = 4
				max_random_adm = 4
				max_random_dip = 4
				max_random_mil = 4
			}
		}
	}
	# If an heir was born in the 9 months (don't ask), keep the current heir
	option = {
		name = flavor_azjakuma.1258.b
		trigger = {
			has_heir = yes
		}
		# Keep current heir
	}
}

# Failure event, mother dies, child dies
country_event = {
	id = flavor_azjakuma.1259
	title = flavor_azjakuma.1259.t
	desc = flavor_azjakuma.1259.d
	picture = DEATH_OF_HEIR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = flavor_azjakuma.1259.a
		if = { limit = { is_female = yes }
			kill_ruler = yes
		}
		else = {
			kill_consort = yes
		}
	}
}

# Failure, nothing happens - Stillborn
country_event = {
	id = flavor_azjakuma.1260
	title = flavor_azjakuma.1260.t
	desc = flavor_azjakuma.1260.d
	picture = NEW_HEIR_eventPicture
	is_triggered_only = yes
	
	option = {
		name = flavor_azjakuma.1260.a
		# nothing
	}
}

# Semi failure, mother dies, child lives
country_event = {
	id = flavor_azjakuma.1261
	title = flavor_azjakuma.1261.t
	desc = flavor_azjakuma.1261.d
	picture = DEATH_OF_HEIR_eventPicture
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			random_list = {
				50 = { set_ruler_flag = boy_child }
				50 = { set_ruler_flag = girl_child }
			}
		}
	}
	after = {
		clr_ruler_flag = girl_child
		clr_ruler_flag = boy_child
	}
	option = {
		name = flavor_azjakuma.1261.a
		if = { limit = { has_heir = yes }
			add_prestige = -20
		}
		if = { limit = { is_female = yes }
			kill_ruler = yes
		}
		else = {
			kill_consort = yes
		}
		if = { limit = { has_ruler_flag = boy_child }
			define_heir = {
				dynasty = ROOT
				claim = 100
				adm = 4
				dip = 4
				mil = 4
				max_random_adm = 4
				max_random_dip = 4
				max_random_mil = 4
			}
		}
		if = { limit = { has_ruler_flag = girl_child }
			define_heir = {
				dynasty = ROOT
				claim = 100
				female = yes
				adm = 4
				dip = 4
				mil = 4
				max_random_adm = 4
				max_random_dip = 4
				max_random_mil = 4
			}
		}
	}
	# If an heir was born in the 9 months (don't ask), keep the current heir
	option = {
		name = flavor_azjakuma.1261.b
		trigger = {
			has_heir = yes
		}
		# Keep current heir
	}
}

#Result Selection for power type
country_event = {
	id = flavor_azjakuma.1262
	title = flavor_azjakuma.1262.t
	desc = flavor_azjakuma.1262.d
	picture = TEMPORAL_RIFT_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	option = { #Success
		name = flavor_azjakuma.1262.a
		ai_chance = {
			factor = 10
			modifier = { factor = 8 has_country_flag = spell_1 }
			modifier = { factor = 7 has_country_flag = spell_2 }
			modifier = { factor = 6 has_country_flag = spell_3 }
		}
		country_event = { id = flavor_azjakuma.1263 }
	}
	option = { #Nothing
		name = flavor_azjakuma.1262.a
		ai_chance = {
			factor = 10
			modifier = { factor = 2 has_country_flag = spell_1 }
			modifier = { factor = 2.5 has_country_flag = spell_2 }
			modifier = { factor = 3 has_country_flag = spell_3 }
		}
	}
	option = { #Fail
		name = flavor_azjakuma.1262.a
		ai_chance = {
			factor = 10
			modifier = { factor = 0 has_country_flag = spell_1 }
			modifier = { factor = 0.5 has_country_flag = spell_2 }
		}
		country_event = { id = flavor_azjakuma.1264 }
	}
	
	after = {
		clr_country_flag = spell_1
		clr_country_flag = spell_2
		clr_country_flag = spell_3
	}
}

#Success
country_event = {
	id = flavor_azjakuma.1263
	title = flavor_azjakuma.1263.t
	desc = flavor_azjakuma.1263.d
	picture = TEMPORAL_RIFT_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	option = { #Adm
		name = flavor_azjakuma.1263.a
		ai_chance = { factor = 33 }
		increase_ruler_stat = { adm = yes amount = 1 }
	}
	option = { #Dip
		name = flavor_azjakuma.1263.a
		ai_chance = { factor = 33 }
		increase_ruler_stat = { dip = yes amount = 1 }
	}
	option = { #Mil
		name = flavor_azjakuma.1263.a
		ai_chance = { factor = 33 }
		increase_ruler_stat = { mil = yes amount = 1 }
	}
}

#Fail
country_event = {
	id = flavor_azjakuma.1264
	title = flavor_azjakuma.1264.t
	desc = flavor_azjakuma.1264.d
	picture = TEMPORAL_RIFT_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	option = { #Adm
		name = flavor_azjakuma.1264.a
		ai_chance = { factor = 33 }
		decrease_ruler_stat = { adm = yes amount = 1 }
	}
	option = { #Dip
		name = flavor_azjakuma.1264.a
		ai_chance = { factor = 33 }
		decrease_ruler_stat = { dip = yes amount = 1 }
	}
	option = { #Mil
		name = flavor_azjakuma.1264.a
		ai_chance = { factor = 33 }
		decrease_ruler_stat = { mil = yes amount = 1 }
	}
}

#-----------------#

province_event = { #on_province_change azjakuma event handler
	id = flavor_azjakuma.2500
	title = flavor_azjakuma.1.t
	desc = flavor_azjakuma.1.d
	picture = CITY_VIEW_eventPicture

	is_triggered_only = yes
	hidden = yes
	
	immediate = {
		#move all events in on_province_change to here
		#include the triggers in the events, not here | most of them
		#all resistance events and losing shirgrii events
		#everything in here should be province events | well that changed, didn't it?
		if = {
			limit = {
				OR = {
					owned_by = Y01
					owner = {
						is_subject_of = Y01
						NOT = { is_subject_of_type = tributary_state_anb }
					}
				}
			}
			province_event = { id = flavor_azjakuma.2501 }
			province_event = { id = flavor_azjakuma.2502 }
			province_event = { id = flavor_azjakuma.2503 }
			province_event = { id = flavor_azjakuma.2504 }
			Y01 = {
				country_event = { id = flavor_azjakuma.2510 }
				country_event = { id = flavor_azjakuma.2511 }
				country_event = { id = flavor_azjakuma.2512 }
				country_event = { id = flavor_azjakuma.2513 }
				country_event = { id = flavor_azjakuma.2514 }
			}
		}
		if = {
			limit = {
				PREV = { FROM = { tag = Y01 } } #check this works
			}
			Y01 = {
				country_event = { id = flavor_azjakuma.2520 }
				country_event = { id = flavor_azjakuma.2521 }
				country_event = { id = flavor_azjakuma.2522 }
				country_event = { id = flavor_azjakuma.2523 }
				country_event = { id = flavor_azjakuma.2524 }
			}
		}
	}
	option = {
		name = flavor_azjakuma.1.a
	}
}
province_event = {
	#Shuvuush Reject Oni Rule
	id = flavor_azjakuma.2501
	title = flavor_azjakuma.2501.t
	desc = {
		trigger = {
			owner = {
				has_country_flag = oni_birb_rejection_setup
			}
		}
		desc = flavor_azjakuma.2501.r
	}
	desc = {
		trigger = {
			owner = {
				has_country_flag = oni_birb_caution_setup
			}
		}
		desc = flavor_azjakuma.2501.c
	}
	picture = ANGRY_MOB_eventPicture

	trigger = {
		owner = {
			tag = Y01
			OR = {
				has_country_flag = oni_birb_rejection_setup
				has_country_flag = oni_birb_caution_setup
			}
		}
		culture = shuvuush
		OR = {
			NOT = {
				has_province_modifier = azjakuma_birb_rejection #-10 mis strength, +3 unrest
			}
			NOT = {
				has_province_modifier = azjakuma_birb_caution
			}
		}
	}

	is_triggered_only = yes

	option = {
		name = flavor_azjakuma.2501.a
		ai_chance = { factor = 1 }
		trigger = {
			owner = {
				has_country_flag = oni_birb_rejection_setup
			}
		}

		custom_tooltip = azjakuma_birb_rejection_tooltip
		hidden_effect = {
			owner = {
				every_owned_province = {
					limit = {
						culture = shuvuush
						NOT = {
							has_province_modifier = azjakuma_birb_rejection
						}
					}
					add_province_modifier = {
						name = azjakuma_birb_rejection
						duration = -1
					}
				}
			}
		}
	}
	option = {
		name = flavor_azjakuma.2501.b
		ai_chance = { factor = 1 }
		trigger = {
			owner = {
				has_country_flag = oni_birb_caution_setup
			}
		}

		custom_tooltip = azjakuma_birb_caution_tooltip
		hidden_effect = {
			owner = {
				every_owned_province = {
					limit = {
						culture = shuvuush
						NOT = {
							has_province_modifier = azjakuma_birb_caution
						}
					}
					add_province_modifier = {
						name = azjakuma_birb_caution
						duration = -1
					}
				}
			}
		}
	}
}
province_event = {
	#Yan resistance
	id = flavor_azjakuma.2502
	title = flavor_azjakuma.2502.t
	desc = flavor_azjakuma.2502.d
	picture = ANGRY_MOB_eventPicture

	is_triggered_only = yes

	trigger = {
		owned_by = Y01
		owner = {
			NOT = { has_country_flag = yan_no_resistance }
		}
		OR = {
			culture_group = yan
			culture = serene_harimari
		}
		OR = {
			region = lower_yanshen_region
			region = upper_yanshen_region
			region = north_yanshen_region
		}
		NOT = { religion = lefthand_path }
		NOT = { has_province_flag = azjakuma_yan_remove_modifier }
		NOT = { has_province_modifier = azjakuma_yanshen_resistance }
		NOT = { area = anjiang_area }
		NOT = { area = linyuan_area }
		NOT = { area = yanzhong_area }
	}

	option = {
		name = flavor_azjakuma.2502.a
		custom_tooltip = azjakuma_yan_resistance_tooltip
		hidden_effect = {
			owner = {
				every_owned_province = {
					limit = {
						OR = {
							region = lower_yanshen_region
							region = upper_yanshen_region
							region = north_yanshen_region
						}
						NOT = { religion = lefthand_path }
						NOT = { has_province_flag = azjakuma_yan_remove_modifier }
						NOT = { has_province_modifier = azjakuma_yanshen_resistance }
						NOT = { area = anjiang_area }
						NOT = { area = linyuan_area }
						NOT = { area = yanzhong_area }
					}
					add_province_modifier = {
						name = azjakuma_yanshen_resistance
						duration = -1
					}
				}
			}
		}
	}
}
province_event = {
	#League resistance
	id = flavor_azjakuma.2503
	title = flavor_azjakuma.2503.t
	desc = flavor_azjakuma.2503.d
	picture = ANGRY_MOB_eventPicture

	is_triggered_only = yes

	trigger = {
		owned_by = Y01
		owner = {
			NOT = { has_country_flag = league_no_resistance }
		}
		OR = {
			culture_group = yan
			culture = serene_harimari
		}
		OR = {
			area = anjiang_area
			area = linyuan_area
			area = yanzhong_area
		}
		NOT = { religion = lefthand_path }
		NOT = { has_province_flag = azjakuma_league_remove_modifier }
		NOT = { has_province_modifier = azjakuma_league_resistance }
	}

	option = {
		name = flavor_azjakuma.2503.a
		custom_tooltip = azjakuma_league_resistance_tooltip
		hidden_effect = {
			owner = {
				every_owned_province = {
					limit = {
						OR = {
							area = anjiang_area
							area = linyuan_area
							area = yanzhong_area
						}
						NOT = { religion = lefthand_path }
						NOT = { has_province_flag = azjakuma_league_remove_modifier }
						NOT = { has_province_modifier = azjakuma_league_resistance }
					}
					add_province_modifier = {
						name = azjakuma_league_resistance
						duration = -1
					}
				}
			}
		}
	}
}

province_event = {
	#xia resistance (has 2 possible modifiers, 1 applied after disaster over, halved for vassals
	id = flavor_azjakuma.2504
	title = flavor_azjakuma.2504.t
	desc = flavor_azjakuma.2504.dx
	# desc = {
	# 	trigger = {
	# 		Y01 = { 
	# 			NOT = { has_country_flag = azjakuma_xianjie_remaining_resistance }
	# 			NOT = { has_country_flag = azjakuma_xianjie_no_resistance }
	# 		}
	# 	}
	# 	desc = flavor_azjakuma.2504.dx
	# }
	# desc = {
	# 	trigger = {
	# 		Y01 = {
	# 			has_country_flag = azjakuma_xianjie_remaining_resistance
	# 			NOT = { has_country_flag = azjakuma_xianjie_no_resistance }
	# 		}
	# 	}
	# 	desc = flavor_azjakuma.2504.dr
	# }
	picture = ANGRY_MOB_eventPicture

	is_triggered_only = yes

	trigger = {
		OR = {
			region = xianjie_region
			area = rangadevi_area
		}
		OR = {
			AND = {
				owned_by = Y01
				Y01 = { NOT = { has_country_flag = azjakuma_xianjie_no_resistance } }
				NOT = { has_province_modifier = azjakuma_remaining_resistance }
				NOT = { has_province_modifier = azjakuma_rebellious_xiaken }
			}
			AND = {
				owner = {
					is_subject_of = Y01
					NOT = { is_subject_of_type = tributary_state_anb }
				}
				Y01 = { NOT = { has_country_flag = azjakuma_xianjie_remaining_resistance } }
				Y01 = { NOT = { has_country_flag = azjakuma_xianjie_no_resistance } }
				NOT = { has_province_modifier = azjakuma_rebellious_xiaken_vassal }
			}
		}
	}

	option = {
		name = flavor_azjakuma.2504.a

		if = {
			limit = {
				OR = {
					region = xianjie_region
					area = rangadevi_area
				}
				owned_by = Y01
				NOT = { has_province_modifier = azjakuma_rebellious_xiaken }
				owner = {
					NOT = { has_country_flag = azjakuma_xianjie_remaining_resistance }
					NOT = { has_country_flag = azjakuma_xianjie_no_resistance }
				}
			}
			custom_tooltip = azjakuma_xianjie_resistance_tooltip
			hidden_effect = {
				owner = {
					every_owned_province = {
						limit = {
							OR = {
								region = xianjie_region
								area = rangadevi_area
							}
						}
						add_province_modifier = {
							name = azjakuma_rebellious_xiaken
							duration = -1
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					region = xianjie_region
					area = rangadevi_area
				}
				owned_by = Y01
				NOT = { has_province_modifier = azjakuma_remaining_resistance }
				owner = {
					has_country_flag = azjakuma_xianjie_remaining_resistance
					NOT = { has_country_flag = azjakuma_xianjie_no_resistance }
				}
			}
			custom_tooltip = azjakuma_xianjie_remaining_resistance_tooltip
			hidden_effect = {
				owner = {
					every_owned_province = {
						limit = {
							OR = {
								region = xianjie_region
								area = rangadevi_area
							}
						}
						add_province_modifier = {
							name = azjakuma_remaining_resistance
							duration = -1
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					region = xianjie_region
					area = rangadevi_area
				}
				NOT = { owned_by = Y01 }
				NOT = { has_province_modifier = azjakuma_rebellious_xiaken_vassal }
				Y01 = {
					NOT = { has_country_flag = azjakuma_xianjie_remaining_resistance }
					NOT = { has_country_flag = azjakuma_xianjie_no_resistance }
				}
			}
			custom_tooltip = azjakuma_xianjie_resistance_vassal_tooltip
			hidden_effect = {
				owner = {
					every_owned_province = {
						limit = {
							OR = {
								region = xianjie_region
								area = rangadevi_area
							}
						}
						add_province_modifier = {
							name = azjakuma_rebellious_xiaken_vassal
							duration = -1
						}
					}
				}
			}
		}
	}
}


country_event = {
	id = flavor_azjakuma.2510
	title =  flavor_azjakuma.2510.t
	desc =  flavor_azjakuma.2510.d
	picture = CITY_VIEW_eventPicture
	
	trigger = {
		tag = Y01
		has_country_flag = oni_shinukhorchi_lost
		owns_or_subject_of = 5430
	}
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			clr_country_flag = oni_shinukhorchi_lost
		}
	}
	
	option = {
		name = flavor_azjakuma.2510.a
		ai_chance = { factor = 100 }
		add_stability_or_adm_power = yes
		add_devotion = 10
		custom_tooltip = oni_shinukhorchi_regained_tooltip
	}
}

country_event = {
	id = flavor_azjakuma.2511
	title =  flavor_azjakuma.2511.t
	desc =  flavor_azjakuma.2511.d
	picture = CITY_VIEW_eventPicture
	
	trigger = {
		tag = Y01
		has_country_flag = oni_chumijemoya_lost
		owns_or_subject_of = 4831
	}
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			clr_country_flag = oni_chumijemoya_lost
		}
	}
	
	option = {
		name = flavor_azjakuma.2511.a
		ai_chance = { factor = 100 }
		add_stability_or_adm_power = yes
		add_devotion = 10
		custom_tooltip = oni_chumijemoya_regained_tooltip
	}
}

country_event = {
	id = flavor_azjakuma.2512
	title =  flavor_azjakuma.2512.t
	desc =  flavor_azjakuma.2512.d
	picture = CITY_VIEW_eventPicture
	
	trigger = {
		tag = Y01
		has_country_flag = oni_ajgriijarul_lost
		owns_or_subject_of = 4829
	}
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			clr_country_flag = oni_ajgriijarul_lost
		}
	}
	
	option = {
		name = flavor_azjakuma.2512.a
		ai_chance = { factor = 100 }
		add_stability_or_adm_power = yes
		add_devotion = 10
		custom_tooltip = oni_ajgriijarul_regained_tooltip
	}
}

country_event = {
	id = flavor_azjakuma.2513
	title =  flavor_azjakuma.2513.t
	desc =  flavor_azjakuma.2513.d
	picture = CITY_VIEW_eventPicture
	
	trigger = {
		tag = Y01
		has_country_flag = oni_kabiurgarko_lost
		owns_or_subject_of = 4828
	}
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			clr_country_flag = oni_kabiurgarko_lost
		}
	}
	
	option = {
		name = flavor_azjakuma.2513.a
		ai_chance = { factor = 100 }
		add_stability_or_adm_power = yes
		add_devotion = 10
		custom_tooltip = oni_ajgriijarul_regained_tooltip
	}
}

country_event = {
	id = flavor_azjakuma.2514
	title =  flavor_azjakuma.2514.t
	desc =  flavor_azjakuma.2514.d
	picture = CITY_VIEW_eventPicture
	
	trigger = {
		tag = Y01
		has_country_flag = oni_khelorvalshi_lost
		has_country_flag = khelorvalshi_restored
		owns_or_subject_of = 4848
	}
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			clr_country_flag = oni_khelorvalshi_lost
		}
	}
	
	option = {
		name = flavor_azjakuma.2514.a
		ai_chance = { factor = 100 }
		add_stability_or_adm_power = yes
		add_devotion = 10
		custom_tooltip = oni_khelorvalshi_regained_tooltip
	}
}

country_event = {
	id = flavor_azjakuma.2520
	title =  flavor_azjakuma.2520.t
	desc =  flavor_azjakuma.2520.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		tag = Y01
		NOT = { has_country_flag = oni_shinukhorchi_lost }
		NOT = { owns_or_subject_of = 5430 }
	}
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_country_flag = oni_shinukhorchi_lost
		}
	}
	
	option = {
		name = flavor_azjakuma.2520.a
		ai_chance = { factor = 100 }
		add_stability = -1
		add_devotion = -10
		custom_tooltip = oni_shinukhorchi_lost_tooltip
	}
}

country_event = {
	id = flavor_azjakuma.2521
	title =  flavor_azjakuma.2521.t
	desc =  flavor_azjakuma.2521.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		tag = Y01
		NOT = { has_country_flag = oni_chumijemoya_lost }
		NOT = { owns_or_subject_of = 4831 } #chumijemoya
	}
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_country_flag = oni_chumijemoya_lost
		}
	}
	
	option = {
		name = flavor_azjakuma.2521.a
		ai_chance = { factor = 100 }
		add_stability = -1
		add_devotion = -10
		custom_tooltip = oni_chumijemoya_lost_tooltip
	}
}

country_event = {
	id = flavor_azjakuma.2522
	title =  flavor_azjakuma.2522.t
	desc =  flavor_azjakuma.2522.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		tag = Y01
		NOT = { has_country_flag = oni_ajgriijarul_lost }
		NOT = { owns_or_subject_of = 4829 } #ajgriijarul
	}
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_country_flag = oni_ajgriijarul_lost
		}
	}
	
	option = {
		name = flavor_azjakuma.2522.a
		ai_chance = { factor = 100 }
		add_stability = -1
		add_devotion = -10
		custom_tooltip = oni_ajgriijarul_lost_tooltip
	}
}

country_event = {
	id = flavor_azjakuma.2523
	title =  flavor_azjakuma.2523.t
	desc =  flavor_azjakuma.2523.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		tag = Y01
		NOT = { has_country_flag = oni_kabiurgarko_lost }
		NOT = { owns_or_subject_of = 4828 } #kabiurgarko
	}
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_country_flag = oni_kabiurgarko_lost
		}
	}
	
	option = {
		name = flavor_azjakuma.2523.a
		ai_chance = { factor = 100 }
		add_stability = -1
		add_devotion = -10
		custom_tooltip = oni_kabiurgarko_lost_tooltip
	}
}

country_event = {
	id = flavor_azjakuma.2524
	title =  flavor_azjakuma.2524.t
	desc =  flavor_azjakuma.2524.d
	picture = COUNTRY_COLLAPSE_eventPicture
	
	trigger = {
		tag = Y01
		has_country_flag = khelorvalshi_restored
		NOT = { has_country_flag = oni_khelorvalshi_lost }
		NOT = { owns_or_subject_of = 4848 } #heiyukcheng
	}
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_country_flag = oni_khelorvalshi_lost
		}
	}
	option = {
		name = flavor_azjakuma.2524.a
		ai_chance = { factor = 100 }
		add_stability = -1
		add_devotion = -10
		custom_tooltip = oni_khelorvalshi_lost_tooltip
	}
}



country_event = { #Kongren Event Chain start - locate Kongren
	id = flavor_azjakuma.2600
	title = flavor_azjakuma.2600.t
	desc = flavor_azjakuma.2600.d
	picture = SPY_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavor_azjakuma.2600.a
		ai_chance = { factor = 1 }

		add_years_of_income = -0.75
		add_adm_power = -15
		add_dip_power = -15
		add_mil_power = -15

		hidden_effect = {
			country_event = { #guarenteed success
				id = flavor_azjakuma.2602
				days = 30
			}
		}
	}

	option = {
		name = flavor_azjakuma.2600.b
		ai_chance = { factor = 1 }
		add_years_of_income = -0.25
		add_adm_power = -5
		add_dip_power = -5
		add_mil_power = -5

		hidden_effect = {
			random_list = {
				50 = {
					country_event = {
						id = flavor_azjakuma.2601 #fail
						days = 30
					}
				}
				50 = {
					country_event = {
						id = flavor_azjakuma.2602 #success
						days = 30
					}
				}
			}
		}
	}

	option = { #guarenteed success
		name = flavor_azjakuma.2600.c
		ai_chance = { factor = 1 }
		highlight = yes
		trigger = {
			estate_loyalty = {
				estate = estate_chumijemoya
				loyalty = 60
			}
			estate_influence = {
				estate = estate_chumijemoya
				influence = 30
			}
			has_estate_privilege = estate_chumijemoya_spynetworks
		}

		add_years_of_income = -0.4
		add_estate_influence_modifier = {
			estate = estate_chumijemoya
			desc = kongren_locate_chumijemoya_guarenteed_success
			influence = 10
			duration = 3650
		}
		custom_tooltip = kongren_locate_chumijemoya_loyal_tooltip
		hidden_effect = {
			country_event = {
				id = flavor_azjakuma.2602
				days = 30
			}
		}
	}
}

country_event = { #Kongren Event Chain - locate Kongren failed
	id = flavor_azjakuma.2601
	title = flavor_azjakuma.2601.t
	desc = flavor_azjakuma.2601.d
	picture = KING_SICK_IN_BED_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavor_azjakuma.2601.a
		ai_chance = { factor = 1 }

		add_years_of_income = -0.75
		add_adm_power = -15
		add_dip_power = -15
		add_mil_power = -15

		hidden_effect = {
			country_event = { #guarenteed success
				id = flavor_azjakuma.2602
				days = 30
			}
		}
	}

	option = { #guarenteed success
		name = flavor_azjakuma.2601.c
		ai_chance = { factor = 1 }
		highlight = yes
		trigger = {
			estate_loyalty = {
				estate = estate_chumijemoya
				loyalty = 60
			}
			estate_influence = {
				estate = estate_chumijemoya
				influence = 30
			}
			has_estate_privilege = estate_chumijemoya_spynetworks
		}

		add_years_of_income = -0.5
		add_estate_influence_modifier = {
			estate = estate_chumijemoya
			desc = kongren_locate_chumijemoya_guarenteed_success
			influence = 10
			duration = 3650
		}
		custom_tooltip = kongren_locate_chumijemoya_loyal_tooltip
		hidden_effect = {
			country_event = {
				id = flavor_azjakuma.2602
				days = 30
			}
		}
	}
}

country_event = { #Kongren Event Chain - take kongren
	id = flavor_azjakuma.2602
	title = flavor_azjakuma.2602.t
	desc = flavor_azjakuma.2602.d
	picture = IKKO_IKKI_INCIDENT_eventPicture

	is_triggered_only = yes

	option = {
		name = flavor_azjakuma.2602.a
		ai_chance = { factor = 1 }
		add_manpower = -5
		add_years_of_income = -0.5
		add_mil_power = -30
		hidden_effect = {
			set_country_flag = kongren_attack_chance
			country_event = { id = flavor_azjakuma.2609 }
		}
	}

	option = {
		name = flavor_azjakuma.2602.b
		ai_chance = { factor = 1 }
		add_manpower = -1
		add_years_of_income = -0.5
		add_dip_power = -30
		hidden_effect = {
			set_country_flag = kongren_spy_chance
			country_event = { id = flavor_azjakuma.2609 }
		}
	}

	option = {
		name = flavor_azjakuma.2602.c
		ai_chance = { factor = 1 }

		add_manpower = -8
		add_years_of_income = -0.75
		add_mil_power = -30
		add_dip_power = -30
		hidden_effect = {
			set_country_flag = kongren_both_chance
			country_event = { id = flavor_azjakuma.2609 }
		}
	}

	option = {
		name = flavor_azjakuma.2602.e
		ai_chance = { factor = 1 }
		highlight = yes
		trigger = {
			has_ruler_flag = enchantment_3
		}
		add_adm_power = -20
		add_dip_power = -10
		custom_tooltip = kongren_take_enchantment_tooltip
		hidden_effect = {
			set_country_flag = kongren_enchant_chance
			country_event = { id = flavor_azjakuma.2609 }
		}
	}
}

country_event = { #Kongren Event Chain - final outcome - major success
	id = flavor_azjakuma.2603
	title = flavor_azjakuma.2603.t
	desc = flavor_azjakuma.2603.d
	picture = BATTLE_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavor_azjakuma.2603.a
		ai_chance = { factor = 1 }
		custom_tooltip = kongren_major_success_xia_tooltip
		hidden_effect = {
			every_known_country = {
				limit = {
					OR = {
						has_reform = wulin
						has_reform = one_xia
						has_reform = xiaken
						has_reform = indep_xiaken
						has_reform = xia_parliament_reform
					}
				}
				country_event = {
					id = flavor_azjakuma.2606
				}
			}
		}
		add_country_modifier = {
			name = azjakuma_seizure_of_kongren
			duration = -1
		}
	}
}

country_event = { #Kongren Event Chain - final outcome - minor success
	id = flavor_azjakuma.2604
	title = flavor_azjakuma.2604.t
	desc = flavor_azjakuma.2604.d
	picture = BATTLE_eventPicture

	is_triggered_only = yes
	fire_only_once = yes
	
	option = {
		name = flavor_azjakuma.2604.a
		ai_chance = { factor = 1 }
		custom_tooltip = kongren_minor_success_xia_tooltip
		hidden_effect = {
			every_known_country = {
				limit = {
					OR = {
						has_reform = wulin
						has_reform = one_xia
						has_reform = xiaken
						has_reform = indep_xiaken
						has_reform = xia_parliament_reform
					}
				}
				country_event = {
					id = flavor_azjakuma.2607
				}
			}
		}
		add_country_modifier = {
			name = azjakuma_seizure_of_kongren
			duration = -1
		}
	}
}

country_event = { #Kongren Event Chain - final outcome - failure
	id = flavor_azjakuma.2605
	title = flavor_azjakuma.2605.t
	desc = flavor_azjakuma.2605.d
	picture = BATTLE_eventPicture

	is_triggered_only = yes

	option = { #try again
		name = flavor_azjakuma.2605.a
		ai_chance = { factor = 1 }
		
		add_prestige = -5
		country_event = {
			id = flavor_azjakuma.2602
		}
	}

	option = { #give up
		name = flavor_azjakuma.2605.b
		ai_chance = { factor = 1 }

		add_prestige = -20
		custom_tooltip = kongren_failure_xia_tooltip
		hidden_effect = {
			every_known_country = {
				limit = {
					OR = {
						has_reform = wulin
						has_reform = one_xia
						has_reform = xiaken
						has_reform = indep_xiaken
						has_reform = xia_parliament_reform
					}
				}
				country_event = {
					id = flavor_azjakuma.2608
				}
			}	
		}
	}
}

country_event = { #Kongren Event Chain - final outcome - major success - xia
	id = flavor_azjakuma.2606
	title = flavor_azjakuma.2606.t
	desc = flavor_azjakuma.2606.d
	picture = COUNTRY_COLLAPSE_eventPicture

	is_triggered_only = yes

	option = {
		name = flavor_azjakuma.2606.a
		ai_chance = { factor = 1 }
		add_country_modifier = {
			name = azjakuma_failure_of_the_order #-15 morale
			duration = 9125 #25 years
		}
	}
}

country_event = { #Kongren Event Chain - final outcome - minor success - xia
	id = flavor_azjakuma.2607
	title = flavor_azjakuma.2607.t
	desc = flavor_azjakuma.2607.d
	picture = BATTLE_eventPicture

	is_triggered_only = yes

	option = {
		name = flavor_azjakuma.2607.a
		ai_chance = { factor = 1 }
		add_country_modifier = {
			name = azjakuma_valiant_order #+5 morale
			duration = 9125 #25 years
		}
	}
}

country_event = { #Kongren Event Chain - final outcome - failure - xia
	id = flavor_azjakuma.2608
	title = flavor_azjakuma.2608.t
	desc = flavor_azjakuma.2608.d
	picture = BATTLE_eventPicture

	is_triggered_only = yes

	option = {
		name = flavor_azjakuma.2608.a
		ai_chance = { factor = 1 }
		add_country_modifier = {
			name = azjakuma_victory_of_the_order #+15 morale
			duration = 9125 #25 years
		}
	}
}

country_event = { #Kongren Event Chain - determine final outcome success without seeding
	id = flavor_azjakuma.2609
	title = flavor_azjakuma.1.t
	desc = flavor_azjakuma.1.d
	picture = BATTLE_eventPicture

	is_triggered_only = yes
	hidden = yes

	after = {
		clr_country_flag = kongren_attack_chance
		clr_country_flag = kongren_spy_chance
		clr_country_flag = kongren_both_chance
		clr_country_flag = kongren_enchant_chance
	}

	option = { #major success
		name = flavor_azjakuma.1.a
		ai_chance = {
			factor = 1
			modifier = {
				factor = 45
				has_country_flag = kongren_attack_chance
				estate_loyalty = {
					estate = estate_ajgriijarul
					loyalty = 60
				}
			}
			modifier = {
				factor = 30
				has_country_flag = kongren_attack_chance
				NOT = {
					estate_loyalty = {
						estate = estate_ajgriijarul
						loyalty = 60
					}
				}
			}
			modifier = {
				factor = 40
				has_country_flag = kongren_spy_chance
				estate_loyalty = {
					estate = estate_chumijemoya
					loyalty = 60
				}
			}
			modifier = {
				factor = 30
				has_country_flag = kongren_spy_chance
				NOT = {
					estate_loyalty = {
						estate = estate_chumijemoya
						loyalty = 60
					}
				}
			}
			modifier = {
				factor = 85
				has_country_flag = kongren_both_chance
			}
			modifier = {
				factor = 95
				has_country_flag = kongren_enchant_chance
			}
		}
		country_event = {
			id = flavor_azjakuma.2603
			days = 30
		}
	}

	option = { #minor success
		name = flavor_azjakuma.1.a
		ai_chance = {
			factor = 1
			modifier = {
				factor = 20
				has_country_flag = kongren_attack_chance
				estate_loyalty = {
					estate = estate_ajgriijarul
					loyalty = 60
				}
			}
			modifier = {
				factor = 20
				has_country_flag = kongren_attack_chance
				NOT = {
					estate_loyalty = {
						estate = estate_ajgriijarul
						loyalty = 60
					}
				}
			}
			modifier = {
				factor = 15
				has_country_flag = kongren_spy_chance
				estate_loyalty = {
					estate = estate_chumijemoya
					loyalty = 60
				}
			}
			modifier = {
				factor = 10
				has_country_flag = kongren_spy_chance
				NOT = {
					estate_loyalty = {
						estate = estate_chumijemoya
						loyalty = 60
					}
				}
			}
			modifier = {
				factor = 15
				has_country_flag = kongren_both_chance
			}
			modifier = {
				factor = 5
				has_country_flag = kongren_enchant_chance
			}
		}
		country_event = {
			id = flavor_azjakuma.2604
			days = 30
		}
	}
	option = { #failure
		name = flavor_azjakuma.1.a
		ai_chance = {
			factor = 1
			modifier = {
				factor = 35
				has_country_flag = kongren_attack_chance
				estate_loyalty = {
					estate = estate_ajgriijarul
					loyalty = 60
				}
			}
			modifier = {
				factor = 50
				has_country_flag = kongren_attack_chance
				NOT = {
					estate_loyalty = {
						estate = estate_ajgriijarul
						loyalty = 60
					}
				}
			}
			modifier = {
				factor = 45
				has_country_flag = kongren_spy_chance
				estate_loyalty = {
					estate = estate_chumijemoya
					loyalty = 60
				}
			}
			modifier = {
				factor = 60
				has_country_flag = kongren_spy_chance
				NOT = {
					estate_loyalty = {
						estate = estate_chumijemoya
						loyalty = 60
					}
				}
			}
			modifier = {
				factor = 0
				has_country_flag = kongren_both_chance
			}
			modifier = {
				factor = 0
				has_country_flag = kongren_enchant_chance
			}
		}
		country_event = {
			id = flavor_azjakuma.2605
			days = 30
		}
	}
}

#rethagi events
country_event = {
	#The Yuantsai
	id = flavor_azjakuma.2650
	title = flavor_azjakuma.2650.t
	desc = flavor_azjakuma.2650.d
	picture = DIPLOMACY_eventPicture

	is_triggered_only = yes

	option = {
		name = flavor_azjakuma.2650.a
		ai_chance = { factor = 0 }

		add_spy_network_in = {
			who = Y89
			value = -20
		}
		Y89 = {
			country_event = {
				id = flavor_azjakuma.2651
			}
		}
	}
	option = { 
		name = flavor_azjakuma.2650.b
		ai_chance = { factor = 100 }

		add_spy_network_in = {
			who = Y89
			value = -20
		}
		Y89 = {
			set_country_flag = rethagi_offer
			country_event = {
				id = flavor_azjakuma.2651
			}
		}
		custom_tooltip = rethagi_grant_tooltip
	}
	option = {
		name = flavor_azjakuma.2650.c
		ai_chance = { factor = 0 }

		add_spy_network_in = {
			who = Y89
			value = -20
		}
		Y89 = {
			every_owned_province = {
				limit = {
					NOT = { is_core = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
}

country_event = {
	#yuantsai recieves event
	id = flavor_azjakuma.2651
	title = flavor_azjakuma.2651.t
	desc = flavor_azjakuma.2651.d
	picture = KINGS_CHOICE_eventPicture

	is_triggered_only = yes

	option = {
		name = flavor_azjakuma.2651.a
		ai_chance = { factor = 99 }


		Y01 = { #accept
			country_event = {
				id = flavor_azjakuma.2652
			}
		}
		add_prestige = -10
		if = {
			limit = {
				Y89 = {
					NOT = { has_country_flag = rethagi_offer }
				}
			}
			tooltip = {
				Y01 = {
					create_subject = {
						subject_type = vassal
						subject = Y89
					}
				}
			}
		}
		else_if = {
			limit = {
				Y89 = {
					has_country_flag = rethagi_offer
				}
			}
			tooltip = {
				Y01 = {
					create_subject = {
						subject_type = oni_governorship
						subject = Y89
					}
				}
				Y89 = {
					add_country_modifier = {
						name = azjakuma_rethagi
						duration = -1
					}
				}
			}
		}
	}
	option = {
		name = flavor_azjakuma.2651.b
		ai_chance = { factor = 1 }

		Y01 = {
			country_event = {
				id = flavor_azjakuma.2653
			}
		}
		add_prestige = 10
		tooltip = {
			Y89 = {
				every_owned_province = {
					limit = {
						NOT = { is_core = Y01 }
					}
					add_permanent_claim = Root
				}
			}
		}
		clr_country_flag = rethagi_offer
	}
}

country_event = {
	#yuantsai accepts
	id = flavor_azjakuma.2652
	title = flavor_azjakuma.2652.t
	desc = flavor_azjakuma.2652.d
	picture = DIPLOMACY_SIGNING_eventPicture

	is_triggered_only = yes

	after = {
		clr_country_flag = rethagi_offer
	}

	option = {
		name = flavor_azjakuma.2652.a
		ai_chance = { factor = 30 }

		if = {
			limit = {
				NOT = { Y89 = { has_country_flag = rethagi_offer } }
			}
			create_subject = {
				subject_type = vassal
				subject = Y89
			}
		}
		else_if = {
			limit = {
				Y89 = { has_country_flag = rethagi_offer }
			}
			create_subject = {
				subject_type = oni_governorship
				subject = Y89
			}
			Y89 = {
				add_country_modifier = {
					name = azjakuma_rethagi
					duration = -1
				}
			}
			custom_tooltip = rethagi_grant_tooltip
		}
	}
}

country_event = {
	#yuantsai rejects
	id = flavor_azjakuma.2653
	title = flavor_azjakuma.2653.t
	desc = flavor_azjakuma.2653.d
	picture = ONI_HUMANS_eventPicture

	is_triggered_only = yes

	option = {
		name = flavor_azjakuma.2653.a
		ai_chance = { factor = 30 }

		Y89 = {
			if = {
				limit = {
					is_subject_of_type_with_overlord = {
						who = Y01
						type = tributary_state_anb
					}
				}
				grant_independence = yes
			}
			every_owned_province = {
				limit = {
					NOT = { is_core = Y01 }
				}
				add_permanent_claim = Root
			}
		}
	}
}

country_event = {
	#Governance of southern yanshen
	id = flavor_azjakuma.2654
	title = flavor_azjakuma.2654.t
	desc = flavor_azjakuma.2654.d
	picture = KINGS_CHOICE_eventPicture

	is_triggered_only = yes
	immediate = {
		hidden_effect = {
			set_variable = { which = provinceCountIncrement value = 0 }
			set_variable = { which = provinceCount value = 0 }
			every_owned_province = {
				limit = {
					is_core = ROOT
					superregion = yanshen_superregion
					has_terrain = jungle
					NOT = { has_province_modifier = temple_complex }
					NOT = { has_province_modifier = damaged_temple_complex }
					NOT = { has_province_modifier = derelict_temple_complex }
					NOT = { has_province_modifier = ruined_temple_complex }
					NOT = { has_province_modifier = corrupted_temple_complex }
				}
				PREV = {
					change_variable = { which = provinceCount value = 1 }
				}
			}
		}
	}

	option = {
		name = flavor_azjakuma.2654.a
		every_owned_province = {
			limit = {
				superregion = yanshen_superregion
				OR = {
					has_terrain = jungle
					is_core = Y23
				}
				NOT = { has_province_modifier = temple_complex }
				NOT = { has_province_modifier = damaged_temple_complex }
				NOT = { has_province_modifier = derelict_temple_complex }
				NOT = { has_province_modifier = ruined_temple_complex }
				NOT = { has_province_modifier = corrupted_temple_complex }
			}
			cede_province = Y23
		}
		create_subject = {
			subject_type = oni_governorship
			subject = Y23
		}
		Y23 = {
			change_religion = lefthand_path
			add_country_modifier = {
				name = azjakuma_rethagi
				duration = -1
			}
			jyutsai_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			wanglam_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			hungngon_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			gungi_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			xiyun_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			luoyip_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			iongsim_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			hongnguan_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			mulim_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
		}
		add_opinion = { who = Y23 modifier = loyal_servants }
		reverse_add_opinion = { who = Y23 modifier = noble_oni }
		while = {
			limit = {
				NOT = {
					check_variable = {
						which = provinceCountIncrement
						which = provinceCount
					}
				}
			}
			add_adm_power = 50
			change_variable = {
				which = provinceCountIncrement
				value = 1
			}
		}
		add_country_modifier = {
			name = azjakuma_human_governance_of_frontiers
			duration = 7300
		}
		custom_tooltip = rethagi_grant_tooltip
		custom_tooltip = azjakuma_returned_50_adm_tooltip
	}
	option = {
		name = flavor_azjakuma.2654.b
		every_owned_province = {
			limit = {
				superregion = yanshen_superregion
				has_terrain = jungle
				NOT = { has_province_modifier = temple_complex }
				NOT = { has_province_modifier = damaged_temple_complex }
				NOT = { has_province_modifier = derelict_temple_complex }
				NOT = { has_province_modifier = ruined_temple_complex }
				NOT = { has_province_modifier = corrupted_temple_complex }
			}
			cede_province = Y23
		}
		create_subject = {
			subject_type = vassal
			subject = Y23
		}
		Y23 = {
			change_religion = lefthand_path
			jyutsai_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			wanglam_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			hungngon_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			gungi_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			xiyun_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			luoyip_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			iongsim_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			hongnguan_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
			mulim_area = {
				limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
				add_permanent_claim = PREV
			}
		}
		add_opinion = { who = Y23 modifier = loyal_servants }
		reverse_add_opinion = { who = Y23 modifier = noble_oni }
		while = {
			limit = {
				NOT = {
					check_variable = {
						which = provinceCountIncrement
						which = provinceCount
					}
				}
			}
			add_adm_power = 50
			change_variable = {
				which = provinceCountIncrement
				value = 1
			}
		}
		custom_tooltip = azjakuma_returned_50_adm_tooltip
	}
	option = {
		name = flavor_azjakuma.2654.c
		every_owned_province = {
			limit = {
				superregion = yanshen_superregion
				has_terrain = jungle
			}
			add_province_modifier = {
				name = azjakuma_rejected_self_governance
				duration = 7300
			}
		}
	}
}

country_event = {
	#Yanzhin League
	id = flavor_azjakuma.2655
	title = flavor_azjakuma.2655.t
	desc = flavor_azjakuma.2655.d
	picture = KINGS_CHOICE_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_variable = { which = provinceCountIncrementY value = 0 }
			set_variable = { which = provinceCountY value = 0 }
			every_owned_province = {
				limit = {
					is_core = ROOT
					OR = {
						area = anjiang_area
						area = linyuan_area
						area = yanzhong_area
					}
					NOT = { has_province_modifier = temple_complex }
					NOT = { has_province_modifier = damaged_temple_complex }
					NOT = { has_province_modifier = derelict_temple_complex }
					NOT = { has_province_modifier = ruined_temple_complex }
					NOT = { has_province_modifier = corrupted_temple_complex }
				}
				PREV = {
					change_variable = { which = provinceCountY value = 1 }
				}
			}
		}
	}

	option = {
		name = flavor_azjakuma.2655.a

		if = {
			limit = {
				OR = { 
					alliance_with = Y10
					Y10 = { is_subject_of = Y01 }
				}
			}
			create_subject = {
				subject_type = oni_governorship
				subject = Y10
			}
			every_owned_province = {
				limit = {
					OR = {
						area = anjiang_area
						area = linyuan_area
						area = yanzhong_area
					}
					NOT = { has_province_modifier = temple_complex }
					NOT = { has_province_modifier = damaged_temple_complex }
					NOT = { has_province_modifier = derelict_temple_complex }
					NOT = { has_province_modifier = ruined_temple_complex }
					NOT = { has_province_modifier = corrupted_temple_complex }
				}
				cede_province = Y10
			}
			Y10 = {
				change_religion = lefthand_path
				add_country_modifier = {
					name = azjakuma_rethagi
					duration = -1
				}
				anjiang_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				linyuan_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				yanzhong_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
			}
			while = {
				limit = {
					NOT = {
						check_variable = {
							which = provinceCountIncrementY
							which = provinceCountY
						}
					}
				}
				add_adm_power = 80
				change_variable = {
					which = provinceCountIncrementY
					value = 1
				}
			}
			custom_tooltip = azjakuma_returned_80_adm_tooltip
		}
		else = {
			every_owned_province = {
				limit = {
					OR = {
						area = anjiang_area
						area = linyuan_area
						area = yanzhong_area
					}
					NOT = { has_province_modifier = temple_complex }
					NOT = { has_province_modifier = damaged_temple_complex }
					NOT = { has_province_modifier = derelict_temple_complex }
					NOT = { has_province_modifier = ruined_temple_complex }
					NOT = { has_province_modifier = corrupted_temple_complex }
				}
				cede_province = Y10
			}
			create_subject = {
				subject_type = oni_governorship
				subject = Y10
			}
			Y10 = {
				change_religion = lefthand_path
				add_country_modifier = {
					name = azjakuma_rethagi
					duration = -1
				}
				anjiang_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				linyuan_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				yanzhong_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
			}
			add_opinion = { who = Y10 modifier = loyal_servants }
			reverse_add_opinion = { who = Y10 modifier = noble_oni }
			while = {
				limit = {
					NOT = {
						check_variable = {
							which = provinceCountIncrementY
							which = provinceCountY
						}
					}
				}
				add_adm_power = 80
				change_variable = {
					which = provinceCountIncrementY
					value = 1
				}
			}
		}
		custom_tooltip = rethagi_grant_tooltip
		custom_tooltip = azjakuma_returned_80_adm_tooltip
	}

	option = {
		name = flavor_azjakuma.2655.b

		trigger = {
			OR = { 
				alliance_with = Y10
				Y10 = { is_subject_of = Y01 ai = yes }
			}
		}

		create_subject = {
			subject_type = oni_governorship
			subject = Y10
		}
		Y10 = {
			change_religion = lefthand_path
			add_country_modifier = {
				name = azjakuma_rethagi
				duration = -1
			}
		}
		custom_tooltip = rethagi_grant_tooltip
	}

	option = {
		name = flavor_azjakuma.2655.c
	}
}

country_event = {
	#Yuanszi Governance
	id = flavor_azjakuma.2656
	title = flavor_azjakuma.2656.t
	desc = flavor_azjakuma.2656.d
	picture = BIG_BOOK_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_variable = { which = provinceCountIncrementYu value = 0 }
			set_variable = { which = provinceCountYu value = 0 }
			every_owned_province = {
				limit = {
					OR = {
						region = xianjie_region
						area = rangadevi_area
					}
					is_core = ROOT
					NOT = { trade_goods = gold }
					NOT = { trade_goods = damestear }
					NOT = { has_province_modifier = temple_complex }
					NOT = { has_province_modifier = damaged_temple_complex }
					NOT = { has_province_modifier = derelict_temple_complex }
					NOT = { has_province_modifier = ruined_temple_complex }
					NOT = { has_province_modifier = corrupted_temple_complex }
				}
				PREV = {
					change_variable = { which = provinceCountYu value = 1 }
				}
			}
		}
	}

	option = {
		name = flavor_azjakuma.2656.a
		add_country_modifier = {
			name = azjakuma_human_governance_of_frontiers
			duration = 7300
		}
		if = {
			limit = {
				Y89 = {
					is_subject_of = Y01
					NOT = { is_subject_of_type = tributary_state_anb }
				}
			}
			add_adm_power = -100
			add_dip_power = -100
			every_owned_province = {
				limit = {
					OR = {
						region = xianjie_region
						area = rangadevi_area
					}
					NOT = { trade_goods = gold }
					NOT = { trade_goods = damestear }
					NOT = { has_province_modifier = temple_complex }
					NOT = { has_province_modifier = damaged_temple_complex }
					NOT = { has_province_modifier = derelict_temple_complex }
					NOT = { has_province_modifier = ruined_temple_complex }
					NOT = { has_province_modifier = corrupted_temple_complex }
				}
				cede_province = Y89
			}
			Y89 = {
				change_religion = lefthand_path
				add_country_modifier = {
					name = azjakuma_rethagi
					duration = -1
				}
				xianjie_region = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				rangadevi_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
			}
			create_subject = {
				subject_type = oni_governorship
				subject = Y89
			}
			while = {
				limit = {
					NOT = {
						check_variable = {
							which = provinceCountIncrementYu
							which = provinceCountYu
						}
					}
				}
				add_adm_power = 50
				change_variable = {
					which = provinceCountIncrementYu
					value = 1
				}
			}
			custom_tooltip = azjakuma_returned_50_adm_tooltip
		}
		else = {
			add_adm_power = -125
			add_dip_power = -150
			every_owned_province = {
				limit = {
					OR = {
						region = xianjie_region
						area = rangadevi_area
					}
					NOT = { trade_goods = gold }
					NOT = { trade_goods = damestear }
					NOT = { has_province_modifier = temple_complex }
					NOT = { has_province_modifier = damaged_temple_complex }
					NOT = { has_province_modifier = derelict_temple_complex }
					NOT = { has_province_modifier = ruined_temple_complex }
					NOT = { has_province_modifier = corrupted_temple_complex }
				}
				cede_province = Y89
			}
			Y01 = {
				create_subject = {
					subject_type = oni_governorship
					subject = Y89
				}
			}
			Y89 = {
				change_religion = lefthand_path
				add_country_modifier = {
					name = azjakuma_rethagi
					duration = -1
				}
				xianjie_region = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				rangadevi_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
			}
			add_opinion = { who = Y89 modifier = loyal_servants }
			reverse_add_opinion = { who = Y89 modifier = noble_oni }
			while = {
				limit = {
					NOT = {
						check_variable = {
							which = provinceCountIncrementYu
							which = provinceCountYu
						}
					}
				}
				add_adm_power = 50
				change_variable = {
					which = provinceCountIncrementYu
					value = 1
				}
			}
			custom_tooltip = rethagi_grant_tooltip
			custom_tooltip = azjakuma_returned_50_adm_tooltip
		}
	}

	option = {
		name = flavor_azjakuma.2656.b
	}
}

country_event = {
	#Self Governance in Shamakhad
	id = flavor_azjakuma.2657
	title = flavor_azjakuma.2657.t
	desc = flavor_azjakuma.2657.d
	picture = KINGS_CHOICE_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_variable = { which = provinceCountIncrementS value = 0 }
			set_variable = { which = provinceCountS value = 0 }
			every_owned_province = {
				limit = {
					is_core = ROOT
					area = sir_area
					has_temple_complex = no
				}
				PREV = {
					change_variable = { which = provinceCountS value = 1 }
				}
			}
		}
	}

	option = {
		name = flavor_azjakuma.2657.a
		if = {
			limit = {
				R78 = {
					is_subject_of = Y01
					NOT = { is_subject_of_type = tributary_state_anb }
				}
			}
			add_adm_power = -100
			add_dip_power = -100
			every_owned_province = {
				limit = {
					area = sir_area
					NOT = { has_province_modifier = temple_complex }
					NOT = { has_province_modifier = damaged_temple_complex }
					NOT = { has_province_modifier = derelict_temple_complex }
					NOT = { has_province_modifier = ruined_temple_complex }
					NOT = { has_province_modifier = corrupted_temple_complex }
				}
				cede_province = R78
			}
			R78 = {
				change_religion = lefthand_path
				yodhilakra_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				pharata_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				nadida_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				ghatasak_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				khasardul_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				raghajandi_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				marudhoj_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				khamarutar_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				tamvihar_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
			}
			add_opinion = { who = R78 modifier = loyal_servants }
			reverse_add_opinion = { who = R78 modifier = noble_oni }
			while = {
				limit = {
					NOT = {
						check_variable = {
							which = provinceCountIncrementS
							which = provinceCountS
						}
					}
				}
				add_adm_power = 50
				change_variable = {
					which = provinceCountIncrementS
					value = 1
				}
			}
			custom_tooltip = azjakuma_returned_50_adm_tooltip
		}
		else = {
			add_adm_power = -125
			add_dip_power = -150
			every_owned_province = {
				limit = {
					area = sir_area
					NOT = { trade_goods = gold }
					NOT = { trade_goods = damestear }
					NOT = { has_province_modifier = temple_complex }
					NOT = { has_province_modifier = damaged_temple_complex }
					NOT = { has_province_modifier = derelict_temple_complex }
					NOT = { has_province_modifier = ruined_temple_complex }
					NOT = { has_province_modifier = corrupted_temple_complex }
				}
				cede_province = R78
			}
			Y01 = {
				create_subject = {
					subject_type = oni_governorship
					subject = R78
				}
			}
			add_opinion = { who = R78 modifier = loyal_servants }
			reverse_add_opinion = { who = R78 modifier = noble_oni }
			R78 = {
				change_religion = lefthand_path
				add_country_modifier = {
					name = azjakuma_rethagi
					duration = -1
				}
				yodhilakra_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				pharata_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				nadida_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				ghatasak_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				khasardul_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				raghajandi_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				marudhoj_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				khamarutar_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				tamvihar_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
			}
			while = {
				limit = {
					NOT = {
						check_variable = {
							which = provinceCountIncrementS
							which = provinceCountS
						}
					}
				}
				add_adm_power = 30
				change_variable = {
					which = provinceCountIncrementS
					value = 1
				}
			}
			custom_tooltip = rethagi_grant_tooltip
			custom_tooltip = azjakuma_returned_50_adm_tooltip
		}
	}

	option = {
		name = flavor_azjakuma.2657.b
		trigger = {
			NOT = {
				R78 = {
					is_subject_of_type_with_overlord = {
						who = Y01
						type = vassal
					}
				}
			}
		}
		if = {
			limit = {
				R78 = {
					is_subject_of = Y01
					NOT = { is_subject_of_type = tributary_state_anb }
				}
			}
			add_adm_power = -100
			add_dip_power = -100
			every_owned_province = {
				limit = {
					area = sir_area
					NOT = { has_province_modifier = temple_complex }
					NOT = { has_province_modifier = damaged_temple_complex }
					NOT = { has_province_modifier = derelict_temple_complex }
					NOT = { has_province_modifier = ruined_temple_complex }
					NOT = { has_province_modifier = corrupted_temple_complex }
				}
				cede_province = R78
			}
			add_opinion = { who = R78 modifier = loyal_servants }
			reverse_add_opinion = { who = R78 modifier = noble_oni }
			R78 = {
				change_religion = lefthand_path
				yodhilakra_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				pharata_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				nadida_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				ghatasak_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				khasardul_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				raghajandi_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				marudhoj_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				khamarutar_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				tamvihar_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
			}
			while = {
				limit = {
					NOT = {
						check_variable = {
							which = provinceCountIncrementS
							which = provinceCountS
						}
					}
				}
				add_adm_power = 50
				change_variable = {
					which = provinceCountIncrementS
					value = 1
				}
			}
			add_liberty_desire = 25
			custom_tooltip = azjakuma_returned_50_adm_tooltip
		}
		else = {
			add_adm_power = -125
			add_dip_power = -150
			every_owned_province = {
				limit = {
					area = sir_area
					NOT = { trade_goods = gold }
					NOT = { trade_goods = damestear }
					NOT = { has_province_modifier = temple_complex }
					NOT = { has_province_modifier = damaged_temple_complex }
					NOT = { has_province_modifier = derelict_temple_complex }
					NOT = { has_province_modifier = ruined_temple_complex }
					NOT = { has_province_modifier = corrupted_temple_complex }
				}
				cede_province = R78
			}
			Y01 = {
				create_subject = {
					subject_type = vassal
					subject = R78
				}
			}
			add_opinion = { who = R78 modifier = loyal_servants }
			reverse_add_opinion = { who = R78 modifier = noble_oni }
			R78 = {
				change_religion = lefthand_path
				yodhilakra_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				pharata_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				nadida_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				ghatasak_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				khasardul_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				raghajandi_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				marudhoj_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				khamarutar_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
				tamvihar_area = {
					limit = { NOT = { is_core = PREV is_permanent_claim = PREV province_group = temple_province_group } }
					add_permanent_claim = PREV
				}
			}
			while = {
				limit = {
					NOT = {
						check_variable = {
							which = provinceCountIncrementS
							which = provinceCountS
						}
					}
				}
				add_adm_power = 30
				change_variable = {
					which = provinceCountIncrementS
					value = 1
				}
			}
			R78 = {
				add_liberty_desire = 25
			}
			custom_tooltip = azjakuma_returned_50_adm_tooltip
		}
	}

	option = {
		name = flavor_azjakuma.2657.c

		add_stability = -1

		4633 = {
			spawn_rebels = {
				type = nationalist_rebels
				size = 2
			}
		}
	}
}

country_event = {
	#start of xianjie disaster
	id = flavor_azjakuma.2700
	title = flavor_azjakuma.2700.t
	desc = {
		trigger = {
			NOT = {
				Y89 = {
					is_subject_of = Y01
				}
			}
		}
		desc = flavor_azjakuma.2700.dd
	}
	desc = {
		trigger = {
			Y89 = {
				is_subject_of = Y01
			}
		}
		desc = flavor_azjakuma.2700.dr
	}
	picture = COUNTRY_COLLAPSE_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			xianjie_region = {
				limit = {
					country_or_non_sovereign_subject_holds = ROOT
					is_territorial_core = ROOT
				}
				set_province_flag = azjakuma_was_territorial_core
			}
			xianjie_region = {
				limit = {
					country_or_non_sovereign_subject_holds = ROOT
				}
				add_core = Y99
				cede_province = Y99
			}
			rangadevi_area = {
				limit = {
					country_or_non_sovereign_subject_holds = ROOT
				}
				add_core = Y99
				cede_province = Y99
			}
			Y99 = {
				declare_war_with_cb = {
					who = Y01
					casus_belli = cb_civ_vs_monster
				}
				country_event = {
					id = flavor_azjakuma.2703
				}
			}
		}
	}

	option = {
		name = flavor_azjakuma.2700.a
		custom_tooltip = azjakuma_xia_break_away_tooltip
		tooltip = {
			Y99 = {
				declare_war_with_cb = {
					who = Y01
					casus_belli = cb_civ_vs_monster
				}
			}
		}
		custom_tooltip = reannex_xia_peace_offer_notification_tooltip
	}
}
country_event = {
	#end of xianjie disaster
	id = flavor_azjakuma.2701
	title = flavor_azjakuma.2701.t
	desc = flavor_azjakuma.2701.d
	picture = KINGS_CHOICE_eventPicture

	is_triggered_only = yes

	option = { #keep all land
		name = flavor_azjakuma.2701.a
		set_country_flag = xia_subjugated_oni
		if = {
			limit = { any_owned_province = { has_province_flag = azjakuma_was_territorial_core } }
			custom_tooltip = azjakuma_add_territorial_core_tooltip
		}
		hidden_effect = {
			every_owned_province = {
				limit = {
					has_province_flag = azjakuma_was_territorial_core
				}
				add_territorial_core = ROOT
				clr_province_flag = azjakuma_was_territorial_core
			}
		}
	}

	option = { #give all but temple to yuanszi
		name = flavor_azjakuma.2701.b
		every_owned_province = {
			limit = {
				OR = {
					region = xianjie_region
					area = rangadevi_area
				}
				NOT = {
					OR = {
						has_province_modifier = temple_complex
						has_province_modifier = damaged_temple_complex
						has_province_modifier = ruined_temple_complex
						has_province_modifier = corrupted_temple_complex
					}
				}
			}
			cede_province = Y89
		}
		set_country_flag = xia_subjugated_oni
		Y01 = {
			create_subject = {
				subject_type = oni_governorship
				subject = Y89
			}
		}
		Y89 = {
			change_religion = lefthand_path
			add_country_modifier = {
				name = azjakuma_rethagi
				duration = -1
			}
		}
		hidden_effect = {
			add_opinion = { who = Y89 modifier = loyal_servants }
			reverse_add_opinion = { who = Y89 modifier = noble_oni }
		}
		custom_tooltip = rethagi_grant_tooltip
	}
}

country_event = {
	#random rebellion
	id = flavor_azjakuma.2702
	title = flavor_azjakuma.2702.t
	desc = flavor_azjakuma.2702.d
	picture = REVOLUTION_eventPicture

	is_triggered_only = yes
	
	trigger = { any_owned_province = { NOT = { religion = lefthand_path } } }

	option = {
		name = flavor_azjakuma.2702
		random_owned_province = {
			limit = { NOT = { religion = lefthand_path } }
			spawn_rebels = {
				type = nationalist_rebels
				size = 1
			}
		}
	}
}

country_event = {
	#xia setup event, needs buffs, crowns, xiadao capital, troops, and manpower
	id = flavor_azjakuma.2703
	title = flavor_azjakuma.2703.t
	desc = flavor_azjakuma.2703.d
	picture = KINGS_CHOICE_eventPicture

	is_triggered_only = yes

	immediate = {
		every_neighbor_country = {
			limit = {
				NOT = { tag = Y01 }
			}
			add_truce_with = Y99
		}
		set_capital = 4559
		yanshen_superregion = {
			discover_country = Y99
		}
		rahen_superregion = {
			discover_country = Y99
		}
		south_haless_superregion = {
			discover_country = Y99
		}
		add_treasury = 5000
		add_manpower = 50
		add_country_modifier = {
			name = azjakuma_xia_buff
			duration = 3650
		}
		capital_scope = {
			build_to_forcelimit = {
				infantry = 0.56
				cavalry = 0.4
				artillery = 0.4
			}
		}
	}

	option = { #keep all land
		name = flavor_azjakuma.2701.a
	}
}

country_event = {
	id = flavor_azjakuma.2801
	title = flavor_azjakuma.2801.t
	desc = flavor_azjakuma.2801.d
	picture = KOBOLD_HOARD_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		tag = Y01
		ai = no
		any_owned_province = {
			culture = goldscale_kobold
			base_production = 2
		}
	}

	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					culture = goldscale_kobold
					base_production = 2
				}
				save_event_target_as = take_prod_1
			}
			if = {
				limit = {
					num_of_owned_provinces_with = {
						value = 2
						culture = goldscale_kobold
						base_production = 2
					}
				}
				random_owned_province = {
					limit = {
						culture = goldscale_kobold
						base_production = 2
						NOT = { province_id = event_target:take_prod_1 }
					}
					save_event_target_as = take_prod_2
				}
			}
		}
	}

	option = {
		name = flavor_azjakuma.2801.a

		if = {
			limit = {
				has_saved_event_target = take_prod_2
			}
			event_target:take_prod_1 = {
				add_base_production = -1
			}
			event_target:take_prod_2 = {
				add_base_production = -1
			}
			4828 = {
				add_base_production = 2
				add_kobold_minority_size_effect = yes
				add_kobold_minority_size_effect = yes
			}
		}
		
		else = {
			event_target:take_prod_1 = {
				add_base_production = -1
			}
			4828 = {
				add_base_production = 1
				add_kobold_minority_size_effect = yes
			}
		}
		add_years_of_income = 0.1
	}
}